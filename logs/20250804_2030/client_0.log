2025-08-04 20:30:06,255 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:06,255 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:06,255 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:06,255 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:30:06,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:30:06,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:06,685 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:06,685 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:06,777 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:30:06,830 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:30:06,831 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:07,133 - ClientAppLogger [Client 0] - INFO - Global hold-out test set with 31657 samples saved to /app/logs/20250804_2030/holdout_test_set.csv
2025-08-04 20:30:07,196 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:07,201 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:07,201 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:07,207 - ClientAppLogger [Client 0] - INFO - Scaler object saved by client 0 to /app/logs/20250804_2030/min_max_scaler.pkl
2025-08-04 20:30:07,207 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:30:07,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:07,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:30:07,214 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:07,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:07,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:30:07,224 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:07,227 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:07,230 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:07,233 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:07,236 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:07,238 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:07,241 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:07,244 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:07,247 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:07,249 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:07,251 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:07,260 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:07,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:30:07,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:30:07,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:30:07,269 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:07,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:30:07,278 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:07,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:30:07,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:07,293 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:07,297 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:30:07,304 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:30:07,304 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:07,304 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:07,304 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:07,304 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:07,304 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:07,305 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:30:07,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:07,305 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:30:07,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:07,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:30:07,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:30:07,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:30:07,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:07,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:07,310 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:07,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:30:07,310 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:30:07,310 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:30:07,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:30:07,316 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:30:07,316 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:07,317 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:07,317 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:07,319 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:07,319 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:07,319 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:07,320 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:07,334 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3481, Threshold=0.3636, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:30:07,334 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3481
2025-08-04 20:30:18,598 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:18,598 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:18,598 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:18,598 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:30:18,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:30:18,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:18,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:18,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:18,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:30:19,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:30:19,005 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:19,117 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:19,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:19,124 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:19,131 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:30:19,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:19,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:30:19,152 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:19,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:19,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:30:19,161 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:19,164 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:19,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:19,169 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:19,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:19,175 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:19,178 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:19,180 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:19,183 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:19,185 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:19,187 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:19,199 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:19,199 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:30:19,205 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:30:19,205 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:30:19,210 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:19,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:30:19,220 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:19,220 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:30:19,220 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:19,235 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:19,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:30:19,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:30:19,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:19,247 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:19,247 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:19,248 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:19,248 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:19,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:30:19,248 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:19,249 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:30:19,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:19,250 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:30:19,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:30:19,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:19,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:30:19,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:19,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:30:19,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:30:19,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:30:19,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:30:19,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:30:19,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:30:19,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:30:19,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:19,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:30:19,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:19,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:19,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:19,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:30:19,255 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:30:19,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:30:19,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:30:19,258 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:30:19,258 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:19,259 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:19,259 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:19,265 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:19,265 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:19,265 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:19,266 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:19,280 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3379, Threshold=0.3533, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:30:19,280 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3379
2025-08-04 20:30:30,539 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:30,539 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:30,539 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:30,540 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:30:30,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:30:30,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:30,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:30,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:30,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:30:30,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:30:30,953 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:31,079 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:31,087 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:31,087 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:31,093 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:30:31,100 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:31,100 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:30:31,101 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:31,101 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:31,101 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:30:31,110 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:31,113 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:31,115 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:31,117 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:31,120 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:31,122 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:31,125 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:31,128 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:31,131 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:31,133 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:31,135 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:31,146 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:31,146 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:30:31,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:30:31,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:30:31,157 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:31,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:30:31,176 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:31,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:30:31,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:31,192 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:31,197 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:30:31,204 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:30:31,204 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:31,204 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:31,204 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:31,205 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:31,205 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:31,205 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:30:31,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:31,206 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:30:31,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:31,207 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:30:31,207 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:30:31,208 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:31,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:30:31,208 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:31,208 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:31,208 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:31,208 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:30:31,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:30:31,210 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:31,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:31,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:31,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:30:31,211 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:30:31,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:30:31,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:30:31,218 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:30:31,218 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:31,220 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:31,220 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:31,222 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:31,222 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:31,222 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:31,223 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:31,237 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3452, Threshold=0.3607, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:30:31,237 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3452
2025-08-04 20:30:45,499 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:45,499 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:45,499 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:45,499 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:30:45,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:30:45,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:45,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:45,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:45,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:30:45,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:30:45,878 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:45,979 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:45,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:45,986 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:45,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:30:46,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:46,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:30:46,003 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:46,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:46,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:30:46,013 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:46,016 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:46,019 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:46,021 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:46,023 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:46,026 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:46,029 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:46,031 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:46,034 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:46,036 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:46,038 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:46,047 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:46,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:30:46,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:30:46,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:30:46,058 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:46,058 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:30:46,068 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:46,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:30:46,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:46,083 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:46,088 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:30:46,092 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:30:46,092 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:46,092 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:46,092 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:46,093 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:46,093 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:46,093 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:30:46,093 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:46,094 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:30:46,094 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:46,095 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:30:46,095 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:30:46,096 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:46,096 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:30:46,096 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:46,096 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:30:46,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:46,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:30:46,099 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:46,099 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:46,099 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:46,099 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:30:46,099 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:30:46,100 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:30:46,100 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:30:46,106 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:30:46,106 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:46,107 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:46,108 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:46,109 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:46,110 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:46,110 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:46,110 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:46,124 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3363, Threshold=0.3512, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:30:46,124 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3363
2025-08-04 20:31:06,418 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:06,419 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:06,419 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:06,419 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:31:06,419 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:31:06,419 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:06,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:06,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:06,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:31:06,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:31:06,951 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:07,100 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:07,108 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:07,108 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:07,115 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:31:07,128 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:07,128 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:31:07,129 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:07,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:07,130 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:31:07,141 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:07,147 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,150 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:07,153 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:07,156 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:07,160 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:07,163 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,165 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:07,168 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:07,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:07,177 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:07,191 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:07,193 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:31:07,201 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:31:07,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:31:07,214 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:07,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:31:07,230 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:07,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:31:07,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:07,249 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:07,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:31:07,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:31:07,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:07,266 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:07,266 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:07,267 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:07,267 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:07,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:31:07,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:07,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:31:07,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:07,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:31:07,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:31:07,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:07,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:31:07,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:07,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:31:07,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:31:07,273 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:31:07,273 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:31:07,273 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:31:07,273 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:31:07,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:31:07,274 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:07,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:31:07,274 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:07,274 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:07,274 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:07,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:31:07,275 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:31:07,275 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:31:07,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:31:07,282 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:31:07,282 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:07,283 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:07,283 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:07,285 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:07,285 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:07,285 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:07,286 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:07,307 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3439, Threshold=0.3581, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:31:07,307 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3439
2025-08-04 20:31:24,604 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:24,604 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:24,604 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:24,605 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:31:24,605 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:31:24,605 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:24,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:24,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:24,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:31:25,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:31:25,024 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:25,116 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:25,122 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:25,123 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:25,130 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:31:25,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:25,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:31:25,143 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:25,143 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:25,143 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:31:25,151 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:25,155 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:25,158 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:25,161 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:25,164 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:25,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:25,170 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:25,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:25,176 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:25,178 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:25,181 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:25,191 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:25,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:31:25,196 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:31:25,196 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:31:25,202 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:25,203 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:31:25,217 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:25,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:31:25,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:25,238 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:25,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:31:25,250 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:31:25,250 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:25,250 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:25,250 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:25,251 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:25,251 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:25,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:31:25,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:25,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:31:25,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:25,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:31:25,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:31:25,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:31:25,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:31:25,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:31:25,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:31:25,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:31:25,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:31:25,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:31:25,256 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:31:25,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:31:25,256 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:31:25,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:31:25,256 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:25,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:31:25,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:25,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:25,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:25,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:31:25,257 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:31:25,258 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:31:25,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:31:25,265 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:31:25,265 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:25,266 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:25,266 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:25,268 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:25,268 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:25,268 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:25,269 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:25,282 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3462, Threshold=0.3604, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:31:25,283 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3462
2025-08-04 20:31:36,564 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:36,564 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:36,564 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:36,564 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:31:36,564 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:31:36,564 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:36,911 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:36,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:37,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:31:37,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:31:37,053 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:37,171 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:37,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:37,180 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:37,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:31:37,204 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:37,204 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:31:37,205 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:37,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:37,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:31:37,216 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:37,220 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:37,223 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:37,225 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:37,228 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:37,231 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:37,234 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:37,236 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:37,239 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:37,242 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:37,244 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:37,254 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:37,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:31:37,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:31:37,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:31:37,264 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:37,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:31:37,275 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:37,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:31:37,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:37,292 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:37,298 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:31:37,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:31:37,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:37,307 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:37,307 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:37,308 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:37,308 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:37,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:31:37,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:37,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:31:37,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:37,310 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:31:37,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:31:37,311 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:37,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:31:37,311 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:37,311 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:31:37,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:37,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:31:37,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:37,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:37,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:37,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:31:37,315 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:31:37,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:31:37,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:31:37,321 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:31:37,321 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:37,323 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:37,323 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:37,324 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:37,324 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:37,324 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:37,325 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:37,344 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3257, Threshold=0.3389, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:31:37,344 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3257
2025-08-04 20:31:48,709 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:48,709 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:48,709 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:48,710 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:31:48,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:31:48,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:49,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:49,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:49,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:31:49,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:31:49,321 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:49,429 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:49,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:49,443 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:49,460 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:31:49,495 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:49,495 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:31:49,496 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:49,496 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:49,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:31:49,508 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:49,512 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,515 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:49,517 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:49,520 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:49,522 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:49,526 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,529 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:49,532 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:49,534 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:49,537 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:49,552 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:49,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:31:49,558 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:31:49,558 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:31:49,567 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:49,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:31:49,582 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:49,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:31:49,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:49,603 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:49,611 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:31:49,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:31:49,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:49,619 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:49,619 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:49,620 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:49,620 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:49,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:31:49,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:49,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:31:49,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:49,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:31:49,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:31:49,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:49,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:31:49,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:49,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:49,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:49,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:31:49,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:31:49,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:31:49,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:31:49,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:31:49,626 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:31:49,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:31:49,626 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:31:49,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:31:49,626 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:31:49,627 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:31:49,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:31:49,627 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:49,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:31:49,628 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:49,628 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:49,628 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:49,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:31:49,628 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:31:49,629 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:31:49,629 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:31:49,639 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:31:49,639 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:49,641 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:49,642 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:49,643 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:49,643 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:49,644 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:49,645 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:49,661 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3455, Threshold=0.3609, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:31:49,662 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3455
2025-08-04 20:31:57,944 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:57,944 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:57,944 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:57,944 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:31:57,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:31:57,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:58,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:58,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:58,335 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:31:58,380 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:31:58,381 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:58,505 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:58,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:58,512 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:58,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:31:58,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:58,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:31:58,527 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:58,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:58,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:31:58,536 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:58,539 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:58,541 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:58,543 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:58,546 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:58,548 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:58,551 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:58,553 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:58,557 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:58,559 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:58,562 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:58,573 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:58,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:31:58,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:31:58,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:31:58,583 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:58,583 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:31:58,591 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:58,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:31:58,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:58,608 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:58,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:31:58,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:31:58,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:58,618 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:58,618 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:58,618 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:58,619 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:58,619 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:31:58,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:58,619 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:31:58,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:58,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:31:58,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:31:58,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:31:58,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:31:58,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:31:58,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:31:58,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:58,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:31:58,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:31:58,627 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:31:58,628 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:58,629 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:58,629 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:58,630 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 49/400.
2025-08-04 20:31:58,731 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:58,731 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:58,732 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:31:58,733 - ClientAppLogger [Client 0] - INFO - [Client] Round 49: Training GAN with 9 samples (7 normal, 2 anomalous).
2025-08-04 20:31:58,733 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:58,758 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0720, Avg D Loss: 0.8456
2025-08-04 20:31:58,758 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0720, Avg D Loss: 0.8456
2025-08-04 20:31:58,758 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:58,773 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3327, Threshold=0.3478, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:31:58,773 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7814
2025-08-04 20:31:58,773 - ClientAppLogger [Client 0] - INFO - Fit completed for round 49. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 49, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.072018790245056, 'd_loss': 0.8455986738204956, 'post_fit_local_f1': 0.7813620071684588, 'fit_time_seconds': 0.14335274696350098, 'cpu_percent_fit': 5.925, 'ram_mb_fit': 2.96875, 'accumulated_train_samples_this_round': 9}
2025-08-04 20:31:58,774 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:32:04,036 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:04,036 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:04,036 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:04,036 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:32:04,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:32:04,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:04,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:04,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:04,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:32:04,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:32:04,554 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:04,697 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:04,703 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:04,703 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:04,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:32:04,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:04,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:32:04,719 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:04,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:04,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:32:04,728 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:04,731 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,734 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:04,736 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:04,738 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:04,741 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:04,744 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,747 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:04,750 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:04,752 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:04,754 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:04,767 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:04,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:32:04,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:32:04,774 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:32:04,781 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:04,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:32:04,804 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:04,805 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:32:04,805 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:04,827 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:04,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:32:04,839 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:32:04,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:04,840 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:04,840 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:04,840 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:04,840 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:04,840 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:32:04,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:04,841 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:32:04,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:04,842 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:32:04,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:32:04,843 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:04,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:32:04,843 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:04,843 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:04,844 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:04,844 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:32:04,844 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:32:04,844 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:32:04,844 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:32:04,845 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:32:04,846 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:32:04,846 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:04,846 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:32:04,847 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:04,847 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:04,847 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:04,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:32:04,847 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:32:04,847 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:32:04,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:32:04,856 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:32:04,856 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:04,858 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:04,858 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:04,859 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:04,859 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:04,859 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:04,860 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:04,874 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3491, Threshold=0.3699, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:32:04,874 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3491
2025-08-04 20:32:16,139 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:16,139 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:16,140 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:16,140 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:32:16,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:32:16,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:16,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:16,489 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:16,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:32:16,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:32:16,602 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:16,698 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:16,705 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:16,706 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:16,713 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:32:16,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:16,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:32:16,726 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:16,726 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:16,726 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:32:16,735 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:16,739 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:16,741 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:16,743 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:16,746 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:16,749 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:16,751 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:16,754 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:16,757 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:16,758 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:16,761 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:16,776 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:16,776 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:32:16,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:32:16,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:32:16,788 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:16,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:32:16,801 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:16,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:32:16,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:16,819 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:16,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:32:16,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:32:16,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:16,833 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:16,833 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:16,834 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:16,834 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:16,834 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:32:16,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:16,834 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:32:16,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:16,836 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:32:16,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:32:16,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:32:16,838 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:32:16,839 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:32:16,839 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:32:16,839 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:32:16,839 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:16,839 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:32:16,839 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:16,840 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:16,840 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:16,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:32:16,840 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:32:16,840 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:32:16,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:32:16,843 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:32:16,843 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:16,844 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:16,844 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:16,846 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:16,846 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:16,846 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:16,847 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:16,861 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3427, Threshold=0.3632, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:32:16,861 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3427
2025-08-04 20:32:31,154 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:31,154 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:31,154 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:31,154 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:32:31,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:32:31,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:31,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:31,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:31,680 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:32:31,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:32:31,734 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:31,872 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:31,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:31,878 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:31,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:32:31,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:31,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:32:31,893 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:31,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:31,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:32:31,904 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:31,907 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:31,911 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:31,914 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:31,917 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:31,919 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,922 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:31,924 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:31,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:31,929 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:31,938 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:31,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:32:31,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:32:31,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:32:31,948 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:31,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:32:31,956 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:31,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:32:31,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:31,974 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:31,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:32:31,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:32:31,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:31,984 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:31,984 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:31,984 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:31,985 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:31,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:32:31,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:31,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:32:31,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:31,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:32:31,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:32:31,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:31,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:32:31,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:31,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:31,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:31,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:32:31,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:32:31,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:32:31,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:32:31,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:32:31,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:32:31,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:31,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:32:31,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:31,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:31,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:31,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:32:31,991 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:32:31,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:32:31,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:32:31,995 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:32:31,995 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:31,996 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:31,996 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:31,997 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:31,998 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:31,998 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:31,998 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:32,017 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3496, Threshold=0.3724, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:32:32,017 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3496
2025-08-04 20:32:43,278 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:43,278 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:43,278 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:43,278 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:32:43,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:32:43,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:43,509 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:43,510 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:43,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:32:43,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:32:43,630 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:43,713 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:43,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:43,719 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:43,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:32:43,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:43,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:32:43,733 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:43,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:43,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:32:43,742 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:43,744 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:43,747 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:43,749 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:43,751 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:43,753 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:43,756 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:43,759 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:43,761 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:43,763 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:43,765 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:43,774 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:43,774 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:32:43,779 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:32:43,779 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:32:43,784 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:43,784 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:32:43,794 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:43,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:32:43,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:43,808 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:43,813 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:32:43,818 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:32:43,818 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:43,818 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:43,818 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:43,819 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:43,819 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:43,819 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:32:43,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:43,819 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:32:43,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:43,821 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:32:43,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:32:43,821 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:32:43,822 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:32:43,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:32:43,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:32:43,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:32:43,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:43,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:32:43,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:43,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:43,825 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:43,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:32:43,825 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:32:43,825 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:32:43,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:32:43,831 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:32:43,831 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:43,832 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:43,832 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:43,833 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:43,834 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:43,834 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:43,834 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:43,847 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3603, Threshold=0.3858, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:32:43,847 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3603
2025-08-04 20:32:55,113 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:55,113 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:55,113 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:55,113 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:32:55,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:32:55,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:55,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:55,392 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:55,479 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:32:55,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:32:55,524 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:55,641 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:55,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:55,647 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:55,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:32:55,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:55,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:32:55,661 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:55,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:55,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:32:55,671 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:55,674 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:55,676 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:55,678 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:55,681 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:55,684 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:55,686 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:55,689 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:55,692 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:55,694 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:55,696 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:55,706 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:55,706 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:32:55,711 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:32:55,711 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:32:55,716 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:55,716 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:32:55,727 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:55,727 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:32:55,727 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:55,745 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:55,751 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:32:55,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:32:55,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:55,761 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:55,761 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:55,761 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:55,762 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:55,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:32:55,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:55,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:32:55,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:55,764 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:32:55,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:32:55,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:55,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:32:55,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:55,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:32:55,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:32:55,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:32:55,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:32:55,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:32:55,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:32:55,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:32:55,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:32:55,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:55,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:32:55,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:55,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:55,769 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:55,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:32:55,769 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:32:55,769 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:32:55,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:32:55,773 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:32:55,774 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:55,776 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:55,776 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:55,778 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 53/400.
2025-08-04 20:32:55,880 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:55,880 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:55,881 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:32:55,882 - ClientAppLogger [Client 0] - INFO - [Client] Round 53: Training GAN with 9 samples (7 normal, 2 anomalous).
2025-08-04 20:32:55,882 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:55,905 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0689, Avg D Loss: 0.8374
2025-08-04 20:32:55,905 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0689, Avg D Loss: 0.8374
2025-08-04 20:32:55,905 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:55,920 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3413, Threshold=0.3643, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:32:55,921 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7814
2025-08-04 20:32:55,921 - ClientAppLogger [Client 0] - INFO - Fit completed for round 53. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 53, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.068902277946472, 'd_loss': 0.8374119877815247, 'post_fit_local_f1': 0.7813620071684588, 'fit_time_seconds': 0.14243245124816895, 'cpu_percent_fit': 6.075, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9}
2025-08-04 20:32:55,921 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:33:04,204 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:04,205 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:04,205 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:04,205 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:33:04,205 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:33:04,205 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:04,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:04,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:04,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:33:04,607 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:33:04,607 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:04,710 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:04,717 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:04,717 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:04,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:33:04,735 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:04,735 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:33:04,735 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:04,736 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:04,736 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:33:04,744 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:04,747 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,750 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:04,752 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:04,755 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:04,757 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:04,760 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,763 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:04,766 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:04,768 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:04,770 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:04,781 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:04,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:33:04,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:33:04,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:33:04,793 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:04,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:33:04,805 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:04,805 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:33:04,805 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:04,820 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:04,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:33:04,829 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:33:04,829 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:04,829 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:04,829 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:04,830 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:04,830 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:04,830 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:33:04,830 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:04,831 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:33:04,831 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:04,832 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:33:04,832 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:33:04,832 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:33:04,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:33:04,834 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:33:04,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:33:04,834 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:33:04,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:33:04,834 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:33:04,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:33:04,835 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:33:04,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:33:04,835 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:04,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:33:04,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:33:04,841 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:33:04,841 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:04,842 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:04,842 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:04,844 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:04,844 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:04,844 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:04,845 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:04,858 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3619, Threshold=0.3905, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:33:04,858 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3619
2025-08-04 20:33:16,128 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:16,128 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:16,128 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:16,128 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:33:16,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:33:16,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:16,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:16,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:16,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:33:16,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:33:16,679 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:16,818 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:16,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:16,826 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:16,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:33:16,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:16,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:33:16,849 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:16,849 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:16,849 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:33:16,860 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:16,862 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:16,865 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:16,867 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:16,870 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:16,872 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:16,874 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:16,877 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:16,880 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:16,882 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:16,884 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:16,898 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:16,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:33:16,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:33:16,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:33:16,911 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:16,911 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:33:16,924 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:16,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:33:16,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:16,943 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:16,949 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:33:16,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:33:16,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:16,962 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:16,963 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:16,963 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:16,964 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:16,964 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:33:16,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:16,964 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:33:16,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:16,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:33:16,966 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:33:16,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:16,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:33:16,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:16,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:16,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:16,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:33:16,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:33:16,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:33:16,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:33:16,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:33:16,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:33:16,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:33:16,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:33:16,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:33:16,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:33:16,970 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:33:16,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:33:16,970 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:16,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:33:16,970 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:16,971 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:16,971 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:16,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:33:16,971 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:33:16,971 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:33:16,972 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:33:16,976 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:33:16,976 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:16,977 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:16,977 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:16,979 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:16,979 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:16,979 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:16,980 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:16,994 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3462, Threshold=0.3725, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:33:16,994 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3462
2025-08-04 20:33:31,267 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:31,268 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:31,268 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:31,268 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:33:31,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:33:31,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:31,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:31,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:31,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:33:31,720 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:33:31,720 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:31,859 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:31,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:31,870 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:31,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:33:31,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:31,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:33:31,889 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:31,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:31,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:33:31,899 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:31,901 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:31,904 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:31,906 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:31,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:31,911 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:31,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:31,916 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:31,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:31,920 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:31,923 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:31,932 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:31,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:33:31,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:33:31,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:33:31,945 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:31,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:33:31,959 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:31,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:33:31,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:31,980 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:31,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:33:31,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:33:32,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:32,000 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:32,000 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:32,000 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:32,001 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:32,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:33:32,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:32,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:33:32,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:32,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:33:32,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:33:32,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:33:32,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:33:32,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:33:32,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:33:32,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:33:32,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:33:32,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:33:32,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:33:32,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:33:32,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:33:32,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:32,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:33:32,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:32,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:32,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:32,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:33:32,007 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:33:32,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:33:32,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:33:32,016 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:33:32,017 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:32,018 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:32,018 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:32,020 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:32,020 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:32,020 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:32,021 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:32,035 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3248, Threshold=0.3467, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:33:32,035 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3248
2025-08-04 20:33:49,320 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:49,320 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:49,320 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:49,320 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:33:49,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:33:49,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:49,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:49,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:49,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:33:49,814 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:33:49,815 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:49,937 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:49,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:49,943 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:49,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:33:49,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:49,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:33:49,958 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:49,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:49,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:33:49,966 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:49,969 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:49,971 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:49,973 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:49,976 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:49,978 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:49,980 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:49,983 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:49,986 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:49,988 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:49,990 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:50,000 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:50,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:33:50,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:33:50,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:33:50,010 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:50,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:33:50,019 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:50,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:33:50,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:50,037 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:50,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:33:50,055 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:33:50,055 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:50,055 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:50,055 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:50,056 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:50,056 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:50,056 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:33:50,056 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:50,056 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:33:50,057 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:50,058 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:33:50,058 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:33:50,059 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:50,059 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:33:50,059 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:50,059 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:50,059 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:50,059 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:33:50,060 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:33:50,060 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:33:50,060 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:33:50,060 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:33:50,060 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:33:50,060 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:33:50,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:33:50,061 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:33:50,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:33:50,061 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:33:50,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:33:50,062 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:50,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:33:50,062 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:50,062 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:50,063 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:50,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:33:50,063 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:33:50,063 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:33:50,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:33:50,067 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:33:50,067 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:50,068 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:50,069 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:50,070 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:50,070 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:50,070 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:50,071 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:50,086 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3607, Threshold=0.3898, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:33:50,086 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3607
2025-08-04 20:34:01,353 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:01,353 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:01,353 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:01,353 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:34:01,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:34:01,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:01,609 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:01,609 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:01,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:34:01,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:34:01,722 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:01,819 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:01,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:01,826 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:01,832 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:34:01,839 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:01,839 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:34:01,840 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:01,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:01,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:34:01,848 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:01,851 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:01,853 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:01,855 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:01,858 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:01,860 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:01,863 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:01,866 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:01,869 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:01,871 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:01,873 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:01,885 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:01,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:34:01,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:34:01,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:34:01,896 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:01,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:34:01,907 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:01,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:34:01,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:01,921 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:01,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:34:01,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:34:01,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:01,932 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:01,932 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:01,933 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:01,933 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:01,933 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:34:01,933 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:01,934 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:34:01,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:01,935 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:34:01,935 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:34:01,936 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:01,936 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:34:01,936 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:01,936 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:01,936 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:01,936 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:34:01,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:34:01,938 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:01,939 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:01,939 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:01,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:34:01,939 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:34:01,939 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:34:01,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:34:01,945 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:34:01,945 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:01,946 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:01,946 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:01,947 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:01,947 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:01,948 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:01,948 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:01,961 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3562, Threshold=0.3842, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:34:01,962 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3562
2025-08-04 20:34:13,237 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:13,237 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:13,238 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:13,238 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:34:13,238 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:34:13,238 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:13,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:13,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:13,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:34:13,702 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:34:13,702 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:13,865 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:13,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:13,872 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:13,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:34:13,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:13,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:34:13,892 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:13,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:13,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:34:13,902 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:13,905 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:13,908 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:13,910 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:13,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:13,916 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:13,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:13,921 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:13,924 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:13,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:13,928 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:13,938 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:13,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:34:13,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:34:13,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:34:13,950 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:13,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:34:13,966 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:13,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:34:13,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:13,986 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:13,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:34:14,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:34:14,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:14,001 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:14,001 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:14,001 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:14,002 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:14,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:34:14,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:14,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:34:14,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:14,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:34:14,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:34:14,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:14,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:34:14,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:14,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:14,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:14,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:34:14,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:34:14,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:34:14,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:34:14,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:34:14,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:34:14,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:34:14,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:34:14,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:34:14,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:34:14,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:34:14,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:34:14,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:14,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:34:14,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:14,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:14,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:14,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:34:14,009 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:34:14,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:34:14,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:34:14,014 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:34:14,014 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:14,016 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:14,016 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:14,017 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:14,018 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:14,018 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:14,019 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:14,034 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3653, Threshold=0.3965, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:34:14,034 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3653
2025-08-04 20:34:28,299 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:28,299 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:28,299 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:28,299 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:34:28,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:34:28,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:28,536 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:28,536 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:28,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:34:28,655 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:34:28,655 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:28,786 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:28,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:28,794 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:28,804 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:34:28,831 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:28,832 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:34:28,832 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:28,832 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:28,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:34:28,843 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:28,846 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:28,848 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:28,850 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:28,853 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:28,855 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:28,858 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:28,860 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:28,863 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:28,865 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:28,867 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:28,879 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:28,879 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:34:28,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:34:28,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:34:28,892 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:28,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:34:28,907 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:28,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:34:28,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:28,925 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:28,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:34:28,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:34:28,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:28,939 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:28,939 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:28,940 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:28,940 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:28,941 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:34:28,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:28,941 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:34:28,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:28,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:34:28,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:34:28,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:28,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:34:28,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:28,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:28,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:28,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:34:28,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:34:28,945 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:34:28,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:34:28,945 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:34:28,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:34:28,945 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:34:28,946 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:34:28,946 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:34:28,946 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:34:28,946 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:34:28,946 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:34:28,946 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:28,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:34:28,947 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:28,947 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:28,947 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:28,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:34:28,948 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:34:28,948 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:34:28,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:34:28,958 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:34:28,958 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:28,960 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:28,960 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:28,962 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:28,962 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:28,962 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:28,963 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:28,977 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3620, Threshold=0.3948, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:34:28,977 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3620
2025-08-04 20:34:40,239 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,239 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:40,239 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:40,239 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:34:40,239 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:34:40,239 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:40,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:40,555 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:40,652 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:34:40,700 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:34:40,700 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:40,853 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:40,861 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:40,861 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:40,869 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:34:40,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:40,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:34:40,878 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:40,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:40,879 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:34:40,889 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:40,892 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:40,894 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:40,896 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:40,899 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:40,901 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:40,904 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:40,907 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:40,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:40,911 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:40,914 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:40,929 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:40,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:34:40,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:34:40,935 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:34:40,940 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:40,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:34:40,951 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:40,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:34:40,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:40,971 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:40,978 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:34:40,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:34:40,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:40,988 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:40,988 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:40,988 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:40,989 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:40,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:34:40,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:40,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:34:40,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:40,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:34:40,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:34:40,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:40,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:34:40,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:40,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:40,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:40,993 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:34:40,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:34:40,993 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:34:40,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:34:40,993 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:34:40,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:34:40,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:34:40,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:34:40,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:34:40,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:34:40,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:34:40,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:34:40,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:40,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:34:40,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:40,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:40,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:40,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:34:40,996 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:34:40,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:34:40,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:34:41,002 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:34:41,002 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:41,004 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:41,004 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:41,006 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:41,006 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:41,006 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:41,007 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:41,021 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3531, Threshold=0.3828, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:34:41,022 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3531
2025-08-04 20:34:52,281 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:52,281 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:52,281 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:52,281 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:34:52,282 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:34:52,282 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:52,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:52,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:52,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:34:52,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:34:52,662 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:52,791 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:52,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:52,800 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:52,810 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:34:52,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:52,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:34:52,886 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:52,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:52,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:34:52,899 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:52,902 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:52,905 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:52,907 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:52,910 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:52,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:52,916 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:52,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:52,921 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:52,923 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:52,926 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:52,939 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:52,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:34:52,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:34:52,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:34:52,953 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:52,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:34:52,969 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:52,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:34:52,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:52,987 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:52,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:34:53,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:34:53,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,002 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,002 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,003 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,003 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:34:53,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:34:53,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:34:53,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:34:53,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:34:53,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:34:53,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:34:53,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:34:53,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:34:53,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:34:53,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:34:53,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:34:53,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:34:53,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:34:53,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:34:53,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:34:53,010 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,010 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,010 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:34:53,011 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:34:53,011 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:34:53,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:34:53,019 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:34:53,020 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,022 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,022 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:53,024 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,024 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,024 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,025 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,040 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3587, Threshold=0.3872, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:34:53,041 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3587
2025-08-04 20:35:10,324 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:10,324 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:10,324 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:10,325 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:35:10,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:35:10,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:10,615 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:10,615 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:10,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:35:10,739 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:35:10,740 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:10,864 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:10,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:10,871 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:10,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:35:10,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:10,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:35:10,883 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:10,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:10,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:35:10,892 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:10,895 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:10,897 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:10,899 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:10,901 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:10,904 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:10,906 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:10,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:10,911 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:10,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:10,916 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:10,927 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:10,927 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:35:10,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:35:10,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:35:10,937 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:10,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:35:10,949 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:10,949 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:35:10,949 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:10,965 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:10,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:35:10,980 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:35:10,980 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:10,981 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:10,981 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:10,981 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:10,982 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:10,982 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:35:10,982 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:10,982 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:35:10,983 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:10,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:35:10,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:35:10,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:10,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:35:10,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:10,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:10,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:10,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:35:10,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:35:10,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:35:10,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:35:10,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:35:10,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:35:10,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:35:10,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:35:10,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:35:10,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:35:10,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:35:10,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:35:10,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:10,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:35:10,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:10,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:10,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:10,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:35:10,992 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:35:10,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:35:10,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:35:10,998 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:35:10,998 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:11,000 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:11,000 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:11,001 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:11,002 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:11,002 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:11,003 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:11,016 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3646, Threshold=0.3984, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:35:11,016 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3646
2025-08-04 20:35:22,285 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:22,285 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:22,285 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:22,285 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:35:22,285 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:35:22,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:22,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:22,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:22,606 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:35:22,649 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:35:22,650 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:22,766 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:22,771 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:22,772 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:22,779 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:35:22,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:22,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:35:22,789 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:22,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:22,790 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:35:22,798 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:22,801 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:22,804 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:22,806 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:22,809 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:22,811 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:22,813 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:22,816 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:22,819 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:22,821 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:22,823 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:22,833 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:22,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:35:22,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:35:22,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:35:22,849 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:22,849 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:35:22,863 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:22,863 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:35:22,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:22,880 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:22,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:35:22,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:35:22,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:22,892 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:22,892 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:22,892 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:22,892 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:22,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:35:22,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:22,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:35:22,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:22,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:35:22,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:35:22,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:22,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:35:22,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:22,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:22,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:22,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:35:22,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:35:22,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:35:22,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:35:22,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:35:22,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:35:22,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:35:22,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:35:22,898 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:35:22,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:35:22,898 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:35:22,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:35:22,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:22,899 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:35:22,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:22,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:22,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:22,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:35:22,900 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:35:22,900 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:35:22,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:35:22,907 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:35:22,907 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:22,909 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:22,909 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:22,911 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:22,911 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:22,911 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:22,912 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:22,926 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3810, Threshold=0.4149, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:35:22,926 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3810
2025-08-04 20:35:34,202 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:34,202 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:34,202 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:34,202 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:35:34,203 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:35:34,203 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:34,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:34,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:34,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:35:34,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:35:34,532 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:34,619 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:34,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:34,624 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:34,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:35:34,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:34,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:35:34,635 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:34,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:34,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:35:34,643 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:34,646 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:34,649 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:34,651 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:34,654 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:34,656 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:34,658 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:34,661 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:34,664 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:34,666 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:34,668 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:34,678 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:34,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:35:34,683 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:35:34,683 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:35:34,688 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:34,688 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:35:34,698 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:34,698 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:35:34,698 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:34,714 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:34,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:35:34,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:35:34,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:34,726 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:35:34,726 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:34,727 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:35:34,727 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:35:34,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:34,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:35:34,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:34,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:34,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:34,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:35:34,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:35:34,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:35:34,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:35:34,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:35:34,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:35:34,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:34,731 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:35:34,731 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:34,731 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:34,731 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:34,731 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:35:34,732 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:35:34,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:35:34,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:35:34,734 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:35:34,735 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:34,736 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:34,736 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:34,737 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:34,737 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:34,737 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:34,738 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:34,751 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3524, Threshold=0.3879, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:35:34,751 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3524
2025-08-04 20:35:46,021 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:46,021 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:46,021 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:46,021 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:35:46,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:35:46,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:46,289 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:46,289 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:46,373 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:35:46,419 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:35:46,419 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:46,541 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:46,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:46,549 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:46,559 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:35:46,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:46,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:35:46,567 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:46,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:46,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:35:46,576 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:46,579 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,582 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:46,584 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:46,587 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:46,589 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:46,592 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,594 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:46,597 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:46,599 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:46,602 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:46,613 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:46,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:35:46,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:35:46,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:35:46,623 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:46,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:35:46,636 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:46,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:35:46,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:46,653 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:46,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:35:46,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:35:46,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:46,671 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:46,671 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:46,672 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:46,672 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:46,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:35:46,672 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:46,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:35:46,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:46,674 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:35:46,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:35:46,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:46,675 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:35:46,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:46,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:46,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:46,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:35:46,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:35:46,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:35:46,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:35:46,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:35:46,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:35:46,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:35:46,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:35:46,677 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:35:46,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:35:46,677 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:35:46,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:35:46,677 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:46,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:35:46,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:46,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:46,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:46,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:35:46,679 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:35:46,679 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:35:46,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:35:46,682 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:35:46,683 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:46,684 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:46,684 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:46,686 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:46,686 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:46,686 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:46,687 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:46,700 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3666, Threshold=0.4065, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:35:46,701 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3666
2025-08-04 20:35:57,964 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:57,964 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:57,964 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:57,964 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:35:57,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:35:57,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:58,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:58,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:58,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:35:58,290 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:35:58,290 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:58,385 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:58,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:58,391 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:58,397 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:35:58,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:58,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:35:58,442 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:58,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:58,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:35:58,452 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:58,456 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:58,458 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:58,460 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:58,463 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:58,465 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:58,468 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:58,471 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:58,473 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:58,475 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:58,477 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:58,488 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:58,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:35:58,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:35:58,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:35:58,498 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:58,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:35:58,511 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:58,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:35:58,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:58,528 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:58,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:35:58,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:35:58,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:58,544 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:58,544 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:58,544 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:58,545 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:58,545 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:35:58,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:58,545 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:35:58,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:58,547 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:35:58,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:35:58,547 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:58,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:35:58,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:35:58,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:35:58,550 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:58,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:35:58,550 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:58,550 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:58,551 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:58,551 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:35:58,551 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:35:58,551 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:35:58,551 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:35:58,559 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:35:58,559 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:58,561 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:58,561 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:58,563 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:58,563 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:58,563 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:58,564 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:58,577 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3777, Threshold=0.4158, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:35:58,578 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3777
2025-08-04 20:36:03,843 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:03,843 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:03,843 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:03,843 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:36:03,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:36:03,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:04,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:04,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:04,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:36:04,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:36:04,228 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:04,337 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:04,342 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:04,342 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:04,348 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:36:04,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:04,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:36:04,354 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:04,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:04,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:36:04,363 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:04,366 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:04,368 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:04,370 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:04,373 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:04,375 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:04,378 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:04,380 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:04,383 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:04,385 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:04,387 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:04,395 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:04,395 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:36:04,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:36:04,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:36:04,404 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:04,404 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:36:04,411 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:04,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:36:04,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:04,426 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:04,431 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:36:04,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:36:04,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:04,436 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:04,436 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:04,437 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:04,437 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:04,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:36:04,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:04,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:36:04,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:04,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:36:04,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:36:04,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:04,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:36:04,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:04,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:04,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:36:04,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:36:04,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:04,443 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:04,443 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:04,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:36:04,443 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:36:04,443 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:36:04,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:36:04,447 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:36:04,447 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:04,448 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:04,448 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:04,449 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 67/400.
2025-08-04 20:36:04,551 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:04,551 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:04,552 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:36:04,552 - ClientAppLogger [Client 0] - INFO - [Client] Round 67: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:36:04,553 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:04,576 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0800, Avg D Loss: 0.8676
2025-08-04 20:36:04,576 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0800, Avg D Loss: 0.8676
2025-08-04 20:36:04,576 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:04,590 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3548, Threshold=0.3912, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:36:04,590 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7814
2025-08-04 20:36:04,590 - ClientAppLogger [Client 0] - INFO - Fit completed for round 67. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 67, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.080016827583313, 'd_loss': 0.8676426231861114, 'post_fit_local_f1': 0.7813620071684588, 'fit_time_seconds': 0.14079070091247559, 'cpu_percent_fit': 6.3375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:36:04,590 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:36:15,866 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:15,866 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:15,866 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:15,866 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:36:15,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:36:15,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:16,146 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:16,146 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:16,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:36:16,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:36:16,269 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:16,378 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:16,385 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:16,385 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:16,392 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:36:16,414 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:16,414 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:36:16,414 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:16,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:16,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:36:16,424 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:16,427 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:16,430 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:16,432 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:16,435 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:16,437 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:16,439 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:16,442 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:16,444 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:16,446 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:16,448 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:16,459 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:16,459 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:36:16,464 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:36:16,464 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:36:16,470 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:16,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:36:16,482 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:16,482 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:36:16,483 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:16,497 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:16,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:36:16,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:36:16,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:16,507 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:16,507 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:16,507 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:16,507 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:16,507 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:36:16,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:16,508 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:36:16,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:16,509 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:36:16,509 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:36:16,510 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:16,510 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:36:16,510 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:16,510 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:16,510 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:16,510 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:36:16,511 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:36:16,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:36:16,512 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:36:16,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:36:16,512 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:16,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:36:16,512 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:36:16,513 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:36:16,522 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:36:16,522 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:16,524 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:16,524 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:16,525 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:16,525 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:16,526 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:16,526 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:16,540 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3630, Threshold=0.3997, Accuracy=0.6852, F1=0.7838, Precision=0.9507, Recall=0.6667
2025-08-04 20:36:16,540 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6852, F1: 0.7838, Prec: 0.9507, Rec: 0.6667, Avg Anomaly Score: 0.3630
2025-08-04 20:36:27,806 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:27,806 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:27,806 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:27,807 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:36:27,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:36:27,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:28,109 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:28,110 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:28,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:36:28,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:36:28,237 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:28,360 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:28,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:28,367 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:28,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:36:28,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:28,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:36:28,382 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:28,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:28,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:36:28,391 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:28,393 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:28,396 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:28,398 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:28,400 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:28,403 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:28,405 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:28,408 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:28,411 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:28,412 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:28,415 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:28,423 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:28,423 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:36:28,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:36:28,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:36:28,432 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:28,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:36:28,439 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:28,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:36:28,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:28,455 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:28,459 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:36:28,464 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:36:28,465 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:28,465 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:28,465 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:28,465 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:28,466 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:28,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:36:28,466 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:28,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:36:28,466 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:28,468 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:36:28,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:36:28,468 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:28,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:36:28,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:28,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:28,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:28,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:36:28,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:36:28,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:36:28,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:36:28,471 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:36:28,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:36:28,471 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:28,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:36:28,471 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:28,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:28,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:28,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:36:28,472 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:36:28,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:36:28,473 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:36:28,476 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:36:28,476 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:28,477 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:28,477 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:28,479 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:28,479 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:28,479 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:28,479 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:28,492 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3699, Threshold=0.4121, Accuracy=0.6852, F1=0.7838, Precision=0.9507, Recall=0.6667
2025-08-04 20:36:28,493 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6852, F1: 0.7838, Prec: 0.9507, Rec: 0.6667, Avg Anomaly Score: 0.3699
2025-08-04 20:36:33,747 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:33,747 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:33,747 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:33,747 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:36:33,748 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:36:33,748 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:33,972 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:33,972 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:34,054 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:36:34,077 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:36:34,077 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:34,162 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:34,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:34,167 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:34,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:36:34,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:34,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:36:34,178 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:34,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:34,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:36:34,187 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:34,189 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:34,191 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:34,193 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:34,196 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:34,198 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:34,201 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:34,203 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:34,206 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:34,208 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:34,210 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:34,219 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:34,219 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:36:34,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:36:34,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:36:34,228 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:34,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:36:34,237 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:34,238 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:36:34,238 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:34,252 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:34,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:36:34,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:36:34,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:34,261 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:34,262 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:34,262 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:34,262 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:34,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:36:34,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:34,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:36:34,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:34,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:36:34,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:36:34,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:36:34,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:36:34,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:36:34,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:36:34,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:34,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:36:34,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:34,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:34,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:34,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:36:34,268 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:36:34,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:36:34,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:36:34,270 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:36:34,270 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:34,271 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:34,271 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:34,272 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 69/400.
2025-08-04 20:36:34,373 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:34,373 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:34,374 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:36:34,374 - ClientAppLogger [Client 0] - INFO - [Client] Round 69: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:36:34,375 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:34,398 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0788, Avg D Loss: 0.8661
2025-08-04 20:36:34,398 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0788, Avg D Loss: 0.8661
2025-08-04 20:36:34,399 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:34,412 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3472, Threshold=0.3878, Accuracy=0.6852, F1=0.7838, Precision=0.9507, Recall=0.6667
2025-08-04 20:36:34,412 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7838
2025-08-04 20:36:34,412 - ClientAppLogger [Client 0] - INFO - Fit completed for round 69. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 69, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0788000345230104, 'd_loss': 0.8660509884357452, 'post_fit_local_f1': 0.7837514934289128, 'fit_time_seconds': 0.13997817039489746, 'cpu_percent_fit': 6.3625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:36:34,412 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:36:45,696 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:45,696 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:45,697 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:45,697 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:36:45,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:36:45,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:46,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:46,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:46,085 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:36:46,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:36:46,133 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:46,254 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:46,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:46,260 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:46,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:36:46,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:46,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:36:46,270 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:46,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:46,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:36:46,279 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:46,281 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:46,284 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:46,286 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:46,289 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:46,291 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:46,293 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:46,296 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:46,299 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:46,301 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:46,303 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:46,312 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:46,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:36:46,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:36:46,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:36:46,321 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:46,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:36:46,328 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:46,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:36:46,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:46,344 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:46,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:36:46,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:36:46,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:46,354 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:46,354 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:46,354 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:46,354 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:46,354 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:36:46,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:46,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:36:46,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:46,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:36:46,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:36:46,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:36:46,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:36:46,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:36:46,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:36:46,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:36:46,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:36:46,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:36:46,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:36:46,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:36:46,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:36:46,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:46,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:36:46,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:46,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:46,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:46,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:36:46,360 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:36:46,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:36:46,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:36:46,363 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:36:46,364 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:46,365 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:46,365 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:46,366 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:46,366 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:46,366 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:46,367 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:46,380 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3886, Threshold=0.4358, Accuracy=0.6887, F1=0.7861, Precision=0.9536, Recall=0.6687
2025-08-04 20:36:46,380 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6887, F1: 0.7861, Prec: 0.9536, Rec: 0.6687, Avg Anomaly Score: 0.3886
2025-08-04 20:36:51,634 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:51,634 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:51,634 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:51,634 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:36:51,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:36:51,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:51,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:51,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:51,976 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:36:52,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:36:52,018 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:52,124 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:52,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:52,130 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:52,135 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:36:52,141 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:52,141 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:36:52,142 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:52,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:52,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:36:52,151 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:52,153 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:52,156 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:52,158 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:52,160 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:52,163 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:52,165 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:52,168 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:52,171 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:52,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:52,175 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:52,183 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:52,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:36:52,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:36:52,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:36:52,192 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:52,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:36:52,199 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:52,200 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:36:52,200 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:52,214 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:52,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:36:52,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:36:52,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:52,224 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:52,224 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:52,224 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:52,224 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:52,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:36:52,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:52,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:36:52,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:52,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:36:52,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:36:52,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:52,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:36:52,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:52,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:52,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:52,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:36:52,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:36:52,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:36:52,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:36:52,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:36:52,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:36:52,230 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:52,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:36:52,230 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:52,230 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:52,231 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:52,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:36:52,231 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:36:52,231 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:36:52,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:36:52,236 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:36:52,236 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:52,237 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:52,237 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:52,239 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 70/400.
2025-08-04 20:36:52,340 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:52,340 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:52,341 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:36:52,342 - ClientAppLogger [Client 0] - INFO - [Client] Round 70: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:36:52,342 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:52,366 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0766, Avg D Loss: 0.8674
2025-08-04 20:36:52,366 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0766, Avg D Loss: 0.8674
2025-08-04 20:36:52,366 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:52,379 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3589, Threshold=0.4001, Accuracy=0.6887, F1=0.7861, Precision=0.9536, Recall=0.6687
2025-08-04 20:36:52,379 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7861
2025-08-04 20:36:52,380 - ClientAppLogger [Client 0] - INFO - Fit completed for round 70. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 70, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.076605486869812, 'd_loss': 0.8673885822296142, 'post_fit_local_f1': 0.7861409796893668, 'fit_time_seconds': 0.14039301872253418, 'cpu_percent_fit': 6.31875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:36:52,380 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:37:00,669 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:00,669 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:00,669 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:00,669 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:37:00,669 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:37:00,670 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:01,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:01,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:01,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:37:01,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:37:01,262 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:01,391 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:01,396 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:01,396 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:01,402 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:37:01,408 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:01,409 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:37:01,409 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:01,409 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:01,409 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:37:01,418 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:01,420 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:01,423 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:01,425 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:01,428 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:01,430 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:01,433 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:01,435 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:01,438 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:01,440 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:01,442 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:01,450 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:01,450 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:37:01,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:37:01,456 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:37:01,462 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:01,462 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:37:01,474 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:01,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:37:01,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:01,488 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:01,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:37:01,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:37:01,498 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:01,498 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:01,498 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:01,498 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:01,498 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:01,498 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:37:01,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:01,499 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:37:01,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:01,500 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:37:01,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:37:01,501 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:01,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:37:01,501 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:01,501 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:01,501 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:37:01,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:37:01,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:37:01,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:37:01,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:37:01,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:01,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:37:01,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:01,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:01,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:01,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:37:01,504 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:37:01,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:37:01,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:37:01,512 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:37:01,512 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:01,513 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:01,514 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:01,515 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:01,515 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:01,515 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:01,515 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:01,528 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3768, Threshold=0.4306, Accuracy=0.6922, F1=0.7885, Precision=0.9565, Recall=0.6707
2025-08-04 20:37:01,528 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6922, F1: 0.7885, Prec: 0.9565, Rec: 0.6707, Avg Anomaly Score: 0.3768
2025-08-04 20:37:06,803 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:06,803 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:06,803 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:06,803 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:37:06,803 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:37:06,804 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:07,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:07,099 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:07,190 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:37:07,219 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:37:07,219 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:07,322 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:07,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:07,329 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:07,335 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:37:07,342 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:07,342 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:37:07,342 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:07,343 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:07,343 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:37:07,351 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:07,354 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:07,357 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:07,359 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:07,361 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:07,364 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:07,366 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:07,369 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:07,371 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:07,374 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:07,376 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:07,387 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:07,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:37:07,394 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:37:07,394 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:37:07,403 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:07,403 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:37:07,415 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:07,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:37:07,416 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:07,432 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:07,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:37:07,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:37:07,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:07,441 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:07,441 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:07,442 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:07,442 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:07,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:37:07,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:07,443 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:37:07,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:07,444 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:37:07,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:37:07,445 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:07,445 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:37:07,445 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:07,446 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:07,446 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:07,446 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:37:07,446 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:37:07,446 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:37:07,447 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:37:07,447 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:37:07,447 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:37:07,447 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:37:07,448 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:37:07,448 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:37:07,448 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:37:07,448 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:37:07,448 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:37:07,449 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:07,449 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:37:07,449 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:07,449 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:07,450 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:07,450 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:37:07,450 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:37:07,450 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:37:07,450 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:37:07,455 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:37:07,456 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:07,457 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:07,457 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:07,459 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 71/400.
2025-08-04 20:37:07,560 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:07,560 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:07,561 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:37:07,562 - ClientAppLogger [Client 0] - INFO - [Client] Round 71: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:37:07,562 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:07,585 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0772, Avg D Loss: 0.8631
2025-08-04 20:37:07,585 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0772, Avg D Loss: 0.8631
2025-08-04 20:37:07,585 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:07,598 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3509, Threshold=0.3994, Accuracy=0.6922, F1=0.7885, Precision=0.9565, Recall=0.6707
2025-08-04 20:37:07,599 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7885
2025-08-04 20:37:07,599 - ClientAppLogger [Client 0] - INFO - Fit completed for round 71. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 71, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0772289037704468, 'd_loss': 0.863059014081955, 'post_fit_local_f1': 0.7885304659498208, 'fit_time_seconds': 0.14017701148986816, 'cpu_percent_fit': 6.41875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:37:07,599 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:37:15,860 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:15,861 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:15,861 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:15,861 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:37:15,861 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:37:15,861 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:16,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:16,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:16,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:37:16,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:37:16,275 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:16,404 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:16,410 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:16,411 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:16,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:37:16,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:16,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:37:16,425 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:16,425 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:16,425 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:37:16,436 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:16,439 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:16,441 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:16,444 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:16,446 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:16,448 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:16,451 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:16,453 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:16,456 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:16,458 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:16,460 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:16,470 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:16,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:37:16,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:37:16,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:37:16,481 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:16,481 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:37:16,489 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:16,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:37:16,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:16,505 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:16,509 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:37:16,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:37:16,515 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:16,515 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:16,515 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:16,515 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:16,515 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:16,516 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:37:16,516 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:16,516 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:37:16,516 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:16,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:37:16,518 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:37:16,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:16,518 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:37:16,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:37:16,519 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:37:16,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:37:16,520 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:37:16,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:37:16,520 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:37:16,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:37:16,520 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:37:16,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:37:16,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:16,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:37:16,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:16,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:16,522 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:16,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:37:16,522 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:37:16,522 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:37:16,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:37:16,527 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:37:16,527 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:16,528 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:16,528 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:16,530 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:16,530 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:16,530 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:16,531 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:16,544 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3813, Threshold=0.4380, Accuracy=0.7061, F1=0.7981, Precision=0.9681, Recall=0.6789
2025-08-04 20:37:16,544 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7061, F1: 0.7981, Prec: 0.9681, Rec: 0.6789, Avg Anomaly Score: 0.3813
2025-08-04 20:37:27,809 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:27,809 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:27,809 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:27,809 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:37:27,809 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:37:27,809 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:28,083 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:28,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:28,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:37:28,190 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:37:28,191 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:28,284 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:28,289 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:28,289 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:28,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:37:28,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:28,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:37:28,300 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:28,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:28,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:37:28,309 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:28,312 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:28,314 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:28,316 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:28,318 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:28,320 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:28,323 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:28,325 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:28,328 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:28,330 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:28,332 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:28,342 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:28,342 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:37:28,347 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:37:28,347 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:37:28,352 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:28,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:37:28,363 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:28,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:37:28,364 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:28,380 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:28,386 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:37:28,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:37:28,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:28,393 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:28,393 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:28,394 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:28,394 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:28,394 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:37:28,394 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:28,394 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:37:28,395 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:28,396 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:37:28,396 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:37:28,397 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:37:28,398 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:37:28,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:37:28,398 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:37:28,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:37:28,398 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:37:28,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:37:28,399 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:37:28,399 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:37:28,399 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:37:28,399 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:37:28,399 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:28,399 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:37:28,400 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:28,400 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:28,400 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:28,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:37:28,400 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:37:28,401 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:37:28,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:37:28,403 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:37:28,403 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:28,404 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:28,404 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:28,405 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:28,406 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:28,406 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:28,406 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:28,421 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3567, Threshold=0.4140, Accuracy=0.7130, F1=0.8029, Precision=0.9739, Recall=0.6829
2025-08-04 20:37:28,421 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7130, F1: 0.8029, Prec: 0.9739, Rec: 0.6829, Avg Anomaly Score: 0.3567
2025-08-04 20:37:42,709 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:42,710 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:42,710 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:42,710 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:37:42,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:37:42,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:43,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:43,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:43,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:37:43,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:37:43,178 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:43,307 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:43,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:43,315 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:43,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:37:43,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:43,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:37:43,346 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:43,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:43,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:37:43,355 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:43,358 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:43,360 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:43,362 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:43,365 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:43,367 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:43,369 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:43,372 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:43,375 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:43,376 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:43,379 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:43,388 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:43,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:37:43,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:37:43,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:37:43,400 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:43,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:37:43,412 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:43,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:37:43,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:43,426 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:43,431 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:37:43,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:37:43,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:43,435 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:43,435 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:43,436 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:43,436 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:43,436 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:37:43,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:43,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:37:43,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:43,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:37:43,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:37:43,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:37:43,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:37:43,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:37:43,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:37:43,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:37:43,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:43,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:37:43,441 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:43,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:43,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:43,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:37:43,442 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:37:43,442 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:37:43,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:37:43,451 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:37:43,451 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:43,452 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:43,452 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:43,454 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:43,454 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:43,454 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:43,455 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:43,467 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3719, Threshold=0.4345, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 20:37:43,467 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.3719
2025-08-04 20:37:54,737 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:54,737 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:54,738 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:54,738 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:37:54,738 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:37:54,738 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:55,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:55,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:55,092 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:37:55,138 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:37:55,138 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:55,279 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:55,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:55,286 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:55,292 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:37:55,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:55,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:37:55,299 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:55,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:55,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:37:55,308 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:55,311 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:55,313 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:55,315 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:55,318 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:55,320 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:55,323 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:55,325 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:55,328 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:55,331 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:55,336 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:55,346 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:55,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:37:55,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:37:55,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:37:55,356 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:55,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:37:55,365 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:55,365 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:37:55,365 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:55,381 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:55,386 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:37:55,396 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:37:55,396 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:55,396 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:55,397 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:55,397 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:55,397 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:55,397 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:37:55,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:55,398 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:37:55,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:55,400 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:37:55,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:37:55,400 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:55,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:37:55,401 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:55,401 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:55,401 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:55,401 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:37:55,402 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:37:55,402 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:37:55,402 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:37:55,402 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:37:55,402 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:37:55,403 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:37:55,403 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:37:55,403 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:37:55,403 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:37:55,403 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:37:55,404 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:37:55,404 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:55,404 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:37:55,405 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:55,405 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:55,405 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:55,405 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:37:55,406 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:37:55,406 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:37:55,406 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:37:55,414 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:37:55,414 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:55,416 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:55,416 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:55,417 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:55,418 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:55,418 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:55,418 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:55,432 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3773, Threshold=0.4402, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:37:55,432 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.3773
2025-08-04 20:38:06,695 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:06,695 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:06,696 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:06,696 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:38:06,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:38:06,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:06,966 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:06,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:07,054 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:38:07,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:38:07,097 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:07,218 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:07,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:07,225 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:07,232 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:38:07,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:07,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:38:07,254 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:07,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:07,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:38:07,263 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:07,266 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:07,268 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:07,270 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:07,273 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:07,275 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:07,278 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:07,280 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:07,283 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:07,285 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:07,287 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:07,297 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:07,297 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:38:07,302 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:38:07,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:38:07,311 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:07,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:38:07,320 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:07,320 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:38:07,320 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:07,335 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:07,340 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:38:07,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:38:07,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:07,346 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:07,346 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:07,346 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:07,346 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:07,347 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:38:07,347 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:07,347 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:38:07,347 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:07,349 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:38:07,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:38:07,349 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:07,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:38:07,349 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:07,349 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:38:07,350 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:38:07,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:38:07,351 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:38:07,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:38:07,351 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:38:07,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:38:07,351 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:07,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:38:07,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:07,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:07,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:07,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:38:07,353 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:38:07,353 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:38:07,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:38:07,361 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:38:07,361 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:07,363 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:07,363 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:07,365 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:07,365 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:07,365 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:07,366 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:07,380 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3779, Threshold=0.4489, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:38:07,381 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.3779
2025-08-04 20:38:21,653 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:21,653 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:21,653 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:21,654 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:38:21,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:38:21,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:21,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:21,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:22,030 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:38:22,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:38:22,073 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:22,184 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:22,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:22,191 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:22,197 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:38:22,220 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:22,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:38:22,221 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:22,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:22,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:38:22,230 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:22,234 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,236 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:22,238 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:22,241 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:22,243 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:22,245 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,248 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:22,251 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:22,252 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:22,255 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:22,265 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:22,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:38:22,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:38:22,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:38:22,277 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:22,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:38:22,293 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:22,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:38:22,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:22,311 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:22,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:38:22,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:38:22,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:22,325 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:22,325 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:22,325 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:22,326 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:22,326 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:38:22,326 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:22,326 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:38:22,327 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:22,328 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:38:22,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:38:22,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:22,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:38:22,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:22,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:22,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:22,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:38:22,330 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:38:22,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:38:22,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:38:22,331 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:38:22,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:38:22,331 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:38:22,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:38:22,332 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:38:22,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:38:22,332 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:38:22,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:38:22,332 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:22,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:38:22,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:22,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:22,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:22,334 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:38:22,334 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:38:22,334 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:38:22,334 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:38:22,342 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:38:22,342 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:22,344 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:22,344 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:22,346 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:22,346 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:22,346 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:22,347 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:22,363 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3753, Threshold=0.4488, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:38:22,363 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.3753
2025-08-04 20:38:33,627 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:33,627 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:33,627 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:33,627 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:38:33,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:38:33,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:33,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:33,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:33,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:38:34,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:38:34,006 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:34,128 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:34,137 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:34,138 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:34,143 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:38:34,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:34,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:38:34,150 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:34,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:34,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:38:34,159 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:34,163 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:34,165 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:34,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:34,170 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:34,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:34,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:34,177 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:34,180 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:34,181 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:34,184 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:34,193 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:34,193 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:38:34,198 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:38:34,198 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:38:34,202 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:34,203 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:38:34,212 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:34,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:38:34,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:34,229 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:34,234 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:38:34,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:38:34,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:34,241 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:34,241 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:34,242 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:34,242 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:34,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:38:34,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:34,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:38:34,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:34,244 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:38:34,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:38:34,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:34,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:38:34,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:34,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:34,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:34,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:38:34,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:38:34,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:38:34,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:38:34,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:38:34,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:38:34,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:38:34,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:38:34,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:38:34,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:38:34,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:38:34,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:38:34,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:34,248 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:38:34,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:34,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:34,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:34,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:38:34,249 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:38:34,249 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:38:34,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:38:34,252 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:38:34,253 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:34,254 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:34,254 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:34,256 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:34,256 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:34,256 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:34,257 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:34,271 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3740, Threshold=0.4502, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:38:34,271 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.3740
2025-08-04 20:38:48,563 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:48,563 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:48,563 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:48,563 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:38:48,563 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:38:48,563 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:48,828 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:48,828 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:48,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:38:48,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:38:48,939 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:49,022 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:49,027 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:49,027 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:49,031 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:38:49,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:49,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:38:49,037 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:49,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:49,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:38:49,045 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:49,048 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:49,051 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:49,053 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:49,055 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:49,058 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:49,060 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:49,062 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:49,065 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:49,067 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:49,069 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:49,078 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:49,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:38:49,083 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:38:49,083 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:38:49,087 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:49,087 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:38:49,096 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:49,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:38:49,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:49,111 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:49,116 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:38:49,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:38:49,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:49,120 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:49,120 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:49,120 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:49,121 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:49,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:38:49,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:49,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:38:49,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:49,123 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:38:49,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:38:49,123 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:49,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:38:49,123 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:38:49,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:38:49,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:38:49,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:38:49,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:38:49,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:38:49,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:38:49,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:49,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:38:49,127 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:38:49,127 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:38:49,127 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:38:49,129 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:38:49,129 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:49,130 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:49,130 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:49,132 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:49,132 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:49,132 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:49,133 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:49,145 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3745, Threshold=0.4513, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:38:49,146 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.3745
2025-08-04 20:39:03,428 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:03,429 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:03,429 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:03,429 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:39:03,429 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:39:03,429 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:03,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:03,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:03,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:39:03,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:39:03,838 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:03,947 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:03,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:03,953 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:03,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:39:03,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:03,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:39:03,964 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:03,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:03,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:39:03,972 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:03,975 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,978 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:03,980 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:03,983 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:03,985 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:03,987 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,990 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:03,992 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:03,994 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:03,997 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:04,004 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:04,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:39:04,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:39:04,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:39:04,013 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:04,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:39:04,021 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:04,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:39:04,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:04,037 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:04,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:39:04,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:39:04,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:04,046 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:04,046 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:04,047 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:04,047 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:04,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:39:04,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:04,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:39:04,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:04,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:39:04,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:39:04,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:04,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:39:04,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:04,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:04,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:04,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:39:04,050 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:39:04,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:39:04,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:39:04,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:39:04,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:39:04,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:04,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:39:04,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:04,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:04,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:04,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:39:04,053 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:39:04,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:39:04,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:39:04,057 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:39:04,057 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:04,058 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:04,058 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:04,060 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:04,060 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:04,060 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:04,060 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:04,073 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3701, Threshold=0.4394, Accuracy=0.7304, F1=0.8148, Precision=0.9884, Recall=0.6931
2025-08-04 20:39:04,073 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7304, F1: 0.8148, Prec: 0.9884, Rec: 0.6931, Avg Anomaly Score: 0.3701
2025-08-04 20:39:09,333 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:09,333 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:09,333 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:09,333 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:39:09,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:39:09,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:09,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:09,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:09,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:39:09,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:39:09,687 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:09,780 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:09,786 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:09,786 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:09,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:39:09,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:09,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:39:09,802 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:09,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:09,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:39:09,811 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:09,814 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:09,816 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:09,819 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:09,821 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:09,824 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:09,826 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:09,829 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:09,831 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:09,834 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:09,836 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:09,845 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:09,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:39:09,850 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:39:09,850 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:39:09,856 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:09,856 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:39:09,866 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:09,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:39:09,867 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:09,881 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:09,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:39:09,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:39:09,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:09,890 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:09,890 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:09,891 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:09,891 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:09,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:39:09,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:09,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:39:09,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:09,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:39:09,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:39:09,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:39:09,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:39:09,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:39:09,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:39:09,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:39:09,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:39:09,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:39:09,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:39:09,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:39:09,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:39:09,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:39:09,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:09,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:39:09,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:09,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:09,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:09,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:39:09,898 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:39:09,898 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:39:09,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:39:09,904 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:39:09,905 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:09,906 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:09,906 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:09,908 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 80/400.
2025-08-04 20:39:10,009 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:10,009 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:10,010 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:39:10,010 - ClientAppLogger [Client 0] - INFO - [Client] Round 80: Training GAN with 15 samples (12 normal, 3 anomalous).
2025-08-04 20:39:10,010 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:10,033 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0801, Avg D Loss: 0.8518
2025-08-04 20:39:10,033 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0801, Avg D Loss: 0.8518
2025-08-04 20:39:10,034 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:10,046 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3451, Threshold=0.4017, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:39:10,047 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:39:10,047 - ClientAppLogger [Client 0] - INFO - Fit completed for round 80. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 80, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0801047563552855, 'd_loss': 0.8518003463745117, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.13909101486206055, 'cpu_percent_fit': 6.50625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 15}
2025-08-04 20:39:10,047 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:39:18,337 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:18,338 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:18,338 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:18,338 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:39:18,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:39:18,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:18,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:18,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:18,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:39:18,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:39:18,773 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:18,902 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:18,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:18,909 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:18,916 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:39:18,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:18,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:39:18,924 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:18,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:18,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:39:18,933 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:18,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,939 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:18,941 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:18,944 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:18,946 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:18,948 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,951 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:18,953 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:18,955 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:18,958 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:18,968 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:18,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:39:18,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:39:18,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:39:18,978 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:18,978 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:39:18,986 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:18,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:39:18,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:19,002 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:19,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:39:19,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:39:19,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:19,011 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:19,012 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:19,012 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:19,012 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:19,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:39:19,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:19,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:39:19,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:19,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:39:19,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:39:19,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:19,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:39:19,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:19,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:19,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:19,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:39:19,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:19,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:19,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:19,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:39:19,018 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:39:19,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:39:19,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:39:19,023 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:39:19,023 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:19,025 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:19,025 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:19,026 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:19,026 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:19,026 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:19,027 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:19,040 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3956, Threshold=0.4676, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:39:19,040 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.3956
2025-08-04 20:39:30,347 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:30,348 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:30,348 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:30,348 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:39:30,348 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:39:30,348 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:30,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:30,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:30,739 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:39:30,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:39:30,782 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:30,878 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:30,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:30,885 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:30,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:39:30,899 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:30,899 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:39:30,900 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:30,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:30,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:39:30,909 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:30,912 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,914 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:30,916 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:30,919 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:30,921 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:30,924 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:30,929 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:30,931 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:30,933 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:30,942 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:30,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:39:30,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:39:30,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:39:30,953 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:30,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:39:30,964 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:30,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:39:30,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:30,980 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:30,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:39:30,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:39:30,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:30,991 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:30,991 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:30,991 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:30,992 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:30,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:39:30,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:30,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:39:30,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:30,993 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:39:30,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:39:30,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:30,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:39:30,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:30,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:39:30,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:39:30,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:30,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:30,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:30,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:39:30,997 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:39:30,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:39:30,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:39:31,001 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:39:31,001 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:31,002 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:31,002 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:31,004 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:31,004 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:31,004 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:31,005 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:31,018 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3835, Threshold=0.4461, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:39:31,018 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3835
2025-08-04 20:39:42,295 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:42,295 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:42,296 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:42,296 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:39:42,296 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:39:42,296 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:42,557 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:42,557 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:42,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:39:42,701 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:39:42,701 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:42,844 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:42,851 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:42,852 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:42,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:39:42,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:42,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:39:42,866 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:42,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:42,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:39:42,874 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:42,877 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,879 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:42,882 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:42,884 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:42,886 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:42,889 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,891 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:42,894 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:42,896 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:42,898 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:42,908 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:42,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:39:42,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:39:42,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:39:42,918 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:42,918 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:39:42,929 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:42,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:39:42,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:42,946 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:42,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:39:42,956 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:39:42,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:42,957 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:42,957 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:42,957 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:42,957 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:42,958 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:39:42,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:42,958 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:39:42,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:42,960 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:39:42,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:39:42,960 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:42,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:39:42,961 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:39:42,962 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:39:42,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:39:42,962 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:39:42,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:39:42,962 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:39:42,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:39:42,963 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:39:42,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:39:42,963 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:42,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:39:42,963 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:42,963 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:42,964 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:42,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:39:42,964 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:39:42,964 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:39:42,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:39:42,968 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:39:42,968 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:42,970 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:42,970 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:42,972 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:42,972 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:42,972 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:42,972 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:42,986 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3720, Threshold=0.4288, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:39:42,986 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3720
2025-08-04 20:39:57,265 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:57,265 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:57,266 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:57,266 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:39:57,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:39:57,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:57,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:57,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:57,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:39:57,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:39:57,652 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:57,759 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:57,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:57,767 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:57,775 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:39:57,786 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:57,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:39:57,787 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:57,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:57,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:39:57,797 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:57,800 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:57,802 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:57,804 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:57,807 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:57,809 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:57,812 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:57,815 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:57,818 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:57,820 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:57,823 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:57,834 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:57,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:39:57,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:39:57,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:39:57,846 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:57,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:39:57,859 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:57,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:39:57,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:57,875 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:57,879 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:39:57,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:39:57,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:57,885 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:57,885 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:57,885 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:57,886 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:57,886 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:39:57,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:57,886 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:39:57,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:57,888 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:39:57,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:39:57,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:57,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:39:57,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:57,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:57,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:57,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:39:57,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:39:57,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:39:57,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:39:57,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:39:57,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:39:57,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:39:57,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:39:57,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:39:57,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:39:57,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:39:57,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:39:57,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:57,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:39:57,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:57,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:57,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:57,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:39:57,896 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:39:57,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:39:57,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:39:57,900 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:39:57,901 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:57,902 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:57,902 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:57,903 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:57,903 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:57,904 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:57,904 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:57,917 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4028, Threshold=0.4662, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:39:57,917 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4028
2025-08-04 20:40:03,170 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:03,170 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:03,170 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:03,171 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:40:03,171 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:40:03,171 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:03,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:03,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:03,510 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:40:03,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:40:03,523 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:03,611 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:03,617 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:03,617 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:03,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:40:03,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:03,629 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:40:03,629 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:03,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:03,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:40:03,638 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:03,641 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:03,644 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:03,646 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:03,649 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:03,651 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:03,654 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:03,657 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:03,659 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:03,662 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:03,664 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:03,674 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:03,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:40:03,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:40:03,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:40:03,685 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:03,685 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:40:03,697 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:03,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:40:03,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:03,713 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:03,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:40:03,723 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:40:03,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:03,724 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:03,724 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:03,724 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:03,725 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:03,725 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:40:03,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:03,725 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:40:03,726 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:03,727 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:40:03,727 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:40:03,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:40:03,729 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:40:03,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:40:03,729 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:40:03,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:40:03,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:40:03,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:40:03,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:40:03,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:40:03,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:40:03,731 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:40:03,731 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:03,731 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:40:03,731 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:03,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:03,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:03,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:40:03,732 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:40:03,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:40:03,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:40:03,735 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:40:03,735 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:03,737 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:03,737 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:03,738 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 84/400.
2025-08-04 20:40:03,840 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:03,840 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:03,842 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:40:03,842 - ClientAppLogger [Client 0] - INFO - [Client] Round 84: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:40:03,842 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:03,866 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0808, Avg D Loss: 0.8358
2025-08-04 20:40:03,866 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0808, Avg D Loss: 0.8358
2025-08-04 20:40:03,867 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:03,879 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3608, Threshold=0.4065, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:40:03,880 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:40:03,880 - ClientAppLogger [Client 0] - INFO - Fit completed for round 84. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 84, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0807682991027834, 'd_loss': 0.8358159065246582, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14125299453735352, 'cpu_percent_fit': 6.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:40:03,880 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:40:12,160 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:12,161 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:12,161 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:12,161 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:40:12,161 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:40:12,161 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:12,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:12,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:12,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:40:12,640 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:40:12,640 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:12,768 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:12,776 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:12,776 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:12,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:40:12,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:12,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:40:12,790 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:12,790 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:12,790 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:40:12,801 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:12,804 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,807 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:12,809 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:12,812 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:12,815 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:12,819 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,822 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:12,825 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:12,827 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:12,830 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:12,840 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:12,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:40:12,846 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:40:12,846 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:40:12,852 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:12,852 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:40:12,861 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:12,861 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:40:12,861 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:12,877 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:12,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:40:12,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:40:12,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:12,889 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:12,889 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:12,890 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:12,890 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:12,890 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:40:12,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:12,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:40:12,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:12,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:40:12,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:40:12,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:12,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:40:12,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:12,897 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:12,898 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:12,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:40:12,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:40:12,900 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:40:12,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:40:12,901 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:40:12,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:40:12,902 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:40:12,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:40:12,903 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:40:12,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:40:12,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:40:12,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:40:12,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:12,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:40:12,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:12,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:12,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:12,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:40:12,907 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:40:12,907 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:40:12,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:40:12,910 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:40:12,911 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:12,912 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:12,912 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:12,914 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:12,914 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:12,914 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:12,915 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:12,928 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4062, Threshold=0.4688, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:40:12,928 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4062
2025-08-04 20:40:24,216 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:24,216 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:24,216 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:24,217 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:40:24,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:40:24,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:24,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:24,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:24,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:40:24,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:40:24,760 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:24,875 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:24,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:24,882 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:24,887 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:40:24,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:24,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:40:24,896 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:24,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:24,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:40:24,908 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:24,911 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:24,915 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:24,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:24,921 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:24,923 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:24,929 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:24,932 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:24,934 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:24,945 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:24,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:40:24,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:40:24,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:40:24,957 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:24,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:40:24,968 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:24,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:40:24,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:24,987 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:24,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:40:24,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:40:24,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:24,998 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:24,998 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:24,998 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:24,999 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:24,999 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:40:24,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:24,999 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:40:24,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:25,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:40:25,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:40:25,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:40:25,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:40:25,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:40:25,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:40:25,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:40:25,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:40:25,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:40:25,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:40:25,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:40:25,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:40:25,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:40:25,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:25,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:40:25,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:25,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:25,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:25,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:40:25,006 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:40:25,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:40:25,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:40:25,009 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:40:25,009 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:25,010 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:25,010 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:25,012 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:25,012 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:25,012 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:25,013 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:25,029 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3831, Threshold=0.4351, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:40:25,029 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3831
2025-08-04 20:40:39,308 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:39,308 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:39,308 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:39,308 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:40:39,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:40:39,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:39,805 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:39,805 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:39,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:40:39,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:40:39,982 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:40,142 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:40,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:40,150 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:40,158 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:40:40,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:40,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:40:40,168 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:40,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:40,169 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:40:40,178 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:40,183 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,186 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:40,188 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:40,191 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:40,193 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:40,196 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,199 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:40,202 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:40,204 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:40,206 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:40,219 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:40,219 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:40:40,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:40:40,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:40:40,233 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:40,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:40:40,257 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:40,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:40:40,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:40,280 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:40,288 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:40:40,303 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:40:40,304 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:40,305 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:40,305 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:40,305 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:40,306 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:40,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:40:40,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:40,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:40:40,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:40,310 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:40:40,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:40:40,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:40,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:40:40,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:40,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:40,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:40,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:40:40,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:40:40,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:40:40,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:40:40,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:40:40,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:40:40,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:40:40,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:40:40,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:40:40,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:40:40,316 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:40:40,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:40:40,317 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:40,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:40:40,319 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:40,319 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:40,319 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:40,320 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:40:40,320 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:40:40,321 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:40:40,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:40:40,329 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:40:40,329 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:40,332 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:40,332 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:40,335 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:40,335 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:40,335 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:40,336 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:40,356 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4153, Threshold=0.4832, Accuracy=0.7304, F1=0.8148, Precision=0.9884, Recall=0.6931
2025-08-04 20:40:40,357 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7304, F1: 0.8148, Prec: 0.9884, Rec: 0.6931, Avg Anomaly Score: 0.4153
2025-08-04 20:40:54,643 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:54,643 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:54,643 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:54,644 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:40:54,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:40:54,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:54,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:54,972 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:55,060 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:40:55,090 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:40:55,090 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:55,231 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:55,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:55,244 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:55,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:40:55,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:55,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:40:55,260 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:55,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:55,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:40:55,270 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:55,273 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,275 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:55,277 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:55,280 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:55,282 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:55,284 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,287 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:55,290 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:55,291 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:55,294 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:55,306 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:55,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:40:55,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:40:55,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:40:55,316 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:55,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:40:55,329 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:55,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:40:55,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:55,346 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:55,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:40:55,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:40:55,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:55,363 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:55,363 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:55,364 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:55,364 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:55,365 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:40:55,365 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:55,365 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:40:55,365 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:55,367 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:40:55,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:40:55,367 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:55,368 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:40:55,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:55,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:55,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:55,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:40:55,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:40:55,369 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:40:55,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:40:55,369 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:40:55,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:40:55,370 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:40:55,370 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:40:55,370 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:40:55,370 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:40:55,371 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:40:55,371 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:40:55,371 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:55,371 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:40:55,372 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:55,372 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:55,372 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:55,373 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:40:55,373 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:40:55,373 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:40:55,373 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:40:55,377 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:40:55,377 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:55,378 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:55,379 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:55,380 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:55,380 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:55,380 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:55,381 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:55,396 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4190, Threshold=0.4798, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:40:55,396 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4190
2025-08-04 20:41:09,678 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:09,678 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:09,678 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:09,678 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:41:09,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:41:09,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:09,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:09,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:10,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:41:10,082 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:41:10,082 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:10,214 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:10,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:10,227 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:10,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:41:10,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:10,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:41:10,245 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:10,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:10,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:41:10,257 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:10,260 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,262 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:10,264 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:10,267 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:10,270 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:10,272 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,275 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:10,278 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:10,280 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:10,282 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:10,294 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:10,295 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:41:10,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:41:10,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:41:10,308 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:10,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:41:10,320 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:10,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:41:10,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:10,338 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:10,343 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:41:10,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:41:10,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:10,351 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:10,351 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:10,352 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:10,352 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:10,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:41:10,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:10,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:41:10,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:10,354 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:41:10,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:41:10,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:10,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:41:10,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:10,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:10,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:10,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:41:10,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:41:10,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:41:10,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:41:10,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:41:10,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:41:10,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:41:10,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:41:10,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:41:10,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:41:10,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:41:10,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:41:10,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:10,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:41:10,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:10,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:10,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:10,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:41:10,360 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:41:10,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:41:10,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:41:10,363 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:41:10,363 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:10,365 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:10,365 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:10,366 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:10,367 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:10,367 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:10,368 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:10,383 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3878, Threshold=0.4360, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:41:10,383 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3878
2025-08-04 20:41:21,649 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:21,649 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:21,650 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:21,650 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:41:21,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:41:21,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:21,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:21,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:21,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:41:22,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:41:22,023 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:22,116 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:22,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:22,123 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:22,130 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:41:22,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:22,141 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:41:22,141 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:22,141 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:22,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:41:22,150 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:22,153 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,156 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:22,158 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:22,161 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:22,163 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:22,166 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,168 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:22,171 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:22,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:22,176 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:22,187 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:22,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:41:22,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:41:22,193 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:41:22,199 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:22,199 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:41:22,211 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:22,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:41:22,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:22,233 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:22,239 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:41:22,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:41:22,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:22,254 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:22,254 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:22,255 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:22,255 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:22,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:41:22,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:22,256 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:41:22,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:22,258 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:41:22,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:41:22,258 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:22,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:41:22,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:22,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:22,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:22,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:41:22,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:41:22,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:41:22,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:41:22,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:41:22,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:41:22,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:41:22,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:41:22,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:41:22,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:41:22,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:41:22,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:41:22,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:22,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:41:22,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:22,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:22,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:22,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:41:22,263 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:41:22,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:41:22,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:41:22,269 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:41:22,269 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:22,271 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:22,271 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:22,273 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:22,273 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:22,273 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:22,274 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:22,288 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3921, Threshold=0.4320, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:41:22,288 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3921
2025-08-04 20:41:33,564 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:33,564 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:33,564 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:33,565 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:41:33,565 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:41:33,565 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:33,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:33,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:33,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:41:33,940 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:41:33,940 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:34,047 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:34,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:34,053 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:34,057 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:41:34,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:34,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:41:34,063 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:34,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:34,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:41:34,071 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:34,074 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:34,076 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:34,078 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:34,081 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:34,083 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:34,085 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:34,088 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:34,090 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:34,092 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:34,094 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:34,103 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:34,103 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:41:34,108 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:41:34,108 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:41:34,113 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:34,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:41:34,122 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:34,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:41:34,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:34,138 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:34,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:41:34,147 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:41:34,147 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:34,147 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:34,147 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:34,148 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:34,148 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:34,148 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:41:34,148 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:34,148 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:41:34,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:34,150 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:41:34,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:41:34,150 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:34,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:41:34,151 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:34,151 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:34,151 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:34,151 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:41:34,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:41:34,151 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:41:34,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:41:34,152 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:41:34,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:41:34,152 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:41:34,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:41:34,152 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:41:34,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:41:34,153 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:41:34,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:41:34,153 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:34,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:41:34,154 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:34,154 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:34,154 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:34,154 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:41:34,154 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:41:34,154 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:41:34,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:41:34,158 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:41:34,158 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:34,159 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:34,160 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:34,161 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:34,161 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:34,161 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:34,162 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:34,176 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4358, Threshold=0.4989, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:41:34,176 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.4358
2025-08-04 20:41:48,458 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:48,458 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:48,458 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:48,459 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:41:48,459 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:41:48,459 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:48,684 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:48,684 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:48,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:41:48,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:41:48,799 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:48,884 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:48,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:48,889 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:48,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:41:48,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:48,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:41:48,902 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:48,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:48,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:41:48,910 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:48,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:48,915 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:48,917 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:48,920 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:48,922 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:48,925 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:48,927 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:48,930 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:48,932 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:48,934 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:48,943 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:48,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:41:48,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:41:48,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:41:48,953 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:48,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:41:48,961 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:48,961 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:41:48,961 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:48,976 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:48,980 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:41:48,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:41:48,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:48,985 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:48,986 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:48,986 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:48,986 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:48,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:41:48,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:48,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:41:48,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:48,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:41:48,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:41:48,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:48,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:41:48,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:48,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:48,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:48,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:41:48,990 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:41:48,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:41:48,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:41:48,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:41:48,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:48,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:41:48,991 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:48,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:48,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:48,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:41:48,992 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:41:48,992 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:41:48,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:41:48,998 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:41:48,998 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:48,999 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:48,999 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:49,001 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:49,001 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:49,001 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:49,002 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:49,015 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4262, Threshold=0.4949, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:41:49,015 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.4262
2025-08-04 20:42:03,296 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:03,296 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:03,296 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:03,297 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:42:03,297 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:42:03,297 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:03,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:03,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:03,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:42:03,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:42:03,665 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:03,778 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:03,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:03,783 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:03,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:42:03,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:03,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:42:03,794 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:03,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:03,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:42:03,803 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:03,805 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:03,807 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:03,809 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:03,812 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:03,814 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:03,816 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:03,819 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:03,822 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:03,823 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:03,826 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:03,835 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:03,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:42:03,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:42:03,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:42:03,844 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:03,844 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:42:03,852 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:03,852 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:42:03,852 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:03,867 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:03,871 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:42:03,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:42:03,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:03,877 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:03,878 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:03,878 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:03,878 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:03,878 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:42:03,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:03,878 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:42:03,879 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:03,880 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:42:03,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:42:03,880 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:03,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:42:03,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:42:03,882 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:42:03,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:42:03,883 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:03,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:42:03,883 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:03,883 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:03,884 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:03,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:42:03,884 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:42:03,884 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:42:03,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:42:03,889 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:42:03,889 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:03,891 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:03,891 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:03,892 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:03,892 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:03,892 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:03,893 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:03,906 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3912, Threshold=0.4432, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:42:03,907 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3912
2025-08-04 20:42:21,194 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:21,194 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:21,194 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:21,194 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:42:21,194 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:42:21,194 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:21,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:21,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:21,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:42:21,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:42:21,577 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:21,672 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:21,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:21,678 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:21,684 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:42:21,700 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:21,700 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:42:21,700 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:21,700 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:21,701 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:42:21,709 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:21,711 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:21,713 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:21,715 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:21,718 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:21,721 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:21,723 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:21,726 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:21,729 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:21,731 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:21,734 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:21,744 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:21,745 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:42:21,750 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:42:21,750 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:42:21,756 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:21,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:42:21,767 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:21,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:42:21,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:21,781 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:21,786 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:42:21,790 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:42:21,790 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:21,790 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:21,790 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:21,791 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:21,791 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:21,791 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:42:21,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:21,791 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:42:21,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:21,793 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:42:21,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:42:21,793 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:21,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:42:21,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:21,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:21,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:21,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:42:21,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:42:21,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:42:21,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:42:21,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:42:21,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:42:21,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:21,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:42:21,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:21,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:21,797 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:21,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:42:21,797 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:42:21,797 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:42:21,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:42:21,801 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:42:21,801 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:21,802 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:21,803 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:21,804 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:21,804 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:21,804 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:21,805 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:21,818 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4080, Threshold=0.4519, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:42:21,818 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4080
2025-08-04 20:42:36,103 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:36,103 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:36,103 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:36,103 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:42:36,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:42:36,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:36,403 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:36,404 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:36,484 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:42:36,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:42:36,524 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:36,631 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:36,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:36,636 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:36,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:42:36,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:36,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:42:36,646 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:36,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:36,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:42:36,655 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:36,657 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:36,660 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:36,662 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:36,664 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:36,666 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:36,669 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:36,671 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:36,674 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:36,676 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:36,678 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:36,687 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:36,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:42:36,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:42:36,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:42:36,696 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:36,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:42:36,704 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:36,704 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:42:36,704 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:36,719 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:36,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:42:36,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:42:36,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:36,729 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:36,729 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:36,730 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:36,730 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:36,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:42:36,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:36,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:42:36,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:42:36,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:42:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:36,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:42:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:42:36,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:42:36,734 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:42:36,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:42:36,734 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:42:36,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:42:36,734 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:42:36,735 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:42:36,735 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:36,735 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:42:36,735 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:36,735 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:36,736 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:36,736 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:42:36,736 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:42:36,736 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:42:36,736 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:42:36,739 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:42:36,740 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:36,741 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:36,741 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:36,742 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:36,743 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:36,743 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:36,743 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:36,756 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3852, Threshold=0.4201, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:42:36,756 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3852
2025-08-04 20:42:54,063 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:54,063 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:54,064 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:54,064 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:42:54,064 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:42:54,064 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:54,362 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:54,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:54,449 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:42:54,487 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:42:54,487 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:54,580 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:54,585 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:54,585 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:54,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:42:54,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:54,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:42:54,600 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:54,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:54,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:42:54,608 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:54,611 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:54,614 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:54,616 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:54,618 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:54,620 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:54,623 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:54,625 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:54,628 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:54,630 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:54,632 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:54,641 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:54,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:42:54,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:42:54,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:42:54,651 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:54,652 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:42:54,662 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:54,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:42:54,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:54,677 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:54,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:42:54,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:42:54,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:54,686 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:54,686 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:54,687 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:54,687 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:54,687 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:42:54,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:54,687 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:42:54,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:54,689 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:42:54,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:42:54,689 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:54,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:42:54,689 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:42:54,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:42:54,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:42:54,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:42:54,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:42:54,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:42:54,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:42:54,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:42:54,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:54,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:42:54,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:54,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:54,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:54,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:42:54,693 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:42:54,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:42:54,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:42:54,696 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:42:54,696 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:54,697 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:54,697 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:54,698 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:54,699 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:54,699 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:54,699 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:54,713 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4037, Threshold=0.4306, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:42:54,713 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4037
2025-08-04 20:43:09,021 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:09,021 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:09,021 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:09,021 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:09,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:09,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:09,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:09,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:09,486 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:09,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:09,531 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:09,644 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:09,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:09,650 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:09,655 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:09,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:09,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:09,663 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:09,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:09,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:09,672 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:09,675 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,677 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:09,679 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:09,682 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:09,684 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:09,687 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,690 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:09,693 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:09,695 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:09,697 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:09,706 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:09,706 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:09,711 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:09,711 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:09,716 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:09,716 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:09,724 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:09,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:09,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:09,740 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:09,744 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:09,751 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:09,751 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:09,751 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:09,751 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:09,751 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:09,752 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:09,752 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:09,752 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:09,752 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:09,752 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:09,753 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:09,754 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:09,754 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:09,754 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:09,754 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:09,754 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:09,754 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:09,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:09,756 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:09,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:09,756 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:09,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:09,756 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:09,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:09,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:09,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:09,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:09,757 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:09,757 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:09,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:09,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:09,763 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:09,764 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:09,765 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:09,765 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:09,766 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:09,766 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:09,766 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:09,767 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:09,780 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4370, Threshold=0.4711, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:09,780 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4370
2025-08-04 20:43:15,046 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:15,046 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:15,047 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:15,047 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:15,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:15,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:15,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:15,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:15,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:15,446 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:15,447 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:15,536 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:15,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:15,542 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:15,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:15,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:15,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:15,553 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:15,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:15,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:15,562 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:15,565 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,567 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:15,569 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:15,572 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:15,574 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:15,577 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,580 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:15,582 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:15,584 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:15,587 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:15,596 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:15,596 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:15,601 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:15,601 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:15,605 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:15,606 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:15,616 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:15,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:15,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:15,631 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:15,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:15,640 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:15,640 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:15,640 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:15,640 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:15,641 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:15,641 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:15,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:15,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:15,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:15,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:15,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:15,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:15,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:15,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:15,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:15,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:15,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:15,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:15,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:15,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:15,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:15,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:15,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:15,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:15,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:15,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:15,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:15,647 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:15,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:15,647 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:15,647 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:15,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:15,649 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:15,650 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:15,651 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:15,651 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:15,653 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 97/400.
2025-08-04 20:43:15,754 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:15,754 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:15,755 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:15,755 - ClientAppLogger [Client 0] - INFO - [Client] Round 97: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:15,756 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:15,779 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0820, Avg D Loss: 0.8085
2025-08-04 20:43:15,779 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0820, Avg D Loss: 0.8085
2025-08-04 20:43:15,779 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:15,792 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4097, Threshold=0.4312, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:15,792 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:43:15,792 - ClientAppLogger [Client 0] - INFO - Fit completed for round 97. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 97, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0820262908935545, 'd_loss': 0.8084871411323548, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.13936996459960938, 'cpu_percent_fit': 6.475, 'ram_mb_fit': 6.72265625, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:15,792 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:43:24,065 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:24,065 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:24,065 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:24,065 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:24,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:24,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:24,394 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:24,394 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:24,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:24,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:24,521 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:24,634 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:24,639 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:24,640 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:24,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:24,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:24,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:24,650 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:24,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:24,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:24,659 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:24,662 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:24,664 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:24,667 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:24,669 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:24,671 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:24,674 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:24,676 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:24,679 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:24,681 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:24,683 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:24,691 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:24,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:24,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:24,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:24,701 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:24,701 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:24,710 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:24,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:24,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:24,727 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:24,731 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:24,738 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:24,739 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:24,739 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:24,739 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:24,739 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:24,740 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:24,740 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:24,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:24,740 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:24,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:24,742 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:24,742 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:24,742 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:24,742 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:24,742 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:24,743 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:24,744 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:24,745 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:24,745 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:24,745 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:24,745 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:24,746 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:24,746 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:24,746 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:24,746 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:24,751 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:24,751 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:24,752 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:24,752 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:24,753 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:24,753 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:24,753 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:24,754 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:24,767 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4105, Threshold=0.4357, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:24,767 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4105
2025-08-04 20:43:30,046 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:30,047 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:30,047 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:30,047 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:30,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:30,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:30,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:30,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:30,458 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:30,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:30,501 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:30,616 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:30,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:30,622 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:30,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:30,633 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:30,633 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:30,634 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:30,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:30,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:30,642 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:30,645 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:30,647 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:30,649 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:30,652 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:30,654 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:30,656 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:30,658 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:30,661 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:30,663 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:30,665 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:30,675 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:30,675 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:30,680 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:30,680 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:30,684 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:30,684 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:30,692 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:30,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:30,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:30,707 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:30,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:30,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:30,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:30,718 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:30,718 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:30,719 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:30,719 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:30,719 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:30,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:30,719 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:30,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:30,721 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:30,721 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:30,721 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:30,721 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:30,721 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:30,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:30,723 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:30,724 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:30,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:30,728 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:30,728 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:30,729 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:30,729 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:30,730 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 98/400.
2025-08-04 20:43:30,832 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:30,832 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:30,833 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:30,833 - ClientAppLogger [Client 0] - INFO - [Client] Round 98: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:30,833 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:30,857 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0807, Avg D Loss: 0.8082
2025-08-04 20:43:30,858 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0807, Avg D Loss: 0.8082
2025-08-04 20:43:30,858 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:30,872 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4080, Threshold=0.4283, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:30,872 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:43:30,872 - ClientAppLogger [Client 0] - INFO - Fit completed for round 98. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 98, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0806708335876465, 'd_loss': 0.8082001745700836, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14163923263549805, 'cpu_percent_fit': 6.175, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:30,872 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:43:42,156 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:42,156 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:42,156 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:42,156 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:42,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:42,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:42,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:42,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:42,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:42,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:42,636 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:42,763 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:42,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:42,773 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:42,780 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:42,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:42,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:42,788 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:42,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:42,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:42,797 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:42,800 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,803 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:42,805 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:42,808 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:42,810 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:42,813 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,816 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:42,819 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:42,822 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:42,824 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:42,836 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:42,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:42,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:42,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:42,847 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:42,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:42,858 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:42,858 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:42,858 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:42,875 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:42,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:42,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:42,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:42,886 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:42,886 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:42,887 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:42,887 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:42,887 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:42,887 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:42,888 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:42,888 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:42,889 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:42,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:42,890 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:42,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:42,890 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:42,890 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:42,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:42,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:42,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:42,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:42,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:42,891 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:42,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:42,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:42,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:42,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:42,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:42,892 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:42,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:42,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:42,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:42,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:42,893 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:42,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:42,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:42,894 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:42,894 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:42,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:42,902 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:42,902 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:42,904 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:42,904 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:42,905 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:42,905 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:42,906 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:42,906 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:42,921 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4470, Threshold=0.4708, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:42,921 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4470
2025-08-04 20:43:48,191 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:48,192 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:48,192 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:48,192 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:48,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:48,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:48,491 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:48,491 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:48,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:48,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:48,623 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:48,740 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:48,747 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:48,747 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:48,753 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:48,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:48,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:48,763 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:48,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:48,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:48,772 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:48,775 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,777 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:48,779 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:48,782 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:48,784 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:48,787 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,789 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:48,792 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:48,794 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:48,797 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:48,807 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:48,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:48,813 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:48,813 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:48,820 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:48,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:48,834 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:48,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:48,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:48,849 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:48,854 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:48,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:48,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:48,859 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:48,859 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:48,860 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:48,860 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:48,860 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:48,860 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:48,860 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:48,860 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:48,862 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:48,862 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:48,862 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:48,862 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:48,862 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:48,862 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:48,863 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:48,864 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:48,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:48,864 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:48,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:48,864 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:48,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:48,865 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:48,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:48,865 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:48,865 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:48,866 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:48,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:48,866 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:48,866 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:48,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:48,873 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:48,873 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:48,874 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:48,874 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:48,876 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 99/400.
2025-08-04 20:43:48,977 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:48,977 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:48,978 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:48,978 - ClientAppLogger [Client 0] - INFO - [Client] Round 99: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:48,978 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:49,002 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0774, Avg D Loss: 0.8023
2025-08-04 20:43:49,002 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0774, Avg D Loss: 0.8023
2025-08-04 20:43:49,002 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:49,015 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4162, Threshold=0.4288, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:49,016 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:43:49,016 - ClientAppLogger [Client 0] - INFO - Fit completed for round 99. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 99, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0774290323257447, 'd_loss': 0.8023133993148803, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.1398768424987793, 'cpu_percent_fit': 4.76875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:49,016 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:43:57,292 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:57,292 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:57,293 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:57,293 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:43:57,293 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:43:57,293 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:57,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:57,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:57,713 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:43:57,757 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:43:57,758 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:57,877 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:57,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:57,885 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:57,893 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:43:57,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:57,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:43:57,903 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:57,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:57,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:43:57,915 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:57,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,920 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:57,923 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:57,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:57,928 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:57,930 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,933 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:57,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:57,938 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:57,941 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:57,953 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:57,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:43:57,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:43:57,959 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:43:57,963 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:57,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:43:57,972 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:57,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:43:57,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:57,989 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:57,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:43:58,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:43:58,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:58,002 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:58,002 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:58,002 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:58,002 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:58,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:43:58,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:58,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:43:58,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:58,004 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:43:58,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:43:58,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:58,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:43:58,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:58,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:58,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:58,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:43:58,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:43:58,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:43:58,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:43:58,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:43:58,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:43:58,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:43:58,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:43:58,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:43:58,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:43:58,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:43:58,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:43:58,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:58,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:43:58,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:58,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:58,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:58,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:43:58,009 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:43:58,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:43:58,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:43:58,013 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:43:58,013 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:58,014 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:58,014 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:58,015 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:58,016 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:58,016 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:58,017 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:58,031 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3854, Threshold=0.3885, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:43:58,031 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.3854
2025-08-04 20:44:09,317 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:09,318 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:09,318 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:09,318 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:44:09,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:44:09,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:09,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:09,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:09,738 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:44:09,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:44:09,781 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:09,903 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:09,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:09,913 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:09,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:44:09,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:09,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:44:09,924 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:09,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:09,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:44:09,932 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:09,935 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:09,937 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:09,939 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:09,942 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:09,944 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:09,946 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:09,949 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:09,952 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:09,954 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:09,956 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:09,965 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:09,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:44:09,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:44:09,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:44:09,977 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:09,978 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:44:09,990 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:09,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:44:09,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:10,005 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:10,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:44:10,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:44:10,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:10,016 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:10,016 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:10,016 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:10,016 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:10,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:44:10,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:10,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:44:10,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:10,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:10,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:44:10,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:10,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:10,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:10,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:44:10,022 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:44:10,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:44:10,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:44:10,025 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:44:10,025 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:10,027 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:10,027 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:10,028 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:10,028 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:10,028 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:10,029 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:10,042 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4069, Threshold=0.4139, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:44:10,042 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4069
2025-08-04 20:44:18,309 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:18,310 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:18,310 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:18,310 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:44:18,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:44:18,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:18,607 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:18,607 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:18,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:44:18,741 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:44:18,741 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:18,858 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:18,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:18,864 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:18,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:44:18,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:18,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:44:18,876 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:18,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:18,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:44:18,885 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:18,889 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:18,891 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:18,893 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:18,896 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:18,898 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:18,901 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:18,903 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:18,906 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:18,908 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:18,910 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:18,919 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:18,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:44:18,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:44:18,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:44:18,929 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:18,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:44:18,938 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:18,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:44:18,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:18,953 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:18,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:44:18,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:44:18,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:18,963 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:18,963 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:18,964 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:18,964 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:18,964 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:44:18,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:18,965 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:44:18,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:18,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:44:18,966 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:44:18,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:44:18,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:44:18,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:44:18,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:18,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:44:18,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:18,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:18,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:18,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:44:18,970 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:44:18,970 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:44:18,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:44:18,973 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:44:18,974 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:18,975 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:18,975 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:18,976 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 101/400.
2025-08-04 20:44:19,078 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:19,078 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:19,079 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:19,079 - ClientAppLogger [Client 0] - INFO - [Client] Round 101: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:44:19,079 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:19,103 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0879, Avg D Loss: 0.7833
2025-08-04 20:44:19,104 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0879, Avg D Loss: 0.7833
2025-08-04 20:44:19,104 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:19,116 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4219, Threshold=0.4324, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:44:19,117 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:44:19,117 - ClientAppLogger [Client 0] - INFO - Fit completed for round 101. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 101, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0878605127334593, 'd_loss': 0.7832530379295349, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.1405789852142334, 'cpu_percent_fit': 6.36875, 'ram_mb_fit': 0.140625, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:44:19,117 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:44:30,408 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:30,408 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:30,408 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:30,408 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:44:30,408 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:44:30,409 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:30,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:30,719 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:30,810 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:44:30,852 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:44:30,852 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:30,970 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:30,976 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:30,977 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:30,982 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:44:30,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:30,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:44:30,989 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:30,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:30,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:44:30,997 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:31,000 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:31,002 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:31,005 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:31,007 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:31,009 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:31,012 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:31,015 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:31,018 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:31,020 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:31,022 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:31,032 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:31,032 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:44:31,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:44:31,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:44:31,044 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:31,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:44:31,052 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:31,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:44:31,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:31,067 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:31,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:44:31,077 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:44:31,077 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:31,077 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:31,077 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:31,078 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:31,078 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:31,078 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:44:31,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:31,079 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:44:31,079 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:31,080 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:44:31,080 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:44:31,080 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:44:31,081 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:44:31,082 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:44:31,083 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:31,083 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:44:31,083 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:31,084 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:31,084 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:31,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:44:31,084 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:44:31,084 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:44:31,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:44:31,091 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:44:31,092 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:31,093 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:31,093 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:31,094 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:31,095 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:31,095 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:31,095 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:31,110 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4185, Threshold=0.4229, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:44:31,110 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4185
2025-08-04 20:44:36,367 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:36,367 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:36,367 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:36,367 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:44:36,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:44:36,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:36,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:36,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:36,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:44:36,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:44:36,732 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:36,816 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:36,822 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:36,822 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:36,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:44:36,832 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:36,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:44:36,833 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:36,833 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:36,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:44:36,842 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:36,845 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:36,847 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:36,849 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:36,852 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:36,855 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:36,857 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:36,860 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:36,863 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:36,865 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:36,867 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:36,877 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:36,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:44:36,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:44:36,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:44:36,887 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:36,887 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:44:36,896 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:36,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:44:36,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:36,912 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:36,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:44:36,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:44:36,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:36,922 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:36,922 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:36,922 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:36,923 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:36,923 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:44:36,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:36,923 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:44:36,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:36,925 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:44:36,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:44:36,925 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:36,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:44:36,926 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:36,926 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:36,926 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:36,926 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:44:36,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:44:36,926 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:44:36,927 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:44:36,928 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:44:36,928 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:44:36,928 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:36,928 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:44:36,928 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:36,929 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:36,929 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:36,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:44:36,929 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:44:36,929 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:44:36,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:44:36,931 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:44:36,931 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:36,933 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:36,933 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:36,934 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 102/400.
2025-08-04 20:44:37,035 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:37,035 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:37,036 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:37,036 - ClientAppLogger [Client 0] - INFO - [Client] Round 102: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:44:37,036 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:37,060 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7805
2025-08-04 20:44:37,060 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7805
2025-08-04 20:44:37,060 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:37,073 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4268, Threshold=0.4390, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:44:37,074 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:44:37,074 - ClientAppLogger [Client 0] - INFO - Fit completed for round 102. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 102, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0838679552078245, 'd_loss': 0.7805397927761077, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.13953590393066406, 'cpu_percent_fit': 6.4, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:44:37,074 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:44:48,352 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:48,352 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:48,352 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:48,352 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:44:48,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:44:48,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:48,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:48,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:48,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:44:48,814 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:44:48,814 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:48,930 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:48,935 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:48,935 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:48,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:44:48,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:48,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:44:48,949 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:48,949 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:48,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:44:48,958 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:48,961 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:48,963 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:48,965 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:48,968 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:48,970 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:48,972 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:48,975 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:48,977 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:48,979 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:48,982 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:48,990 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:48,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:44:48,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:44:48,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:44:49,000 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:49,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:44:49,011 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:49,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:44:49,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:49,026 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:49,031 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:44:49,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:44:49,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:49,035 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:49,035 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:49,036 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:49,036 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:49,036 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:44:49,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:49,037 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:44:49,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:49,038 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:44:49,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:44:49,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:44:49,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:44:49,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:44:49,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:44:49,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:44:49,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:49,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:44:49,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:44:49,049 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:44:49,049 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:49,050 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:49,050 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:49,051 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:49,051 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:49,051 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:49,052 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:49,065 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4406, Threshold=0.4531, Accuracy=0.7235, F1=0.8100, Precision=0.9826, Recall=0.6890
2025-08-04 20:44:49,065 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7235, F1: 0.8100, Prec: 0.9826, Rec: 0.6890, Avg Anomaly Score: 0.4406
2025-08-04 20:44:57,335 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:57,335 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:57,335 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:57,336 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:44:57,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:44:57,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:57,652 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:57,652 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:57,739 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:44:57,780 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:44:57,781 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:57,897 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:57,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:57,903 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:57,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:44:57,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:57,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:44:57,913 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:57,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:57,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:44:57,921 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:57,924 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:57,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:57,928 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:57,931 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:57,933 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:57,935 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:57,938 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:57,940 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:57,942 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:57,944 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:57,952 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:57,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:44:57,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:44:57,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:44:57,962 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:57,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:44:57,970 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:57,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:44:57,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:57,985 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:57,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:44:57,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:44:57,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:57,996 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:57,996 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:57,997 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:57,997 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:57,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:44:57,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:57,998 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:44:57,998 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:57,999 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:44:57,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:44:58,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:44:58,001 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:44:58,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:44:58,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:44:58,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:44:58,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:58,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:44:58,002 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:58,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:58,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:58,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:44:58,003 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:44:58,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:44:58,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:44:58,009 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:44:58,009 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:58,010 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:58,010 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:58,011 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 103/400.
2025-08-04 20:44:58,112 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:58,112 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:58,113 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:58,113 - ClientAppLogger [Client 0] - INFO - [Client] Round 103: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:44:58,114 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:58,137 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7811
2025-08-04 20:44:58,137 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7811
2025-08-04 20:44:58,138 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:58,151 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4378, Threshold=0.4602, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:44:58,151 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:44:58,151 - ClientAppLogger [Client 0] - INFO - Fit completed for round 103. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 103, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.083572196960449, 'd_loss': 0.7811345756053925, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.13979482650756836, 'cpu_percent_fit': 6.34375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:44:58,151 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:45:09,428 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:09,428 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:09,428 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:09,428 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:45:09,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:45:09,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:09,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:09,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:09,779 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:45:09,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:45:09,819 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:09,936 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:09,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:09,944 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:09,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:45:09,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:09,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:45:09,960 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:09,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:09,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:45:09,968 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:09,971 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:09,974 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:09,976 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:09,978 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:09,980 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:09,983 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:09,985 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:09,988 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:09,990 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:09,992 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:10,002 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:10,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:45:10,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:45:10,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:45:10,013 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:10,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:45:10,023 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:10,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:45:10,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:10,038 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:10,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:45:10,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:45:10,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:10,047 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:10,048 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:10,048 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:10,048 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:10,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:45:10,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:10,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:45:10,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:10,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:45:10,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:45:10,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:10,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:45:10,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:10,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:10,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:10,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:45:10,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:45:10,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:45:10,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:45:10,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:45:10,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:45:10,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:45:10,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:45:10,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:45:10,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:45:10,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:45:10,054 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:45:10,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:10,054 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:45:10,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:10,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:10,055 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:10,055 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:45:10,055 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:45:10,055 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:45:10,055 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:45:10,063 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:45:10,063 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:10,065 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:10,065 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:10,066 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:10,066 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:10,066 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:10,067 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:10,080 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4580, Threshold=0.4861, Accuracy=0.7252, F1=0.8110, Precision=0.9855, Recall=0.6890
2025-08-04 20:45:10,081 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7252, F1: 0.8110, Prec: 0.9855, Rec: 0.6890, Avg Anomaly Score: 0.4580
2025-08-04 20:45:18,345 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:18,345 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:18,346 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:18,346 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:45:18,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:45:18,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:18,649 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:18,649 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:18,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:45:18,779 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:45:18,779 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:18,894 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:18,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:18,900 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:18,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:45:18,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:18,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:45:18,909 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:18,910 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:18,910 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:45:18,918 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:18,920 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:18,922 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:18,925 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:18,927 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:18,931 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:18,933 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:18,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:18,939 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:18,941 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:18,943 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:18,952 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:18,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:45:18,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:45:18,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:45:18,962 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:18,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:45:18,969 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:18,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:45:18,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:18,984 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:18,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:45:18,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:45:18,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:18,994 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:18,994 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:18,994 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:18,994 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:18,994 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:45:18,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:18,995 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:45:18,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:18,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:45:18,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:45:18,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:18,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:45:18,996 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:45:18,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:45:18,998 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:18,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:45:18,999 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:18,999 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:18,999 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:18,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:45:18,999 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:45:19,000 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:45:19,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:45:19,003 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:45:19,003 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:19,004 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:19,004 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:19,005 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 104/400.
2025-08-04 20:45:19,106 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:19,106 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:19,107 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:45:19,107 - ClientAppLogger [Client 0] - INFO - [Client] Round 104: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:45:19,108 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:19,132 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0850, Avg D Loss: 0.7752
2025-08-04 20:45:19,132 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0850, Avg D Loss: 0.7752
2025-08-04 20:45:19,133 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:19,146 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4496, Threshold=0.4824, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:45:19,146 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:45:19,146 - ClientAppLogger [Client 0] - INFO - Fit completed for round 104. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 104, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.084986996650696, 'd_loss': 0.775150066614151, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14066052436828613, 'cpu_percent_fit': 6.23125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:45:19,146 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:45:30,413 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:30,413 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:30,413 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:30,413 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:45:30,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:45:30,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:30,668 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:30,668 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:30,757 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:45:30,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:45:30,807 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:30,941 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:30,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:30,948 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:30,955 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:45:30,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:30,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:45:30,964 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:30,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:30,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:45:30,973 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:30,976 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:30,979 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:30,981 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:30,983 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:30,986 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:30,988 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:30,991 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:30,993 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:30,995 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:30,998 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:31,008 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:31,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:45:31,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:45:31,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:45:31,020 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:31,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:45:31,031 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:31,032 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:45:31,032 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:31,050 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:31,055 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:45:31,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:45:31,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:31,064 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:31,064 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:31,064 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:31,064 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:31,065 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:45:31,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:31,065 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:45:31,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:31,067 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:45:31,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:45:31,067 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:31,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:45:31,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:45:31,069 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:45:31,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:45:31,069 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:45:31,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:45:31,069 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:45:31,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:45:31,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:45:31,070 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:45:31,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:31,070 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:45:31,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:31,071 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:31,071 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:31,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:45:31,071 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:45:31,071 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:45:31,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:45:31,075 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:45:31,075 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:31,076 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:31,077 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:31,078 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:31,078 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:31,078 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:31,079 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:31,092 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4907, Threshold=0.5207, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 20:45:31,092 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.4907
2025-08-04 20:45:45,369 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:45,369 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:45,369 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:45,369 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:45:45,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:45:45,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:45,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:45,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:45,856 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:45:45,888 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:45:45,888 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:46,035 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:46,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:46,045 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:46,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:45:46,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:46,085 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:45:46,085 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:46,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:46,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:45:46,097 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:46,101 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,104 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:46,107 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:46,112 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:46,115 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:46,119 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,124 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:46,128 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:46,131 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:46,134 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:46,150 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:46,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:45:46,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:45:46,167 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:45:46,194 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,195 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:45:46,195 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,214 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:45:46,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:45:46,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,228 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,228 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,228 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,229 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:45:46,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:45:46,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,231 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:45:46,232 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,232 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,232 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,232 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,233 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,233 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,233 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:45:46,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:45:46,233 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:45:46,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:45:46,234 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:45:46,234 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:45:46,234 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:45:46,234 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:45:46,234 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:45:46,235 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:45:46,235 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:45:46,235 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:45:46,235 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,235 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:45:46,236 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,236 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,236 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:45:46,236 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:45:46,237 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:45:46,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:45:46,245 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:45:46,246 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,248 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,248 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:46,249 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,250 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,250 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,251 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,265 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5036, Threshold=0.5611, Accuracy=0.7165, F1=0.8053, Precision=0.9768, Recall=0.6850
2025-08-04 20:45:46,266 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7165, F1: 0.8053, Prec: 0.9768, Rec: 0.6850, Avg Anomaly Score: 0.5036
2025-08-04 20:45:57,525 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:57,526 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:57,526 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:57,526 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:45:57,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:45:57,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:57,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:57,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:57,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:45:57,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:45:57,973 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:58,110 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:58,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:58,118 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:58,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:45:58,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:58,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:45:58,134 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:58,134 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:58,135 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:45:58,144 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:58,148 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,150 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:58,152 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:58,154 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:58,157 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:58,159 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,162 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:58,164 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:58,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:58,169 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:58,180 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:58,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:45:58,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:45:58,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:45:58,197 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:58,197 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:45:58,212 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:58,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:45:58,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:58,230 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:58,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:45:58,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:45:58,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:58,246 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:58,246 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:58,247 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:58,247 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:58,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:45:58,248 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:58,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:45:58,248 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:58,250 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:45:58,250 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:45:58,250 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:58,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:45:58,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:58,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:58,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:58,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:45:58,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:45:58,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:45:58,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:45:58,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:45:58,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:45:58,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:45:58,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:45:58,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:45:58,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:45:58,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:45:58,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:45:58,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:58,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:45:58,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:58,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:58,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:58,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:45:58,255 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:45:58,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:45:58,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:45:58,260 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:45:58,261 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:58,262 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:58,263 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:58,265 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:58,265 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:58,265 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:58,266 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:58,284 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4590, Threshold=0.4825, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:45:58,284 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4590
2025-08-04 20:46:12,546 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:12,547 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:12,547 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:12,547 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:46:12,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:46:12,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:12,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:12,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:12,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:46:12,949 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:46:12,949 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:13,109 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:13,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:13,118 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:13,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:46:13,145 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:13,145 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:46:13,146 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:13,146 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:13,146 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:46:13,158 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:13,162 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,164 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:13,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:13,170 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:13,173 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:13,176 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,178 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:13,181 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:13,184 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:13,186 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:13,198 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:13,198 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:46:13,203 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:46:13,204 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:46:13,210 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:13,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:46:13,224 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:13,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:46:13,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:13,246 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:13,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:46:13,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:46:13,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:13,262 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:13,262 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:13,263 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:13,263 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:13,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:46:13,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:13,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:46:13,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:13,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:46:13,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:46:13,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:13,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:46:13,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:13,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:46:13,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:46:13,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:46:13,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:46:13,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:46:13,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:46:13,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:46:13,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:13,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:46:13,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:13,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:13,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:13,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:46:13,270 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:46:13,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:46:13,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:46:13,279 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:46:13,280 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:13,281 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:13,282 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:13,284 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:13,284 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:13,284 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:13,285 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:13,301 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4645, Threshold=0.4892, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:46:13,301 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4645
2025-08-04 20:46:18,549 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:18,550 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:18,550 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:18,550 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:46:18,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:46:18,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:18,810 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:18,810 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:18,892 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:46:18,935 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:46:18,935 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:19,050 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:19,056 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:19,056 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:19,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:46:19,066 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:19,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:46:19,067 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:19,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:19,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:46:19,076 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:19,079 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:19,081 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:19,083 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:19,086 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:19,090 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:19,092 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:19,095 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:19,098 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:19,100 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:19,102 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:19,113 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:19,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:46:19,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:46:19,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:46:19,123 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:19,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:46:19,133 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:19,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:46:19,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:19,148 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:19,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:46:19,158 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:46:19,159 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:19,160 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:46:19,160 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:19,161 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:46:19,161 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:46:19,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:46:19,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:46:19,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:46:19,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:46:19,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:46:19,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:46:19,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:46:19,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:46:19,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:46:19,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:46:19,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:19,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:46:19,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:19,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:19,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:19,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:46:19,165 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:46:19,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:46:19,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:46:19,169 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:46:19,169 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:19,170 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:19,170 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:19,172 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 108/400.
2025-08-04 20:46:19,273 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:19,273 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:19,274 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:46:19,275 - ClientAppLogger [Client 0] - INFO - [Client] Round 108: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:46:19,275 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:19,299 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0761, Avg D Loss: 0.7634
2025-08-04 20:46:19,299 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0761, Avg D Loss: 0.7634
2025-08-04 20:46:19,299 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:19,312 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4743, Threshold=0.5082, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:46:19,313 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:46:19,313 - ClientAppLogger [Client 0] - INFO - Fit completed for round 108. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 108, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.076091504096985, 'd_loss': 0.7634106159210206, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14076948165893555, 'cpu_percent_fit': 6.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:46:19,313 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:46:30,596 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:30,596 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:30,596 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:30,597 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:46:30,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:46:30,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:30,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:30,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:31,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:46:31,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:46:31,047 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:31,142 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:31,148 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:31,148 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:31,154 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:46:31,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:31,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:46:31,165 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:31,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:31,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:46:31,174 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:31,177 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:31,180 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:31,182 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:31,186 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:31,188 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:31,191 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:31,194 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:31,197 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:31,199 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:31,201 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:31,211 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:31,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:46:31,216 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:46:31,216 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:46:31,222 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:31,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:46:31,236 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:31,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:46:31,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:31,254 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:31,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:46:31,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:46:31,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:31,264 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:31,264 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:31,265 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:31,265 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:31,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:46:31,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:31,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:46:31,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:31,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:46:31,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:46:31,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:31,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:46:31,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:31,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:31,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:31,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:46:31,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:46:31,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:46:31,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:46:31,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:46:31,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:46:31,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:31,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:46:31,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:46:31,276 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:46:31,276 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:31,277 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:31,277 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:31,279 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:31,279 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:31,279 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:31,280 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:31,293 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4854, Threshold=0.5263, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:46:31,293 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4854
2025-08-04 20:46:45,587 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:45,587 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:45,587 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:45,587 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:46:45,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:46:45,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:45,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:45,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:45,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:46:46,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:46:46,021 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:46,145 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:46,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:46,152 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:46,158 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:46:46,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:46,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:46:46,165 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:46,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:46,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:46:46,174 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:46,177 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:46,179 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:46,181 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:46,184 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:46,187 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:46,189 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:46,192 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:46,195 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:46,196 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:46,199 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:46,208 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:46,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:46:46,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:46:46,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:46:46,217 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:46,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:46:46,225 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:46,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:46:46,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:46,243 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:46,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:46:46,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:46:46,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:46,256 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:46,256 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:46,256 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:46,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:46:46,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:46:46,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:46:46,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:46:46,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:46:46,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:46:46,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:46:46,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:46:46,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:46:46,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:46:46,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:46:46,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:46:46,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:46:46,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:46,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:46:46,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:46,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:46,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:46,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:46:46,264 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:46:46,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:46:46,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:46:46,268 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:46:46,269 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:46,270 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:46,270 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:46,271 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:46,272 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:46,272 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:46,273 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:46,287 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4688, Threshold=0.4988, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:46:46,287 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4688
2025-08-04 20:47:00,560 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:00,560 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:00,560 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:00,560 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:47:00,560 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:47:00,560 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:00,862 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:00,862 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:00,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:47:00,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:47:00,988 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:01,092 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:01,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:01,098 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:01,105 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:47:01,112 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:01,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:47:01,113 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:01,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:01,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:47:01,122 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:01,125 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:01,127 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:01,130 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:01,133 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:01,135 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:01,137 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:01,140 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:01,142 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:01,144 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:01,147 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:01,156 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:01,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:47:01,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:47:01,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:47:01,170 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:01,170 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:47:01,182 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:01,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:47:01,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:01,197 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:01,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:47:01,207 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:47:01,207 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:01,207 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:01,208 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:01,208 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:01,208 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:01,208 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:47:01,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:01,209 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:47:01,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:01,210 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:47:01,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:47:01,210 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:47:01,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:47:01,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:47:01,213 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:01,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:47:01,213 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:01,213 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:01,213 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:01,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:47:01,214 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:47:01,214 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:47:01,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:47:01,217 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:47:01,217 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:01,219 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:01,219 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:01,220 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:01,220 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:01,220 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:01,221 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:01,233 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5075, Threshold=0.5546, Accuracy=0.7165, F1=0.8053, Precision=0.9768, Recall=0.6850
2025-08-04 20:47:01,233 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7165, F1: 0.8053, Prec: 0.9768, Rec: 0.6850, Avg Anomaly Score: 0.5075
2025-08-04 20:47:15,502 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:15,503 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:15,503 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:15,503 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:47:15,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:47:15,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:15,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:15,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:15,940 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:47:15,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:47:15,990 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:16,136 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:16,143 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:16,144 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:16,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:47:16,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:16,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:47:16,157 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:16,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:16,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:47:16,166 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:16,169 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:16,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:16,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:16,177 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:16,179 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:16,182 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:16,185 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:16,188 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:16,190 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:16,192 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:16,203 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:16,203 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:47:16,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:47:16,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:47:16,213 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:16,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:47:16,225 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:16,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:47:16,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:16,242 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:16,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:47:16,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:47:16,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:16,253 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:16,253 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:16,253 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:16,253 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:16,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:47:16,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:16,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:47:16,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:16,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:47:16,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:47:16,256 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:16,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:47:16,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:16,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:16,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:16,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:47:16,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:47:16,257 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:47:16,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:47:16,258 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:47:16,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:47:16,258 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:47:16,258 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:47:16,258 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:47:16,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:47:16,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:47:16,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:47:16,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:16,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:47:16,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:16,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:16,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:16,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:47:16,260 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:47:16,260 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:47:16,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:47:16,267 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:47:16,267 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:16,268 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:16,268 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:16,270 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:16,270 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:16,270 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:16,271 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:16,283 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4778, Threshold=0.5084, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:47:16,283 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4778
2025-08-04 20:47:21,534 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:21,534 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:21,534 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:21,534 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:47:21,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:47:21,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:21,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:21,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:21,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:47:21,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:47:21,957 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:22,046 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:22,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:22,053 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:22,059 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:47:22,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:22,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:47:22,069 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:22,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:22,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:47:22,079 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:22,082 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:22,084 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:22,087 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:22,090 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:22,092 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:22,094 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:22,097 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:22,099 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:22,102 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:22,104 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:22,114 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:22,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:47:22,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:47:22,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:47:22,125 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:22,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:47:22,136 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:22,136 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:47:22,136 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:22,152 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:22,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:47:22,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:47:22,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:22,163 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:22,163 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:22,163 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:22,163 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:22,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:47:22,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:22,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:47:22,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:22,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:47:22,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:47:22,166 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:22,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:47:22,166 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:22,166 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:47:22,167 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:47:22,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:47:22,168 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:47:22,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:47:22,168 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:47:22,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:47:22,168 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:22,169 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:47:22,169 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:22,169 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:22,169 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:22,169 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:47:22,170 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:47:22,170 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:47:22,170 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:47:22,174 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:47:22,174 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:22,175 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:22,176 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:22,177 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 112/400.
2025-08-04 20:47:22,278 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:22,278 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:22,279 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:47:22,279 - ClientAppLogger [Client 0] - INFO - [Client] Round 112: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:47:22,279 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:22,304 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0778, Avg D Loss: 0.7667
2025-08-04 20:47:22,304 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0778, Avg D Loss: 0.7667
2025-08-04 20:47:22,304 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:22,318 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5471, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:47:22,318 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:47:22,318 - ClientAppLogger [Client 0] - INFO - Fit completed for round 112. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 112, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.077790641784668, 'd_loss': 0.7666627705097199, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14087939262390137, 'cpu_percent_fit': 6.18125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:47:22,318 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:47:33,595 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:33,595 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:33,595 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:33,596 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:47:33,596 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:47:33,596 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:33,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:33,889 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:33,981 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:47:34,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:47:34,013 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:34,111 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:34,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:34,118 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:34,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:47:34,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:34,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:47:34,177 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:34,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:34,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:47:34,187 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:34,190 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:34,192 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:34,194 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:34,198 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:34,200 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:34,202 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:34,205 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:34,207 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:34,209 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:34,211 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:34,221 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:34,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:47:34,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:47:34,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:47:34,231 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:34,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:47:34,243 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:34,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:47:34,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:34,259 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:34,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:47:34,273 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:47:34,273 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:34,273 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:34,273 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:34,274 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:34,274 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:34,274 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:47:34,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:34,275 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:47:34,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:34,276 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:47:34,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:47:34,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:34,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:47:34,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:34,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:34,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:47:34,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:47:34,279 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:47:34,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:47:34,279 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:47:34,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:47:34,279 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:34,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:47:34,280 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:34,280 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:34,280 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:34,280 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:47:34,280 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:47:34,281 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:47:34,281 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:47:34,286 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:47:34,286 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:34,288 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:34,288 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:34,289 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:34,289 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:34,290 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:34,290 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:34,303 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4472, Threshold=0.4620, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:47:34,303 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4472
2025-08-04 20:47:45,586 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:45,586 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:45,586 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:45,587 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:47:45,587 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:47:45,587 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:45,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:45,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:45,972 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:47:46,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:47:46,016 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:46,163 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:46,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:46,172 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:46,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:47:46,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:46,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:47:46,189 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:46,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:46,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:47:46,198 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:46,201 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,204 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:46,206 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:46,209 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:46,211 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:46,214 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,216 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:46,219 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:46,221 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:46,224 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:46,235 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:46,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:47:46,240 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:47:46,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:47:46,247 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:46,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:47:46,263 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:46,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:47:46,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:46,280 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:46,285 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:47:46,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:47:46,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:46,294 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:46,294 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:46,295 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:46,295 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:46,295 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:47:46,295 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:46,295 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:47:46,296 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:46,297 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:47:46,297 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:47:46,297 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:47:46,298 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:47:46,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:47:46,299 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:47:46,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:47:46,299 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:47:46,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:47:46,299 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:47:46,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:47:46,300 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:47:46,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:47:46,300 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:46,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:47:46,300 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:46,301 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:46,301 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:46,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:47:46,301 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:47:46,301 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:47:46,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:47:46,306 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:47:46,307 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:46,308 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:46,308 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:46,310 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:46,310 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:46,310 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:46,310 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:46,326 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4897, Threshold=0.5322, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:47:46,326 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4897
2025-08-04 20:47:51,605 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:51,606 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:51,606 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:51,606 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:47:51,606 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:47:51,606 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:51,857 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:51,857 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:51,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:47:51,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:47:51,968 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:52,056 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:52,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:52,062 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:52,066 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:47:52,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:52,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:47:52,072 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:52,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:52,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:47:52,081 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:52,084 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:52,086 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:52,089 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:52,092 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:52,094 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:52,097 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:52,099 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:52,102 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:52,104 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:52,106 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:52,115 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:52,115 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:47:52,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:47:52,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:47:52,125 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:52,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:47:52,134 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:52,135 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:47:52,135 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:52,150 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:52,154 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:47:52,159 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:47:52,159 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:52,159 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:52,159 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:52,160 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:52,160 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:52,160 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:47:52,161 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:52,161 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:47:52,161 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:52,162 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:47:52,162 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:47:52,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:52,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:47:52,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:52,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:52,163 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:47:52,164 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:52,165 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:47:52,166 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:52,166 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:52,166 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:52,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:47:52,166 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:47:52,167 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:47:52,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:47:52,169 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:47:52,169 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:52,170 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:52,171 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:52,172 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 114/400.
2025-08-04 20:47:52,274 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:52,274 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:52,275 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:47:52,276 - ClientAppLogger [Client 0] - INFO - [Client] Round 114: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:47:52,276 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:52,308 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0816, Avg D Loss: 0.7634
2025-08-04 20:47:52,308 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0816, Avg D Loss: 0.7634
2025-08-04 20:47:52,308 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:52,321 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5121, Threshold=0.5603, Accuracy=0.7165, F1=0.8053, Precision=0.9768, Recall=0.6850
2025-08-04 20:47:52,321 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8053
2025-08-04 20:47:52,321 - ClientAppLogger [Client 0] - INFO - Fit completed for round 114. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 114, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0815700769424437, 'd_loss': 0.7634099960327149, 'post_fit_local_f1': 0.8052568697729988, 'fit_time_seconds': 0.14900708198547363, 'cpu_percent_fit': 5.2375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:47:52,322 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:48:03,597 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:03,597 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:03,597 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:03,597 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:48:03,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:48:03,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:03,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:03,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:04,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:48:04,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:48:04,069 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:04,207 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:04,216 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:04,216 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:04,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:48:04,235 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:04,235 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:48:04,236 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:04,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:04,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:48:04,246 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:04,248 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,250 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:04,253 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:04,255 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:04,257 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:04,260 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,262 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:04,265 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:04,267 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:04,270 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:04,280 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:04,280 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:48:04,285 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:48:04,285 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:48:04,292 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:04,292 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:48:04,307 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:04,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:48:04,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:04,323 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:04,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:48:04,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:48:04,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:04,339 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:04,340 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:04,340 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:04,340 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:04,341 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:48:04,341 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:04,341 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:48:04,341 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:04,343 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:48:04,343 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:48:04,343 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:48:04,344 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:48:04,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:48:04,345 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:48:04,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:48:04,345 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:48:04,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:48:04,345 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:48:04,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:48:04,346 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:48:04,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:48:04,346 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:04,347 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:48:04,347 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:04,347 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:04,347 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:04,347 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:48:04,348 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:48:04,348 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:48:04,348 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:48:04,355 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:48:04,356 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:04,357 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:04,357 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:04,359 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:04,359 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:04,359 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:04,359 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:04,373 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5226, Threshold=0.5739, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:48:04,374 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5226
2025-08-04 20:48:15,644 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:15,644 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:15,644 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:15,644 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:48:15,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:48:15,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:15,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:15,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:16,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:48:16,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:48:16,052 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:16,193 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:16,201 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:16,201 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:16,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:48:16,216 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:16,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:48:16,217 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:16,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:16,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:48:16,227 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:16,230 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,233 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:16,235 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:16,238 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:16,240 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:16,242 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,245 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:16,248 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:16,250 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:16,252 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:16,263 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:16,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:48:16,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:48:16,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:48:16,276 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:16,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:48:16,295 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:16,295 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:48:16,296 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:16,312 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:16,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:48:16,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:48:16,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:16,323 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:16,323 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:16,323 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:16,324 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:16,324 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:48:16,324 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:16,324 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:48:16,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:16,326 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:48:16,326 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:48:16,327 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:16,327 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:48:16,327 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:16,327 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:16,327 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:16,327 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:48:16,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:48:16,328 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:48:16,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:48:16,328 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:48:16,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:48:16,328 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:16,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:48:16,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:16,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:16,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:16,330 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:48:16,331 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:48:16,331 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:48:16,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:48:16,335 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:48:16,336 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:16,337 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:16,337 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:16,338 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:16,338 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:16,338 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:16,339 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:16,353 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5560, Threshold=0.6170, Accuracy=0.7165, F1=0.8053, Precision=0.9768, Recall=0.6850
2025-08-04 20:48:16,354 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7165, F1: 0.8053, Prec: 0.9768, Rec: 0.6850, Avg Anomaly Score: 0.5560
2025-08-04 20:48:27,632 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:27,632 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:27,632 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:27,632 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:48:27,632 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:48:27,632 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:27,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:27,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:27,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:48:28,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:48:28,043 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:28,194 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:28,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:28,203 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:28,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:48:28,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:28,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:48:28,228 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:28,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:28,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:48:28,238 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:28,241 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,244 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:28,247 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:28,249 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:28,252 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:28,254 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,257 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:28,260 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:28,262 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:28,264 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:28,275 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:28,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:48:28,280 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:48:28,280 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:48:28,286 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:28,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:48:28,302 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:28,303 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:48:28,303 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:28,319 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:28,324 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:48:28,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:48:28,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:28,332 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:28,332 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:28,333 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:28,333 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:28,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:48:28,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:28,334 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:48:28,334 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:28,335 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:48:28,335 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:48:28,336 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:28,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:48:28,336 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:28,336 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:28,336 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:28,336 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:48:28,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:48:28,337 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:48:28,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:48:28,337 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:48:28,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:48:28,338 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:48:28,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:48:28,338 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:48:28,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:48:28,338 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:48:28,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:48:28,339 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:28,340 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:48:28,340 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:28,340 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:28,341 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:28,341 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:48:28,341 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:48:28,341 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:48:28,341 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:48:28,346 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:48:28,346 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:28,348 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:28,348 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:28,350 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:28,350 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:28,351 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:28,351 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:28,366 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4651, Threshold=0.5043, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:48:28,366 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4651
2025-08-04 20:48:42,644 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:42,644 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:42,644 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:42,644 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:48:42,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:48:42,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:42,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:42,910 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:42,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:48:43,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:48:43,021 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:43,116 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:43,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:43,124 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:43,132 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:48:43,159 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:43,160 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:48:43,160 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:43,160 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:43,160 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:48:43,169 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:43,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:43,176 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:43,179 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:43,182 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:43,185 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,187 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:43,190 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:43,192 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:43,194 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:43,205 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:43,205 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:48:43,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:48:43,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:48:43,216 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:43,216 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:48:43,228 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:43,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:48:43,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:43,244 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:43,250 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:48:43,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:48:43,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:43,257 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:43,258 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:43,258 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:43,258 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:43,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:48:43,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:43,259 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:48:43,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:43,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:48:43,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:48:43,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:43,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:48:43,261 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:48:43,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:48:43,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:48:43,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:48:43,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:48:43,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:48:43,263 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:48:43,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:48:43,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:43,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:48:43,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:43,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:43,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:43,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:48:43,265 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:48:43,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:48:43,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:48:43,273 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:48:43,273 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:43,275 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:43,275 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:43,277 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:43,277 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:43,277 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:43,278 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:43,292 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4851, Threshold=0.5181, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:48:43,292 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4851
2025-08-04 20:48:54,566 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:54,566 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:54,566 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:54,566 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:48:54,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:48:54,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:54,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:54,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:54,930 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:48:54,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:48:54,971 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:55,099 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:55,106 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:55,106 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:55,112 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:48:55,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:55,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:48:55,118 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:55,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:55,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:48:55,127 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:55,130 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,133 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:55,135 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:55,138 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:55,140 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:55,143 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,145 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:55,148 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:55,150 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:55,152 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:55,163 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:55,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:48:55,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:48:55,169 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:48:55,174 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:55,174 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:48:55,185 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:55,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:48:55,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:55,204 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:55,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:48:55,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:48:55,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:55,218 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:55,218 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:55,219 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:55,219 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:55,219 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:48:55,219 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:55,220 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:48:55,220 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:55,221 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:48:55,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:48:55,222 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:55,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:48:55,222 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:55,222 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:55,222 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:48:55,223 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:55,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:48:55,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:55,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:55,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:55,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:48:55,226 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:48:55,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:48:55,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:48:55,231 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:48:55,231 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:55,232 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:55,232 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:55,234 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:55,234 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:55,234 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:55,235 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:55,248 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5146, Threshold=0.5704, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:48:55,249 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5146
2025-08-04 20:49:06,522 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:06,523 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:06,523 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:06,523 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:49:06,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:49:06,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:06,798 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:06,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:06,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:49:06,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:49:06,907 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:07,004 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:07,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:07,011 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:07,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:49:07,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:07,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:49:07,025 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:07,025 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:07,025 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:49:07,034 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:07,036 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,039 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:07,042 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:07,044 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:07,047 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:07,049 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,052 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:07,055 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:07,056 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:07,059 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:07,069 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:07,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:49:07,074 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:49:07,074 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:49:07,079 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:07,079 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:49:07,089 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:07,089 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:49:07,089 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:07,104 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:07,110 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:49:07,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:49:07,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:07,117 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:07,117 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:07,118 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:07,118 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:07,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:49:07,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:07,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:49:07,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:07,120 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:49:07,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:49:07,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:07,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:49:07,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:07,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:07,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:49:07,122 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:49:07,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:49:07,123 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:49:07,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:49:07,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:49:07,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:49:07,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:07,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:49:07,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:07,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:07,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:07,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:49:07,125 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:49:07,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:49:07,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:49:07,128 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:49:07,128 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:07,130 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:07,130 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:07,132 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:07,132 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:07,132 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:07,133 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:07,148 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4947, Threshold=0.5339, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:49:07,149 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4947
2025-08-04 20:49:12,411 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:12,411 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:12,411 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:12,412 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:49:12,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:49:12,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:12,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:12,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:12,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:49:12,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:49:12,835 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:12,948 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:12,955 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:12,955 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:12,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:49:12,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:12,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:49:12,969 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:12,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:12,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:49:12,977 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:12,980 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,983 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:12,985 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:12,988 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:12,990 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:12,992 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,995 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:12,997 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:12,999 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:13,001 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:13,010 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:13,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:49:13,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:49:13,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:49:13,024 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:13,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:49:13,038 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:13,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:49:13,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:13,060 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:13,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:49:13,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:49:13,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:13,071 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:13,072 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:13,072 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:13,072 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:13,073 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:49:13,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:13,073 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:49:13,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:13,075 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:49:13,075 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:49:13,075 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:13,076 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:49:13,076 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:13,076 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:13,076 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:13,076 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:49:13,077 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:49:13,077 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:49:13,077 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:49:13,077 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:49:13,077 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:49:13,077 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:49:13,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:49:13,078 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:49:13,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:49:13,078 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:49:13,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:49:13,078 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:13,079 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:49:13,079 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:13,079 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:13,079 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:13,080 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:49:13,080 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:49:13,080 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:49:13,080 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:49:13,084 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:49:13,084 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:13,086 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:13,086 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:13,087 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 120/400.
2025-08-04 20:49:13,188 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:13,188 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:13,189 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:49:13,190 - ClientAppLogger [Client 0] - INFO - [Client] Round 120: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:49:13,190 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:13,214 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0823, Avg D Loss: 0.7575
2025-08-04 20:49:13,214 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0823, Avg D Loss: 0.7575
2025-08-04 20:49:13,214 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:13,227 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5134, Threshold=0.5652, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:49:13,227 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:49:13,227 - ClientAppLogger [Client 0] - INFO - Fit completed for round 120. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 120, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0823014974594116, 'd_loss': 0.7575473129749298, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.13981962203979492, 'cpu_percent_fit': 6.36875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:49:13,227 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:49:24,492 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:24,492 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:24,492 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:24,492 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:49:24,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:49:24,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:24,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:24,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:24,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:49:24,855 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:49:24,855 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:24,952 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:24,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:24,958 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:24,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:49:24,972 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:24,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:49:24,973 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:24,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:24,974 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:49:24,982 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:24,985 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:24,987 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:24,990 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:24,992 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:24,994 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:24,997 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:24,999 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:25,002 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:25,004 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:25,006 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:25,015 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:25,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:49:25,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:49:25,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:49:25,026 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:25,027 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:49:25,038 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:25,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:49:25,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:25,054 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:25,060 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:49:25,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:49:25,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:25,065 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:25,065 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:25,066 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:25,066 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:25,066 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:49:25,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:25,067 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:49:25,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:25,069 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:49:25,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:49:25,069 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:25,069 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:49:25,069 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:25,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:25,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:25,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:49:25,070 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:49:25,070 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:49:25,070 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:49:25,071 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:49:25,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:49:25,071 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:49:25,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:49:25,071 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:49:25,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:49:25,072 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:49:25,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:49:25,072 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:25,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:49:25,072 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:25,073 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:25,073 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:25,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:49:25,073 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:49:25,073 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:49:25,073 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:49:25,079 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:49:25,079 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:25,080 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:25,080 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:25,082 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:25,082 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:25,082 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:25,083 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:25,098 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5143, Threshold=0.5555, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:49:25,098 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5143
2025-08-04 20:49:36,355 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:36,356 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:36,356 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:36,356 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:49:36,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:49:36,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:36,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:36,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:36,706 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:49:36,750 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:49:36,751 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:36,872 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:36,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:36,879 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:36,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:49:36,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:36,890 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:49:36,890 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:36,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:36,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:49:36,899 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:36,902 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:36,904 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:36,906 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:36,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:36,911 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:36,913 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:36,916 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:36,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:36,920 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:36,923 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:36,932 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:36,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:49:36,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:49:36,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:49:36,942 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:36,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:49:36,952 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:36,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:49:36,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:36,968 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:36,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:49:36,981 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:49:36,982 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:36,982 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:36,982 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:36,982 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:36,983 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:36,983 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:49:36,983 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:36,983 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:49:36,983 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:36,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:49:36,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:49:36,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:36,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:49:36,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:36,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:36,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:36,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:49:36,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:49:36,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:49:36,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:49:36,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:49:36,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:49:36,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:49:36,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:49:36,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:49:36,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:49:36,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:49:36,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:49:36,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:36,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:49:36,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:36,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:36,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:36,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:49:36,989 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:49:36,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:49:36,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:49:36,993 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:49:36,993 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:36,994 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:36,995 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:36,996 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:36,996 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:36,997 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:36,997 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:37,010 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4551, Threshold=0.4732, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:49:37,011 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4551
2025-08-04 20:49:48,275 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:48,275 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:48,276 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:48,276 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:49:48,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:49:48,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:48,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:48,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:48,637 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:49:48,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:49:48,682 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:48,802 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:48,808 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:48,809 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:48,813 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:49:48,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:48,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:49:48,821 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:48,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:48,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:49:48,830 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:48,833 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:48,835 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:48,837 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:48,840 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:48,842 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:48,845 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:48,847 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:48,850 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:48,852 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:48,854 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:48,864 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:48,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:49:48,869 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:49:48,869 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:49:48,875 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:48,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:49:48,888 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:48,888 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:49:48,888 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:48,903 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:48,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:49:48,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:49:48,914 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:48,914 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:48,914 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:48,915 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:48,915 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:48,915 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:49:48,915 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:48,915 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:49:48,916 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:48,917 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:49:48,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:49:48,918 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:48,918 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:49:48,918 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:48,918 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:48,918 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:48,919 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:49:48,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:49:48,919 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:49:48,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:49:48,919 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:49:48,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:49:48,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:49:48,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:49:48,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:49:48,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:49:48,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:49:48,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:49:48,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:48,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:49:48,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:48,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:48,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:48,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:49:48,922 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:49:48,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:49:48,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:49:48,930 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:49:48,930 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:48,931 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:48,931 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:48,933 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:48,933 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:48,933 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:48,933 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:48,946 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5249, Threshold=0.5919, Accuracy=0.7165, F1=0.8053, Precision=0.9768, Recall=0.6850
2025-08-04 20:49:48,947 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7165, F1: 0.8053, Prec: 0.9768, Rec: 0.6850, Avg Anomaly Score: 0.5249
2025-08-04 20:50:03,213 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:03,213 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:03,214 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:03,214 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:50:03,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:50:03,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:03,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:03,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:03,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:50:03,655 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:50:03,655 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:03,782 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:03,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:03,790 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:03,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:50:03,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:03,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:50:03,802 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:03,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:03,803 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:50:03,811 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:03,814 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,816 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:03,819 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:03,822 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:03,824 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:03,827 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,830 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:03,833 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:03,835 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:03,838 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:03,848 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:03,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:50:03,853 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:50:03,853 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:50:03,858 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:03,858 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:50:03,868 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:03,868 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:50:03,868 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:03,885 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:03,891 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:50:03,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:50:03,900 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:03,900 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:03,900 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:03,900 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:03,901 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:03,901 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:50:03,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:03,901 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:50:03,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:03,903 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:50:03,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:50:03,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:03,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:50:03,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:03,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:03,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:03,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:50:03,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:50:03,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:50:03,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:50:03,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:50:03,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:50:03,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:03,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:50:03,907 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:03,907 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:03,907 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:03,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:50:03,907 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:50:03,908 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:50:03,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:50:03,912 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:50:03,912 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:03,913 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:03,914 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:03,916 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:03,916 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:03,916 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:03,917 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:03,930 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5416, Threshold=0.6027, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:50:03,930 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5416
2025-08-04 20:50:18,212 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:18,213 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:18,213 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:18,213 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:50:18,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:50:18,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:18,457 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:18,457 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:18,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:50:18,566 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:50:18,567 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:18,667 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:18,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:18,674 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:18,680 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:50:18,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:18,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:50:18,687 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:18,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:18,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:50:18,696 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:18,699 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,701 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:18,703 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:18,706 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:18,708 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:18,710 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,713 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:18,716 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:18,717 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:18,720 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:18,729 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:18,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:50:18,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:50:18,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:50:18,741 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:18,741 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:50:18,755 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:18,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:50:18,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:18,771 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:18,776 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:50:18,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:50:18,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:18,782 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:18,782 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:18,782 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:18,783 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:18,783 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:50:18,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:18,783 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:50:18,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:18,785 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:50:18,785 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:50:18,785 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:18,785 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:50:18,786 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:50:18,787 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:50:18,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:50:18,788 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:18,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:50:18,788 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:18,788 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:18,788 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:18,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:50:18,789 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:50:18,789 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:50:18,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:50:18,791 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:50:18,791 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:18,793 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:18,793 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:18,794 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:18,794 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:18,795 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:18,795 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:18,808 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5207, Threshold=0.5861, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 20:50:18,808 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.5207
2025-08-04 20:50:36,131 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:36,131 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:36,131 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:36,131 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:50:36,132 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:50:36,132 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:36,384 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:36,384 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:36,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:50:36,524 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:50:36,524 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:36,643 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:36,649 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:36,649 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:36,655 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:50:36,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:36,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:50:36,661 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:36,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:36,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:50:36,670 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:36,673 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:36,675 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:36,677 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:36,680 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:36,682 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:36,684 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:36,687 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:36,689 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:36,691 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:36,693 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:36,703 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:36,704 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:50:36,709 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:50:36,709 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:50:36,715 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:36,715 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:50:36,727 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:36,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:50:36,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:36,744 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:36,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:50:36,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:50:36,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:36,756 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:36,756 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:36,756 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:36,757 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:36,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:50:36,757 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:36,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:50:36,757 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:36,759 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:50:36,759 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:50:36,759 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:50:36,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:50:36,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:50:36,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:50:36,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:50:36,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:36,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:50:36,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:36,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:36,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:36,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:50:36,763 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:50:36,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:50:36,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:50:36,768 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:50:36,768 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:36,769 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:36,769 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:36,771 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:36,771 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:36,771 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:36,772 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:36,785 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5271, Threshold=0.5797, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:50:36,785 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5271
2025-08-04 20:50:48,066 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:48,066 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:48,066 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:48,067 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:50:48,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:50:48,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:48,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:48,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:48,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:50:48,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:50:48,422 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:48,516 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:48,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:48,522 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:48,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:50:48,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:48,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:50:48,534 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:48,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:48,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:50:48,542 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:48,545 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,547 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:48,549 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:48,552 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:48,554 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:48,556 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,559 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:48,562 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:48,564 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:48,566 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:48,576 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:48,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:50:48,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:50:48,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:50:48,587 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:48,587 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:50:48,602 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:48,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:50:48,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:48,620 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:48,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:50:48,629 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:50:48,629 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:48,629 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:48,629 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:48,630 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:48,630 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:48,630 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:50:48,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:48,630 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:50:48,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:48,632 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:50:48,632 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:50:48,632 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:48,633 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:50:48,633 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:48,633 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:48,633 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:48,633 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:50:48,633 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:50:48,634 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:50:48,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:50:48,635 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:50:48,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:50:48,635 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:48,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:50:48,635 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:48,636 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:48,636 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:48,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:50:48,636 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:50:48,636 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:50:48,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:50:48,638 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:50:48,638 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:48,640 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:48,640 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:48,641 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:48,642 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:48,642 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:48,642 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:48,655 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5182, Threshold=0.5789, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:50:48,655 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5182
2025-08-04 20:51:05,964 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:05,964 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:05,964 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:05,964 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:51:05,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:51:05,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:06,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:06,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:06,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:51:06,516 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:51:06,516 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:06,640 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:06,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:06,648 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:06,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:51:06,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:06,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:51:06,662 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:06,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:06,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:51:06,670 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:06,673 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,676 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:06,678 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:06,681 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:06,684 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:06,687 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,691 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:06,695 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:06,698 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:06,701 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:06,712 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:06,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:51:06,717 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:51:06,717 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:51:06,721 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:06,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:51:06,730 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:06,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:51:06,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:06,745 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:06,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:51:06,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:51:06,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:06,755 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:06,755 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:06,755 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:06,755 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:06,756 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:51:06,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:06,756 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:51:06,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:06,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:51:06,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:51:06,758 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:06,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:51:06,758 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:06,758 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:06,758 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:51:06,759 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:06,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:51:06,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:06,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:06,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:06,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:51:06,762 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:51:06,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:51:06,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:51:06,766 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:51:06,766 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:06,767 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:06,767 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:06,769 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:06,769 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:06,769 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:06,770 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:06,783 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5203, Threshold=0.5820, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:51:06,784 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5203
2025-08-04 20:51:21,066 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:21,066 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:21,066 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:21,067 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:51:21,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:51:21,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:21,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:21,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:21,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:51:21,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:51:21,572 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:21,675 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:21,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:21,682 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:21,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:51:21,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:21,699 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:51:21,699 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:21,699 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:21,699 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:51:21,710 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:21,714 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,717 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:21,720 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:21,725 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:21,728 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:21,732 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,736 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:21,739 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:21,741 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:21,743 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:21,753 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:21,753 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:51:21,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:51:21,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:51:21,763 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:21,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:51:21,772 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:21,772 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:51:21,772 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:21,787 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:21,792 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:51:21,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:51:21,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:21,797 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:21,797 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:21,797 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:21,797 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:21,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:51:21,798 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:21,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:51:21,798 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:21,800 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:51:21,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:51:21,800 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:21,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:51:21,800 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:21,800 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:51:21,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:51:21,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:51:21,802 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:51:21,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:51:21,802 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:51:21,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:51:21,802 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:21,803 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:51:21,803 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:21,803 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:21,803 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:21,803 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:51:21,803 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:51:21,804 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:51:21,804 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:51:21,806 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:51:21,806 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:21,807 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:21,807 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:21,808 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:21,809 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:21,809 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:21,809 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:21,823 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5149, Threshold=0.5669, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:51:21,823 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5149
2025-08-04 20:51:39,118 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:39,118 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:39,119 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:39,119 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:51:39,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:51:39,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:39,551 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:39,552 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:39,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:51:39,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:51:39,698 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:39,831 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:39,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:39,839 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:39,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:51:39,857 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:39,857 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:51:39,858 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:39,858 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:39,858 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:51:39,867 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:39,871 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,873 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:39,875 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:39,877 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:39,880 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:39,882 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,885 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:39,888 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:39,890 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:39,893 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:39,903 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:39,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:51:39,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:51:39,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:51:39,912 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:39,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:51:39,922 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:39,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:51:39,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:39,939 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:39,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:51:39,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:51:39,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:39,952 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:39,952 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:39,952 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:39,953 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:39,953 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:51:39,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:39,953 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:51:39,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:39,955 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:51:39,955 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:51:39,955 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:39,955 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:51:39,955 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:39,955 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:39,956 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:39,956 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:51:39,956 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:51:39,956 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:51:39,956 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:51:39,957 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:51:39,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:51:39,957 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:51:39,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:51:39,957 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:51:39,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:51:39,958 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:51:39,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:51:39,958 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:39,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:51:39,958 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:39,959 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:39,959 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:39,959 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:51:39,959 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:51:39,959 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:51:39,959 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:51:39,963 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:51:39,963 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:39,964 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:39,965 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:39,966 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:39,967 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:39,967 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:39,968 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:39,983 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5151, Threshold=0.5714, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:51:39,984 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5151
2025-08-04 20:51:54,289 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:54,290 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:54,290 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:54,290 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:51:54,290 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:51:54,290 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:54,817 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:51:54,849 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:51:54,849 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:54,978 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:54,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:54,985 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:54,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:51:55,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:55,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:51:55,006 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:55,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:55,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:51:55,021 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:55,025 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:55,027 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:55,029 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:55,032 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:55,034 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:55,037 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:55,040 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:55,043 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:55,045 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:55,047 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:55,059 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:55,059 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:51:55,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:51:55,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:51:55,071 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:55,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:51:55,084 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:55,085 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:51:55,085 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:55,100 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:55,105 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:51:55,111 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:51:55,112 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:55,112 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:55,112 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:55,112 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:55,113 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:55,113 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:51:55,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:55,113 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:51:55,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:55,115 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:51:55,115 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:51:55,116 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:55,116 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:51:55,116 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:55,116 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:55,116 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:55,116 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:51:55,117 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:51:55,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:51:55,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:51:55,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:51:55,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:55,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:51:55,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:55,119 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:55,119 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:55,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:51:55,119 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:51:55,119 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:51:55,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:51:55,127 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:51:55,127 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:55,129 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:55,129 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:55,130 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:55,130 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:55,131 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:55,131 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:55,145 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4871, Threshold=0.5209, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:51:55,146 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4871
2025-08-04 20:52:06,441 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,442 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:06,442 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:06,442 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:52:06,442 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:52:06,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:06,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:06,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:06,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:52:06,954 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:52:06,955 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:07,128 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:07,137 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:07,137 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:07,144 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:52:07,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:07,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:52:07,153 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:07,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:07,154 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:52:07,163 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:07,166 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,169 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:07,171 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:07,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:07,176 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:07,178 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,181 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:07,184 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:07,186 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:07,189 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:07,200 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:07,201 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:52:07,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:52:07,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:52:07,213 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:07,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:52:07,231 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:07,234 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:52:07,234 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:07,251 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:07,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:52:07,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:52:07,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:07,263 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:07,263 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:07,263 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:07,263 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:07,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:52:07,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:07,264 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:52:07,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:07,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:52:07,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:52:07,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:07,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:52:07,266 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:52:07,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:52:07,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:52:07,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:52:07,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:52:07,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:52:07,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:52:07,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:52:07,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:52:07,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:07,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:52:07,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:07,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:07,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:07,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:52:07,270 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:52:07,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:52:07,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:52:07,276 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:52:07,276 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:07,277 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:07,277 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:07,279 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:07,279 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:07,279 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:07,280 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:07,293 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5127, Threshold=0.5634, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:52:07,293 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5127
2025-08-04 20:52:18,574 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:18,574 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:18,574 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:18,574 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:52:18,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:52:18,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:18,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:18,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:19,080 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:52:19,110 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:52:19,110 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:19,264 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:19,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:19,272 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:19,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:52:19,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:19,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:52:19,287 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:19,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:19,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:52:19,297 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:19,300 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,302 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:19,305 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:19,308 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:19,310 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:19,313 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,315 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:19,318 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:19,320 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:19,322 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:19,334 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:19,334 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:52:19,340 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:52:19,340 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:52:19,345 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:19,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:52:19,356 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:19,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:52:19,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:19,373 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:19,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:52:19,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:52:19,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:19,382 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:19,383 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:19,383 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:19,383 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:19,383 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:52:19,384 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:19,384 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:52:19,384 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:19,386 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:52:19,386 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:52:19,386 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:19,386 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:52:19,386 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:52:19,387 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:52:19,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:52:19,388 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:52:19,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:52:19,388 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:52:19,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:52:19,388 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:52:19,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:52:19,389 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:19,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:52:19,389 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:19,389 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:19,390 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:19,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:52:19,390 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:52:19,390 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:52:19,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:52:19,394 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:52:19,395 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:19,396 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:19,396 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:19,398 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:19,398 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:19,398 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:19,399 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:19,413 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5322, Threshold=0.5869, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:52:19,414 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5322
2025-08-04 20:52:24,693 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:24,693 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:24,693 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:24,693 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:52:24,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:52:24,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:25,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:25,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:25,107 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:52:25,146 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:52:25,146 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:25,262 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:25,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:25,267 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:25,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:52:25,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:25,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:52:25,278 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:25,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:25,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:52:25,287 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:25,289 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:25,292 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:25,294 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:25,297 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:25,299 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:25,301 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:25,304 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:25,307 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:25,309 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:25,311 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:25,320 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:25,320 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:52:25,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:52:25,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:52:25,330 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:25,330 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:52:25,338 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:25,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:52:25,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:25,353 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:25,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:52:25,362 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:52:25,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:25,363 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:25,363 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:25,363 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:25,363 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:25,363 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:52:25,364 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:25,364 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:52:25,364 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:25,365 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:52:25,365 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:52:25,366 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:52:25,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:52:25,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:52:25,368 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:52:25,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:25,368 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:52:25,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:25,368 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:25,369 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:25,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:52:25,369 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:52:25,369 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:52:25,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:52:25,373 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:52:25,373 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:25,374 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:25,374 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:25,376 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 133/400.
2025-08-04 20:52:25,477 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:25,477 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:25,478 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:52:25,479 - ClientAppLogger [Client 0] - INFO - [Client] Round 133: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:52:25,479 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:25,503 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0729, Avg D Loss: 0.7488
2025-08-04 20:52:25,504 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0729, Avg D Loss: 0.7488
2025-08-04 20:52:25,504 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:25,516 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5147, Threshold=0.5586, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:52:25,516 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:52:25,517 - ClientAppLogger [Client 0] - INFO - Fit completed for round 133. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 133, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.072927474975586, 'd_loss': 0.7488117218017578, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14090681076049805, 'cpu_percent_fit': 6.3, 'ram_mb_fit': 1.4765625, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:52:25,517 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:52:36,806 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:36,806 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:36,806 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:36,806 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:52:36,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:52:36,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:37,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:37,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:37,197 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:52:37,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:52:37,229 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:37,393 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:37,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:37,400 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:37,406 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:52:37,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:37,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:52:37,413 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:37,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:37,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:52:37,423 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:37,426 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,428 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:37,430 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:37,433 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:37,435 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:37,438 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,440 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:37,443 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:37,445 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:37,447 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:37,457 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:37,457 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:52:37,463 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:52:37,463 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:52:37,469 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:37,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:52:37,484 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:37,485 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:52:37,485 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:37,503 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:37,509 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:52:37,517 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:52:37,517 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:37,517 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:37,517 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:37,518 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:37,518 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:37,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:52:37,518 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:37,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:52:37,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:37,520 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:52:37,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:52:37,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:37,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:52:37,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:37,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:37,521 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:52:37,522 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:52:37,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:52:37,523 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:52:37,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:52:37,523 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:52:37,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:52:37,524 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:37,524 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:52:37,524 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:37,524 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:37,525 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:37,525 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:52:37,525 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:52:37,525 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:52:37,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:52:37,530 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:52:37,530 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:37,531 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:37,531 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:37,532 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:37,536 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:37,536 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:37,536 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:37,550 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5711, Threshold=0.6332, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:52:37,550 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5711
2025-08-04 20:52:48,828 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:48,829 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:48,829 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:48,829 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:52:48,829 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:52:48,829 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:49,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:49,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:49,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:52:49,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:52:49,325 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:49,463 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:49,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:49,470 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:49,477 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:52:49,484 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:49,484 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:52:49,485 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:49,485 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:49,485 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:52:49,495 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:49,498 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:49,500 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:49,502 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:49,505 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:49,507 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:49,510 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:49,512 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:49,515 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:49,517 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:49,519 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:49,528 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:49,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:52:49,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:52:49,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:52:49,538 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:49,539 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:52:49,548 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:49,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:52:49,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:49,564 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:49,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:52:49,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:52:49,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:49,574 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:49,574 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:49,574 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:49,575 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:49,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:52:49,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:49,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:52:49,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:49,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:52:49,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:52:49,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:52:49,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:52:49,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:52:49,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:52:49,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:52:49,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:49,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:52:49,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:49,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:49,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:49,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:52:49,581 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:52:49,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:52:49,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:52:49,585 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:52:49,585 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:49,586 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:49,587 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:49,588 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:49,589 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:49,589 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:49,589 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:49,603 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5095, Threshold=0.5506, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:52:49,603 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5095
2025-08-04 20:53:00,871 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:00,871 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:00,871 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:00,872 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:53:00,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:53:00,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:01,220 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:01,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:01,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:53:01,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:53:01,336 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:01,449 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:01,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:01,456 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:01,464 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:53:01,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:01,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:53:01,472 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:01,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:01,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:53:01,482 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:01,485 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:01,488 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:01,490 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:01,493 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:01,495 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:01,498 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:01,500 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:01,503 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:01,505 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:01,507 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:01,522 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:01,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:53:01,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:53:01,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:53:01,533 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:01,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:53:01,542 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:01,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:53:01,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:01,559 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:01,564 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:53:01,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:53:01,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:01,571 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:01,571 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:01,572 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:01,572 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:01,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:53:01,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:01,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:53:01,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:01,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:53:01,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:53:01,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:01,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:53:01,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:01,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:01,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:01,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:53:01,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:53:01,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:53:01,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:53:01,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:53:01,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:53:01,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:53:01,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:53:01,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:53:01,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:53:01,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:53:01,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:53:01,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:01,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:53:01,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:01,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:01,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:01,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:53:01,580 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:53:01,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:53:01,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:53:01,585 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:53:01,585 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:01,586 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:01,586 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:01,588 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:01,588 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:01,588 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:01,589 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:01,602 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5152, Threshold=0.5716, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:53:01,602 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5152
2025-08-04 20:53:12,856 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:12,856 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:12,856 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:12,857 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:53:12,857 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:53:12,857 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:13,190 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:13,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:13,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:53:13,297 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:53:13,297 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:13,385 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:13,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:13,391 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:13,395 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:53:13,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:13,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:53:13,401 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:13,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:13,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:53:13,410 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:13,413 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:13,415 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:13,417 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:13,420 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:13,422 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:13,424 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:13,427 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:13,430 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:13,432 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:13,434 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:13,444 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:13,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:53:13,449 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:53:13,449 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:53:13,455 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:13,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:53:13,468 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:13,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:53:13,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:13,486 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:13,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:53:13,498 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:53:13,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:13,499 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:13,499 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:13,499 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:13,499 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:13,500 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:53:13,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:13,500 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:53:13,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:13,501 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:53:13,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:53:13,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:13,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:53:13,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:53:13,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:53:13,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:13,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:53:13,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:13,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:13,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:13,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:53:13,506 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:53:13,506 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:53:13,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:53:13,510 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:53:13,510 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:13,511 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:13,511 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:13,513 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:13,513 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:13,513 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:13,514 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:13,527 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5446, Threshold=0.5994, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:53:13,527 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5446
2025-08-04 20:53:18,787 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:18,787 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:18,787 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:18,787 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:53:18,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:53:18,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:19,095 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:19,095 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:19,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:53:19,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:53:19,221 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:19,338 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:19,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:19,345 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:19,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:53:19,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:19,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:53:19,358 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:19,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:19,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:53:19,367 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:19,370 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:19,372 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:19,374 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:19,377 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:19,379 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:19,381 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:19,384 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:19,386 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:19,388 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:19,390 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:19,401 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:19,401 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:53:19,406 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:53:19,406 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:53:19,412 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:19,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:53:19,424 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:19,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:53:19,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:19,438 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:19,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:53:19,448 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:53:19,449 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:19,449 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:19,449 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:19,449 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:19,450 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:19,450 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:53:19,450 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:19,450 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:53:19,450 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:19,452 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:53:19,452 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:53:19,452 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:19,452 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:53:19,453 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:53:19,454 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:53:19,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:53:19,454 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:53:19,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:53:19,454 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:53:19,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:53:19,455 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:53:19,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:53:19,455 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:19,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:53:19,456 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:19,456 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:19,456 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:19,456 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:53:19,456 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:53:19,456 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:53:19,457 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:53:19,461 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:53:19,461 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:19,463 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:19,463 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:19,464 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 137/400.
2025-08-04 20:53:19,566 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:19,566 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:19,567 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:53:19,568 - ClientAppLogger [Client 0] - INFO - [Client] Round 137: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:53:19,568 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:19,593 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0733, Avg D Loss: 0.7430
2025-08-04 20:53:19,593 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0733, Avg D Loss: 0.7430
2025-08-04 20:53:19,593 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:19,606 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5181, Threshold=0.5601, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:53:19,607 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:53:19,607 - ClientAppLogger [Client 0] - INFO - Fit completed for round 137. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 137, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0732798099517824, 'd_loss': 0.7430076479911805, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14229226112365723, 'cpu_percent_fit': 6.10625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:53:19,607 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:53:33,882 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:33,882 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:33,882 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:33,882 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:53:33,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:53:33,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:34,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:34,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:34,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:53:34,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:53:34,270 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:34,358 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:34,364 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:34,364 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:34,369 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:53:34,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:34,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:53:34,376 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:34,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:34,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:53:34,385 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:34,388 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:34,390 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:34,392 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:34,395 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:34,399 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:34,401 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:34,404 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:34,406 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:34,409 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:34,412 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:34,421 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:34,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:53:34,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:53:34,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:53:34,434 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:34,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:53:34,444 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:34,445 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:53:34,445 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:34,459 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:34,464 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:53:34,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:53:34,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:34,468 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:34,469 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:34,469 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:34,469 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:34,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:53:34,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:34,470 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:53:34,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:34,471 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:53:34,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:53:34,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:34,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:53:34,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:34,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:34,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:34,473 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:53:34,473 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:53:34,473 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:53:34,473 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:53:34,473 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:53:34,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:53:34,474 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:53:34,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:53:34,474 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:53:34,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:53:34,474 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:53:34,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:53:34,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:34,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:53:34,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:34,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:34,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:34,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:53:34,476 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:53:34,476 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:53:34,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:53:34,478 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:53:34,478 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:34,480 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:34,480 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:34,481 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:34,482 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:34,482 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:34,482 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:34,495 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5445, Threshold=0.5982, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 20:53:34,496 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.5445
2025-08-04 20:53:39,749 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:39,749 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:39,749 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:39,749 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:53:39,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:53:39,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:39,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:39,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:40,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:53:40,060 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:53:40,060 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:40,139 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:40,145 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:40,145 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:40,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:53:40,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:40,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:53:40,156 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:40,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:40,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:53:40,164 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:40,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:40,169 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:40,171 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:40,174 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:40,176 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:40,179 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:40,181 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:40,184 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:40,186 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:40,189 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:40,197 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:40,197 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:53:40,201 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:53:40,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:53:40,206 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:40,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:53:40,214 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:40,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:53:40,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:40,229 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:40,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:53:40,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:53:40,238 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:40,238 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:40,238 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:40,238 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:40,238 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:40,239 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:53:40,239 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:40,239 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:53:40,239 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:40,240 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:40,241 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:53:40,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:53:40,243 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:53:40,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:53:40,243 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:53:40,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:53:40,243 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:40,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:53:40,244 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:40,244 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:40,244 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:40,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:53:40,244 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:53:40,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:53:40,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:53:40,248 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:53:40,248 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:40,249 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:40,249 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:40,250 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 138/400.
2025-08-04 20:53:40,351 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:40,352 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:40,353 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:53:40,353 - ClientAppLogger [Client 0] - INFO - [Client] Round 138: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:53:40,353 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:40,378 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0713, Avg D Loss: 0.7464
2025-08-04 20:53:40,378 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0713, Avg D Loss: 0.7464
2025-08-04 20:53:40,378 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:40,391 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5181, Threshold=0.5587, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:53:40,391 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:53:40,392 - ClientAppLogger [Client 0] - INFO - Fit completed for round 138. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 138, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.071312355995178, 'd_loss': 0.7464236378669739, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.1412181854248047, 'cpu_percent_fit': 6.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:53:40,392 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:53:54,670 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:54,670 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:54,670 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:54,670 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:53:54,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:53:54,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:54,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:54,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:55,064 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:53:55,110 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:53:55,110 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:55,229 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:55,236 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:55,236 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:55,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:53:55,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:55,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:53:55,251 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:55,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:55,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:53:55,260 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:55,263 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:55,265 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:55,267 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:55,270 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:55,272 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:55,275 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:55,277 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:55,280 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:55,282 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:55,284 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:55,294 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:55,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:53:55,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:53:55,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:53:55,304 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:55,304 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:53:55,314 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:55,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:53:55,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:55,332 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:55,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:53:55,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:53:55,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:55,351 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:55,351 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:55,351 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:55,352 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:55,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:53:55,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:55,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:53:55,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:55,354 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:53:55,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:53:55,354 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:55,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:53:55,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:55,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:55,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:55,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:53:55,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:53:55,355 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:53:55,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:53:55,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:53:55,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:53:55,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:55,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:53:55,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:55,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:55,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:55,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:53:55,358 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:53:55,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:53:55,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:53:55,366 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:53:55,366 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:55,367 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:55,367 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:55,369 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:55,369 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:55,369 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:55,370 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:55,383 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5348, Threshold=0.5880, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:53:55,384 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5348
2025-08-04 20:54:00,630 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:00,630 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:00,630 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:00,630 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:54:00,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:54:00,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:00,918 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:00,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:01,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:54:01,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:54:01,015 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:01,114 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:01,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:01,121 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:01,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:54:01,132 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:01,132 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:54:01,133 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:01,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:01,133 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:54:01,142 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:01,145 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:01,147 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:01,149 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:01,152 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:01,154 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:01,157 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:01,159 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:01,162 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:01,164 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:01,166 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:01,176 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:01,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:54:01,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:54:01,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:54:01,188 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:01,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:54:01,198 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:01,199 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:54:01,199 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:01,213 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:01,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:54:01,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:54:01,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:01,223 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:01,223 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:01,223 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:01,223 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:01,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:54:01,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:01,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:54:01,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:01,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:54:01,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:54:01,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:01,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:54:01,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:01,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:01,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:54:01,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:54:01,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:54:01,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:54:01,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:54:01,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:54:01,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:01,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:54:01,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:01,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:01,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:01,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:54:01,229 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:54:01,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:54:01,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:54:01,232 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:54:01,232 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:01,234 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:01,234 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:01,235 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 139/400.
2025-08-04 20:54:01,336 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:01,337 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:01,338 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:54:01,338 - ClientAppLogger [Client 0] - INFO - [Client] Round 139: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:54:01,339 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:01,366 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0831, Avg D Loss: 0.7372
2025-08-04 20:54:01,366 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0831, Avg D Loss: 0.7372
2025-08-04 20:54:01,366 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:01,381 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5234, Threshold=0.5661, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:54:01,381 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:54:01,381 - ClientAppLogger [Client 0] - INFO - Fit completed for round 139. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 139, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.083143377304077, 'd_loss': 0.7372468769550323, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14589190483093262, 'cpu_percent_fit': 6.975, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:54:01,381 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:54:15,727 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:15,727 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:15,727 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:15,727 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:54:15,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:54:15,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:16,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:16,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:16,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:54:16,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:54:16,155 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:16,268 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:16,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:16,275 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:16,280 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:54:16,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:16,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:54:16,287 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:16,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:16,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:54:16,295 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:16,298 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:16,300 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:16,302 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:16,305 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:16,307 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:16,309 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:16,311 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:16,314 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:16,316 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:16,318 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:16,327 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:16,327 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:54:16,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:54:16,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:54:16,337 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:16,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:54:16,346 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:16,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:54:16,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:16,362 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:16,367 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:54:16,373 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:54:16,373 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:16,373 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:16,374 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:16,374 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:16,374 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:16,374 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:54:16,374 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:16,375 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:54:16,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:16,376 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:54:16,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:54:16,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:16,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:54:16,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:16,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:16,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:16,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:54:16,378 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:16,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:16,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:16,380 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:54:16,380 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:54:16,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:54:16,380 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:54:16,386 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:54:16,386 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:16,387 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:16,388 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:16,389 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:16,389 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:16,389 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:16,390 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:16,404 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5709, Threshold=0.6357, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:54:16,404 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5709
2025-08-04 20:54:21,690 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:21,690 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:21,690 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:21,690 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:54:21,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:54:21,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:22,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:22,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:22,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:54:22,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:54:22,153 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:22,254 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:22,260 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:22,260 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:22,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:54:22,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:22,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:54:22,271 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:22,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:22,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:54:22,279 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:22,283 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:22,285 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:22,287 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:22,290 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:22,292 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:22,294 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:22,297 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:22,299 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:22,301 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:22,304 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:22,312 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:22,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:54:22,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:54:22,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:54:22,322 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:22,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:54:22,330 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:22,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:54:22,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:22,345 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:22,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:54:22,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:54:22,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:22,355 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:22,355 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:22,355 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:22,356 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:22,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:54:22,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:22,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:54:22,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:22,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:54:22,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:54:22,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:54:22,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:54:22,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:54:22,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:54:22,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:54:22,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:54:22,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:54:22,361 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:54:22,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:54:22,361 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:54:22,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:54:22,361 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:22,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:54:22,362 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:22,362 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:22,362 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:22,362 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:54:22,362 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:54:22,363 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:54:22,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:54:22,366 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:54:22,367 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:22,368 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:22,368 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:22,370 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 140/400.
2025-08-04 20:54:22,470 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:22,471 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:22,472 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:54:22,472 - ClientAppLogger [Client 0] - INFO - [Client] Round 140: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:54:22,472 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:22,498 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0807, Avg D Loss: 0.7388
2025-08-04 20:54:22,498 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0807, Avg D Loss: 0.7388
2025-08-04 20:54:22,498 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:22,511 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5258, Threshold=0.5707, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:54:22,511 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:54:22,511 - ClientAppLogger [Client 0] - INFO - Fit completed for round 140. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 140, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.080654501914978, 'd_loss': 0.7388182520866394, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14154887199401855, 'cpu_percent_fit': 6.09375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:54:22,512 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:54:30,780 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:30,780 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:30,780 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:30,780 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:54:30,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:54:30,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:31,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:31,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:31,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:54:31,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:54:31,255 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:31,394 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:31,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:31,400 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:31,408 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:54:31,431 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:31,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:54:31,433 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:31,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:31,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:54:31,443 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:31,446 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:31,449 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:31,451 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:31,454 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:31,456 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:31,459 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:31,461 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:31,464 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:31,466 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:31,468 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:31,480 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:31,480 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:54:31,485 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:54:31,485 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:54:31,491 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:31,491 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:54:31,502 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:31,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:54:31,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:31,518 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:31,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:54:31,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:54:31,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:31,527 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:31,527 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:31,527 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:31,528 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:31,528 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:54:31,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:31,528 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:54:31,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:31,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:54:31,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:54:31,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:31,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:54:31,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:54:31,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:54:31,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:54:31,532 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:54:31,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:54:31,532 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:54:31,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:54:31,532 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:54:31,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:54:31,533 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:31,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:54:31,533 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:31,533 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:31,534 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:31,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:54:31,534 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:54:31,534 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:54:31,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:54:31,543 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:54:31,544 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:31,545 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:31,545 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:31,546 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:31,546 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:31,546 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:31,547 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:31,561 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5291, Threshold=0.5727, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:54:31,561 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5291
2025-08-04 20:54:39,818 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:39,819 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:39,819 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:39,819 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:54:39,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:54:39,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:40,083 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:40,083 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:40,167 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:54:40,194 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:54:40,194 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:40,311 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:40,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:40,317 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:40,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:54:40,327 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:40,327 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:54:40,327 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:40,327 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:40,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:54:40,336 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:40,338 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:40,341 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:40,343 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:40,345 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:40,348 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:40,351 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:40,355 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:40,358 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:40,360 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:40,362 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:40,371 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:40,372 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:54:40,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:54:40,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:54:40,382 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:40,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:54:40,392 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:40,392 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:54:40,392 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:40,407 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:40,411 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:54:40,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:54:40,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:40,417 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:40,418 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:40,418 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:40,418 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:40,418 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:54:40,418 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:40,419 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:54:40,419 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:40,420 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:54:40,420 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:54:40,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:54:40,422 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:54:40,423 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:54:40,423 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:54:40,423 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:54:40,423 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:40,423 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:54:40,424 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:40,424 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:40,424 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:40,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:54:40,425 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:54:40,425 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:54:40,425 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:54:40,427 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:54:40,427 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:40,429 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:40,429 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:40,430 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 141/400.
2025-08-04 20:54:40,532 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:40,532 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:40,533 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:54:40,534 - ClientAppLogger [Client 0] - INFO - [Client] Round 141: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:54:40,534 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:40,559 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0749, Avg D Loss: 0.7570
2025-08-04 20:54:40,559 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0749, Avg D Loss: 0.7570
2025-08-04 20:54:40,560 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:40,573 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4921, Threshold=0.5151, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:54:40,573 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:54:40,573 - ClientAppLogger [Client 0] - INFO - Fit completed for round 141. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 141, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.074921226501465, 'd_loss': 0.756951630115509, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14289283752441406, 'cpu_percent_fit': 6.01875, 'ram_mb_fit': 15.23828125, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:54:40,573 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:54:51,839 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:51,839 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:51,840 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:51,840 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:54:51,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:54:51,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:52,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:52,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:52,263 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:54:52,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:54:52,307 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:52,445 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:52,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:52,455 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:52,464 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:54:52,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:52,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:54:52,475 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:52,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:52,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:54:52,485 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:52,489 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:52,492 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:52,495 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:52,498 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:52,501 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:52,503 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:52,506 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:52,509 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:52,511 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:52,514 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:52,526 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:52,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:54:52,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:54:52,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:54:52,537 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:52,537 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:54:52,548 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:52,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:54:52,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:52,564 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:52,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:54:52,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:54:52,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:52,575 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:52,575 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:52,575 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:52,576 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:52,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:54:52,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:52,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:54:52,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:52,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:54:52,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:54:52,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:52,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:54:52,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:52,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:52,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:52,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:54:52,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:54:52,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:54:52,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:54:52,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:54:52,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:54:52,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:54:52,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:54:52,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:54:52,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:54:52,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:54:52,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:54:52,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:52,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:54:52,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:52,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:52,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:52,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:54:52,582 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:54:52,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:54:52,583 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:54:52,589 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:54:52,589 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:52,591 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:52,591 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:52,592 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:52,592 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:52,592 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:52,593 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:52,608 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5595, Threshold=0.6066, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:54:52,608 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5595
2025-08-04 20:55:03,881 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:03,882 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:03,882 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:03,882 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:55:03,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:55:03,882 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:04,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:04,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:04,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:55:04,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:55:04,362 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:04,481 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:04,487 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:04,487 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:04,492 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:55:04,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:04,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:55:04,500 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:04,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:04,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:55:04,510 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:04,513 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:04,515 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:04,518 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:04,520 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:04,523 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:04,526 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:04,528 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:04,531 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:04,533 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:04,535 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:04,545 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:04,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:55:04,551 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:55:04,551 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:55:04,556 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:04,556 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:55:04,568 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:04,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:55:04,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:04,583 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:04,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:55:04,594 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:55:04,594 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:04,594 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:04,594 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:55:04,596 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:04,597 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:55:04,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:55:04,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:55:04,599 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:55:04,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:55:04,599 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:55:04,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:55:04,599 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:55:04,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:55:04,600 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:55:04,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:55:04,600 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:55:04,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:55:04,600 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:04,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:55:04,601 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:04,601 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:04,601 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:04,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:55:04,602 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:55:04,602 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:55:04,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:55:04,606 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:55:04,607 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:04,609 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:04,609 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:04,610 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 142/400.
2025-08-04 20:55:04,712 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:04,712 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:04,714 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:55:04,714 - ClientAppLogger [Client 0] - INFO - [Client] Round 142: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:55:04,714 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:04,741 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0730, Avg D Loss: 0.7598
2025-08-04 20:55:04,741 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0730, Avg D Loss: 0.7598
2025-08-04 20:55:04,741 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:04,755 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4912, Threshold=0.5105, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:55:04,755 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:55:04,755 - ClientAppLogger [Client 0] - INFO - Fit completed for round 142. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 142, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0730034828186037, 'd_loss': 0.7598080396652221, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14479947090148926, 'cpu_percent_fit': 7.16875, 'ram_mb_fit': 6.37890625, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:55:04,756 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:55:13,023 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:13,023 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:13,023 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:13,023 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:55:13,023 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:55:13,023 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:13,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:13,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:13,513 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:55:13,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:55:13,553 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:13,673 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:13,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:13,679 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:13,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:55:13,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:13,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:55:13,693 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:13,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:13,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:55:13,703 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:13,706 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:13,708 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:13,710 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:13,712 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:13,715 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:13,718 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:13,721 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:13,723 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:13,726 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:13,728 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:13,740 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:13,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:55:13,745 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:55:13,746 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:55:13,750 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:13,751 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:55:13,760 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:13,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:55:13,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:13,777 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:13,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:55:13,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:55:13,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:13,791 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:13,791 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:13,792 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:13,792 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:13,792 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:55:13,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:13,793 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:55:13,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:13,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:55:13,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:55:13,795 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:13,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:55:13,795 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:55:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:55:13,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:55:13,797 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:55:13,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:55:13,797 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:55:13,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:55:13,797 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:55:13,798 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:55:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:13,798 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:55:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:13,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:55:13,799 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:55:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:55:13,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:55:13,803 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:55:13,803 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:13,805 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:13,805 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:13,806 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:13,806 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:13,807 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:13,807 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:13,822 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5439, Threshold=0.5895, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:55:13,822 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5439
2025-08-04 20:55:22,084 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:22,084 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:22,084 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:22,084 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:55:22,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:55:22,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:22,368 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:22,368 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:22,452 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:55:22,477 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:55:22,478 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:22,564 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:22,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:22,569 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:22,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:55:22,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:22,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:55:22,580 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:22,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:22,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:55:22,589 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:22,592 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:22,594 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:22,596 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:22,599 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:22,601 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:22,604 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:22,607 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:22,610 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:22,612 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:22,614 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:22,623 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:22,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:55:22,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:55:22,629 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:55:22,634 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:22,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:55:22,644 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:22,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:55:22,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:22,659 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:22,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:55:22,668 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:55:22,668 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:22,669 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:22,669 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:22,669 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:22,669 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:22,670 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:55:22,670 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:22,670 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:55:22,670 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:22,671 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:55:22,672 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:55:22,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:22,672 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:55:22,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:22,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:22,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:55:22,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:55:22,674 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:55:22,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:55:22,674 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:55:22,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:55:22,674 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:22,674 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:55:22,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:22,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:22,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:22,675 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:55:22,676 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:55:22,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:55:22,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:55:22,681 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:55:22,682 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:22,683 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:22,683 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:22,684 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 143/400.
2025-08-04 20:55:22,786 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:22,786 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:22,787 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:55:22,787 - ClientAppLogger [Client 0] - INFO - [Client] Round 143: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:55:22,787 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:22,814 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7551
2025-08-04 20:55:22,814 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7551
2025-08-04 20:55:22,814 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:22,831 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4965, Threshold=0.5184, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:55:22,831 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:55:22,831 - ClientAppLogger [Client 0] - INFO - Fit completed for round 143. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 143, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.084680128097534, 'd_loss': 0.755105608701706, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14672088623046875, 'cpu_percent_fit': 6.8625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:55:22,833 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:55:34,101 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:34,101 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:34,101 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:34,101 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:55:34,101 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:55:34,101 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:34,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:34,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:34,688 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:55:34,739 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:55:34,739 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:34,912 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:34,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:34,919 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:34,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:55:34,933 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:34,933 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:55:34,934 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:34,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:34,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:55:34,943 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:34,947 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,951 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:34,954 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:34,957 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:34,960 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:34,964 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,967 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:34,971 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:34,974 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:34,976 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:34,987 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:34,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:55:34,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:55:34,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:55:34,999 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:34,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:55:35,008 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:35,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:55:35,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:35,023 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:35,027 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:55:35,033 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:55:35,034 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:35,034 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:35,034 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:35,034 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:35,035 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:35,035 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:55:35,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:35,035 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:55:35,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:35,037 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:55:35,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:55:35,037 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:35,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:55:35,038 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:35,038 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:35,038 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:35,038 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:55:35,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:55:35,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:55:35,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:55:35,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:55:35,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:55:35,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:35,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:55:35,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:55:35,048 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:55:35,048 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:35,050 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:35,050 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:35,052 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:35,052 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:35,052 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:35,053 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:35,067 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4781, Threshold=0.4957, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:55:35,067 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4781
2025-08-04 20:55:40,318 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:40,318 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:40,318 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:40,319 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:55:40,319 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:55:40,319 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:40,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:40,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:40,701 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:55:40,731 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:55:40,731 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:40,830 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:40,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:40,837 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:40,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:55:40,852 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:40,852 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:55:40,853 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:40,853 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:40,853 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:55:40,863 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:40,866 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:40,869 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:40,871 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:40,874 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:40,876 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:40,879 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:40,881 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:40,884 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:40,886 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:40,888 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:40,898 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:40,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:55:40,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:55:40,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:55:40,909 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:40,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:55:40,920 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:40,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:55:40,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:40,936 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:40,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:55:40,946 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:55:40,946 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:40,947 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:40,947 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:40,947 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:40,947 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:40,948 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:55:40,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:40,948 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:55:40,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:40,950 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:55:40,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:55:40,950 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:40,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:55:40,951 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:55:40,952 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:55:40,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:55:40,952 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:55:40,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:55:40,952 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:55:40,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:55:40,953 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:55:40,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:55:40,953 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:40,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:55:40,953 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:40,954 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:40,954 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:40,954 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:55:40,954 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:55:40,954 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:55:40,954 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:55:40,956 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:55:40,956 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:40,958 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:40,958 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:40,959 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 144/400.
2025-08-04 20:55:41,061 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:41,061 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:41,064 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:55:41,065 - ClientAppLogger [Client 0] - INFO - [Client] Round 144: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:55:41,065 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:41,095 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7534
2025-08-04 20:55:41,095 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7534
2025-08-04 20:55:41,095 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:41,108 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4935, Threshold=0.5193, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:55:41,109 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:55:41,109 - ClientAppLogger [Client 0] - INFO - Fit completed for round 144. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 144, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.083867979049683, 'd_loss': 0.7533816754817962, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14957785606384277, 'cpu_percent_fit': 7.79375, 'ram_mb_fit': 1.953125, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:55:41,109 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:55:55,390 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:55,390 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:55,390 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:55,390 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:55:55,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:55:55,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:55,764 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:55,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:55,853 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:55:55,888 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:55:55,889 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:56,049 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:56,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:56,063 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:56,075 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:55:56,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,087 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,087 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,087 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:55:56,097 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,101 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,104 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,107 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,110 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,112 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,115 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,119 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,122 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,124 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,127 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,139 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:55:56,145 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,145 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:55:56,155 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,155 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:55:56,170 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:55:56,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,197 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,205 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:55:56,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:55:56,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,214 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,215 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,216 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,216 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,217 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:55:56,217 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,218 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:55:56,219 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,221 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:55:56,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:55:56,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:55:56,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:55:56,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:55:56,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:55:56,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:55:56,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:55:56,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:55:56,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:55:56,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:55:56,230 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:55:56,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:55:56,230 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:55:56,231 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,231 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,232 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,232 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:55:56,232 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:55:56,233 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:55:56,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:55:56,238 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:55:56,239 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,240 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,240 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:56,242 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,242 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,242 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,243 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,259 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5784, Threshold=0.6401, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:55:56,259 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5784
2025-08-04 20:56:07,530 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:07,531 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:07,531 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:07,531 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:56:07,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:56:07,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:07,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:07,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:56:08,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:56:08,068 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:08,218 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:08,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:08,228 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:08,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:56:08,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:08,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:56:08,267 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:08,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:08,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:56:08,279 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:08,282 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,284 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:08,287 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:08,290 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:08,292 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:08,296 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,298 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:08,302 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:08,304 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:08,307 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:08,320 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:08,320 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:56:08,326 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:56:08,326 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:56:08,336 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:08,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:56:08,359 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:08,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:56:08,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:08,388 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:08,395 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:56:08,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:56:08,413 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:08,414 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:08,414 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:08,415 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:08,415 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:08,416 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:56:08,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:08,418 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:56:08,418 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:08,420 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:56:08,420 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:56:08,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:08,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:56:08,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:08,421 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:08,422 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:08,422 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:56:08,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:56:08,423 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:56:08,423 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:56:08,423 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:56:08,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:56:08,425 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:56:08,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:56:08,427 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:56:08,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:56:08,428 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:56:08,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:56:08,429 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:08,429 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:56:08,430 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:08,430 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:08,431 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:08,431 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:56:08,432 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:56:08,432 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:56:08,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:56:08,448 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:56:08,448 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:08,450 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:08,452 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:08,453 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:08,454 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:08,454 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:08,455 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:08,476 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5059, Threshold=0.5205, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:56:08,477 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5059
2025-08-04 20:56:13,724 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:13,724 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:13,724 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:13,724 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:56:13,724 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:56:13,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:14,029 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:14,029 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:14,110 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:56:14,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:56:14,149 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:14,271 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:14,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:14,277 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:14,282 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:56:14,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:14,287 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:56:14,288 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:14,288 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:14,288 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:56:14,297 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:14,300 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:14,303 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:14,305 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:14,309 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:14,311 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:14,313 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:14,316 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:14,318 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:14,320 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:14,323 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:14,332 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:14,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:56:14,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:56:14,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:56:14,341 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:14,342 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:56:14,350 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:14,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:56:14,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:14,366 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:14,370 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:56:14,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:56:14,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:14,376 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:14,376 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:14,376 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:14,376 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:14,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:56:14,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:14,377 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:56:14,377 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:14,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:56:14,379 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:56:14,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:14,379 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:56:14,379 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:56:14,380 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:56:14,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:56:14,381 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:56:14,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:56:14,381 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:56:14,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:56:14,381 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:56:14,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:56:14,382 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:14,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:56:14,382 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:14,382 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:14,383 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:14,383 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:56:14,383 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:56:14,383 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:56:14,383 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:56:14,386 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:56:14,387 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:14,388 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:14,388 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:14,390 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 146/400.
2025-08-04 20:56:14,491 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:14,491 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:14,495 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:56:14,496 - ClientAppLogger [Client 0] - INFO - [Client] Round 146: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:56:14,496 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:14,535 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0802, Avg D Loss: 0.7516
2025-08-04 20:56:14,535 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0802, Avg D Loss: 0.7516
2025-08-04 20:56:14,535 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:14,549 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4957, Threshold=0.5182, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:56:14,549 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:56:14,550 - ClientAppLogger [Client 0] - INFO - Fit completed for round 146. Duration: 0.16s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 146, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.080179810523987, 'd_loss': 0.7516288936138154, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.15981817245483398, 'cpu_percent_fit': 4.25625, 'ram_mb_fit': 5.1640625, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:56:14,550 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:56:25,816 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:25,816 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:25,817 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:25,817 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:56:25,817 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:56:25,817 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:26,143 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:26,143 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:26,235 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:56:26,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:56:26,267 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:26,408 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:26,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:26,415 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:26,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:56:26,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:26,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:56:26,429 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:26,429 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:26,429 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:56:26,442 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:26,446 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,448 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:26,451 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:26,454 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:26,456 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:26,459 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,462 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:26,465 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:26,467 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:26,469 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:26,482 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:26,483 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:56:26,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:56:26,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:56:26,494 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:26,494 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:56:26,506 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:26,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:56:26,507 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:26,526 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:26,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:56:26,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:56:26,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:26,543 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:26,544 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:26,544 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:26,544 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:26,544 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:56:26,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:26,545 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:56:26,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:26,546 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:56:26,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:56:26,547 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:26,547 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:56:26,547 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:26,547 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:26,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:26,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:56:26,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:56:26,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:56:26,548 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:56:26,548 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:56:26,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:56:26,549 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:56:26,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:56:26,549 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:56:26,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:56:26,550 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:56:26,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:56:26,550 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:26,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:56:26,551 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:26,551 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:26,551 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:26,551 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:56:26,551 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:56:26,551 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:56:26,552 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:56:26,557 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:56:26,557 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:26,558 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:26,559 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:26,560 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:26,560 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:26,561 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:26,561 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:26,577 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5601, Threshold=0.6156, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:56:26,577 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5601
2025-08-04 20:56:31,847 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:31,847 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:31,847 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:31,847 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:56:31,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:56:31,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:32,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:32,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:32,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:56:32,362 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:56:32,363 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:32,484 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:32,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:32,490 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:32,495 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:56:32,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:32,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:56:32,500 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:32,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:32,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:56:32,508 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:32,511 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:32,513 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:32,515 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:32,518 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:32,520 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:32,523 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:32,525 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:32,528 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:32,530 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:32,532 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:32,540 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:32,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:56:32,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:56:32,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:56:32,549 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:32,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:56:32,557 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:32,557 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:56:32,557 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:32,572 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:32,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:56:32,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:56:32,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:32,588 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:32,588 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:32,589 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:32,589 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:32,589 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:56:32,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:32,589 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:56:32,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:32,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:56:32,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:56:32,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:32,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:56:32,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:56:32,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:56:32,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:32,594 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:56:32,594 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:32,594 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:32,594 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:32,594 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:56:32,595 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:56:32,595 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:56:32,595 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:56:32,603 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:56:32,603 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:32,604 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:32,604 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:32,606 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 147/400.
2025-08-04 20:56:32,707 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:32,707 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:32,709 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:56:32,709 - ClientAppLogger [Client 0] - INFO - [Client] Round 147: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:56:32,709 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:32,737 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0751, Avg D Loss: 0.7546
2025-08-04 20:56:32,737 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0751, Avg D Loss: 0.7546
2025-08-04 20:56:32,737 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:32,753 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5000, Threshold=0.5248, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:56:32,753 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:56:32,753 - ClientAppLogger [Client 0] - INFO - Fit completed for round 147. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 147, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.075097715854645, 'd_loss': 0.7545713305473327, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14712262153625488, 'cpu_percent_fit': 5.43125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:56:32,753 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:56:47,045 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:47,045 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:47,046 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:47,046 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:56:47,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:56:47,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:47,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:47,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:47,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:56:47,702 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:56:47,702 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:47,900 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:47,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:47,909 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:47,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:56:47,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:47,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:56:47,926 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:47,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:47,927 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:56:47,938 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:47,942 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,945 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:47,949 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:47,953 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:47,956 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:47,958 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,961 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:47,964 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:47,967 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:47,970 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:47,984 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:47,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:56:47,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:56:47,993 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:56:48,000 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:48,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:56:48,013 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:48,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:56:48,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:48,033 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:48,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:56:48,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:56:48,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:48,045 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:48,045 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:48,045 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:48,045 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:48,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:56:48,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:48,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:56:48,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:48,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:56:48,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:56:48,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:48,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:56:48,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:48,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:48,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:48,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:56:48,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:56:48,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:56:48,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:56:48,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:56:48,050 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:56:48,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:56:48,050 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:56:48,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:56:48,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:56:48,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:56:48,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:56:48,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:48,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:56:48,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:48,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:48,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:48,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:56:48,053 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:56:48,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:56:48,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:56:48,063 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:56:48,064 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:48,065 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:48,065 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:48,067 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:48,067 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:48,067 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:48,068 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:48,083 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4761, Threshold=0.4851, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:56:48,083 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4761
2025-08-04 20:56:53,343 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:53,343 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:53,343 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:53,343 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:56:53,343 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:56:53,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:53,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:53,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:53,817 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:56:53,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:56:53,859 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:53,994 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:54,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:54,003 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:54,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:56:54,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:54,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:56:54,020 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:54,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:54,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:56:54,029 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:54,033 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:54,036 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:54,038 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:54,041 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:54,043 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:54,046 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:54,048 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:54,051 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:54,054 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:54,056 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:54,067 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:54,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:56:54,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:56:54,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:56:54,078 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:54,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:56:54,090 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:54,091 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:56:54,091 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:54,108 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:54,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:56:54,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:56:54,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:54,119 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:54,119 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:54,119 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:54,120 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:54,120 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:56:54,120 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:54,121 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:56:54,121 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:54,122 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:56:54,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:56:54,123 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:54,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:56:54,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:54,124 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:54,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:54,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:56:54,125 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:56:54,125 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:56:54,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:56:54,126 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:56:54,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:56:54,127 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:56:54,127 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:56:54,127 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:56:54,127 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:56:54,127 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:56:54,128 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:56:54,128 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:54,128 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:56:54,128 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:54,128 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:54,129 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:54,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:56:54,129 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:56:54,129 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:56:54,130 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:56:54,139 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:56:54,139 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:54,141 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:54,141 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:54,143 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 148/400.
2025-08-04 20:56:54,244 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:54,244 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:54,246 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:56:54,246 - ClientAppLogger [Client 0] - INFO - [Client] Round 148: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:56:54,246 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:54,274 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7504
2025-08-04 20:56:54,274 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7504
2025-08-04 20:56:54,274 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:54,288 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5019, Threshold=0.5391, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 20:56:54,288 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8076
2025-08-04 20:56:54,288 - ClientAppLogger [Client 0] - INFO - Fit completed for round 148. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 148, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0840813636779787, 'd_loss': 0.7504211604595185, 'post_fit_local_f1': 0.8076463560334528, 'fit_time_seconds': 0.1448817253112793, 'cpu_percent_fit': 5.65625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:56:54,288 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:57:05,588 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:05,588 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:05,588 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:05,588 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:57:05,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:57:05,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:06,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:06,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:06,164 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:57:06,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:57:06,193 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:06,336 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:06,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:06,344 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:06,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:57:06,362 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:06,362 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:57:06,363 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:06,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:06,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:57:06,372 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:06,376 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,378 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:06,380 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:06,383 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:06,385 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:06,388 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,391 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:06,394 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:06,396 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:06,399 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:06,410 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:06,410 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:57:06,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:57:06,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:57:06,421 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:06,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:57:06,433 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:06,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:57:06,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:06,452 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:06,458 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:57:06,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:57:06,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:06,470 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:06,470 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:06,471 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:06,471 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:06,471 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:57:06,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:06,472 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:57:06,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:06,474 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:57:06,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:57:06,474 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:06,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:57:06,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:06,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:06,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:06,475 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:57:06,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:57:06,476 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:57:06,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:57:06,476 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:57:06,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:57:06,476 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:57:06,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:57:06,477 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:57:06,477 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:57:06,477 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:57:06,477 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:57:06,477 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:06,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:57:06,478 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:06,478 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:06,478 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:06,479 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:57:06,479 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:57:06,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:57:06,479 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:57:06,484 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:57:06,484 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:06,486 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:06,486 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:06,487 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:06,487 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:06,488 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:06,489 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:06,503 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5318, Threshold=0.5646, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:57:06,504 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5318
2025-08-04 20:57:11,781 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:11,781 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:11,781 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:11,781 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:57:11,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:57:11,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:12,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:12,211 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:12,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:57:12,355 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:57:12,355 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:12,501 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:12,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:12,508 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:12,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:57:12,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:12,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:57:12,521 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:12,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:12,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:57:12,531 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:12,534 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:12,536 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:12,539 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:12,541 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:12,544 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:12,547 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:12,550 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:12,553 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:12,555 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:12,557 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:12,568 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:12,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:57:12,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:57:12,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:57:12,582 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:12,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:57:12,591 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:12,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:57:12,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:12,608 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:12,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:57:12,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:57:12,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:12,618 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:12,618 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:12,619 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:12,619 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:12,619 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:57:12,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:12,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:57:12,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:12,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:57:12,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:57:12,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:12,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:57:12,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:12,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:12,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:12,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:57:12,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:57:12,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:57:12,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:57:12,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:57:12,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:57:12,624 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:57:12,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:57:12,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:57:12,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:57:12,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:57:12,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:57:12,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:12,626 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:57:12,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:12,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:12,627 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:12,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:57:12,627 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:57:12,627 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:57:12,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:57:12,633 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:57:12,633 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:12,635 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:12,635 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:12,636 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 149/400.
2025-08-04 20:57:12,737 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:12,737 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:12,739 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:57:12,739 - ClientAppLogger [Client 0] - INFO - [Client] Round 149: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:57:12,739 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:12,766 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0817, Avg D Loss: 0.7510
2025-08-04 20:57:12,766 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0817, Avg D Loss: 0.7510
2025-08-04 20:57:12,766 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:12,781 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5032, Threshold=0.5351, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:57:12,782 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:57:12,782 - ClientAppLogger [Client 0] - INFO - Fit completed for round 149. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 149, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0816503763198853, 'd_loss': 0.7510067522525787, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14594411849975586, 'cpu_percent_fit': 5.525, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:57:12,786 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:57:27,108 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:27,109 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:27,109 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:27,109 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:57:27,109 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:57:27,109 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:27,562 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:27,562 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:27,658 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:57:27,700 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:57:27,701 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:27,860 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:27,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:27,872 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:27,888 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:57:27,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:27,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:57:27,920 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:27,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:27,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:57:27,931 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:27,934 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:27,939 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:27,942 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:27,945 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:27,947 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,950 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:27,954 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:27,957 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:27,960 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:27,973 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:27,974 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:57:27,980 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:57:27,980 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:57:27,988 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:27,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:57:28,006 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:28,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:57:28,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:28,025 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:28,031 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:57:28,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:57:28,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:28,038 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:28,038 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:28,039 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:28,039 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:28,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:57:28,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:28,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:57:28,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:28,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:57:28,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:57:28,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:28,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:57:28,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:28,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:28,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:28,045 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:57:28,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:57:28,045 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:57:28,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:57:28,045 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:57:28,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:57:28,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:57:28,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:57:28,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:57:28,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:57:28,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:57:28,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:57:28,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:28,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:57:28,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:28,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:28,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:28,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:57:28,049 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:57:28,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:57:28,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:57:28,060 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:57:28,061 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:28,063 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:28,063 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:28,066 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:28,066 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:28,066 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:28,067 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:28,081 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5396, Threshold=0.5726, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:57:28,081 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5396
2025-08-04 20:57:33,348 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:33,348 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:33,348 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:33,348 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:57:33,348 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:57:33,348 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:33,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:33,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:33,859 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:57:33,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:57:33,903 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:34,049 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:34,057 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:34,058 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:34,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:57:34,074 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:34,075 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:57:34,075 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:34,075 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:34,076 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:57:34,086 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:34,089 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,091 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:34,094 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:34,097 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:34,099 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:34,102 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,104 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:34,107 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:34,110 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:34,113 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:34,125 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:34,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:57:34,131 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:57:34,131 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:57:34,136 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:34,137 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:57:34,147 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:34,147 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:57:34,148 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:34,164 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:34,169 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:57:34,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:57:34,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:34,177 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:34,178 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:34,178 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:34,178 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:34,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:57:34,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:34,179 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:57:34,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:34,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:57:34,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:57:34,181 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:34,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:57:34,181 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:34,181 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:34,181 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:34,182 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:57:34,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:57:34,182 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:57:34,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:57:34,182 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:57:34,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:57:34,183 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:57:34,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:57:34,183 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:57:34,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:57:34,183 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:57:34,184 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:57:34,184 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:34,184 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:57:34,184 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:34,185 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:34,185 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:34,185 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:57:34,185 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:57:34,185 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:57:34,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:57:34,191 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:57:34,191 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:34,192 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:34,192 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:34,194 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 150/400.
2025-08-04 20:57:34,294 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:34,295 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:34,296 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:57:34,296 - ClientAppLogger [Client 0] - INFO - [Client] Round 150: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:57:34,297 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:34,322 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0728, Avg D Loss: 0.7520
2025-08-04 20:57:34,322 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0728, Avg D Loss: 0.7520
2025-08-04 20:57:34,322 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:34,336 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5331, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:57:34,336 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:57:34,336 - ClientAppLogger [Client 0] - INFO - Fit completed for round 150. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 150, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.072804164886475, 'd_loss': 0.7520487248897553, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14220952987670898, 'cpu_percent_fit': 5.98125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:57:34,336 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:57:48,645 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:48,645 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:48,645 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:48,645 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:57:48,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:57:48,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:49,103 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:49,103 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:49,196 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:57:49,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:57:49,221 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:49,351 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:49,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:49,358 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:49,366 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:57:49,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:49,375 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:57:49,376 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:49,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:49,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:57:49,385 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:49,388 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,390 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:49,393 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:49,396 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:49,398 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:49,400 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,404 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:49,407 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:49,409 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:49,411 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:49,424 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:49,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:57:49,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:57:49,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:57:49,440 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:49,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:57:49,466 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:49,466 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:57:49,467 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:49,485 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:49,492 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:57:49,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:57:49,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:49,499 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:49,499 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:49,500 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:49,500 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:49,500 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:57:49,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:49,501 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:57:49,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:49,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:57:49,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:57:49,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:49,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:57:49,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:49,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:49,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:49,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:57:49,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:57:49,504 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:57:49,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:57:49,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:57:49,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:57:49,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:57:49,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:57:49,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:57:49,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:57:49,506 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:57:49,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:57:49,506 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:49,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:57:49,507 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:49,507 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:49,507 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:49,507 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:57:49,507 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:57:49,507 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:57:49,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:57:49,513 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:57:49,514 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:49,515 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:49,515 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:49,517 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:49,517 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:49,517 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:49,518 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:49,532 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5447, Threshold=0.5845, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:57:49,532 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5447
2025-08-04 20:57:54,820 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:54,820 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:54,820 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:54,821 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:57:54,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:57:54,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:55,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:55,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:55,187 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:57:55,220 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:57:55,220 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:55,329 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:55,335 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:55,335 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:55,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:57:55,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:55,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:57:55,346 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:55,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:55,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:57:55,355 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:55,358 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:55,360 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:55,362 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:55,365 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:55,367 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:55,370 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:55,372 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:55,375 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:55,377 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:55,379 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:55,388 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:55,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:57:55,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:57:55,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:57:55,398 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:55,398 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:57:55,408 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:55,408 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:57:55,409 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:55,423 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:55,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:57:55,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:57:55,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:55,433 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:55,433 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:55,433 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:55,433 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:55,434 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:57:55,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:55,434 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:57:55,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:55,436 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:57:55,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:57:55,436 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:55,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:57:55,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:57:55,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:55,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:57:55,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:55,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:55,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:55,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:57:55,440 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:57:55,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:57:55,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:57:55,447 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:57:55,447 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:55,448 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:55,449 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:55,450 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 151/400.
2025-08-04 20:57:55,551 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:55,551 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:55,553 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:57:55,553 - ClientAppLogger [Client 0] - INFO - [Client] Round 151: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:57:55,553 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:55,579 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0777, Avg D Loss: 0.7919
2025-08-04 20:57:55,579 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0777, Avg D Loss: 0.7919
2025-08-04 20:57:55,579 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:55,593 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4999, Threshold=0.5238, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:57:55,593 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:57:55,593 - ClientAppLogger [Client 0] - INFO - Fit completed for round 151. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 151, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.077734899520874, 'd_loss': 0.7918899893760681, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14303946495056152, 'cpu_percent_fit': 5.9625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:57:55,594 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:58:06,917 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:06,917 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:06,917 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:06,917 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:58:06,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:58:06,918 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:07,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:07,354 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:07,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:58:07,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:58:07,488 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:07,618 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:07,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:07,625 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:07,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:58:07,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:07,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:58:07,672 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:07,672 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:07,672 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:58:07,681 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:07,684 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,687 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:07,689 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:07,692 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:07,694 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:07,697 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,700 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:07,703 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:07,705 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:07,707 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:07,717 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:07,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:58:07,723 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:58:07,723 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:58:07,729 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:07,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:58:07,740 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:07,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:58:07,740 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:07,758 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:07,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:58:07,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:58:07,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:07,768 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:07,768 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:07,769 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:07,769 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:07,769 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:58:07,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:07,769 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:58:07,770 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:07,771 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:58:07,771 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:58:07,772 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:07,772 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:58:07,772 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:07,772 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:07,773 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:07,773 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:58:07,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:58:07,773 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:58:07,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:58:07,774 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:58:07,774 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:58:07,774 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:58:07,774 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:58:07,774 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:58:07,775 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:58:07,775 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:58:07,775 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:58:07,775 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:07,776 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:58:07,776 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:07,776 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:07,776 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:07,776 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:58:07,777 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:58:07,777 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:58:07,777 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:58:07,786 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:58:07,786 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:07,788 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:07,788 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:07,789 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:07,790 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:07,790 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:07,790 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:07,805 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5213, Threshold=0.5530, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:58:07,805 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5213
2025-08-04 20:58:13,066 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:13,066 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:13,066 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:13,067 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:58:13,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:58:13,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:13,416 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:13,416 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:13,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:58:13,560 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:58:13,560 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:13,683 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:13,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:13,689 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:13,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:58:13,701 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:13,702 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:58:13,702 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:13,702 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:13,703 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:58:13,711 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:13,714 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:13,717 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:13,719 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:13,722 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:13,725 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:13,727 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:13,730 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:13,733 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:13,735 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:13,738 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:13,749 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:13,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:58:13,754 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:58:13,754 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:58:13,760 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:13,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:58:13,769 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:13,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:58:13,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:13,784 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:13,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:58:13,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:58:13,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:13,795 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:13,795 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:13,795 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:13,795 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:58:13,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:13,796 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:58:13,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:13,797 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:58:13,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:58:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:13,798 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:58:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:13,798 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:58:13,799 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:58:13,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:58:13,800 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:58:13,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:58:13,800 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:13,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:58:13,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:13,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:13,801 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:13,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:58:13,802 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:58:13,802 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:58:13,802 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:58:13,806 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:58:13,806 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:13,807 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:13,808 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:13,809 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 152/400.
2025-08-04 20:58:13,911 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:13,911 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:13,912 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:58:13,912 - ClientAppLogger [Client 0] - INFO - [Client] Round 152: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:58:13,912 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:13,938 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.7899
2025-08-04 20:58:13,938 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.7899
2025-08-04 20:58:13,938 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:13,953 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4980, Threshold=0.5221, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:58:13,953 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:58:13,953 - ClientAppLogger [Client 0] - INFO - Fit completed for round 152. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 152, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0833891868591308, 'd_loss': 0.7899482190608978, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.1439807415008545, 'cpu_percent_fit': 7.3125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:58:13,953 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:58:28,248 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:28,248 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:28,248 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:28,248 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:58:28,248 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:58:28,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:28,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:28,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:28,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:58:28,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:58:28,734 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:28,865 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:28,873 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:28,874 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:28,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:58:28,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:28,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:58:28,905 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:28,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:28,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:58:28,915 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:28,918 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,921 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:28,923 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:28,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:28,928 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:28,931 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,933 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:28,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:28,938 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:28,941 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:28,954 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:28,955 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:58:28,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:58:28,960 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:58:28,967 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:28,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:58:28,978 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:28,978 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:58:28,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:28,996 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:29,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:58:29,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:58:29,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:29,006 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:29,007 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:29,007 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:29,007 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:29,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:58:29,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:29,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:58:29,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:29,010 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:58:29,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:58:29,010 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:29,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:58:29,011 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:29,011 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:29,011 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:29,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:58:29,012 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:58:29,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:58:29,012 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:58:29,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:58:29,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:58:29,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:58:29,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:58:29,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:58:29,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:58:29,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:58:29,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:58:29,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:29,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:58:29,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:29,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:29,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:29,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:58:29,015 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:58:29,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:58:29,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:58:29,026 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:58:29,026 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:29,027 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:29,028 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:29,029 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:29,029 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:29,030 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:29,030 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:29,044 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5744, Threshold=0.6276, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:58:29,045 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5744
2025-08-04 20:58:34,300 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:34,301 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:34,301 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:34,301 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:58:34,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:58:34,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:34,666 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:34,666 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:34,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:58:34,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:58:34,797 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:34,941 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:34,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:34,947 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:34,952 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:58:34,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:34,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:58:34,957 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:34,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:34,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:58:34,966 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:34,969 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:34,971 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:34,973 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:34,975 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:34,978 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:34,980 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:34,983 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:34,986 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:34,988 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:34,990 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:34,999 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:35,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:58:35,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:58:35,004 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:58:35,010 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:35,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:58:35,020 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:35,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:58:35,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:35,036 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:35,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:58:35,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:58:35,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:35,047 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:35,047 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:35,047 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:35,047 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:35,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:58:35,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:35,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:58:35,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:35,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:58:35,050 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:58:35,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:35,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:58:35,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:35,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:35,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:35,051 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:58:35,051 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:58:35,052 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:58:35,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:58:35,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:58:35,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:58:35,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:35,053 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:58:35,053 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:35,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:35,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:35,054 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:58:35,054 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:58:35,054 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:58:35,054 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:58:35,060 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:58:35,060 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:35,061 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:35,062 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:35,063 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 153/400.
2025-08-04 20:58:35,164 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:35,164 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:35,166 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:58:35,166 - ClientAppLogger [Client 0] - INFO - [Client] Round 153: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:58:35,166 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:35,194 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0734, Avg D Loss: 0.7940
2025-08-04 20:58:35,195 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0734, Avg D Loss: 0.7940
2025-08-04 20:58:35,195 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:35,209 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4970, Threshold=0.5166, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:58:35,209 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:58:35,209 - ClientAppLogger [Client 0] - INFO - Fit completed for round 153. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 153, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0733628034591676, 'd_loss': 0.7940132021903992, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14620733261108398, 'cpu_percent_fit': 5.48125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:58:35,210 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:58:46,496 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:46,496 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:46,496 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:46,497 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:58:46,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:58:46,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:46,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:46,883 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:46,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:58:46,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:58:47,000 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:47,129 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:47,136 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:47,136 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:47,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:58:47,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:47,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:58:47,149 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:47,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:47,150 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:58:47,159 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:47,162 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,165 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:47,167 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:47,170 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:47,172 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:47,175 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,177 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:47,180 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:47,183 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:47,185 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:47,197 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:47,197 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:58:47,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:58:47,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:58:47,208 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:47,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:58:47,221 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:47,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:58:47,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:47,237 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:47,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:58:47,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:58:47,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:47,248 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:47,248 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:47,248 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:47,248 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:47,249 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:58:47,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:47,249 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:58:47,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:47,250 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:58:47,250 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:58:47,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:47,251 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:58:47,251 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:47,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:47,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:47,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:58:47,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:58:47,252 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:58:47,252 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:58:47,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:58:47,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:58:47,253 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:58:47,253 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:58:47,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:58:47,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:58:47,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:58:47,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:58:47,254 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:47,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:58:47,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:47,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:47,255 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:47,255 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:58:47,255 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:58:47,256 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:58:47,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:58:47,260 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:58:47,260 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:47,262 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:47,262 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:47,264 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:47,264 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:47,264 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:47,264 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:47,279 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4773, Threshold=0.4923, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:58:47,279 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4773
2025-08-04 20:58:52,552 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:52,552 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:52,552 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:52,553 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:58:52,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:58:52,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:52,915 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:52,915 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:53,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:58:53,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:58:53,046 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:53,163 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:53,168 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:53,169 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:53,175 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:58:53,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:53,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:58:53,181 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:53,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:53,182 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:58:53,191 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:53,194 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:53,197 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:53,199 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:53,202 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:53,204 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:53,207 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:53,210 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:53,213 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:53,215 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:53,218 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:53,227 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:53,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:58:53,232 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:58:53,232 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:58:53,236 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:53,237 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:58:53,245 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:53,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:58:53,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:53,261 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:53,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:58:53,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:58:53,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:53,272 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:53,272 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:53,272 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:53,272 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:53,273 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:58:53,273 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:53,273 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:58:53,273 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:53,274 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:58:53,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:58:53,275 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:53,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:58:53,275 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:53,276 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:53,276 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:53,276 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:58:53,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:58:53,276 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:58:53,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:58:53,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:58:53,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:58:53,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:58:53,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:58:53,277 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:58:53,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:58:53,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:58:53,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:58:53,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:53,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:58:53,278 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:53,279 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:53,279 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:53,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:58:53,279 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:58:53,279 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:58:53,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:58:53,283 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:58:53,283 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:53,285 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:53,285 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:53,287 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 154/400.
2025-08-04 20:58:53,388 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:53,388 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:53,390 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:58:53,390 - ClientAppLogger [Client 0] - INFO - [Client] Round 154: Training GAN with 31 samples (24 normal, 7 anomalous).
2025-08-04 20:58:53,390 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:53,417 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0787, Avg D Loss: 0.7845
2025-08-04 20:58:53,417 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0787, Avg D Loss: 0.7845
2025-08-04 20:58:53,417 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:53,434 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5043, Threshold=0.5250, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:58:53,434 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:58:53,434 - ClientAppLogger [Client 0] - INFO - Fit completed for round 154. Duration: 0.15s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 154, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0787399053573608, 'd_loss': 0.7845408916473389, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.1471099853515625, 'cpu_percent_fit': 6.70625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 31}
2025-08-04 20:58:53,435 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:59:07,728 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:07,728 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:07,728 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:07,728 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:59:07,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:59:07,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:08,081 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:08,081 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:08,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:59:08,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:59:08,213 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:08,330 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:08,337 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:08,337 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:08,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:59:08,370 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:08,371 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:59:08,371 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:08,372 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:08,372 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:59:08,380 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:08,383 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,385 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:08,387 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:08,390 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:08,393 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:08,395 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,398 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:08,400 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:08,402 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:08,405 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:08,415 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:08,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:59:08,420 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:59:08,420 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:59:08,426 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:08,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:59:08,436 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:08,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:59:08,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:08,453 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:08,457 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:59:08,462 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:59:08,462 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:08,462 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:08,462 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:08,462 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:08,463 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:08,463 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:59:08,463 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:08,463 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:59:08,463 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:08,465 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:59:08,465 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:59:08,465 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:08,465 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:59:08,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:08,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:08,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:08,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:59:08,466 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:59:08,466 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:59:08,467 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:59:08,468 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:59:08,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:59:08,468 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:08,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:59:08,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:08,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:08,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:08,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:59:08,469 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:59:08,469 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:59:08,470 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:59:08,478 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:59:08,479 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:08,480 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:08,480 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:08,482 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:08,482 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:08,482 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:08,482 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:08,496 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5365, Threshold=0.5736, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:59:08,496 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5365
2025-08-04 20:59:13,762 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:13,762 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:13,762 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:13,763 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:59:13,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:59:13,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:14,065 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:14,066 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:14,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:59:14,194 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:59:14,194 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:14,325 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:14,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:14,331 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:14,338 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:59:14,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:14,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:59:14,345 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:14,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:14,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:59:14,354 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:14,357 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:14,359 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:14,361 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:14,364 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:14,366 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:14,369 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:14,371 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:14,374 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:14,377 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:14,379 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:14,388 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:14,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:59:14,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:59:14,394 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:59:14,399 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:14,399 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:59:14,407 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:14,407 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:59:14,407 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:14,423 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:14,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:59:14,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:59:14,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:14,432 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:14,433 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:14,433 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:14,433 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:14,433 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:59:14,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:14,434 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:59:14,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:14,435 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:59:14,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:59:14,436 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:14,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:59:14,436 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:14,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:14,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:14,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:59:14,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:59:14,437 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:59:14,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:59:14,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:59:14,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:59:14,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:59:14,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:59:14,438 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:59:14,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:59:14,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:59:14,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:59:14,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:14,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:59:14,439 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:14,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:14,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:14,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:59:14,440 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:59:14,440 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:59:14,441 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:59:14,445 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:59:14,445 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:14,446 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:14,446 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:14,448 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 155/400.
2025-08-04 20:59:14,549 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:14,549 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:14,550 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:59:14,551 - ClientAppLogger [Client 0] - INFO - [Client] Round 155: Training GAN with 31 samples (24 normal, 7 anomalous).
2025-08-04 20:59:14,551 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:14,577 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0816, Avg D Loss: 0.7847
2025-08-04 20:59:14,577 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0816, Avg D Loss: 0.7847
2025-08-04 20:59:14,577 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:14,591 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5025, Threshold=0.5232, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:59:14,591 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 20:59:14,591 - ClientAppLogger [Client 0] - INFO - Fit completed for round 155. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 155, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0815616607666017, 'd_loss': 0.7846921384334564, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14328980445861816, 'cpu_percent_fit': 5.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 31}
2025-08-04 20:59:14,591 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:59:25,869 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:25,870 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:25,870 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:25,870 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:59:25,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:59:25,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:26,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:26,254 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:26,364 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:59:26,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:59:26,393 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:26,500 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:26,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:26,508 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:26,513 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:59:26,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:26,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:59:26,520 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:26,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:26,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:59:26,530 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:26,533 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,536 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:26,538 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:26,541 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:26,543 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:26,545 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,548 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:26,550 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:26,552 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:26,555 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:26,565 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:26,565 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:59:26,570 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:59:26,570 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:59:26,576 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:26,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:59:26,588 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:26,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:59:26,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:26,605 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:26,610 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:59:26,615 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:59:26,615 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:26,615 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:26,615 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:26,616 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:26,616 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:26,616 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:59:26,617 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:26,617 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:59:26,617 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:26,618 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:59:26,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:59:26,619 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:26,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:59:26,619 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:26,619 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:59:26,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:59:26,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:59:26,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:59:26,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:59:26,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:59:26,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:59:26,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:59:26,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:26,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:59:26,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:26,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:26,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:26,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:59:26,623 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:59:26,623 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:59:26,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:59:26,626 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:59:26,627 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:26,628 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:26,628 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:26,629 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:26,630 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:26,630 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:26,630 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:26,645 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5293, Threshold=0.5602, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:59:26,646 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5293
2025-08-04 20:59:37,929 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:37,929 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:37,930 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:37,930 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:59:37,930 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:59:37,930 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:38,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:38,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:38,402 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:59:38,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:59:38,422 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:38,553 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:38,560 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:38,561 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:38,566 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:59:38,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:38,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:59:38,575 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:38,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:38,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:59:38,586 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:38,589 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,592 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:38,594 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:38,597 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:38,599 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:38,602 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,605 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:38,608 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:38,610 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:38,612 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:38,623 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:38,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:59:38,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:59:38,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:59:38,635 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:38,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:59:38,649 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:38,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:59:38,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:38,666 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:38,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:59:38,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:59:38,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:38,678 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:38,678 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:38,678 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:38,679 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:38,679 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:59:38,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:38,679 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:59:38,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:38,681 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:59:38,681 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:59:38,681 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:59:38,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:59:38,683 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:59:38,683 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:59:38,683 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:59:38,683 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:59:38,683 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:59:38,683 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:59:38,684 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:59:38,684 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:59:38,684 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:38,684 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:59:38,685 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:38,685 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:38,685 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:38,685 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:59:38,686 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:59:38,686 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:59:38,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:59:38,692 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:59:38,692 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:38,693 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:38,693 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:38,694 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:38,695 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:38,695 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:38,696 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:38,710 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5072, Threshold=0.5609, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:59:38,710 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5072
2025-08-04 20:59:53,001 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:53,001 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:53,001 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:53,001 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:59:53,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:59:53,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:53,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:53,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:53,416 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:59:53,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:59:53,468 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:53,635 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:53,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:53,645 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:53,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:59:53,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:53,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:59:53,664 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:53,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:53,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:59:53,676 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:53,680 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:53,683 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:53,685 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:53,688 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:53,691 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:53,694 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:53,696 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:53,699 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:53,701 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:53,704 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:53,717 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:53,717 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:59:53,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:59:53,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:59:53,731 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:53,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:59:53,745 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:53,746 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:59:53,746 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:53,765 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:53,770 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:59:53,785 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:59:53,786 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:53,786 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:53,786 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:53,786 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:53,787 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:53,787 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:59:53,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:53,787 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:59:53,788 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:53,789 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:59:53,789 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:59:53,790 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:53,790 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:59:53,790 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:53,790 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:53,791 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:53,791 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:59:53,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:59:53,791 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:59:53,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:59:53,792 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:59:53,792 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:59:53,792 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:59:53,792 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:59:53,792 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:59:53,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:59:53,793 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:59:53,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:59:53,793 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:53,793 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:59:53,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:53,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:53,794 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:53,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:59:53,795 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:59:53,795 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:59:53,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:59:53,804 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:59:53,804 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:53,805 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:53,806 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:53,807 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:53,807 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:53,807 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:53,808 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:53,823 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5133, Threshold=0.5372, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 20:59:53,823 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5133
