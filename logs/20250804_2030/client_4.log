2025-08-04 20:30:00,188 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:00,188 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:30:00,188 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:30:00,189 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:30:00,189 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:30:00,189 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:00,468 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:00,468 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:00,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:30:00,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:30:00,575 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:00,669 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:00,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:00,677 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:00,683 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:30:00,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:00,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:30:00,693 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:00,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:00,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:30:00,703 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:00,706 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:00,708 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:00,710 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:00,714 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:00,717 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:00,719 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:00,722 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:00,725 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:00,727 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:00,729 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:00,739 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:00,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:30:00,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:30:00,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:30:00,748 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:00,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:30:00,756 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:00,756 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:30:00,756 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:00,770 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:00,775 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:30:00,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:30:00,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:00,779 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:00,780 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:00,780 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:00,780 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:00,780 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:30:00,780 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:00,780 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:30:00,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:00,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:30:00,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:30:00,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:30:00,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:30:00,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:30:00,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:30:00,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:30:00,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:30:00,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:30:00,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:30:00,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:30:00,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:30:00,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:00,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:30:00,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:00,786 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:00,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:00,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:30:00,790 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:30:00,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:30:00,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:30:00,793 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:30:00,793 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:00,795 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:00,795 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:30:00,797 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 41/400.
2025-08-04 20:30:00,898 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:00,898 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:00,899 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 18 anomalous samples to GAN training data (target: 18).
2025-08-04 20:30:00,900 - ClientAppLogger [Client 4] - INFO - [Client] Round 41: Training GAN with 79 samples (61 normal, 18 anomalous).
2025-08-04 20:30:00,900 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:00,974 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0903, Avg D Loss: 0.8692
2025-08-04 20:30:00,975 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0903, Avg D Loss: 0.8692
2025-08-04 20:30:00,975 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:01,017 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3558, Threshold=0.3754, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:30:01,017 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7854
2025-08-04 20:30:01,018 - ClientAppLogger [Client 4] - INFO - Fit completed for round 41. Duration: 0.22s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 41, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.090331925621516, 'd_loss': 0.8691969098169592, 'post_fit_local_f1': 0.7854362262422716, 'fit_time_seconds': 0.2207036018371582, 'cpu_percent_fit': 18.25, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 79}
2025-08-04 20:30:01,018 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:30:06,301 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:06,301 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:30:06,301 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:30:06,302 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:30:06,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:30:06,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:06,720 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:06,720 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:06,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:30:06,853 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:30:06,853 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:06,985 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:06,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:06,995 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:07,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:30:07,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:07,008 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:30:07,008 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:07,008 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:07,008 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:30:07,018 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:07,021 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:07,024 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:07,027 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:07,030 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:07,032 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:07,036 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:07,039 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:07,043 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:07,045 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:07,048 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:07,058 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:07,058 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:30:07,063 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:30:07,063 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:30:07,071 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:07,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:30:07,084 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:07,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:30:07,085 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:07,103 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:07,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:30:07,116 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:30:07,116 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:07,116 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:07,116 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:07,117 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:07,117 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:07,117 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:30:07,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:07,117 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:30:07,118 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:07,119 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:30:07,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:30:07,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:07,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:30:07,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:07,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:07,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:07,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:30:07,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:30:07,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:30:07,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:30:07,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:30:07,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:30:07,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:30:07,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:30:07,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:30:07,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:30:07,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:30:07,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:30:07,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:07,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:30:07,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:07,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:07,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:07,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:30:07,124 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:30:07,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:30:07,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:30:07,133 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:30:07,133 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:07,134 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:07,136 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:30:07,138 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:07,138 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:07,138 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:07,138 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:07,182 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3476, Threshold=0.3673, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:30:07,182 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3476
2025-08-04 20:30:18,454 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:18,454 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:30:18,454 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:30:18,454 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:30:18,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:30:18,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:18,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:18,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:18,820 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:30:18,858 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:30:18,858 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:18,950 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:18,956 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:18,956 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:18,961 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:30:18,967 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:18,967 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:30:18,967 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:18,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:18,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:30:18,977 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:18,980 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:18,983 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:18,984 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:18,987 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:18,989 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:18,992 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:18,995 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:18,998 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:19,000 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:19,002 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:19,012 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:19,013 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:30:19,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:30:19,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:30:19,022 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:19,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:30:19,031 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:19,032 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:30:19,032 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:19,048 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:19,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:30:19,062 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:30:19,063 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:19,063 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:19,063 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:19,064 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:19,064 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:19,064 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:30:19,065 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:19,065 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:30:19,065 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:19,067 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:30:19,067 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:30:19,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:19,068 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:30:19,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:19,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:19,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:19,069 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:30:19,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:30:19,069 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:30:19,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:30:19,069 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:30:19,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:30:19,070 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:30:19,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:30:19,071 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:30:19,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:30:19,071 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:30:19,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:30:19,072 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:19,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:30:19,072 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:19,073 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:19,073 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:19,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:30:19,073 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:30:19,073 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:30:19,074 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:30:19,078 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:30:19,078 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:19,080 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:19,080 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:30:19,082 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:19,082 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:19,082 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:19,083 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:19,133 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3376, Threshold=0.3570, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:30:19,133 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3376
2025-08-04 20:30:33,446 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:33,446 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:30:33,446 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:30:33,446 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:30:33,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:30:33,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:33,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:33,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:33,893 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:30:33,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:30:33,925 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:34,063 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:34,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:34,071 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:34,092 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:30:34,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:34,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:30:34,106 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:34,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:34,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:30:34,120 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:34,123 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:34,126 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:34,128 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:34,131 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:34,133 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:34,135 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:34,138 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:34,141 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:34,143 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:34,145 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:34,154 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:34,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:30:34,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:30:34,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:30:34,164 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:34,164 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:30:34,174 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:34,174 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:30:34,175 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:34,192 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:34,196 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:30:34,201 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:30:34,201 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:34,202 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:34,202 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:34,202 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:34,202 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:34,203 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:30:34,203 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:34,203 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:30:34,203 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:34,204 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:30:34,205 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:30:34,205 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:34,205 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:30:34,205 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:34,205 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:34,205 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:34,206 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:30:34,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:30:34,206 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:30:34,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:30:34,206 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:30:34,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:30:34,207 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:30:34,207 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:30:34,207 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:30:34,207 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:30:34,207 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:30:34,207 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:30:34,208 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:34,208 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:30:34,208 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:34,208 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:34,208 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:34,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:30:34,209 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:30:34,209 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:30:34,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:30:34,216 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:30:34,216 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:34,218 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:34,218 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:30:34,220 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:34,220 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:34,220 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:34,221 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:34,263 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3451, Threshold=0.3651, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:30:34,263 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3451
2025-08-04 20:30:48,578 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:48,579 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:30:48,579 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:30:48,579 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:30:48,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:30:48,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:49,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:30:49,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:30:49,078 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:49,198 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:49,207 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:49,208 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:49,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:30:49,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:49,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:30:49,223 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:49,223 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:49,223 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:30:49,233 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:49,236 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,240 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:49,242 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:49,245 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:49,247 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:49,250 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,252 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:49,255 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:49,258 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:49,260 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:49,272 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:49,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:30:49,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:30:49,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:30:49,284 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:49,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:30:49,297 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:49,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:30:49,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:49,319 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:49,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:30:49,330 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:30:49,330 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:49,330 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:49,331 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:49,331 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:49,331 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:49,331 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:30:49,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:49,332 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:30:49,332 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:49,333 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:30:49,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:30:49,333 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:49,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:30:49,334 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:30:49,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:30:49,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:30:49,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:30:49,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:30:49,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:30:49,336 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:30:49,336 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:30:49,336 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:49,336 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:30:49,336 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:49,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:49,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:49,337 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:30:49,337 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:30:49,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:30:49,337 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:30:49,342 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:30:49,342 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:49,343 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:49,344 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:30:49,345 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:49,345 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:49,345 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:49,346 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:49,390 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3362, Threshold=0.3554, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:30:49,390 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3362
2025-08-04 20:31:03,652 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:03,652 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:31:03,652 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:31:03,652 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:31:03,652 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:31:03,652 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:03,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:03,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:04,002 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:31:04,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:31:04,028 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:04,118 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:04,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:04,124 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:04,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:31:04,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:04,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:31:04,136 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:04,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:04,137 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:31:04,145 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:04,148 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:04,150 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:04,153 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:04,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:04,158 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:04,161 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:04,163 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:04,166 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:04,168 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:04,170 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:04,180 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:04,180 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:31:04,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:31:04,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:31:04,190 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:04,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:31:04,200 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:04,201 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:31:04,201 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:04,218 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:04,224 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:31:04,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:31:04,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:04,233 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:04,233 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:04,234 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:04,234 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:04,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:31:04,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:04,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:31:04,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:04,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:31:04,236 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:31:04,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:04,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:31:04,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:04,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:04,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:04,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:31:04,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:31:04,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:31:04,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:31:04,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:31:04,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:31:04,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:31:04,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:31:04,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:31:04,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:31:04,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:31:04,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:31:04,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:04,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:31:04,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:04,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:04,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:04,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:31:04,241 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:31:04,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:31:04,242 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:31:04,246 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:31:04,246 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:04,248 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:04,248 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:31:04,250 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:04,250 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:04,250 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:04,251 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:04,297 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3438, Threshold=0.3626, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:31:04,297 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3438
2025-08-04 20:31:24,591 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:24,591 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:31:24,591 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:31:24,591 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:31:24,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:31:24,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:24,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:24,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:25,027 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:31:25,075 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:31:25,075 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:25,207 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:25,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:25,214 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:25,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:31:25,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:25,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:31:25,228 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:25,228 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:25,228 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:31:25,238 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:25,241 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:25,243 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:25,245 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:25,248 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:25,251 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:25,254 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:25,257 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:25,260 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:25,263 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:25,265 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:25,274 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:25,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:31:25,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:31:25,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:31:25,285 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:25,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:31:25,294 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:25,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:31:25,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:25,309 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:25,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:31:25,319 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:31:25,320 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:25,320 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:25,320 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:25,320 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:25,320 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:25,321 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:31:25,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:25,321 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:31:25,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:25,322 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:31:25,322 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:31:25,323 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:25,323 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:31:25,323 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:25,323 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:25,323 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:25,323 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:31:25,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:31:25,324 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:31:25,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:31:25,324 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:31:25,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:31:25,324 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:31:25,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:31:25,325 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:31:25,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:31:25,325 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:31:25,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:31:25,326 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:25,326 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:31:25,326 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:25,327 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:25,327 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:25,327 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:31:25,327 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:31:25,327 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:31:25,328 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:31:25,331 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:31:25,331 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:25,333 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:25,333 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:31:25,334 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:25,335 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:25,335 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:25,336 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:25,376 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3459, Threshold=0.3649, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:31:25,377 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3459
2025-08-04 20:31:36,672 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:36,672 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:31:36,673 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:31:36,673 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:31:36,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:31:36,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:36,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:36,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:37,068 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:31:37,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:31:37,094 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:37,194 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:37,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:37,206 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:37,216 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:31:37,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:37,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:31:37,231 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:37,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:37,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:31:37,240 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:37,244 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:37,247 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:37,249 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:37,252 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:37,254 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:37,257 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:37,260 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:37,263 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:37,265 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:37,267 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:37,278 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:37,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:31:37,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:31:37,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:31:37,289 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:37,289 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:31:37,302 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:37,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:31:37,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:37,320 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:37,326 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:31:37,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:31:37,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:37,334 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:37,335 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:37,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:31:37,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:37,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:31:37,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:37,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:31:37,337 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:31:37,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:37,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:31:37,338 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:37,338 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:37,338 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:37,338 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:31:37,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:31:37,339 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:31:37,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:31:37,339 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:31:37,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:31:37,339 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:31:37,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:31:37,340 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:31:37,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:31:37,340 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:31:37,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:31:37,340 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:37,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:31:37,341 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:37,341 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:37,341 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:37,342 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:31:37,342 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:31:37,342 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:31:37,342 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:31:37,349 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:31:37,349 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:37,350 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:37,350 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:31:37,352 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:37,352 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:37,352 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:37,353 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:37,396 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3254, Threshold=0.3429, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:31:37,396 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3254
2025-08-04 20:31:48,709 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:48,709 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:31:48,709 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:31:48,710 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:31:48,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:31:48,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:49,197 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:49,197 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:49,290 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:31:49,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:31:49,331 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:49,477 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:49,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:49,486 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:49,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:31:49,510 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:49,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:31:49,511 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:49,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:49,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:31:49,523 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:49,527 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,529 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:49,531 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:49,534 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:49,537 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:49,541 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,543 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:49,547 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:49,549 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:49,551 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:49,565 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:49,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:31:49,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:31:49,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:31:49,576 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:49,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:31:49,590 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:49,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:31:49,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:49,611 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:49,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:31:49,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:49,631 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:49,632 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:49,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:31:49,632 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:49,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:31:49,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:49,634 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:31:49,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:31:49,635 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:49,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:31:49,635 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:49,635 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:49,636 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:49,636 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:31:49,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:31:49,636 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:31:49,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:31:49,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:31:49,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:31:49,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:31:49,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:31:49,638 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:31:49,638 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:31:49,638 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:31:49,638 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:31:49,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:49,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:31:49,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:49,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:49,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:49,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:31:49,640 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:31:49,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:31:49,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:31:49,647 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:31:49,647 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:49,649 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:49,649 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:31:49,651 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:49,651 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:49,652 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:49,653 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:49,709 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3453, Threshold=0.3652, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:31:49,710 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3453
2025-08-04 20:32:07,011 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:07,011 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:32:07,011 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:32:07,011 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:32:07,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:32:07,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:07,311 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:07,311 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:07,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:32:07,431 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:32:07,431 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:07,521 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:07,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:07,529 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:07,536 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:32:07,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:07,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:32:07,546 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:07,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:07,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:32:07,555 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:07,558 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:07,560 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:07,562 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:07,565 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:07,567 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:07,570 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:07,572 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:07,575 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:07,577 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:07,580 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:07,589 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:07,589 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:32:07,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:32:07,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:32:07,599 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:07,599 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:32:07,608 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:07,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:32:07,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:07,624 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:07,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:32:07,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:32:07,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:07,636 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:07,636 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:07,636 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:07,637 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:07,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:32:07,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:07,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:32:07,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:07,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:32:07,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:32:07,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:07,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:32:07,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:07,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:32:07,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:32:07,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:32:07,641 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:32:07,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:32:07,641 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:32:07,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:32:07,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:07,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:32:07,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:07,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:07,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:07,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:32:07,643 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:32:07,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:32:07,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:32:07,650 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:32:07,650 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:07,651 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:07,652 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:32:07,653 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:07,698 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3492, Threshold=0.3733, Accuracy=0.6902, F1=0.7859, Precision=0.9475, Recall=0.6714
2025-08-04 20:32:07,698 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6902, F1: 0.7859, Prec: 0.9475, Rec: 0.6714, Avg Anomaly Score: 0.3492
2025-08-04 20:32:18,965 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:18,965 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:32:18,965 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:32:18,965 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:32:18,966 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:32:18,966 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:19,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:19,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:19,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:32:19,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:32:19,402 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:19,494 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:19,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:19,500 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:19,506 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:32:19,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:19,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:32:19,514 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:19,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:19,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:32:19,524 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:19,527 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:19,529 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:19,532 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:19,535 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:19,537 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:19,540 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:19,542 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:19,546 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:19,548 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:19,550 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:19,560 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:19,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:32:19,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:32:19,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:32:19,571 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:19,571 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:32:19,584 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:19,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:32:19,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:19,602 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:19,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:32:19,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:32:19,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:19,614 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:19,614 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:19,615 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:19,615 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:19,615 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:32:19,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:19,615 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:32:19,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:19,617 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:32:19,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:32:19,617 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:19,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:32:19,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:32:19,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:32:19,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:32:19,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:32:19,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:32:19,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:32:19,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:32:19,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:32:19,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:32:19,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:19,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:32:19,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:19,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:19,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:19,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:32:19,622 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:32:19,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:32:19,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:32:19,627 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:32:19,627 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:19,628 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:19,628 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:32:19,630 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:19,630 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:19,630 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:19,631 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:19,679 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3430, Threshold=0.3655, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:32:19,680 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3430
2025-08-04 20:32:30,962 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:30,962 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:32:30,962 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:32:30,963 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:32:30,963 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:32:30,963 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:31,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:31,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:31,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:32:31,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:32:31,412 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:31,525 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:31,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:31,534 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:31,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:32:31,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:31,558 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:32:31,558 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:31,559 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:31,559 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:32:31,569 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:31,572 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,575 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:31,578 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:31,581 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:31,583 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:31,587 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,591 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:31,594 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:31,596 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:31,599 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:31,611 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:31,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:32:31,616 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:32:31,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:32:31,624 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:31,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:32:31,637 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:31,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:32:31,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:31,656 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:31,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:32:31,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:32:31,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:31,676 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:31,676 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:31,677 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:31,677 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:31,677 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:32:31,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:31,678 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:32:31,678 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:31,679 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:32:31,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:32:31,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:31,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:32:31,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:31,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:31,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:31,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:32:31,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:32:31,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:32:31,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:32:31,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:32:31,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:32:31,682 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:32:31,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:32:31,683 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:32:31,683 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:32:31,683 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:32:31,683 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:32:31,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:31,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:32:31,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:31,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:31,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:31,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:32:31,685 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:32:31,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:32:31,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:32:31,694 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:32:31,694 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:31,696 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:31,696 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:32:31,697 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:31,698 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:31,698 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:31,698 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:31,748 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3502, Threshold=0.3757, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:32:31,748 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3502
2025-08-04 20:32:46,037 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:46,037 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:32:46,037 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:32:46,037 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:32:46,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:32:46,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:46,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:46,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:46,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:32:46,471 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:32:46,471 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:46,588 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:46,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:46,596 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:46,606 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:32:46,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:46,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:32:46,626 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:46,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:46,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:32:46,636 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:46,639 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,641 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:46,644 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:46,647 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:46,649 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:46,652 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,654 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:46,658 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:46,660 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:46,662 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:46,674 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:46,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:32:46,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:32:46,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:32:46,686 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:46,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:32:46,696 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:46,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:32:46,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:46,713 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:46,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:32:46,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:32:46,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:46,725 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:46,725 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:46,726 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:46,726 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:46,726 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:32:46,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:46,727 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:32:46,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:46,729 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:32:46,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:32:46,729 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:46,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:32:46,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:46,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:46,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:46,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:32:46,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:32:46,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:32:46,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:32:46,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:32:46,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:32:46,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:32:46,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:32:46,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:32:46,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:32:46,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:32:46,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:32:46,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:46,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:32:46,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:46,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:46,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:46,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:32:46,735 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:32:46,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:32:46,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:32:46,739 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:32:46,739 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:46,740 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:46,740 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:32:46,742 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:46,742 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:46,742 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:46,743 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:46,787 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3612, Threshold=0.3887, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:32:46,788 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3612
2025-08-04 20:33:04,076 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:04,077 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:33:04,077 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:33:04,077 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:33:04,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:33:04,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:04,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:04,360 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:04,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:33:04,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:33:04,486 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:04,584 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:04,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:04,593 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:04,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:33:04,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:04,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:33:04,612 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:04,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:04,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:33:04,622 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:04,625 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,627 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:04,629 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:04,632 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:04,635 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:04,637 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,640 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:04,643 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:04,645 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:04,647 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:04,658 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:04,658 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:33:04,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:33:04,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:33:04,669 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:04,669 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:33:04,683 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:04,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:33:04,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:04,701 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:04,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:33:04,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:33:04,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:04,716 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:04,717 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:04,717 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:04,717 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:04,718 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:33:04,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:04,718 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:33:04,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:04,720 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:33:04,720 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:33:04,720 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:04,720 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:33:04,721 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:04,721 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:04,721 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:04,721 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:33:04,721 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:33:04,721 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:33:04,722 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:33:04,722 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:33:04,722 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:33:04,722 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:33:04,722 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:33:04,723 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:33:04,723 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:33:04,723 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:33:04,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:33:04,724 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:04,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:33:04,724 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:04,724 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:04,725 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:04,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:33:04,725 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:33:04,725 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:33:04,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:33:04,730 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:33:04,730 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:04,731 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:04,731 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:33:04,733 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:04,733 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:04,733 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:04,734 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:04,779 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3626, Threshold=0.3920, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:33:04,780 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3626
2025-08-04 20:33:16,050 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:16,050 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:33:16,050 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:33:16,051 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:33:16,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:33:16,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:16,293 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:16,293 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:16,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:33:16,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:33:16,413 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:16,577 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:16,586 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:16,586 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:16,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:33:16,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:16,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:33:16,608 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:16,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:16,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:33:16,618 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:16,621 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:16,624 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:16,626 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:16,629 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:16,631 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:16,634 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:16,637 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:16,640 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:16,642 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:16,645 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:16,658 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:16,658 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:33:16,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:33:16,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:33:16,670 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:16,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:33:16,686 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:16,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:33:16,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:16,708 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:16,715 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:33:16,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:33:16,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:16,725 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:16,725 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:16,725 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:16,725 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:16,726 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:33:16,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:16,726 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:33:16,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:16,728 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:33:16,728 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:33:16,728 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:16,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:33:16,729 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:16,729 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:16,729 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:16,729 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:33:16,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:33:16,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:33:16,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:33:16,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:33:16,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:33:16,730 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:33:16,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:33:16,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:33:16,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:33:16,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:33:16,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:33:16,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:16,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:33:16,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:16,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:16,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:16,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:33:16,734 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:33:16,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:33:16,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:33:16,741 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:33:16,741 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:16,743 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:16,743 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:33:16,744 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:16,744 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:16,744 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:16,745 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:16,788 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3473, Threshold=0.3740, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:33:16,788 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3473
2025-08-04 20:33:31,051 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:31,051 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:33:31,051 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:33:31,051 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:33:31,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:33:31,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:31,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:31,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:31,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:33:31,443 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:33:31,444 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:31,592 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:31,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:31,602 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:31,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:33:31,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:31,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:33:31,618 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:31,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:31,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:33:31,628 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:31,632 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:31,634 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:31,636 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:31,639 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:31,641 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:31,644 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:31,646 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:31,649 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:31,651 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:31,654 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:31,666 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:31,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:33:31,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:33:31,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:33:31,679 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:31,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:33:31,697 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:31,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:33:31,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:31,717 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:31,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:33:31,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:33:31,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:31,734 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:31,734 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:31,734 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:31,735 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:31,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:33:31,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:31,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:33:31,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:31,737 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:33:31,737 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:33:31,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:31,738 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:33:31,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:31,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:31,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:31,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:33:31,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:33:31,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:33:31,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:33:31,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:33:31,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:33:31,740 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:33:31,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:33:31,741 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:33:31,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:33:31,741 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:33:31,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:33:31,742 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:31,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:33:31,742 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:31,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:31,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:31,743 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:33:31,743 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:33:31,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:33:31,743 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:33:31,750 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:33:31,750 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:31,752 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:31,752 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:33:31,753 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:31,753 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:31,753 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:31,754 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:31,804 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3259, Threshold=0.3478, Accuracy=0.6862, F1=0.7831, Precision=0.9442, Recall=0.6690
2025-08-04 20:33:31,805 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6862, F1: 0.7831, Prec: 0.9442, Rec: 0.6690, Avg Anomaly Score: 0.3259
2025-08-04 20:33:49,078 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:49,078 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:33:49,078 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:33:49,078 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:33:49,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:33:49,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:49,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:49,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:49,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:33:49,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:33:49,461 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:49,557 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:49,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:49,564 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:49,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:33:49,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:49,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:33:49,609 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:49,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:49,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:33:49,618 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:49,621 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:49,623 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:49,625 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:49,628 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:49,630 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:49,634 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:49,637 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:49,639 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:49,641 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:49,644 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:49,654 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:49,654 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:33:49,659 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:33:49,660 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:33:49,664 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:49,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:33:49,677 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:49,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:33:49,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:49,692 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:49,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:33:49,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:33:49,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:49,704 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:49,704 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:49,705 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:49,705 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:49,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:33:49,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:49,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:33:49,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:49,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:33:49,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:33:49,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:49,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:33:49,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:33:49,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:33:49,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:33:49,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:33:49,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:33:49,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:33:49,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:33:49,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:33:49,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:33:49,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:49,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:33:49,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:49,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:49,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:49,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:33:49,712 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:33:49,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:33:49,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:33:49,719 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:33:49,719 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:49,720 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:49,721 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:33:49,722 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:49,722 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:49,722 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:49,723 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:49,763 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3622, Threshold=0.3907, Accuracy=0.6872, F1=0.7838, Precision=0.9453, Recall=0.6694
2025-08-04 20:33:49,764 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6872, F1: 0.7838, Prec: 0.9453, Rec: 0.6694, Avg Anomaly Score: 0.3622
2025-08-04 20:34:01,018 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:01,018 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:01,018 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:01,019 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:01,019 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:01,019 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:01,243 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:01,244 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:01,327 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:01,363 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:01,363 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:01,458 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:01,465 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:01,466 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:01,474 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:01,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:01,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:01,484 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:01,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:01,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:01,494 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:01,497 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:01,499 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:01,501 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:01,504 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:01,506 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:01,508 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:01,511 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:01,513 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:01,515 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:01,518 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:01,528 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:01,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:01,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:01,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:01,539 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:01,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:01,551 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:01,552 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:01,552 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:01,568 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:01,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:01,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:01,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:01,585 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:01,585 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:01,586 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:01,586 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:01,586 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:01,586 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:01,587 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:01,587 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:01,588 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:01,588 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:01,589 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:01,589 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:01,589 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:01,589 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:01,589 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:01,589 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:01,590 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:01,590 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:01,590 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:01,590 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:01,590 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:01,591 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:01,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:01,592 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:01,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:01,592 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:01,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:01,592 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:01,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:01,593 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:01,593 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:01,593 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:01,593 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:01,594 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:01,594 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:01,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:01,601 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:01,601 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:01,602 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:01,603 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:01,604 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:01,604 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:01,604 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:01,605 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:01,647 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3578, Threshold=0.3854, Accuracy=0.6862, F1=0.7831, Precision=0.9442, Recall=0.6690
2025-08-04 20:34:01,647 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6862, F1: 0.7831, Prec: 0.9442, Rec: 0.6690, Avg Anomaly Score: 0.3578
2025-08-04 20:34:12,910 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:12,910 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:12,910 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:12,910 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:12,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:12,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:13,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:13,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:13,308 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:13,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:13,340 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:13,451 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:13,459 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:13,459 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:13,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:13,510 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:13,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:13,511 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:13,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:13,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:13,521 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:13,524 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:13,526 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:13,529 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:13,531 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:13,534 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:13,538 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:13,540 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:13,543 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:13,545 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:13,548 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:13,560 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:13,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:13,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:13,566 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:13,571 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:13,571 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:13,585 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:13,586 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:13,586 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:13,602 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:13,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:13,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:13,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:13,613 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:13,613 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:13,614 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:13,614 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:13,615 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:13,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:13,615 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:13,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:13,617 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:13,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:13,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:13,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:13,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:13,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:13,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:13,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:13,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:13,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:13,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:13,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:13,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:13,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:13,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:13,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:13,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:13,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:13,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:13,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:13,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:13,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:13,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:13,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:13,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:13,624 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:13,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:13,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:13,631 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:13,631 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:13,632 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:13,632 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:13,634 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:13,634 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:13,634 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:13,635 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:13,691 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3674, Threshold=0.3978, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:34:13,692 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6842, F1: 0.7818, Prec: 0.9426, Rec: 0.6678, Avg Anomaly Score: 0.3674
2025-08-04 20:34:18,950 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:18,950 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:18,951 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:18,951 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:18,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:18,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:19,211 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:19,211 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:19,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:19,329 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:19,330 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:19,422 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:19,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:19,428 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:19,434 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:19,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:19,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:19,440 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:19,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:19,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:19,450 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:19,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:19,455 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:19,458 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:19,461 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:19,463 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:19,466 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:19,469 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:19,473 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:19,477 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:19,480 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:19,492 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:19,492 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:19,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:19,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:19,503 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:19,503 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:19,514 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:19,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:19,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:19,531 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:19,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:19,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:19,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:19,546 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:19,546 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:19,547 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:19,547 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:19,548 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:19,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:19,549 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:19,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:19,551 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:19,552 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:19,552 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:19,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:19,553 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:19,554 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:19,555 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:19,556 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:19,556 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:19,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:19,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:19,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:19,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:19,558 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:19,558 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:19,559 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:19,559 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:19,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:19,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:19,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:19,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:19,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:19,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:19,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:19,562 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:19,562 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:19,562 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:19,562 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:19,567 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:19,567 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:19,569 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:19,569 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:19,571 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 59/400.
2025-08-04 20:34:19,672 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:19,673 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:19,674 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 26 anomalous samples to GAN training data (target: 26).
2025-08-04 20:34:19,674 - ClientAppLogger [Client 4] - INFO - [Client] Round 59: Training GAN with 114 samples (88 normal, 26 anomalous).
2025-08-04 20:34:19,675 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:19,795 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0819, Avg D Loss: 0.8393
2025-08-04 20:34:19,795 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0819, Avg D Loss: 0.8393
2025-08-04 20:34:19,796 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:19,847 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3881, Threshold=0.4208, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:34:19,848 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7818
2025-08-04 20:34:19,849 - ClientAppLogger [Client 4] - INFO - Fit completed for round 59. Duration: 0.28s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 59, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0818815473924603, 'd_loss': 0.8393177423560829, 'post_fit_local_f1': 0.7817723837874971, 'fit_time_seconds': 0.27741169929504395, 'cpu_percent_fit': 18.08125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 114}
2025-08-04 20:34:19,849 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:34:28,103 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:28,103 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:28,103 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:28,103 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:28,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:28,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:28,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:28,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:28,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:28,443 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:28,444 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:28,549 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:28,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:28,555 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:28,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:28,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:28,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:28,573 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:28,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:28,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:28,583 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:28,586 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:28,588 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:28,590 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:28,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:28,595 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:28,598 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:28,600 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:28,603 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:28,605 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:28,608 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:28,617 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:28,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:28,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:28,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:28,628 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:28,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:28,640 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:28,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:28,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:28,657 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:28,662 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:28,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:28,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:28,671 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:28,671 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:28,671 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:28,672 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:28,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:28,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:28,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:28,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:28,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:28,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:28,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:28,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:28,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:28,677 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:28,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:28,677 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:28,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:28,678 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:28,678 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:28,678 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:28,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:28,679 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:28,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:28,679 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:28,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:28,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:28,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:28,681 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:28,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:28,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:28,685 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:28,685 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:28,687 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:28,688 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:28,689 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:28,689 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:28,689 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:28,690 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:28,732 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3639, Threshold=0.3962, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:34:28,732 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6842, F1: 0.7818, Prec: 0.9426, Rec: 0.6678, Avg Anomaly Score: 0.3639
2025-08-04 20:34:33,985 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:33,985 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:33,985 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:33,985 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:33,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:33,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:34,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:34,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:34,307 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:34,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:34,341 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:34,423 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:34,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:34,428 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:34,433 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:34,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:34,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:34,441 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:34,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:34,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:34,450 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:34,452 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:34,455 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:34,457 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:34,459 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:34,461 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:34,464 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:34,466 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:34,469 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:34,471 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:34,473 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:34,481 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:34,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:34,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:34,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:34,490 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:34,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:34,499 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:34,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:34,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:34,515 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:34,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:34,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:34,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:34,526 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:34,526 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:34,526 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:34,527 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:34,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:34,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:34,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:34,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:34,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:34,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:34,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:34,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:34,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:34,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:34,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:34,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:34,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:34,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:34,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:34,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:34,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:34,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:34,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:34,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:34,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:34,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:34,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:34,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:34,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:34,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:34,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:34,534 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:34,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:34,534 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:34,534 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:34,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:34,537 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:34,538 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:34,539 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:34,539 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:34,540 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 60/400.
2025-08-04 20:34:34,641 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:34,641 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:34,642 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 26 anomalous samples to GAN training data (target: 26).
2025-08-04 20:34:34,643 - ClientAppLogger [Client 4] - INFO - [Client] Round 60: Training GAN with 115 samples (89 normal, 26 anomalous).
2025-08-04 20:34:34,643 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:34,733 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0827, Avg D Loss: 0.8374
2025-08-04 20:34:34,733 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0827, Avg D Loss: 0.8374
2025-08-04 20:34:34,733 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:34,774 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3746, Threshold=0.4055, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:34:34,774 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7818
2025-08-04 20:34:34,775 - ClientAppLogger [Client 4] - INFO - Fit completed for round 60. Duration: 0.23s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 60, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.082673198658487, 'd_loss': 0.8374267101287842, 'post_fit_local_f1': 0.7817723837874971, 'fit_time_seconds': 0.23409748077392578, 'cpu_percent_fit': 18.74375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 115}
2025-08-04 20:34:34,775 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:34:40,042 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,042 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:40,042 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:40,042 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:40,042 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:40,042 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:40,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:40,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:40,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:40,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:40,394 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:40,501 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:40,507 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:40,507 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:40,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:40,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:40,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:40,529 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:40,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:40,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:40,539 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:40,542 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:40,544 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:40,546 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:40,549 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:40,552 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:40,555 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:40,558 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:40,560 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:40,562 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:40,565 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:40,575 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:40,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:40,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:40,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:40,585 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:40,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:40,597 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:40,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:40,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:40,612 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:40,616 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:40,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:40,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:40,621 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:40,621 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:40,622 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:40,622 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:40,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:40,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:40,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:40,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:40,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:40,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:40,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:40,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:40,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:40,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:40,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:40,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:40,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:40,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:40,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:40,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:40,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:40,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:40,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:40,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:40,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:40,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:40,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:40,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:40,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:40,628 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:40,628 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:40,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:40,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:40,629 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:40,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:40,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:40,631 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:40,631 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:40,632 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:40,633 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:40,634 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:40,634 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:40,635 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:40,635 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:40,685 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3551, Threshold=0.3839, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:34:40,686 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6842, F1: 0.7818, Prec: 0.9426, Rec: 0.6678, Avg Anomaly Score: 0.3551
2025-08-04 20:34:45,934 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:45,935 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:45,935 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:45,935 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:45,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:45,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:46,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:46,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:46,249 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:46,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:46,286 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:46,369 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:46,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:46,374 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:46,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:46,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:46,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:46,385 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:46,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:46,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:46,393 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:46,396 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:46,398 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:46,400 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:46,403 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:46,405 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:46,407 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:46,409 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:46,412 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:46,414 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:46,416 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:46,424 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:46,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:46,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:46,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:46,433 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:46,433 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:46,441 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:46,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:46,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:46,455 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:46,460 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:46,466 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:46,466 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:46,466 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:46,466 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:46,467 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:46,467 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:46,467 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:46,467 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:46,467 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:46,468 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:46,469 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:46,469 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:46,469 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:46,470 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:46,471 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:46,471 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:46,471 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:46,471 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:46,471 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:46,472 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:46,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:46,472 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:46,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:46,472 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:46,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:46,473 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:46,473 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:46,473 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:46,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:46,473 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:46,473 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:46,474 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:46,479 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:46,480 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:46,480 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:46,481 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:46,482 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 61/400.
2025-08-04 20:34:46,583 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:46,584 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:46,585 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 27 anomalous samples to GAN training data (target: 27).
2025-08-04 20:34:46,585 - ClientAppLogger [Client 4] - INFO - [Client] Round 61: Training GAN with 117 samples (90 normal, 27 anomalous).
2025-08-04 20:34:46,585 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:46,679 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0846, Avg D Loss: 0.8460
2025-08-04 20:34:46,679 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0846, Avg D Loss: 0.8460
2025-08-04 20:34:46,680 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:46,724 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3882, Threshold=0.4198, Accuracy=0.6849, F1=0.7822, Precision=0.9431, Recall=0.6682
2025-08-04 20:34:46,724 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7822
2025-08-04 20:34:46,724 - ClientAppLogger [Client 4] - INFO - Fit completed for round 61. Duration: 0.24s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 61, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084593400384626, 'd_loss': 0.846013118670537, 'post_fit_local_f1': 0.782230364094344, 'fit_time_seconds': 0.24193334579467773, 'cpu_percent_fit': 18.2125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 117}
2025-08-04 20:34:46,724 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:34:51,974 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:51,974 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:34:51,974 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:34:51,975 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:34:51,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:34:51,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:52,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:52,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:52,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:34:52,326 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:34:52,327 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:52,421 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:52,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:52,428 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:52,434 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:34:52,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:52,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:34:52,442 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:52,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:52,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:34:52,451 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:52,454 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:52,456 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:52,458 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:52,461 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:52,463 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:52,466 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:52,468 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:52,471 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:52,473 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:52,475 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:52,486 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:52,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:34:52,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:34:52,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:34:52,497 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:52,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:34:52,510 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:52,510 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:34:52,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:52,528 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:52,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:34:52,541 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:34:52,541 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:52,541 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:52,541 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:52,542 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:52,542 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:52,542 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:34:52,542 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:52,543 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:34:52,543 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:52,544 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:34:52,544 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:34:52,545 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:52,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:34:52,545 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:52,545 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:52,545 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:52,546 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:34:52,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:34:52,546 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:34:52,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:34:52,547 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:34:52,547 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:34:52,547 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:34:52,548 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:34:52,548 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:34:52,548 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:34:52,548 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:34:52,548 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:34:52,549 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:52,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:34:52,549 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:52,550 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:52,550 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:52,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:34:52,550 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:34:52,550 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:34:52,551 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:34:52,556 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:34:52,556 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:52,558 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:52,558 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:34:52,559 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:52,560 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:52,560 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:52,560 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:52,605 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3606, Threshold=0.3887, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:34:52,605 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6842, F1: 0.7818, Prec: 0.9426, Rec: 0.6678, Avg Anomaly Score: 0.3606
2025-08-04 20:35:00,855 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:00,855 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:00,855 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:00,855 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:00,856 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:00,856 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:01,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:01,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:01,176 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:01,208 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:01,209 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:01,290 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:01,296 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:01,296 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:01,301 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:01,306 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:01,306 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:01,306 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:01,307 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:01,307 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:01,315 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:01,318 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:01,320 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:01,322 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:01,325 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:01,327 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:01,329 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:01,331 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:01,334 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:01,336 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:01,338 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:01,347 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:01,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:01,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:01,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:01,356 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:01,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:01,365 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:01,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:01,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:01,380 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:01,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:01,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:01,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:01,390 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:01,390 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:01,390 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:01,391 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:01,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:01,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:01,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:01,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:01,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:01,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:01,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:01,394 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:01,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:01,394 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:01,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:01,394 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:01,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:01,396 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:01,396 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:01,396 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:01,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:01,396 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:01,397 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:01,397 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:01,400 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:01,400 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:01,401 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:01,401 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:01,402 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 62/400.
2025-08-04 20:35:01,503 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:01,504 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:01,505 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 27 anomalous samples to GAN training data (target: 27).
2025-08-04 20:35:01,505 - ClientAppLogger [Client 4] - INFO - [Client] Round 62: Training GAN with 119 samples (92 normal, 27 anomalous).
2025-08-04 20:35:01,505 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:01,600 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.8322
2025-08-04 20:35:01,600 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.8322
2025-08-04 20:35:01,600 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:01,642 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3866, Threshold=0.4159, Accuracy=0.6836, F1=0.7813, Precision=0.9420, Recall=0.6674
2025-08-04 20:35:01,642 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7813
2025-08-04 20:35:01,643 - ClientAppLogger [Client 4] - INFO - Fit completed for round 62. Duration: 0.24s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 62, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083833415167672, 'd_loss': 0.8322344053693179, 'post_fit_local_f1': 0.7813144034806503, 'fit_time_seconds': 0.2401127815246582, 'cpu_percent_fit': 18.39375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 119}
2025-08-04 20:35:01,643 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:35:09,898 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:09,898 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:09,898 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:09,898 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:09,899 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:09,899 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:10,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:10,118 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:10,199 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:10,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:10,227 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:10,312 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:10,317 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:10,317 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:10,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:10,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:10,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:10,335 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:10,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:10,336 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:10,345 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:10,347 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:10,350 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:10,352 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:10,355 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:10,358 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:10,360 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:10,363 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:10,366 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:10,368 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:10,370 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:10,380 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:10,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:10,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:10,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:10,390 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:10,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:10,399 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:10,399 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:10,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:10,415 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:10,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:10,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:10,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:10,425 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:10,425 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:10,426 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:10,426 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:10,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:10,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:10,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:10,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:10,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:10,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:10,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:10,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:10,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:10,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:10,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:10,431 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:10,431 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:10,431 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:10,431 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:10,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:10,432 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:10,432 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:10,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:10,434 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:10,435 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:10,436 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:10,436 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:10,438 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:10,438 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:10,438 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:10,439 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:10,480 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3667, Threshold=0.4000, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:35:10,480 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6842, F1: 0.7818, Prec: 0.9426, Rec: 0.6678, Avg Anomaly Score: 0.3667
2025-08-04 20:35:15,726 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:15,727 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:15,727 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:15,727 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:15,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:15,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:15,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:15,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:16,059 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:16,096 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:16,096 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:16,179 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:16,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:16,184 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:16,189 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:16,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:16,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:16,195 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:16,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:16,196 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:16,204 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:16,207 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:16,209 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:16,211 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:16,214 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:16,216 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:16,219 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:16,221 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:16,224 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:16,226 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:16,228 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:16,237 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:16,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:16,242 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:16,242 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:16,246 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:16,246 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:16,255 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:16,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:16,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:16,270 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:16,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:16,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:16,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:16,281 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:16,281 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:16,281 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:16,281 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:16,282 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:16,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:16,282 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:16,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:16,283 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:16,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:16,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:16,285 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:16,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:16,285 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:16,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:16,285 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:16,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:16,286 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:16,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:16,286 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:16,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:16,286 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:16,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:16,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:16,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:16,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:16,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:16,288 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:16,288 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:16,288 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:16,294 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:16,294 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:16,295 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:16,295 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:16,297 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 63/400.
2025-08-04 20:35:16,397 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:16,398 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:16,399 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 27 anomalous samples to GAN training data (target: 27).
2025-08-04 20:35:16,399 - ClientAppLogger [Client 4] - INFO - [Client] Round 63: Training GAN with 120 samples (93 normal, 27 anomalous).
2025-08-04 20:35:16,399 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:16,490 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0827, Avg D Loss: 0.8326
2025-08-04 20:35:16,490 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0827, Avg D Loss: 0.8326
2025-08-04 20:35:16,490 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:16,529 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3886, Threshold=0.4212, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:35:16,529 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7818
2025-08-04 20:35:16,529 - ClientAppLogger [Client 4] - INFO - Fit completed for round 63. Duration: 0.23s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 63, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0827009503046674, 'd_loss': 0.8325929188728333, 'post_fit_local_f1': 0.7817723837874971, 'fit_time_seconds': 0.23270320892333984, 'cpu_percent_fit': 18.48125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 120}
2025-08-04 20:35:16,530 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:35:21,778 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:21,778 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:21,778 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:21,778 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:21,778 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:21,778 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:22,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:22,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:22,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:22,116 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:22,116 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:22,203 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:22,207 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:22,207 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:22,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:22,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:22,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:22,222 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:22,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:22,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:22,231 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:22,233 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:22,236 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:22,239 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:22,243 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:22,245 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:22,247 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:22,250 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:22,253 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:22,255 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:22,257 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:22,265 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:22,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:22,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:22,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:22,275 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:22,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:22,284 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:22,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:22,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:22,300 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:22,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:22,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:22,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:22,310 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:22,310 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:22,311 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:22,311 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:22,311 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:22,311 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:22,312 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:22,312 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:22,313 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:22,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:22,314 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:22,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:22,315 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:22,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:22,315 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:22,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:22,315 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:22,316 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:22,316 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:22,316 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:22,316 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:22,316 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:22,316 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:22,317 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:22,317 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:22,317 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:22,317 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:22,317 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:22,318 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:22,320 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:22,320 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:22,321 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:22,321 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:22,322 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:22,323 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:22,323 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:22,323 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:22,364 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3831, Threshold=0.4164, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:35:22,365 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6842, F1: 0.7818, Prec: 0.9426, Rec: 0.6678, Avg Anomaly Score: 0.3831
2025-08-04 20:35:33,630 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:33,630 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:33,630 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:33,630 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:33,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:33,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:33,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:33,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:33,981 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:34,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:34,023 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:34,118 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:34,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:34,124 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:34,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:34,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:34,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:34,137 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:34,137 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:34,137 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:34,146 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:34,149 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:34,151 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:34,153 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:34,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:34,158 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:34,161 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:34,163 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:34,166 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:34,168 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:34,170 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:34,180 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:34,180 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:34,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:34,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:34,189 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:34,189 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:34,198 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:34,198 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:34,198 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:34,213 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:34,218 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:34,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:34,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:34,225 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:34,226 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:34,226 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:34,226 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:34,227 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:34,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:34,227 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:34,228 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:34,230 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:34,230 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:34,230 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:34,230 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:34,230 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:34,231 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:34,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:34,232 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:34,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:34,232 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:34,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:34,233 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:34,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:34,233 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:34,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:34,233 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:34,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:34,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:34,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:34,234 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:34,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:34,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:34,238 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:34,238 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:34,240 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:34,240 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:34,241 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:34,241 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:34,241 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:34,242 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:34,284 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3547, Threshold=0.3892, Accuracy=0.6856, F1=0.7827, Precision=0.9437, Recall=0.6686
2025-08-04 20:35:34,284 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6856, F1: 0.7827, Prec: 0.9437, Rec: 0.6686, Avg Anomaly Score: 0.3547
2025-08-04 20:35:45,546 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:45,546 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:45,546 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:45,547 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:45,547 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:45,547 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:45,818 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:45,818 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:45,900 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:45,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:45,927 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:46,011 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:46,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:46,016 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:46,021 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:46,027 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:46,027 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:46,027 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:46,027 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:46,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:46,037 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:46,040 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,042 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:46,044 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:46,047 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:46,050 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:46,053 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,056 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:46,059 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:46,062 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:46,064 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:46,075 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:46,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:46,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:46,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:46,086 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:46,086 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:46,096 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:46,097 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:46,097 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:46,112 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:46,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:46,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:46,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:46,121 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:46,121 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:46,122 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:46,122 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:46,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:46,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:46,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:46,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:46,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:46,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:46,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:46,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:46,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:46,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:46,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:46,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:46,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:46,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:46,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:46,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:46,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:46,129 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:46,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:46,129 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:46,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:46,130 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:46,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:46,130 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:46,131 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:46,132 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:46,132 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:46,132 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:46,132 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:46,133 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:46,133 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:46,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:46,137 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:46,137 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:46,138 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:46,138 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:46,140 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:46,140 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:46,140 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:46,141 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:46,183 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3690, Threshold=0.4083, Accuracy=0.6862, F1=0.7831, Precision=0.9442, Recall=0.6690
2025-08-04 20:35:46,183 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6862, F1: 0.7831, Prec: 0.9442, Rec: 0.6690, Avg Anomaly Score: 0.3690
2025-08-04 20:35:51,440 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:51,440 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:51,440 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:51,440 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:51,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:51,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:51,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:51,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:51,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:51,778 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:51,778 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:51,862 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:51,867 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:51,867 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:51,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:51,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:51,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:51,877 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:51,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:51,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:51,885 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:51,888 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:51,890 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:51,892 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:51,895 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:51,897 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:51,900 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:51,902 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:51,905 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:51,907 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:51,909 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:51,918 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:51,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:51,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:51,923 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:51,928 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:51,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:51,938 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:51,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:51,939 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:51,953 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:51,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:51,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:51,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:51,964 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:51,964 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:51,965 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:51,965 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:51,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:51,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:51,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:51,966 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:51,967 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:51,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:51,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:51,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:51,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:51,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:51,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:51,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:51,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:51,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:51,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:51,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:51,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:51,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:51,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:51,972 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:51,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:51,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:51,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:51,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:51,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:51,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:51,975 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:51,975 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:51,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:51,975 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:51,976 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:51,977 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:51,982 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:51,982 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:51,984 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:51,984 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:51,985 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 66/400.
2025-08-04 20:35:52,087 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:52,087 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:52,088 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 29 anomalous samples to GAN training data (target: 29).
2025-08-04 20:35:52,088 - ClientAppLogger [Client 4] - INFO - [Client] Round 66: Training GAN with 126 samples (97 normal, 29 anomalous).
2025-08-04 20:35:52,088 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:52,186 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0823, Avg D Loss: 0.8370
2025-08-04 20:35:52,186 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0823, Avg D Loss: 0.8370
2025-08-04 20:35:52,186 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:52,227 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3961, Threshold=0.4350, Accuracy=0.6856, F1=0.7827, Precision=0.9437, Recall=0.6686
2025-08-04 20:35:52,227 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7827
2025-08-04 20:35:52,227 - ClientAppLogger [Client 4] - INFO - Fit completed for round 66. Duration: 0.24s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 66, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.082289930373903, 'd_loss': 0.8370455590505447, 'post_fit_local_f1': 0.7826883444011907, 'fit_time_seconds': 0.2420508861541748, 'cpu_percent_fit': 18.20625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 126}
2025-08-04 20:35:52,228 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:35:57,479 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:57,479 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:35:57,479 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:35:57,479 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:35:57,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:35:57,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:57,721 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:57,721 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:57,804 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:35:57,833 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:35:57,833 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:57,920 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:57,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:57,926 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:57,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:35:57,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:57,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:35:57,942 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:57,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:57,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:35:57,951 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:57,954 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:57,957 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:57,959 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:57,962 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:57,964 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:57,970 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:57,972 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:57,975 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:57,977 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:57,979 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:57,989 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:57,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:35:57,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:35:57,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:35:57,999 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:57,999 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:35:58,008 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:58,009 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:35:58,009 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:58,024 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:58,029 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:35:58,034 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:35:58,034 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:58,034 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:58,034 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:58,034 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:58,034 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:58,035 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:35:58,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:58,035 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:35:58,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:58,036 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:35:58,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:35:58,037 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:58,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:35:58,037 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:58,037 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:58,037 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:58,037 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:35:58,038 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:35:58,039 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:35:58,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:35:58,039 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:35:58,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:35:58,040 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:58,040 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:35:58,040 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:58,040 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:58,040 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:58,041 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:35:58,041 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:35:58,041 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:35:58,041 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:35:58,043 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:35:58,043 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:58,045 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:58,045 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:35:58,047 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:58,047 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:58,047 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:58,048 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:58,095 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3802, Threshold=0.4174, Accuracy=0.6856, F1=0.7827, Precision=0.9437, Recall=0.6686
2025-08-04 20:35:58,096 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6856, F1: 0.7827, Prec: 0.9437, Rec: 0.6686, Avg Anomaly Score: 0.3802
2025-08-04 20:36:03,371 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:03,371 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:36:03,372 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:36:03,372 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:36:03,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:36:03,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:03,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:03,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:03,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:36:03,722 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:36:03,723 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:03,806 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:03,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:03,812 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:03,817 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:36:03,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:03,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:36:03,822 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:03,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:03,823 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:36:03,831 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:03,833 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:03,836 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:03,838 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:03,840 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:03,843 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:03,845 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:03,849 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:03,852 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:03,854 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:03,856 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:03,865 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:03,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:36:03,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:36:03,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:36:03,876 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:03,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:36:03,885 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:03,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:36:03,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:03,901 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:03,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:36:03,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:36:03,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:03,912 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:03,912 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:03,913 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:03,913 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:03,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:36:03,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:03,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:36:03,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:03,915 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:36:03,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:36:03,915 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:03,916 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:36:03,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:03,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:03,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:03,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:36:03,916 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:36:03,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:36:03,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:36:03,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:36:03,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:36:03,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:36:03,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:36:03,918 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:36:03,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:36:03,918 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:36:03,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:36:03,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:03,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:36:03,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:03,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:03,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:03,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:36:03,920 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:36:03,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:36:03,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:36:03,923 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:36:03,923 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:03,925 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:03,925 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:36:03,926 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 67/400.
2025-08-04 20:36:04,028 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:04,028 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:04,029 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 29 anomalous samples to GAN training data (target: 29).
2025-08-04 20:36:04,030 - ClientAppLogger [Client 4] - INFO - [Client] Round 67: Training GAN with 126 samples (97 normal, 29 anomalous).
2025-08-04 20:36:04,030 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:04,124 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8346
2025-08-04 20:36:04,124 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8346
2025-08-04 20:36:04,124 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:04,164 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4017, Threshold=0.4358, Accuracy=0.6842, F1=0.7818, Precision=0.9426, Recall=0.6678
2025-08-04 20:36:04,165 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7818
2025-08-04 20:36:04,165 - ClientAppLogger [Client 4] - INFO - Fit completed for round 67. Duration: 0.24s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 67, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0832326438691875, 'd_loss': 0.8345745105592032, 'post_fit_local_f1': 0.7817723837874971, 'fit_time_seconds': 0.23855137825012207, 'cpu_percent_fit': 18.66875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 126}
2025-08-04 20:36:04,165 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:36:15,440 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:15,440 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:36:15,440 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:36:15,440 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:36:15,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:36:15,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:15,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:15,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:15,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:36:15,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:36:15,784 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:15,871 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:15,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:15,878 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:15,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:36:15,891 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:15,891 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:36:15,892 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:15,892 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:15,892 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:36:15,901 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:15,904 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:15,906 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:15,908 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:15,911 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:15,913 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:15,916 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:15,918 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:15,921 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:15,923 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:15,926 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:15,936 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:15,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:36:15,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:36:15,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:36:15,947 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:15,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:36:15,957 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:15,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:36:15,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:15,974 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:15,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:36:15,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:36:15,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:15,986 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:15,986 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:15,987 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:15,987 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:15,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:36:15,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:15,988 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:36:15,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:15,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:36:15,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:36:15,990 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:36:15,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:36:15,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:36:15,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:36:15,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:36:15,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:36:15,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:36:15,992 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:36:15,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:36:15,992 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:36:15,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:36:15,993 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:15,993 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:36:15,993 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:15,993 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:15,994 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:15,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:36:15,994 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:36:15,994 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:36:15,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:36:15,998 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:36:15,998 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:15,999 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:15,999 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:36:16,001 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:16,001 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:16,001 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:16,002 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:16,043 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3646, Threshold=0.4005, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:36:16,044 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3646
2025-08-04 20:36:27,302 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:27,302 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:36:27,302 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:36:27,303 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:36:27,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:36:27,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:27,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:27,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:27,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:36:27,669 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:36:27,669 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:27,757 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:27,762 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:27,763 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:27,768 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:36:27,773 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:27,773 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:36:27,774 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:27,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:27,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:36:27,782 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:27,785 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:27,787 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:27,790 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:27,793 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:27,795 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:27,798 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:27,800 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:27,803 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:27,804 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:27,807 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:27,817 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:27,817 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:36:27,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:36:27,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:36:27,828 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:27,828 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:36:27,839 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:27,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:36:27,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:27,855 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:27,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:36:27,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:36:27,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:27,866 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:27,867 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:27,867 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:27,867 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:27,868 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:36:27,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:27,868 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:36:27,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:27,869 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:36:27,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:36:27,870 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:27,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:36:27,870 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:27,870 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:27,870 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:27,871 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:36:27,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:36:27,871 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:36:27,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:36:27,871 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:36:27,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:36:27,872 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:36:27,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:36:27,872 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:36:27,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:36:27,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:36:27,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:36:27,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:27,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:36:27,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:27,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:27,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:27,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:36:27,874 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:36:27,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:36:27,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:36:27,878 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:36:27,878 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:27,880 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:27,880 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:36:27,881 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:27,882 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:27,882 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:27,882 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:27,922 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3723, Threshold=0.4138, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:36:27,923 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3723
2025-08-04 20:36:33,172 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:33,172 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:36:33,172 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:36:33,172 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:36:33,172 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:36:33,172 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:33,434 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:33,434 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:33,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:36:33,547 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:36:33,547 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:33,630 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:33,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:33,635 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:33,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:36:33,655 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:33,656 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:36:33,656 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:33,657 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:33,657 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:36:33,666 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:33,669 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:33,671 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:33,673 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:33,676 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:33,678 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:33,681 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:33,683 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:33,686 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:33,688 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:33,690 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:33,698 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:33,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:36:33,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:36:33,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:36:33,707 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:33,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:36:33,716 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:33,717 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:36:33,717 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:33,731 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:33,736 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:36:33,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:36:33,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:33,742 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:33,742 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:33,743 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:33,743 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:33,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:36:33,743 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:33,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:36:33,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:33,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:36:33,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:36:33,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:36:33,746 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:36:33,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:36:33,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:36:33,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:36:33,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:36:33,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:36:33,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:36:33,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:36:33,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:36:33,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:33,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:36:33,749 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:33,749 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:33,749 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:33,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:36:33,749 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:36:33,750 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:36:33,750 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:36:33,752 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:36:33,752 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:33,753 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:33,754 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:36:33,755 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 69/400.
2025-08-04 20:36:33,856 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:33,856 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:33,858 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 30 anomalous samples to GAN training data (target: 30).
2025-08-04 20:36:33,858 - ClientAppLogger [Client 4] - INFO - [Client] Round 69: Training GAN with 130 samples (100 normal, 30 anomalous).
2025-08-04 20:36:33,858 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:33,970 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0809, Avg D Loss: 0.8346
2025-08-04 20:36:33,970 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0809, Avg D Loss: 0.8346
2025-08-04 20:36:33,970 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:34,011 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3859, Threshold=0.4266, Accuracy=0.6862, F1=0.7831, Precision=0.9442, Recall=0.6690
2025-08-04 20:36:34,011 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7831
2025-08-04 20:36:34,011 - ClientAppLogger [Client 4] - INFO - Fit completed for round 69. Duration: 0.26s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 69, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0808638015160192, 'd_loss': 0.8345519387722014, 'post_fit_local_f1': 0.7831463247080376, 'fit_time_seconds': 0.25595664978027344, 'cpu_percent_fit': 18.5375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 130}
2025-08-04 20:36:34,011 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:36:45,276 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:45,276 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:36:45,276 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:36:45,276 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:36:45,276 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:36:45,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:45,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:45,551 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:45,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:36:45,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:36:45,681 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:45,794 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:45,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:45,800 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:45,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:36:45,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:45,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:36:45,813 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:45,813 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:45,813 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:36:45,822 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:45,825 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:45,827 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:45,829 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:45,831 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:45,834 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:45,836 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:45,839 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:45,841 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:45,843 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:45,846 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:45,856 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:45,857 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:36:45,861 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:36:45,862 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:36:45,867 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:45,867 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:36:45,879 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:45,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:36:45,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:45,895 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:45,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:36:45,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:36:45,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:45,908 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:45,908 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:45,909 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:45,909 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:45,909 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:36:45,909 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:45,910 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:36:45,910 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:45,912 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:36:45,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:36:45,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:45,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:36:45,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:45,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:45,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:45,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:36:45,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:36:45,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:36:45,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:36:45,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:36:45,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:36:45,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:36:45,916 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:36:45,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:36:45,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:36:45,918 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:36:45,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:36:45,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:45,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:36:45,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:45,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:45,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:45,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:36:45,921 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:36:45,921 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:36:45,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:36:45,928 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:36:45,928 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:45,929 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:45,929 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:36:45,931 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:45,931 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:45,931 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:45,932 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:45,972 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3907, Threshold=0.4362, Accuracy=0.6935, F1=0.7882, Precision=0.9503, Recall=0.6733
2025-08-04 20:36:45,972 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6935, F1: 0.7882, Prec: 0.9503, Rec: 0.6733, Avg Anomaly Score: 0.3907
2025-08-04 20:37:00,239 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:00,239 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:37:00,239 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:37:00,239 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:37:00,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:37:00,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:00,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:00,571 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:00,657 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:37:00,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:37:00,684 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:00,861 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:00,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:00,869 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:00,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:37:00,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:00,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:37:00,919 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:00,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:00,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:37:00,932 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:00,935 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:00,937 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:00,940 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:00,943 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:00,945 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:00,948 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:00,950 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:00,953 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:00,955 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:00,958 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:00,969 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:00,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:37:00,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:37:00,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:37:00,983 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:00,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:37:01,005 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:01,006 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:37:01,006 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:01,025 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:01,032 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:37:01,040 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:37:01,040 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:01,041 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:01,041 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:01,042 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:01,042 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:01,043 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:37:01,043 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:01,043 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:37:01,043 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:01,045 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:37:01,045 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:37:01,046 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:01,046 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:37:01,046 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:01,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:01,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:01,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:37:01,047 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:37:01,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:37:01,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:37:01,048 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:37:01,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:37:01,048 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:37:01,049 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:37:01,050 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:37:01,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:37:01,050 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:37:01,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:37:01,050 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:01,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:37:01,051 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:01,051 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:01,051 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:01,052 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:37:01,052 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:37:01,052 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:37:01,052 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:37:01,061 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:37:01,061 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:01,062 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:01,062 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:37:01,064 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:01,064 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:01,064 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:01,065 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:01,114 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3790, Threshold=0.4321, Accuracy=0.7008, F1=0.7932, Precision=0.9564, Recall=0.6776
2025-08-04 20:37:01,115 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7008, F1: 0.7932, Prec: 0.9564, Rec: 0.6776, Avg Anomaly Score: 0.3790
2025-08-04 20:37:15,380 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:15,381 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:37:15,381 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:37:15,381 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:37:15,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:37:15,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:15,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:15,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:15,723 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:37:15,752 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:37:15,752 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:15,889 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:15,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:15,897 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:15,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:37:15,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:15,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:37:15,921 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:15,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:15,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:37:15,931 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:15,933 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:15,935 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:15,938 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:15,941 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:15,943 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:15,945 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:15,948 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:15,951 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:15,953 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:15,955 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:15,965 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:15,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:37:15,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:37:15,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:37:15,975 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:15,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:37:15,984 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:15,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:37:15,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:16,001 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:16,006 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:37:16,015 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:37:16,015 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:16,015 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:16,015 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:16,016 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:16,016 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:16,016 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:37:16,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:16,016 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:37:16,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:16,018 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:37:16,018 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:37:16,018 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:37:16,019 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:37:16,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:37:16,020 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:37:16,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:37:16,020 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:37:16,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:37:16,021 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:37:16,021 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:37:16,021 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:37:16,021 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:37:16,021 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:16,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:37:16,022 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:16,022 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:16,022 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:16,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:37:16,023 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:37:16,023 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:37:16,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:37:16,031 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:37:16,031 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:16,032 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:16,032 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:37:16,034 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:16,034 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:16,034 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:16,035 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:16,077 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3836, Threshold=0.4405, Accuracy=0.7101, F1=0.7996, Precision=0.9641, Recall=0.6831
2025-08-04 20:37:16,077 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7101, F1: 0.7996, Prec: 0.9641, Rec: 0.6831, Avg Anomaly Score: 0.3836
2025-08-04 20:37:27,345 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:27,345 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:37:27,345 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:37:27,346 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:37:27,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:37:27,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:27,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:27,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:27,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:37:27,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:37:27,726 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:27,817 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:27,824 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:27,824 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:27,830 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:37:27,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:27,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:37:27,838 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:27,838 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:27,838 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:37:27,847 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:27,850 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:27,852 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:27,854 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:27,857 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:27,859 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:27,861 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:27,864 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:27,866 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:27,868 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:27,870 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:27,881 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:27,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:37:27,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:37:27,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:37:27,894 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:27,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:37:27,908 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:27,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:37:27,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:27,925 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:27,931 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:37:27,945 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:37:27,945 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:27,945 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:27,945 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:27,946 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:27,946 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:27,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:37:27,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:27,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:37:27,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:27,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:37:27,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:37:27,953 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:27,955 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:37:27,958 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:27,960 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:27,963 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:27,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:37:27,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:37:27,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:37:27,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:37:27,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:37:27,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:37:27,972 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:37:27,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:37:27,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:37:27,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:37:27,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:37:27,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:37:27,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:27,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:37:27,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:27,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:27,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:27,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:37:27,975 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:37:27,975 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:37:27,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:37:27,979 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:37:27,979 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:27,981 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:27,981 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:37:27,982 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:27,983 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:27,983 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:27,983 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:28,029 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3595, Threshold=0.4154, Accuracy=0.7127, F1=0.8015, Precision=0.9663, Recall=0.6847
2025-08-04 20:37:28,031 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7127, F1: 0.8015, Prec: 0.9663, Rec: 0.6847, Avg Anomaly Score: 0.3595
2025-08-04 20:37:42,302 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:42,302 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:37:42,302 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:37:42,303 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:37:42,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:37:42,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:42,606 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:42,606 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:42,689 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:37:42,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:37:42,717 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:42,841 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:42,851 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:42,851 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:42,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:37:42,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:42,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:37:42,880 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:42,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:42,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:37:42,891 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:42,894 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:42,896 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:42,899 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:42,902 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:42,904 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:42,907 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:42,911 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:42,915 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:42,918 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:42,922 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:42,933 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:42,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:37:42,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:37:42,939 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:37:42,944 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:42,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:37:42,954 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:42,955 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:37:42,955 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:42,970 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:42,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:37:42,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:37:42,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:42,982 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:42,982 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:42,983 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:42,983 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:42,983 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:37:42,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:42,984 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:37:42,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:42,985 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:37:42,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:37:42,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:42,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:37:42,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:42,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:42,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:42,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:37:42,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:37:42,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:37:42,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:37:42,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:37:42,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:37:42,988 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:37:42,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:37:42,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:37:42,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:37:42,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:37:42,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:37:42,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:42,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:37:42,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:42,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:42,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:42,990 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:37:42,991 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:37:42,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:37:42,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:37:42,999 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:37:42,999 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:43,001 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:43,001 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:37:43,003 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:43,003 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:43,003 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:43,004 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:43,048 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3749, Threshold=0.4364, Accuracy=0.7227, F1=0.8083, Precision=0.9746, Recall=0.6905
2025-08-04 20:37:43,049 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7227, F1: 0.8083, Prec: 0.9746, Rec: 0.6905, Avg Anomaly Score: 0.3749
2025-08-04 20:37:54,309 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:54,310 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:37:54,310 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:37:54,310 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:37:54,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:37:54,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:54,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:54,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:54,662 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:37:54,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:37:54,695 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:54,787 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:54,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:54,797 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:54,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:37:54,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:54,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:37:54,810 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:54,810 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:54,810 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:37:54,818 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:54,821 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:54,823 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:54,826 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:54,829 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:54,831 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:54,834 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:54,836 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:54,839 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:54,841 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:54,843 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:54,853 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:54,853 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:37:54,858 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:37:54,858 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:37:54,863 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:54,863 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:37:54,872 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:54,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:37:54,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:54,887 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:54,892 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:37:54,899 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:37:54,900 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:54,900 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:54,900 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:54,900 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:54,900 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:54,901 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:37:54,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:54,901 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:37:54,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:54,902 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:37:54,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:37:54,903 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:54,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:37:54,904 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:54,904 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:54,904 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:54,904 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:37:54,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:37:54,905 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:37:54,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:37:54,905 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:37:54,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:37:54,905 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:37:54,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:37:54,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:37:54,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:37:54,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:37:54,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:37:54,907 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:54,907 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:37:54,907 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:54,907 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:54,907 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:54,907 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:37:54,908 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:37:54,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:37:54,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:37:54,912 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:37:54,912 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:54,914 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:54,914 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:37:54,916 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:54,916 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:54,916 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:54,916 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:54,960 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3804, Threshold=0.4400, Accuracy=0.7227, F1=0.8083, Precision=0.9746, Recall=0.6905
2025-08-04 20:37:54,960 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7227, F1: 0.8083, Prec: 0.9746, Rec: 0.6905, Avg Anomaly Score: 0.3804
2025-08-04 20:38:09,273 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:09,273 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:38:09,273 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:38:09,273 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:38:09,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:38:09,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:09,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:09,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:09,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:38:09,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:38:09,699 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:09,781 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:09,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:09,785 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:09,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:38:09,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:09,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:38:09,798 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:09,798 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:09,798 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:38:09,807 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:09,810 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,812 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:09,814 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:09,816 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:09,818 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:09,820 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,823 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:09,825 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:09,827 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:09,829 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:09,837 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:09,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:38:09,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:38:09,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:38:09,847 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:09,847 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:38:09,855 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:09,855 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:38:09,855 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:09,869 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:09,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:38:09,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:38:09,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:09,879 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:09,879 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:09,879 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:09,880 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:09,880 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:38:09,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:09,880 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:38:09,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:09,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:38:09,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:38:09,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:09,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:38:09,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:09,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:38:09,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:38:09,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:38:09,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:38:09,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:38:09,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:38:09,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:38:09,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:09,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:38:09,885 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:09,885 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:09,886 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:09,886 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:38:09,886 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:38:09,886 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:38:09,886 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:38:09,889 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:38:09,889 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:09,891 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:09,891 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:38:09,892 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:09,893 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:09,893 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:09,893 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:09,934 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3812, Threshold=0.4499, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:38:09,935 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.3812
2025-08-04 20:38:24,223 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:24,223 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:38:24,223 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:38:24,224 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:38:24,224 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:38:24,224 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:24,482 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:24,482 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:24,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:38:24,598 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:38:24,599 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:24,681 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:24,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:24,686 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:24,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:38:24,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:24,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:38:24,697 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:24,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:24,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:38:24,705 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:24,708 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,710 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:24,712 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:24,714 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:24,716 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:24,719 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,721 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:24,724 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:24,726 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:24,728 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:24,736 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:24,736 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:38:24,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:38:24,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:38:24,745 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:24,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:38:24,753 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:24,753 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:38:24,753 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:24,768 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:24,772 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:38:24,778 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:38:24,778 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:24,778 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:24,778 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:24,778 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:24,779 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:24,779 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:38:24,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:24,779 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:38:24,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:24,781 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:38:24,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:38:24,781 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:24,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:38:24,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:38:24,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:38:24,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:38:24,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:38:24,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:38:24,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:38:24,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:38:24,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:38:24,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:24,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:38:24,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:24,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:24,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:24,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:38:24,785 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:38:24,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:38:24,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:38:24,789 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:38:24,789 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:24,790 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:24,790 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:38:24,792 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:24,792 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:24,792 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:24,793 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:24,832 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3786, Threshold=0.4503, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:38:24,832 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.3786
2025-08-04 20:38:36,119 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:36,119 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:38:36,119 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:38:36,119 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:38:36,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:38:36,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:36,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:36,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:36,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:38:36,506 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:38:36,506 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:36,590 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:36,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:36,596 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:36,600 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:38:36,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:36,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:38:36,608 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:36,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:36,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:38:36,616 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:36,619 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,621 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:36,623 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:36,626 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:36,628 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:36,630 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,633 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:36,636 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:36,638 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:36,640 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:36,649 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:36,649 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:38:36,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:38:36,654 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:38:36,658 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:36,658 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:38:36,666 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:36,666 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:38:36,666 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:36,680 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:36,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:38:36,689 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:38:36,690 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:36,690 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:36,690 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:36,690 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:36,691 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:36,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:38:36,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:36,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:38:36,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:36,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:38:36,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:38:36,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:36,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:38:36,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:38:36,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:38:36,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:38:36,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:38:36,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:38:36,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:38:36,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:38:36,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:38:36,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:36,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:38:36,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:36,697 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:36,697 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:36,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:38:36,697 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:38:36,697 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:38:36,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:38:36,700 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:38:36,700 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:36,702 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:36,702 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:38:36,703 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:36,703 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:36,704 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:36,704 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:36,747 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3775, Threshold=0.4531, Accuracy=0.7260, F1=0.8106, Precision=0.9774, Recall=0.6925
2025-08-04 20:38:36,747 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7260, F1: 0.8106, Prec: 0.9774, Rec: 0.6925, Avg Anomaly Score: 0.3775
2025-08-04 20:38:48,037 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:48,037 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:38:48,037 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:38:48,037 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:38:48,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:38:48,038 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:48,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:48,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:48,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:38:48,460 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:38:48,460 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:48,555 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:48,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:48,561 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:48,567 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:38:48,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:48,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:38:48,573 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:48,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:48,574 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:38:48,583 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:48,586 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,588 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:48,590 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:48,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:48,595 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:48,598 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,600 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:48,603 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:48,605 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:48,607 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:48,617 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:48,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:38:48,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:38:48,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:38:48,627 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:48,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:38:48,636 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:48,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:38:48,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:48,653 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:48,657 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:38:48,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:38:48,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:48,664 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:48,664 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:48,664 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:48,664 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:48,664 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:38:48,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:48,665 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:38:48,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:48,666 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:38:48,666 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:38:48,667 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:48,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:38:48,667 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:48,667 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:48,668 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:48,668 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:38:48,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:38:48,668 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:38:48,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:38:48,669 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:38:48,669 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:38:48,669 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:38:48,669 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:38:48,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:38:48,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:38:48,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:38:48,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:38:48,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:48,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:38:48,671 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:48,671 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:48,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:48,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:38:48,672 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:38:48,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:38:48,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:38:48,676 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:38:48,676 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:48,677 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:48,677 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:38:48,679 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:48,679 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:48,679 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:48,680 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:48,721 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3780, Threshold=0.4515, Accuracy=0.7260, F1=0.8106, Precision=0.9774, Recall=0.6925
2025-08-04 20:38:48,722 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7260, F1: 0.8106, Prec: 0.9774, Rec: 0.6925, Avg Anomaly Score: 0.3780
2025-08-04 20:39:03,010 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:03,010 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:39:03,010 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:39:03,011 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:39:03,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:39:03,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:03,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:03,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:03,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:39:03,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:39:03,410 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:03,514 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:03,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:03,520 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:03,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:39:03,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:03,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:39:03,531 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:03,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:03,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:39:03,540 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:03,543 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,546 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:03,548 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:03,550 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:03,553 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:03,555 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,558 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:03,561 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:03,563 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:03,565 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:03,575 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:03,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:39:03,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:39:03,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:39:03,585 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:03,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:39:03,593 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:03,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:39:03,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:03,609 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:03,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:39:03,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:39:03,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:03,619 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:03,619 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:03,620 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:03,620 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:03,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:39:03,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:03,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:39:03,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:03,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:39:03,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:39:03,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:03,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:39:03,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:39:03,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:39:03,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:39:03,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:39:03,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:39:03,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:39:03,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:39:03,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:39:03,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:03,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:39:03,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:03,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:03,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:03,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:39:03,626 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:39:03,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:39:03,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:39:03,630 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:39:03,630 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:03,631 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:03,632 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:39:03,633 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:03,633 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:03,633 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:03,634 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:03,676 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3734, Threshold=0.4398, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:39:03,677 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.3734
2025-08-04 20:39:17,969 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:17,969 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:39:17,970 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:39:17,970 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:39:17,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:39:17,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:18,293 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:18,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:18,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:39:18,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:39:18,420 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:18,517 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:18,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:18,524 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:18,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:39:18,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:18,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:39:18,538 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:18,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:18,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:39:18,548 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:18,551 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,553 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:18,556 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:18,559 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:18,561 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:18,564 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,566 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:18,570 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:18,572 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:18,575 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:18,586 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:18,586 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:39:18,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:39:18,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:39:18,596 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:18,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:39:18,607 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:18,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:39:18,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:18,623 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:18,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:39:18,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:39:18,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:18,636 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:18,636 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:18,636 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:18,637 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:18,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:39:18,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:18,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:39:18,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:18,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:39:18,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:39:18,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:18,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:39:18,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:18,639 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:18,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:18,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:39:18,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:39:18,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:39:18,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:39:18,640 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:39:18,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:39:18,641 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:39:18,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:39:18,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:39:18,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:39:18,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:39:18,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:39:18,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:18,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:39:18,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:18,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:18,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:18,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:39:18,644 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:39:18,644 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:39:18,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:39:18,648 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:39:18,649 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:18,651 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:18,651 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:39:18,652 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:18,652 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:18,652 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:18,653 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:18,696 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3989, Threshold=0.4679, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:39:18,696 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.3989
2025-08-04 20:39:29,993 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:29,994 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:39:29,994 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:39:29,994 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:39:29,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:39:29,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:30,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:30,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:30,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:39:30,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:39:30,429 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:30,547 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:30,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:30,556 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:30,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:39:30,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:30,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:39:30,579 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:30,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:30,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:39:30,591 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:30,594 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,596 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:30,599 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:30,602 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:30,604 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:30,606 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,609 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:30,612 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:30,613 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:30,616 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:30,628 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:30,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:39:30,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:39:30,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:39:30,641 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:30,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:39:30,653 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:30,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:39:30,654 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:30,670 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:30,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:39:30,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:39:30,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:30,687 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:30,687 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:30,687 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:30,688 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:30,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:39:30,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:30,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:39:30,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:30,690 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:39:30,690 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:39:30,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:30,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:39:30,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:30,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:30,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:30,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:39:30,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:39:30,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:39:30,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:39:30,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:39:30,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:39:30,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:39:30,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:39:30,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:39:30,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:39:30,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:39:30,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:39:30,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:30,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:39:30,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:30,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:30,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:30,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:39:30,695 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:39:30,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:39:30,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:39:30,701 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:39:30,701 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:30,703 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:30,703 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:39:30,704 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:30,704 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:30,705 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:30,705 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:30,754 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3873, Threshold=0.4472, Accuracy=0.7240, F1=0.8093, Precision=0.9757, Recall=0.6913
2025-08-04 20:39:30,754 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7240, F1: 0.8093, Prec: 0.9757, Rec: 0.6913, Avg Anomaly Score: 0.3873
2025-08-04 20:39:42,048 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:42,048 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:39:42,049 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:39:42,049 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:39:42,049 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:39:42,049 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:42,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:42,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:42,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:39:42,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:39:42,463 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:42,581 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:42,587 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:42,587 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:42,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:39:42,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:42,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:39:42,602 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:42,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:42,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:39:42,611 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:42,614 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,616 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:42,619 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:42,622 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:42,624 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:42,626 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,629 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:42,631 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:42,633 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:42,636 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:42,647 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:42,647 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:39:42,652 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:39:42,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:39:42,659 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:42,659 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:39:42,674 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:42,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:39:42,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:42,693 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:42,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:39:42,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:39:42,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:42,705 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:42,705 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:42,706 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:42,706 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:42,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:39:42,706 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:42,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:39:42,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:42,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:39:42,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:39:42,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:42,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:39:42,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:42,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:42,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:42,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:39:42,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:39:42,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:39:42,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:39:42,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:39:42,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:39:42,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:39:42,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:39:42,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:39:42,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:39:42,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:39:42,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:39:42,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:42,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:39:42,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:42,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:42,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:42,713 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:39:42,713 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:39:42,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:39:42,714 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:39:42,718 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:39:42,718 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:42,720 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:42,720 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:39:42,722 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:42,722 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:42,722 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:42,723 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:42,769 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3760, Threshold=0.4298, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:39:42,769 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7247, F1: 0.8097, Prec: 0.9763, Rec: 0.6917, Avg Anomaly Score: 0.3760
2025-08-04 20:39:57,054 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:57,054 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:39:57,054 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:39:57,054 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:39:57,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:39:57,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:57,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:57,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:57,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:39:57,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:39:57,487 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:57,615 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:57,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:57,623 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:57,632 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:39:57,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:57,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:39:57,641 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:57,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:57,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:39:57,650 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:57,653 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:57,655 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:57,658 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:57,660 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:57,663 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:57,666 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:57,668 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:57,671 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:57,673 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:57,675 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:57,686 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:57,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:39:57,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:39:57,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:39:57,697 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:57,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:39:57,710 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:57,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:39:57,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:57,728 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:57,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:39:57,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:39:57,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:57,740 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:57,740 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:57,741 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:57,741 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:57,741 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:39:57,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:57,742 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:39:57,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:57,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:39:57,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:39:57,744 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:57,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:39:57,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:39:57,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:39:57,746 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:39:57,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:39:57,746 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:39:57,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:39:57,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:39:57,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:39:57,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:39:57,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:57,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:39:57,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:57,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:57,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:57,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:39:57,749 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:39:57,749 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:39:57,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:39:57,753 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:39:57,753 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:57,754 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:57,755 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:39:57,756 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:57,756 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:57,756 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:57,757 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:57,804 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4068, Threshold=0.4673, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:39:57,804 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4068
2025-08-04 20:40:12,096 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:12,096 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:40:12,096 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:40:12,096 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:40:12,096 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:40:12,097 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:12,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:12,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:12,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:40:12,551 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:40:12,552 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:12,655 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:12,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:12,662 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:12,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:40:12,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:12,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:40:12,676 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:12,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:12,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:40:12,685 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:12,688 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,690 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:12,692 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:12,695 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:12,697 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:12,700 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,702 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:12,705 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:12,707 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:12,709 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:12,719 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:12,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:40:12,723 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:40:12,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:40:12,728 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:12,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:40:12,738 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:12,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:40:12,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:12,757 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:12,763 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:40:12,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:40:12,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:12,774 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:12,774 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:12,775 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:12,775 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:12,775 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:40:12,775 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:12,776 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:40:12,776 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:12,777 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:40:12,777 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:40:12,778 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:12,778 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:40:12,778 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:12,778 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:12,778 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:12,778 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:40:12,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:40:12,779 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:40:12,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:40:12,779 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:40:12,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:40:12,779 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:40:12,780 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:40:12,780 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:40:12,780 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:40:12,781 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:40:12,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:40:12,781 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:12,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:40:12,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:12,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:12,782 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:12,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:40:12,783 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:40:12,783 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:40:12,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:40:12,788 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:40:12,788 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:12,790 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:12,790 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:40:12,792 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:12,792 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:12,793 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:12,793 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:12,843 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4099, Threshold=0.4700, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:40:12,843 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4099
2025-08-04 20:40:24,149 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:24,149 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:40:24,149 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:40:24,149 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:40:24,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:40:24,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:24,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:24,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:24,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:40:24,659 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:40:24,659 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:24,801 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:24,807 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:24,808 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:24,815 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:40:24,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:24,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:40:24,826 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:24,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:24,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:40:24,834 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:24,837 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,839 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:24,842 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:24,844 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:24,846 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:24,849 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,852 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:24,854 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:24,857 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:24,859 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:24,872 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:24,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:40:24,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:40:24,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:40:24,884 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:24,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:40:24,901 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:24,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:40:24,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:24,919 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:24,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:40:24,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:40:24,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:24,930 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:24,930 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:24,931 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:24,931 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:24,931 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:40:24,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:24,932 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:40:24,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:24,934 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:40:24,934 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:40:24,934 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:24,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:40:24,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:24,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:24,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:24,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:40:24,936 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:40:24,936 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:40:24,936 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:40:24,936 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:40:24,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:40:24,937 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:40:24,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:40:24,938 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:40:24,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:40:24,938 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:40:24,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:40:24,939 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:24,939 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:40:24,939 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:24,939 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:24,940 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:24,940 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:40:24,940 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:40:24,940 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:40:24,940 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:40:24,947 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:40:24,948 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:24,949 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:24,949 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:40:24,950 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:24,950 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:24,951 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:24,952 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:25,001 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3875, Threshold=0.4364, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:40:25,001 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.3875
2025-08-04 20:40:30,262 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:30,262 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:40:30,263 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:40:30,263 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:40:30,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:40:30,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:30,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:30,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:30,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:40:30,651 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:40:30,651 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:30,747 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:30,751 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:30,752 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:30,758 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:40:30,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:30,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:40:30,766 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:30,766 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:30,766 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:40:30,775 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:30,778 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:30,780 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:30,782 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:30,785 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:30,787 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:30,790 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:30,792 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:30,795 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:30,797 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:30,799 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:30,808 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:30,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:40:30,813 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:40:30,813 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:40:30,818 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:30,818 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:40:30,828 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:30,829 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:40:30,829 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:30,846 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:30,851 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:40:30,859 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:40:30,859 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:30,859 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:30,859 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:30,860 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:30,860 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:30,860 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:40:30,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:30,861 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:40:30,861 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:30,863 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:40:30,863 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:40:30,863 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:30,863 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:40:30,863 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:40:30,864 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:40:30,865 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:40:30,865 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:40:30,865 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:40:30,865 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:40:30,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:40:30,866 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:40:30,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:40:30,866 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:30,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:40:30,866 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:30,867 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:30,867 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:30,867 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:40:30,867 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:40:30,867 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:40:30,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:40:30,873 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:40:30,873 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:30,874 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:30,874 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:40:30,875 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 86/400.
2025-08-04 20:40:30,977 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:30,977 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:30,978 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 35 anomalous samples to GAN training data (target: 35).
2025-08-04 20:40:30,979 - ClientAppLogger [Client 4] - INFO - [Client] Round 86: Training GAN with 153 samples (118 normal, 35 anomalous).
2025-08-04 20:40:30,979 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:31,106 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8419
2025-08-04 20:40:31,106 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8419
2025-08-04 20:40:31,106 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:31,147 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4323, Threshold=0.5019, Accuracy=0.7240, F1=0.8093, Precision=0.9757, Recall=0.6913
2025-08-04 20:40:31,147 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8093
2025-08-04 20:40:31,148 - ClientAppLogger [Client 4] - INFO - Fit completed for round 86. Duration: 0.27s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 86, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.08406760412104, 'd_loss': 0.8419340093151417, 'post_fit_local_f1': 0.8092512021983055, 'fit_time_seconds': 0.27222180366516113, 'cpu_percent_fit': 18.64375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 153}
2025-08-04 20:40:31,148 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:40:39,423 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:39,424 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:40:39,424 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:40:39,424 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:40:39,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:40:39,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:39,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:39,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:40,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:40:40,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:40:40,081 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:40,212 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:40,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:40,221 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:40,229 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:40:40,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:40,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:40:40,241 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:40,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:40,242 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:40:40,252 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:40,256 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,259 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:40,262 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:40,264 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:40,267 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:40,270 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,273 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:40,276 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:40,279 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:40,281 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:40,296 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:40,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:40:40,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:40:40,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:40:40,313 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:40,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:40:40,338 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:40,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:40:40,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:40,365 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:40,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:40:40,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:40:40,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:40,380 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:40,380 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:40,380 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:40,381 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:40,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:40:40,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:40,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:40:40,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:40,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:40:40,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:40:40,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:40,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:40:40,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:40,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:40,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:40,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:40:40,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:40:40,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:40:40,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:40:40,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:40:40,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:40:40,387 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:40:40,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:40:40,387 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:40:40,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:40:40,388 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:40:40,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:40:40,388 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:40,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:40:40,389 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:40,389 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:40,390 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:40,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:40:40,390 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:40:40,390 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:40:40,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:40:40,396 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:40:40,396 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:40,397 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:40,398 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:40:40,400 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:40,400 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:40,400 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:40,401 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:40,454 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4194, Threshold=0.4843, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:40:40,455 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4194
2025-08-04 20:40:54,769 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:54,770 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:40:54,771 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:40:54,771 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:40:54,771 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:40:54,772 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:55,182 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:55,182 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:55,281 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:40:55,311 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:40:55,311 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:55,422 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:55,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:55,429 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:55,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:40:55,452 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:55,452 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:40:55,453 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:55,453 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:55,453 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:40:55,462 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:55,466 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,468 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:55,472 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:55,476 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:55,479 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:55,484 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,487 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:55,491 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:55,494 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:55,497 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:55,511 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:55,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:40:55,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:40:55,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:40:55,529 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:55,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:40:55,544 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:55,544 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:40:55,545 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:55,560 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:55,566 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:40:55,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:40:55,573 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:55,573 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:55,573 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:55,574 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:55,574 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:55,574 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:40:55,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:40:55,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:55,577 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:40:55,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:40:55,577 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:55,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:40:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:40:55,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:40:55,579 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:40:55,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:40:55,579 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:40:55,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:40:55,579 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:40:55,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:40:55,580 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:40:55,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:40:55,580 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:40:55,581 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:40:55,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:55,581 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:40:55,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:55,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:55,582 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:55,582 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:40:55,582 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:40:55,582 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:40:55,582 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:40:55,585 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:40:55,585 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:55,587 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:55,587 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:40:55,588 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:55,589 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:55,589 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:55,590 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:55,636 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4235, Threshold=0.4812, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:40:55,637 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4235
2025-08-04 20:41:09,914 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:09,914 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:41:09,915 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:41:09,915 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:41:09,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:41:09,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:10,301 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:10,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:10,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:41:10,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:41:10,441 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:10,591 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:10,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:10,601 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:10,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:41:10,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:10,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:41:10,627 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:10,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:10,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:41:10,638 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:10,642 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,644 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:10,647 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:10,650 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:10,653 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:10,655 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,658 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:10,661 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:10,663 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:10,666 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:10,680 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:10,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:41:10,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:41:10,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:41:10,691 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:10,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:41:10,707 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:10,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:41:10,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:10,726 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:10,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:41:10,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:41:10,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:10,741 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:10,742 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:10,742 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:10,743 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:10,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:41:10,743 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:10,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:41:10,743 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:10,745 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:41:10,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:41:10,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:10,746 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:41:10,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:10,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:10,746 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:10,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:41:10,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:41:10,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:41:10,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:41:10,747 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:41:10,747 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:41:10,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:41:10,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:41:10,749 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:41:10,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:41:10,749 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:10,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:41:10,750 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:41:10,751 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:41:10,758 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:41:10,758 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:10,759 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:10,759 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:41:10,761 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:10,761 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:10,761 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:10,762 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:10,815 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3924, Threshold=0.4374, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:41:10,815 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.3924
2025-08-04 20:41:22,102 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:22,102 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:41:22,102 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:41:22,103 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:41:22,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:41:22,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:22,494 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:22,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:22,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:41:22,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:41:22,640 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:22,772 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:22,780 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:22,780 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:22,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:41:22,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:22,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:41:22,823 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:22,823 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:22,823 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:41:22,835 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:22,839 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,842 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:22,844 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:22,847 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:22,850 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:22,853 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,856 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:22,859 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:22,861 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:22,863 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:22,876 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:22,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:41:22,881 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:41:22,881 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:41:22,887 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:22,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:41:22,907 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:22,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:41:22,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:22,927 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:22,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:41:22,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:41:22,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:22,941 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:22,941 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:22,942 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:22,942 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:22,942 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:41:22,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:22,943 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:41:22,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:22,944 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:41:22,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:41:22,945 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:22,945 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:41:22,945 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:22,945 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:41:22,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:41:22,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:41:22,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:41:22,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:41:22,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:41:22,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:41:22,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:41:22,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:22,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:41:22,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:22,951 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:22,951 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:22,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:41:22,951 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:41:22,952 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:41:22,952 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:41:22,959 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:41:22,960 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:22,961 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:22,961 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:41:22,963 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:22,963 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:22,963 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:22,964 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:23,022 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3967, Threshold=0.4336, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:41:23,022 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.3967
2025-08-04 20:41:28,274 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:28,274 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:41:28,275 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:41:28,275 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:41:28,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:41:28,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:28,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:28,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:28,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:41:28,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:41:28,671 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:28,765 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:28,771 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:28,771 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:28,777 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:41:28,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:28,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:41:28,783 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:28,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:28,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:41:28,793 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:28,796 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:28,798 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:28,800 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:28,803 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:28,805 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:28,807 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:28,810 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:28,813 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:28,814 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:28,817 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:28,827 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:28,827 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:41:28,832 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:41:28,832 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:41:28,837 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:28,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:41:28,845 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:28,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:41:28,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:28,860 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:28,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:41:28,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:41:28,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:28,870 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:28,870 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:28,870 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:28,871 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:28,871 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:41:28,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:28,871 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:41:28,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:28,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:41:28,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:41:28,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:28,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:41:28,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:28,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:28,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:28,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:41:28,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:41:28,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:41:28,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:41:28,875 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:41:28,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:41:28,875 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:41:28,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:41:28,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:41:28,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:41:28,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:41:28,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:41:28,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:28,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:41:28,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:28,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:28,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:28,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:41:28,878 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:41:28,878 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:41:28,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:41:28,881 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:41:28,882 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:28,883 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:28,883 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:41:28,884 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 90/400.
2025-08-04 20:41:28,985 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:28,985 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:28,987 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 38 anomalous samples to GAN training data (target: 38).
2025-08-04 20:41:28,987 - ClientAppLogger [Client 4] - INFO - [Client] Round 90: Training GAN with 165 samples (127 normal, 38 anomalous).
2025-08-04 20:41:28,987 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:29,127 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.8362
2025-08-04 20:41:29,127 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.8362
2025-08-04 20:41:29,128 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:29,168 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4779, Threshold=0.5527, Accuracy=0.7240, F1=0.8093, Precision=0.9757, Recall=0.6913
2025-08-04 20:41:29,168 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8093
2025-08-04 20:41:29,168 - ClientAppLogger [Client 4] - INFO - Fit completed for round 90. Duration: 0.28s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 90, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0826495989886196, 'd_loss': 0.8361686606118175, 'post_fit_local_f1': 0.8092512021983055, 'fit_time_seconds': 0.2838447093963623, 'cpu_percent_fit': 18.40625, 'ram_mb_fit': 1.83203125, 'accumulated_train_samples_this_round': 165}
2025-08-04 20:41:29,168 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:41:34,432 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:34,432 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:41:34,432 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:41:34,432 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:41:34,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:41:34,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:34,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:34,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:35,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:41:35,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:41:35,066 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:35,221 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:35,230 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:35,231 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:35,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:41:35,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:35,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:41:35,285 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:35,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:35,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:41:35,297 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:35,300 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,303 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:35,305 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:35,308 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:35,314 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:35,319 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,322 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:35,326 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:35,328 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:35,331 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:35,352 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:35,353 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:41:35,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:41:35,360 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:41:35,369 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:35,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:41:35,389 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:35,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:41:35,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:35,408 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:35,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:41:35,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:41:35,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:35,422 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:35,422 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:35,423 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:35,423 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:35,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:41:35,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:35,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:41:35,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:35,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:41:35,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:41:35,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:35,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:41:35,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:35,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:35,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:35,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:41:35,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:41:35,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:41:35,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:41:35,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:41:35,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:41:35,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:41:35,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:41:35,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:41:35,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:41:35,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:41:35,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:41:35,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:35,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:41:35,431 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:35,431 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:35,431 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:35,431 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:41:35,432 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:41:35,432 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:41:35,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:41:35,443 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:41:35,443 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:35,445 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:35,445 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:41:35,446 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:35,446 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:35,447 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:35,447 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:35,507 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4401, Threshold=0.4996, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:41:35,507 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4401
2025-08-04 20:41:40,782 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:40,782 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:41:40,783 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:41:40,783 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:41:40,786 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:41:40,786 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:41,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:41,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:41,162 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:41:41,200 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:41:41,200 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:41,287 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:41,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:41,294 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:41,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:41:41,304 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:41,304 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:41:41,305 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:41,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:41,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:41:41,313 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:41,316 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:41,318 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:41,321 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:41,323 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:41,326 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:41,328 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:41,332 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:41,338 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:41,342 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:41,345 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:41,357 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:41,357 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:41:41,362 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:41:41,362 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:41:41,367 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:41,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:41:41,375 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:41,375 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:41:41,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:41,391 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:41,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:41:41,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:41:41,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:41,402 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:41,402 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:41,403 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:41,403 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:41,403 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:41:41,403 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:41,404 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:41:41,404 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:41,405 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:41:41,405 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:41:41,405 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:41,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:41:41,406 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:41,406 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:41,406 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:41,406 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:41:41,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:41:41,407 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:41:41,407 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:41:41,407 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:41:41,407 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:41:41,407 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:41:41,407 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:41:41,408 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:41:41,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:41:41,411 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:41:41,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:41:41,411 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:41,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:41:41,412 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:41,412 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:41,412 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:41,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:41:41,412 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:41:41,413 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:41:41,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:41:41,416 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:41:41,416 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:41,417 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:41,417 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:41:41,418 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 91/400.
2025-08-04 20:41:41,519 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:41,519 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:41,521 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 38 anomalous samples to GAN training data (target: 38).
2025-08-04 20:41:41,521 - ClientAppLogger [Client 4] - INFO - [Client] Round 91: Training GAN with 166 samples (128 normal, 38 anomalous).
2025-08-04 20:41:41,521 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:41,666 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0828, Avg D Loss: 0.8160
2025-08-04 20:41:41,666 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0828, Avg D Loss: 0.8160
2025-08-04 20:41:41,666 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:41,708 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4545, Threshold=0.5378, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:41:41,708 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8097
2025-08-04 20:41:41,709 - ClientAppLogger [Client 4] - INFO - Fit completed for round 91. Duration: 0.29s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 91, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0828133916280356, 'd_loss': 0.8160059485090784, 'post_fit_local_f1': 0.8097091825051522, 'fit_time_seconds': 0.2901115417480469, 'cpu_percent_fit': 18.4625, 'ram_mb_fit': 8.09375, 'accumulated_train_samples_this_round': 166}
2025-08-04 20:41:41,709 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:41:46,952 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:46,953 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:41:46,953 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:41:46,953 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:41:46,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:41:46,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:47,208 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:47,208 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:47,290 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:41:47,319 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:41:47,319 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:47,402 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:47,407 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:47,407 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:47,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:41:47,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:47,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:41:47,424 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:47,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:47,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:41:47,433 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:47,436 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:47,438 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:47,440 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:47,443 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:47,446 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:47,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:47,450 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:47,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:47,455 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:47,457 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:47,467 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:47,468 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:41:47,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:41:47,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:41:47,478 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:47,478 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:41:47,488 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:47,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:41:47,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:47,505 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:47,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:41:47,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:41:47,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:47,515 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:47,515 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:47,516 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:47,516 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:47,516 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:41:47,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:47,516 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:41:47,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:47,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:41:47,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:41:47,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:47,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:41:47,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:47,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:47,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:47,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:41:47,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:41:47,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:41:47,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:41:47,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:41:47,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:41:47,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:47,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:41:47,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:47,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:47,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:47,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:41:47,523 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:41:47,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:41:47,524 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:41:47,527 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:41:47,527 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:47,528 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:47,528 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:41:47,530 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:47,530 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:47,530 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:47,531 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:47,576 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4300, Threshold=0.4953, Accuracy=0.7240, F1=0.8093, Precision=0.9757, Recall=0.6913
2025-08-04 20:41:47,576 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7240, F1: 0.8093, Prec: 0.9757, Rec: 0.6913, Avg Anomaly Score: 0.4300
2025-08-04 20:42:04,872 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:04,873 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:42:04,873 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:42:04,873 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:42:04,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:42:04,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:05,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:05,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:05,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:42:05,433 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:42:05,434 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:05,567 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:05,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:05,576 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:05,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:42:05,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:05,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:42:05,592 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:05,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:05,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:42:05,601 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:05,604 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,606 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:05,608 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:05,611 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:05,613 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:05,615 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,618 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:05,621 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:05,623 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:05,625 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:05,638 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:05,638 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:42:05,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:42:05,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:42:05,650 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:05,650 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:42:05,660 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:05,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:42:05,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:05,677 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:05,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:42:05,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:42:05,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:05,692 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:05,692 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:05,692 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:05,692 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:05,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:42:05,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:05,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:42:05,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:05,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:42:05,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:42:05,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:05,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:42:05,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:42:05,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:42:05,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:42:05,697 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:42:05,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:42:05,698 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:42:05,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:42:05,698 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:42:05,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:42:05,699 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:05,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:42:05,699 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:05,699 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:05,700 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:05,700 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:42:05,700 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:42:05,700 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:42:05,700 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:42:05,705 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:42:05,705 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:05,707 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:05,707 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:42:05,709 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:05,709 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:05,709 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:05,710 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:05,758 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3944, Threshold=0.4452, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:42:05,759 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.3944
2025-08-04 20:42:23,064 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:23,064 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:42:23,064 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:42:23,065 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:42:23,065 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:42:23,065 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:23,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:23,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:23,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:42:23,542 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:42:23,542 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:23,666 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:23,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:23,674 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:23,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:42:23,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:23,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:42:23,703 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:23,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:23,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:42:23,715 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:23,719 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,721 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:23,724 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:23,727 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:23,729 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:23,732 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,734 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:23,737 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:23,739 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:23,741 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:23,752 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:23,752 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:42:23,757 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:42:23,758 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:42:23,764 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:23,764 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:42:23,775 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:23,776 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:42:23,776 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:23,792 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:23,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:42:23,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:42:23,801 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:23,801 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:23,801 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:23,801 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:23,801 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:23,802 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:42:23,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:23,802 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:42:23,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:23,804 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:42:23,804 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:42:23,804 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:23,804 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:42:23,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:42:23,806 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:42:23,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:42:23,806 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:42:23,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:42:23,807 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:23,808 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:23,808 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:23,808 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:42:23,808 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:42:23,808 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:42:23,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:42:23,813 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:42:23,813 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:23,815 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:23,815 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:42:23,816 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:23,816 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:23,816 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:23,817 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:23,861 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4121, Threshold=0.4535, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:42:23,861 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4121
2025-08-04 20:42:38,156 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:38,156 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:42:38,156 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:42:38,156 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:42:38,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:42:38,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:38,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:38,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:38,775 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:42:38,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:42:38,826 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:38,965 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:38,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:38,972 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:38,977 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:42:38,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:38,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:42:38,984 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:38,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:38,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:42:38,994 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:38,997 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,999 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:39,001 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:39,004 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:39,007 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:39,010 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:39,013 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:39,016 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:39,018 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:39,021 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:39,031 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:39,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:42:39,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:42:39,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:42:39,041 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:39,041 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:42:39,051 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:39,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:42:39,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:39,066 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:39,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:42:39,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:42:39,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:39,076 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:39,076 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:39,076 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:39,077 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:39,077 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:42:39,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:39,077 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:42:39,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:39,079 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:42:39,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:42:39,079 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:42:39,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:42:39,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:42:39,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:42:39,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:42:39,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:42:39,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:42:39,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:42:39,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:42:39,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:42:39,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:42:39,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:39,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:42:39,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:39,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:39,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:39,083 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:42:39,084 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:42:39,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:42:39,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:42:39,088 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:42:39,088 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:39,089 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:39,089 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:42:39,091 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:39,091 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:39,091 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:39,092 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:39,133 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3892, Threshold=0.4221, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:42:39,133 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.3892
2025-08-04 20:42:53,393 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:53,393 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:42:53,393 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:42:53,393 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:42:53,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:42:53,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:53,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:53,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:53,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:42:53,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:42:53,729 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:53,821 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:53,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:53,831 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:53,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:42:53,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:53,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:42:53,847 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:53,847 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:53,847 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:42:53,856 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:53,860 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:53,862 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:53,864 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:53,867 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:53,869 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:53,872 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:53,875 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:53,878 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:53,880 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:53,882 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:53,892 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:53,892 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:42:53,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:42:53,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:42:53,902 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:53,902 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:42:53,910 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:53,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:42:53,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:53,928 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:53,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:42:53,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:42:53,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:53,942 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:53,942 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:53,942 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:53,943 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:53,943 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:42:53,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:53,943 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:42:53,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:53,945 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:42:53,945 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:42:53,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:53,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:42:53,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:53,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:53,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:53,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:42:53,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:42:53,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:42:53,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:42:53,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:42:53,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:42:53,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:42:53,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:42:53,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:42:53,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:42:53,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:42:53,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:42:53,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:53,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:42:53,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:53,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:53,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:53,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:42:53,951 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:42:53,951 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:42:53,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:42:53,955 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:42:53,955 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:53,956 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:53,956 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:42:53,958 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:53,958 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:53,958 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:53,959 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:54,000 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4084, Threshold=0.4330, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:42:54,001 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4084
2025-08-04 20:43:11,287 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:11,287 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:11,288 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:11,288 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:11,288 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:11,288 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:11,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:11,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:11,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:43:11,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:43:11,699 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:11,792 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:11,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:11,802 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:11,810 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:43:11,820 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:11,820 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:43:11,820 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:11,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:11,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:43:11,831 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:11,834 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:11,836 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:11,838 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:11,841 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:11,843 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:11,846 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:11,848 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:11,851 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:11,853 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:11,855 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:11,867 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:11,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:43:11,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:43:11,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:43:11,881 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:11,881 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:43:11,895 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:11,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:43:11,898 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:11,914 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:11,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:43:11,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:43:11,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:11,927 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:11,927 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:11,927 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:11,927 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:11,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:43:11,928 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:11,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:43:11,928 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:11,929 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:43:11,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:43:11,930 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:11,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:43:11,930 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:11,930 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:11,931 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:11,931 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:43:11,931 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:43:11,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:43:11,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:43:11,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:43:11,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:43:11,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:43:11,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:43:11,936 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:43:11,936 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:43:11,936 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:43:11,936 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:43:11,937 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:11,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:43:11,937 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:11,937 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:43:11,938 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:43:11,942 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:43:11,943 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:11,944 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:11,948 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:43:11,949 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:11,949 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:11,949 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:11,950 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:11,996 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4423, Threshold=0.4738, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:43:12,000 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4423
2025-08-04 20:43:17,251 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:17,252 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:17,252 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:17,252 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:17,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:17,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:17,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:17,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:17,568 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:43:17,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:43:17,596 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:17,682 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:17,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:17,687 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:17,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:43:17,700 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:17,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:43:17,701 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:17,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:17,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:43:17,710 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:17,713 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:17,715 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:17,717 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:17,720 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:17,722 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:17,725 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:17,727 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:17,730 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:17,732 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:17,735 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:17,743 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:17,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:43:17,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:43:17,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:43:17,753 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:17,753 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:43:17,761 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:17,761 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:43:17,761 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:17,776 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:17,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:43:17,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:43:17,786 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:17,786 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:17,786 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:17,786 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:17,786 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:17,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:43:17,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:17,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:43:17,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:17,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:43:17,789 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:43:17,789 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:17,789 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:43:17,789 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:17,789 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:43:17,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:43:17,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:43:17,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:43:17,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:43:17,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:43:17,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:43:17,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:43:17,792 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:17,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:43:17,792 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:17,792 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:17,793 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:17,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:43:17,793 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:43:17,794 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:43:17,794 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:43:17,797 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:43:17,797 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:17,798 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:17,798 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:43:17,800 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 97/400.
2025-08-04 20:43:17,901 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:17,901 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:17,902 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 41 anomalous samples to GAN training data (target: 41).
2025-08-04 20:43:17,902 - ClientAppLogger [Client 4] - INFO - [Client] Round 97: Training GAN with 178 samples (137 normal, 41 anomalous).
2025-08-04 20:43:17,902 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:18,048 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0825, Avg D Loss: 0.8198
2025-08-04 20:43:18,048 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0825, Avg D Loss: 0.8198
2025-08-04 20:43:18,048 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:18,090 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4605, Threshold=0.5232, Accuracy=0.7227, F1=0.8083, Precision=0.9746, Recall=0.6905
2025-08-04 20:43:18,090 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8083
2025-08-04 20:43:18,090 - ClientAppLogger [Client 4] - INFO - Fit completed for round 97. Duration: 0.29s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 97, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0825120832143207, 'd_loss': 0.8197636905680881, 'post_fit_local_f1': 0.8083352415846119, 'fit_time_seconds': 0.29000067710876465, 'cpu_percent_fit': 18.15625, 'ram_mb_fit': 6.43359375, 'accumulated_train_samples_this_round': 178}
2025-08-04 20:43:18,090 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:43:26,367 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:26,367 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:26,367 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:26,368 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:26,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:26,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:26,728 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:26,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:26,820 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:43:26,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:43:26,860 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:26,990 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:26,997 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:26,997 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:27,004 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:43:27,010 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:27,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:43:27,011 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:27,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:27,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:43:27,021 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:27,024 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:27,027 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:27,029 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:27,031 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:27,033 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:27,036 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:27,038 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:27,041 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:27,043 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:27,046 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:27,055 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:27,055 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:43:27,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:43:27,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:43:27,066 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:27,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:43:27,077 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:27,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:43:27,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:27,093 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:27,098 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:43:27,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:43:27,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:27,104 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:27,104 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:27,105 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:27,105 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:27,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:43:27,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:27,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:43:27,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:27,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:43:27,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:43:27,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:27,108 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:43:27,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:27,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:27,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:27,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:43:27,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:43:27,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:43:27,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:43:27,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:43:27,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:43:27,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:27,111 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:43:27,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:27,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:27,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:27,112 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:43:27,112 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:43:27,112 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:43:27,112 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:43:27,117 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:43:27,117 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:27,119 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:27,119 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:43:27,120 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:27,121 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:27,121 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:27,121 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:27,166 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4147, Threshold=0.4384, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:43:27,166 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4147
2025-08-04 20:43:32,419 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:32,420 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:32,420 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:32,420 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:32,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:32,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:32,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:32,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:32,767 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:43:32,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:43:32,796 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:32,880 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:32,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:32,885 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:32,891 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:43:32,898 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:32,898 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:43:32,898 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:32,898 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:32,899 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:43:32,907 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:32,910 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:32,912 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:32,914 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:32,917 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:32,919 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:32,922 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:32,924 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:32,927 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:32,929 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:32,931 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:32,939 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:32,939 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:43:32,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:43:32,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:43:32,948 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:32,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:43:32,957 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:32,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:43:32,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:32,973 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:32,978 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:43:32,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:43:32,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:32,983 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:32,983 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:32,983 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:32,983 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:32,984 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:43:32,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:32,984 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:43:32,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:32,985 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:43:32,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:43:32,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:32,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:43:32,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:32,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:32,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:32,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:43:32,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:43:32,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:43:32,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:43:32,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:43:32,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:43:32,988 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:43:32,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:43:32,988 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:43:32,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:43:32,988 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:43:32,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:43:32,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:32,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:43:32,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:32,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:32,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:32,990 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:43:32,990 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:43:32,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:43:32,990 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:43:32,994 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:43:32,994 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:32,995 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:32,995 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:43:32,996 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 98/400.
2025-08-04 20:43:33,098 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:33,098 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:33,099 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 41 anomalous samples to GAN training data (target: 41).
2025-08-04 20:43:33,099 - ClientAppLogger [Client 4] - INFO - [Client] Round 98: Training GAN with 178 samples (137 normal, 41 anomalous).
2025-08-04 20:43:33,099 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:33,239 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.8083
2025-08-04 20:43:33,239 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.8083
2025-08-04 20:43:33,239 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:33,282 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4553, Threshold=0.5134, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:43:33,283 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8088
2025-08-04 20:43:33,283 - ClientAppLogger [Client 4] - INFO - Fit completed for round 98. Duration: 0.29s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 98, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084228437938047, 'd_loss': 0.8082595501053198, 'post_fit_local_f1': 0.8087932218914586, 'fit_time_seconds': 0.2862887382507324, 'cpu_percent_fit': 18.55, 'ram_mb_fit': 0.140625, 'accumulated_train_samples_this_round': 178}
2025-08-04 20:43:33,283 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:43:44,563 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:44,563 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:44,563 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:44,563 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:44,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:44,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:44,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:44,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:44,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:43:45,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:43:45,020 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:45,119 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:45,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:45,126 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:45,131 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:43:45,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:45,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:43:45,139 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:45,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:45,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:43:45,148 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:45,150 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:45,153 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:45,155 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:45,159 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:45,161 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:45,166 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:45,171 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:45,174 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:45,176 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:45,179 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:45,190 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:45,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:43:45,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:43:45,196 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:43:45,200 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:45,200 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:43:45,208 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:45,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:43:45,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:45,224 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:45,228 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:43:45,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:43:45,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:45,234 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:45,234 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:45,234 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:45,234 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:45,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:43:45,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:45,235 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:43:45,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:45,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:43:45,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:43:45,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:45,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:43:45,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:45,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:45,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:45,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:43:45,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:43:45,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:43:45,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:43:45,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:43:45,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:43:45,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:43:45,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:43:45,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:45,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:45,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:45,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:43:45,241 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:43:45,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:43:45,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:43:45,244 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:43:45,245 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:45,246 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:45,246 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:43:45,247 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:45,247 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:45,247 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:45,248 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:45,289 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4517, Threshold=0.4735, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:43:45,289 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4517
2025-08-04 20:43:50,546 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:50,546 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:50,546 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:50,546 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:50,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:50,547 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:50,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:50,760 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:50,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:43:50,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:43:50,873 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:50,960 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:50,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:50,965 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:50,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:43:50,979 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:50,979 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:43:50,980 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:50,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:50,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:43:50,989 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:50,991 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:50,994 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:50,996 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:50,999 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:51,001 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:51,003 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:51,005 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:51,008 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:51,010 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:51,013 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:51,021 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:51,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:43:51,026 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:43:51,026 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:43:51,031 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:51,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:43:51,039 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:51,040 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:43:51,040 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:51,055 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:51,059 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:43:51,064 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:43:51,064 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:51,065 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:51,065 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:51,065 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:51,065 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:51,065 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:43:51,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:51,066 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:43:51,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:51,067 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:43:51,068 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:43:51,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:51,068 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:43:51,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:51,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:51,068 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:51,069 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:43:51,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:43:51,069 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:43:51,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:43:51,069 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:43:51,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:43:51,072 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:43:51,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:43:51,072 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:43:51,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:43:51,073 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:43:51,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:43:51,073 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:51,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:43:51,074 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:51,074 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:51,074 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:51,074 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:43:51,074 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:43:51,075 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:43:51,075 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:43:51,078 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:43:51,078 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:51,079 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:51,079 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:43:51,080 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 99/400.
2025-08-04 20:43:51,182 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:51,182 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:51,183 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 41 anomalous samples to GAN training data (target: 41).
2025-08-04 20:43:51,183 - ClientAppLogger [Client 4] - INFO - [Client] Round 99: Training GAN with 180 samples (139 normal, 41 anomalous).
2025-08-04 20:43:51,183 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:51,321 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0825, Avg D Loss: 0.8037
2025-08-04 20:43:51,321 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0825, Avg D Loss: 0.8037
2025-08-04 20:43:51,322 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:51,363 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4621, Threshold=0.5126, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:43:51,363 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8088
2025-08-04 20:43:51,363 - ClientAppLogger [Client 4] - INFO - Fit completed for round 99. Duration: 0.28s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 99, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.082524535920885, 'd_loss': 0.80374481982655, 'post_fit_local_f1': 0.8087932218914586, 'fit_time_seconds': 0.2827646732330322, 'cpu_percent_fit': 18.58125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 180}
2025-08-04 20:43:51,363 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:43:59,634 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:59,634 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:43:59,634 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:43:59,635 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:43:59,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:43:59,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:59,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:59,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:00,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:44:00,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:44:00,126 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:00,245 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:00,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:00,252 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:00,257 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:44:00,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:00,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:44:00,263 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:00,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:00,264 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:44:00,272 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:00,275 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:00,277 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:00,279 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:00,282 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:00,284 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:00,287 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:00,289 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:00,292 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:00,294 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:00,296 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:00,304 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:00,304 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:44:00,309 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:44:00,309 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:44:00,313 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:00,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:44:00,322 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:00,322 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:44:00,322 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:00,337 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:00,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:44:00,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:44:00,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:00,346 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:00,347 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:00,347 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:00,347 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:00,347 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:44:00,348 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:00,348 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:44:00,348 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:00,349 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:44:00,349 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:44:00,350 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:44:00,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:44:00,352 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:44:00,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:44:00,352 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:00,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:44:00,353 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:00,353 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:00,353 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:00,353 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:44:00,353 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:44:00,354 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:44:00,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:44:00,358 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:44:00,358 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:00,360 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:00,360 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:44:00,361 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:00,361 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:00,361 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:00,362 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:00,403 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3896, Threshold=0.3914, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:44:00,404 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.3896
2025-08-04 20:44:11,696 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,696 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:44:11,696 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:44:11,697 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:44:11,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:44:11,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:12,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:12,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:12,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:44:12,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:44:12,283 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:12,382 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:12,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:12,389 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:12,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:44:12,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:12,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:44:12,403 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:12,403 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:12,403 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:44:12,412 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:12,416 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,418 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:12,421 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:12,424 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:12,426 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:12,429 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,431 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:12,434 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:12,436 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:12,439 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:12,450 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:12,451 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:44:12,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:44:12,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:44:12,461 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:12,463 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:44:12,473 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:12,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:44:12,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:12,489 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:12,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:44:12,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:44:12,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:12,499 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:12,499 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:12,500 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:12,500 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:12,500 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:44:12,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:12,501 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:44:12,501 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:12,502 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:44:12,502 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:44:12,503 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:12,503 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:44:12,503 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:12,503 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:12,503 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:12,503 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:44:12,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:44:12,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:44:12,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:44:12,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:44:12,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:44:12,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:44:12,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:44:12,505 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:44:12,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:44:12,506 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:44:12,506 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:44:12,506 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:12,506 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:44:12,506 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:12,507 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:12,507 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:12,507 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:44:12,507 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:44:12,507 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:44:12,507 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:44:12,511 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:44:12,511 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:12,512 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:12,512 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:44:12,514 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:12,514 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:12,514 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:12,515 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:12,560 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4120, Threshold=0.4172, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:44:12,560 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4120
2025-08-04 20:44:32,860 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:32,860 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:44:32,860 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:44:32,860 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:44:32,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:44:32,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:33,182 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:33,186 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:33,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:44:33,317 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:44:33,318 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:33,417 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:33,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:33,424 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:33,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:44:33,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:33,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:44:33,438 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:33,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:33,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:44:33,448 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:33,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:33,455 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:33,458 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:33,460 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:33,463 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,465 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:33,468 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:33,470 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:33,472 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:33,485 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:33,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:44:33,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:44:33,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:44:33,495 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:33,496 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:44:33,505 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:33,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:44:33,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:33,521 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:33,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:44:33,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:44:33,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:33,534 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:33,534 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:33,535 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:33,535 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:33,535 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:44:33,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:33,535 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:44:33,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:33,537 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:44:33,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:44:33,537 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:33,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:44:33,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:44:33,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:44:33,539 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:44:33,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:44:33,539 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:44:33,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:44:33,540 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:44:33,540 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:44:33,540 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:33,540 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:44:33,540 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:33,540 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:33,541 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:33,541 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:44:33,541 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:44:33,541 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:44:33,541 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:44:33,547 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:44:33,547 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:33,549 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:33,549 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:44:33,550 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:33,550 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:33,550 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:33,551 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:33,597 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4232, Threshold=0.4266, Accuracy=0.7233, F1=0.8088, Precision=0.9752, Recall=0.6909
2025-08-04 20:44:33,597 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7233, F1: 0.8088, Prec: 0.9752, Rec: 0.6909, Avg Anomaly Score: 0.4232
2025-08-04 20:44:50,900 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:50,900 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:44:50,901 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:44:50,901 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:44:50,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:44:50,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:51,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:51,355 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:51,450 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:44:51,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:44:51,488 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:51,591 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:51,600 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:51,600 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:51,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:44:51,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:51,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:44:51,627 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:51,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:51,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:44:51,636 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:51,639 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,641 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:51,643 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:51,645 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:51,648 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:51,650 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,653 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:51,656 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:51,658 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:51,661 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:51,671 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:51,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:44:51,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:44:51,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:44:51,682 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:51,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:44:51,692 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:51,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:44:51,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:51,710 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:51,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:44:51,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:44:51,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:51,725 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:51,725 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:51,726 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:51,726 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:51,726 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:44:51,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:51,727 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:44:51,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:51,728 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:51,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:51,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:51,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:51,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:44:51,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:44:51,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:44:51,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:44:51,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:44:51,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:44:51,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:44:51,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:44:51,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:44:51,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:44:51,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:44:51,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:44:51,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:51,736 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:44:51,736 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:51,736 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:51,740 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:51,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:44:51,740 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:44:51,740 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:44:51,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:44:51,745 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:44:51,745 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:51,747 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:51,750 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:44:51,752 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:51,752 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:51,752 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:51,753 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:51,803 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4448, Threshold=0.4554, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:44:51,803 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7247, F1: 0.8097, Prec: 0.9763, Rec: 0.6917, Avg Anomaly Score: 0.4448
2025-08-04 20:45:09,070 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:09,070 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:45:09,070 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:45:09,070 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:45:09,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:45:09,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:09,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:09,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:09,397 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:45:09,433 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:45:09,433 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:09,528 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:09,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:09,535 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:09,543 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:45:09,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:09,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:45:09,549 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:09,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:09,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:45:09,559 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:09,561 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:09,564 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:09,566 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:09,569 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:09,571 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:09,573 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:09,576 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:09,579 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:09,581 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:09,583 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:09,592 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:09,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:45:09,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:45:09,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:45:09,602 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:09,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:45:09,612 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:09,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:45:09,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:09,628 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:09,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:45:09,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:45:09,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:09,641 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:09,641 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:09,642 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:09,642 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:09,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:45:09,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:09,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:45:09,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:09,644 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:45:09,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:45:09,645 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:45:09,646 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:45:09,646 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:45:09,646 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:45:09,646 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:45:09,646 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:45:09,646 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:45:09,647 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:45:09,647 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:45:09,647 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:45:09,647 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:45:09,648 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:09,648 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:45:09,648 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:09,648 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:09,648 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:09,649 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:45:09,649 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:45:09,649 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:45:09,650 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:45:09,654 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:45:09,655 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:09,656 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:09,656 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:45:09,658 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:09,658 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:09,658 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:09,659 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:09,704 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4626, Threshold=0.4876, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:45:09,704 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.4626
2025-08-04 20:45:32,988 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:32,988 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:45:32,988 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:45:32,988 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:45:32,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:45:32,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:33,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:33,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:33,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:45:33,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:45:33,431 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:33,535 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:33,543 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:33,543 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:33,552 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:45:33,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:33,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:45:33,564 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:33,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:33,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:45:33,575 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:33,578 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,580 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:33,583 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:33,586 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:33,588 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:33,591 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:33,596 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:33,598 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:33,601 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:33,611 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:33,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:45:33,616 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:45:33,616 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:45:33,623 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:33,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:45:33,636 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:33,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:45:33,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:33,655 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:33,660 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:45:33,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:45:33,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:33,670 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:33,670 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:33,671 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:33,671 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:33,671 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:45:33,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:33,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:45:33,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:33,673 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:45:33,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:45:33,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:33,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:45:33,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:33,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:33,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:33,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:45:33,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:45:33,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:45:33,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:45:33,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:45:33,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:45:33,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:45:33,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:45:33,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:45:33,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:45:33,677 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:45:33,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:45:33,677 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:33,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:45:33,678 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:33,678 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:33,678 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:33,678 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:45:33,679 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:45:33,679 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:45:33,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:45:33,683 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:45:33,683 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:33,685 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:33,687 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:33,690 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:33,742 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4951, Threshold=0.5216, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:45:33,742 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.4951
2025-08-04 20:45:38,999 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:39,000 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:45:39,000 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:45:39,000 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:45:39,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:45:39,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:39,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:39,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:39,445 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:45:39,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:45:39,493 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:39,619 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:39,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:39,627 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:39,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:45:39,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:39,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:45:39,644 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:39,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:39,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:45:39,655 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:39,658 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,660 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:39,663 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:39,665 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:39,668 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:39,670 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,673 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:39,675 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:39,678 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:39,680 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:39,690 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:39,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:45:39,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:45:39,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:45:39,704 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:39,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:45:39,725 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:39,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:45:39,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:39,744 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:39,750 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:45:39,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:45:39,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:39,784 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:39,784 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:39,784 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:39,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:45:39,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:45:39,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:39,788 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:45:39,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:39,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:39,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:39,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:45:39,788 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:45:39,789 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:45:39,789 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:45:39,789 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:45:39,789 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:45:39,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:45:39,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:45:39,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:45:39,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:45:39,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:45:39,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:45:39,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:39,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:45:39,792 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:39,792 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:39,793 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:39,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:45:39,793 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:45:39,793 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:45:39,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:45:39,802 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:45:39,802 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:39,803 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:39,803 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:45:39,805 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 105/400.
2025-08-04 20:45:39,905 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:39,905 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:39,907 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 44 anomalous samples to GAN training data (target: 44).
2025-08-04 20:45:39,907 - ClientAppLogger [Client 4] - INFO - [Client] Round 105: Training GAN with 191 samples (147 normal, 44 anomalous).
2025-08-04 20:45:39,907 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:40,055 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.7857
2025-08-04 20:45:40,056 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.7857
2025-08-04 20:45:40,056 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:40,106 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4955, Threshold=0.5341, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:45:40,107 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8097
2025-08-04 20:45:40,107 - ClientAppLogger [Client 4] - INFO - Fit completed for round 105. Duration: 0.30s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 105, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0854640264161595, 'd_loss': 0.7857046717436525, 'post_fit_local_f1': 0.8097091825051522, 'fit_time_seconds': 0.3025357723236084, 'cpu_percent_fit': 18.56875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 191}
2025-08-04 20:45:40,108 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:45:45,367 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:45,367 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:45:45,367 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:45:45,367 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:45:45,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:45:45,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:45,769 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:45,769 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:45,865 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:45:45,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:45:45,925 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:46,108 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:46,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:46,119 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:46,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:45:46,137 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:46,137 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:45:46,138 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:46,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:46,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:45:46,149 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:46,153 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:46,158 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:46,161 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:46,164 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:46,167 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,170 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:46,173 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:46,175 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:46,179 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:46,196 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:46,197 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:45:46,202 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,202 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:45:46,208 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:45:46,226 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:45:46,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,249 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:45:46,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:45:46,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,266 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,266 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,267 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,267 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,268 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:45:46,268 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,268 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:45:46,268 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,270 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:45:46,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,271 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,272 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:45:46,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:45:46,272 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:45:46,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:45:46,273 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:45:46,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:45:46,273 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:45:46,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:45:46,274 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:45:46,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:45:46,274 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:45:46,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:45:46,275 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:45:46,275 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,276 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,276 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,276 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:45:46,276 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:45:46,276 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:45:46,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:45:46,285 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:45:46,285 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,287 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,287 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:45:46,289 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,289 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,289 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,290 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,348 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5621, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:45:46,349 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.5078
2025-08-04 20:45:57,619 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:57,619 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:45:57,619 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:45:57,619 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:45:57,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:45:57,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:57,934 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:57,934 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:58,024 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:45:58,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:45:58,072 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:58,241 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:58,250 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:58,250 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:58,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:45:58,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:58,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:45:58,270 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:58,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:58,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:45:58,282 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:58,285 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,287 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:58,290 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:58,293 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:58,295 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:58,298 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,300 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:58,303 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:58,305 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:58,308 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:58,321 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:58,322 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:45:58,327 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:45:58,327 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:45:58,333 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:58,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:45:58,346 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:58,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:45:58,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:58,364 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:58,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:45:58,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:45:58,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:58,376 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:58,377 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:58,377 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:58,377 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:58,378 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:45:58,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:58,378 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:45:58,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:58,380 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:45:58,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:45:58,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:58,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:45:58,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:58,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:58,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:58,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:45:58,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:45:58,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:45:58,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:45:58,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:45:58,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:45:58,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:45:58,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:45:58,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:45:58,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:45:58,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:45:58,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:45:58,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:58,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:45:58,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:58,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:58,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:58,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:45:58,385 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:45:58,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:45:58,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:45:58,395 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:45:58,396 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:58,397 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:58,397 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:45:58,399 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:58,399 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:58,399 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:58,400 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:58,448 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4635, Threshold=0.4936, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:45:58,449 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4635
2025-08-04 20:46:12,728 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:12,728 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:46:12,728 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:46:12,728 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:46:12,728 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:46:12,728 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:13,034 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:13,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:13,131 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:46:13,165 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:46:13,165 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:13,288 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:13,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:13,297 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:13,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:46:13,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:13,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:46:13,314 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:13,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:13,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:46:13,323 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:13,326 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,329 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:13,331 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:13,334 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:13,336 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:13,338 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,341 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:13,344 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:13,346 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:13,349 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:13,361 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:13,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:46:13,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:46:13,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:46:13,372 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:13,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:46:13,389 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:13,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:46:13,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:13,406 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:13,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:46:13,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:46:13,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:13,420 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:13,420 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:13,421 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:13,421 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:13,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:46:13,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:13,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:46:13,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:13,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:46:13,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:46:13,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:13,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:46:13,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:13,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:13,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:13,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:46:13,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:46:13,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:46:13,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:46:13,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:46:13,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:46:13,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:46:13,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:46:13,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:46:13,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:46:13,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:46:13,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:46:13,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:13,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:46:13,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:13,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:13,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:13,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:46:13,429 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:46:13,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:46:13,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:46:13,433 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:46:13,434 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:13,435 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:13,436 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:46:13,437 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:13,437 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:13,437 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:13,438 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:13,489 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4695, Threshold=0.5026, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:46:13,489 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.4695
2025-08-04 20:46:27,754 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:27,754 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:46:27,754 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:46:27,755 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:46:27,755 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:46:27,755 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:28,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:28,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:28,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:46:28,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:46:28,157 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:28,288 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:28,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:28,297 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:28,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:46:28,309 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:28,309 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:46:28,310 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:28,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:28,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:46:28,319 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:28,322 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:28,324 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:28,327 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:28,329 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:28,332 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:28,334 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:28,337 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:28,339 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:28,341 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:28,344 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:28,356 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:28,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:46:28,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:46:28,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:46:28,366 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:28,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:46:28,377 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:28,377 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:46:28,377 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:28,394 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:28,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:46:28,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:46:28,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:28,414 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:28,414 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:28,414 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:28,415 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:28,415 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:46:28,415 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:28,416 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:46:28,416 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:28,418 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:46:28,418 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:46:28,418 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:28,419 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:46:28,419 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:28,419 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:28,419 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:28,419 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:46:28,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:46:28,420 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:46:28,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:46:28,420 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:46:28,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:46:28,421 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:46:28,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:46:28,421 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:46:28,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:46:28,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:46:28,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:46:28,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:28,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:46:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:28,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:46:28,427 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:46:28,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:46:28,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:46:28,431 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:46:28,432 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:28,433 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:28,433 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:46:28,434 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:28,435 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:28,435 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:28,435 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:28,479 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4895, Threshold=0.5314, Accuracy=0.7270, F1=0.8111, Precision=0.9795, Recall=0.6921
2025-08-04 20:46:28,479 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7270, F1: 0.8111, Prec: 0.9795, Rec: 0.6921, Avg Anomaly Score: 0.4895
2025-08-04 20:46:42,749 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:42,750 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:46:42,750 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:46:42,750 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:46:42,750 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:46:42,750 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:43,032 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:43,032 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:43,118 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:46:43,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:46:43,150 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:43,246 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:43,254 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:43,254 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:43,265 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:46:43,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:43,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:46:43,314 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:43,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:43,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:46:43,325 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:43,328 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:43,330 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:43,332 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:43,335 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:43,337 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:43,340 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:43,342 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:43,345 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:43,347 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:43,349 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:43,359 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:43,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:46:43,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:46:43,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:46:43,370 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:43,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:46:43,384 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:43,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:46:43,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:43,406 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:43,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:46:43,418 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:46:43,418 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:43,418 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:43,418 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:43,419 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:43,419 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:43,419 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:46:43,419 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:43,420 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:46:43,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:43,421 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:46:43,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:46:43,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:43,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:46:43,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:43,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:43,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:43,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:46:43,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:46:43,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:46:43,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:46:43,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:46:43,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:46:43,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:46:43,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:46:43,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:46:43,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:46:43,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:46:43,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:46:43,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:43,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:46:43,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:43,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:43,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:43,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:46:43,427 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:46:43,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:46:43,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:46:43,433 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:46:43,433 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:43,435 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:43,435 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:46:43,436 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:43,436 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:43,437 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:43,437 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:43,485 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4727, Threshold=0.5100, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:46:43,486 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.4727
2025-08-04 20:46:51,757 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:51,757 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:46:51,757 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:46:51,757 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:46:51,757 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:46:51,757 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:52,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:52,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:52,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:46:52,141 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:46:52,141 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:52,235 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:52,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:52,241 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:52,247 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:46:52,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:52,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:46:52,253 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:52,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:52,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:46:52,262 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:52,265 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:52,267 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:52,270 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:52,273 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:52,276 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:52,279 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:52,282 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:52,284 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:52,286 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:52,288 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:52,297 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:52,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:46:52,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:46:52,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:46:52,306 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:52,307 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:46:52,315 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:52,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:46:52,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:52,330 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:52,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:46:52,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:46:52,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:52,340 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:52,340 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:52,340 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:52,340 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:52,340 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:46:52,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:52,341 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:46:52,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:52,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:46:52,343 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:46:52,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:52,343 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:46:52,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:52,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:46:52,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:46:52,345 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:46:52,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:46:52,345 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:46:52,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:46:52,345 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:46:52,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:46:52,346 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:52,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:46:52,346 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:52,346 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:52,347 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:52,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:46:52,347 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:46:52,347 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:46:52,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:46:52,351 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:46:52,351 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:52,353 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:52,353 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:46:52,354 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 110/400.
2025-08-04 20:46:52,455 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:52,455 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:52,456 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 47 anomalous samples to GAN training data (target: 47).
2025-08-04 20:46:52,456 - ClientAppLogger [Client 4] - INFO - [Client] Round 110: Training GAN with 204 samples (157 normal, 47 anomalous).
2025-08-04 20:46:52,456 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:52,617 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7789
2025-08-04 20:46:52,617 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7789
2025-08-04 20:46:52,617 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:52,659 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5267, Threshold=0.5857, Accuracy=0.7240, F1=0.8093, Precision=0.9757, Recall=0.6913
2025-08-04 20:46:52,659 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8093
2025-08-04 20:46:52,659 - ClientAppLogger [Client 4] - INFO - Fit completed for round 110. Duration: 0.31s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 110, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0836085398991906, 'd_loss': 0.7789170080540226, 'post_fit_local_f1': 0.8092512021983055, 'fit_time_seconds': 0.30513477325439453, 'cpu_percent_fit': 18.63125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 204}
2025-08-04 20:46:52,659 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:46:57,912 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:57,913 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:46:57,913 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:46:57,913 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:46:57,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:46:57,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:58,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:58,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:58,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:46:58,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:46:58,338 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:58,438 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:58,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:58,444 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:58,450 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:46:58,457 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:58,457 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:46:58,457 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:58,458 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:58,458 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:46:58,467 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:58,470 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:58,472 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:58,474 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:58,477 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:58,480 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:58,482 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:58,485 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:58,487 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:58,489 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:58,492 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:58,501 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:58,501 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:46:58,506 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:46:58,506 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:46:58,511 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:58,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:46:58,520 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:58,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:46:58,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:58,536 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:58,549 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:46:58,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:46:58,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:58,555 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:58,556 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:58,556 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:58,556 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:58,556 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:46:58,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:58,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:46:58,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:58,558 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:46:58,558 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:46:58,559 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:58,559 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:46:58,559 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:58,559 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:58,559 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:58,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:46:58,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:46:58,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:46:58,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:46:58,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:46:58,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:46:58,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:46:58,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:46:58,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:46:58,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:46:58,562 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:46:58,562 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:46:58,562 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:58,562 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:46:58,562 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:58,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:58,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:58,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:46:58,563 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:46:58,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:46:58,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:46:58,569 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:46:58,569 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:58,570 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:58,570 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:46:58,572 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:58,572 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:58,572 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:58,573 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:58,616 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5114, Threshold=0.5557, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:46:58,616 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7253, F1: 0.8102, Prec: 0.9768, Rec: 0.6921, Avg Anomaly Score: 0.5114
2025-08-04 20:47:15,916 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:15,917 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:47:15,917 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:47:15,917 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:47:15,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:47:15,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:16,172 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:16,173 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:16,265 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:47:16,301 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:47:16,301 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:16,390 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:16,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:16,396 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:16,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:47:16,405 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:16,405 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:47:16,406 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:16,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:16,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:47:16,414 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:16,417 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:16,419 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:16,421 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:16,424 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:16,426 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:16,429 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:16,431 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:16,434 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:16,436 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:16,438 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:16,446 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:16,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:47:16,451 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:47:16,451 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:47:16,455 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:16,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:47:16,463 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:16,463 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:47:16,464 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:16,478 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:16,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:47:16,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:47:16,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:16,488 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:16,488 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:16,488 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:16,488 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:16,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:47:16,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:16,489 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:47:16,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:16,490 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:47:16,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:47:16,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:16,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:47:16,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:16,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:16,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:16,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:47:16,492 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:47:16,492 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:47:16,492 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:47:16,492 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:47:16,492 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:47:16,492 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:47:16,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:47:16,493 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:47:16,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:47:16,493 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:47:16,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:47:16,494 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:16,494 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:47:16,494 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:16,494 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:16,494 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:16,494 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:47:16,495 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:47:16,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:47:16,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:47:16,499 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:47:16,499 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:16,500 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:16,500 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:47:16,501 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:16,502 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:16,502 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:16,502 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:16,542 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4820, Threshold=0.5209, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:47:16,542 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4820
2025-08-04 20:47:33,845 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:33,846 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:47:33,846 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:47:33,846 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:47:33,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:47:33,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:34,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:34,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:34,242 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:47:34,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:47:34,270 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:34,362 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:34,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:34,368 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:34,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:47:34,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:34,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:47:34,383 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:34,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:34,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:47:34,392 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:34,395 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:34,397 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:34,400 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:34,403 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:34,405 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:34,407 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:34,410 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:34,413 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:34,415 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:34,417 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:34,427 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:34,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:47:34,431 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:47:34,431 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:47:34,436 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:34,436 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:47:34,444 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:34,445 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:47:34,445 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:34,461 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:34,466 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:47:34,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:47:34,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:34,470 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:34,471 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:34,471 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:34,471 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:34,471 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:47:34,471 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:34,472 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:47:34,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:34,473 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:47:34,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:47:34,474 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:34,474 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:47:34,474 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:34,474 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:34,474 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:34,475 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:47:34,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:47:34,475 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:47:34,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:47:34,475 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:47:34,476 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:47:34,476 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:47:34,476 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:47:34,477 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:47:34,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:47:34,477 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:47:34,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:47:34,477 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:34,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:47:34,478 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:34,478 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:34,478 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:34,478 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:47:34,479 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:47:34,479 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:47:34,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:47:34,484 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:47:34,484 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:34,485 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:34,485 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:47:34,487 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:34,487 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:34,487 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:34,488 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:34,530 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4511, Threshold=0.4754, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:47:34,530 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.4511
2025-08-04 20:47:45,826 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:45,827 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:47:45,827 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:47:45,827 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:47:45,827 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:47:45,827 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:46,099 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:46,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:46,188 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:47:46,229 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:47:46,230 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:46,333 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:46,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:46,339 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:46,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:47:46,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:46,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:47:46,351 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:46,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:46,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:47:46,362 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:46,366 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,369 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:46,372 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:46,375 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:46,378 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:46,380 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,383 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:46,386 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:46,388 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:46,390 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:46,400 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:46,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:47:46,405 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:47:46,405 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:47:46,409 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:46,409 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:47:46,419 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:46,419 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:47:46,419 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:46,436 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:46,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:47:46,449 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:47:46,449 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:46,449 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:46,449 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:46,449 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:46,450 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:46,450 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:47:46,450 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:46,450 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:47:46,450 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:46,452 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:47:46,452 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:47:46,453 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:46,453 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:47:46,453 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:46,453 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:46,453 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:46,453 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:47:46,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:47:46,454 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:47:46,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:47:46,454 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:47:46,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:47:46,454 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:47:46,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:47:46,455 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:47:46,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:47:46,456 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:47:46,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:47:46,456 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:46,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:47:46,456 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:46,457 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:46,457 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:46,457 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:47:46,457 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:47:46,457 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:47:46,457 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:47:46,461 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:47:46,461 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:46,462 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:46,462 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:47:46,464 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:46,464 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:46,464 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:46,465 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:46,509 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4940, Threshold=0.5432, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:47:46,509 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.4940
2025-08-04 20:48:03,787 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:03,787 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:48:03,787 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:48:03,787 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:48:03,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:48:03,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:04,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:04,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:04,203 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:48:04,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:48:04,234 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:04,341 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:04,348 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:04,348 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:04,353 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:48:04,358 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:04,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:48:04,359 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:04,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:04,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:48:04,368 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:04,371 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,373 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:04,376 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:04,379 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:04,381 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:04,383 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,386 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:04,388 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:04,390 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:04,392 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:04,404 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:04,404 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:48:04,409 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:48:04,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:48:04,415 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:04,415 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:48:04,427 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:04,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:48:04,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:04,443 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:04,448 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:48:04,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:48:04,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:04,455 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:04,455 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:04,456 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:04,456 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:04,456 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:48:04,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:04,456 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:48:04,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:04,458 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:48:04,458 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:48:04,458 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:04,458 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:48:04,459 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:04,459 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:04,459 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:04,459 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:48:04,459 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:48:04,460 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:48:04,460 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:48:04,460 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:48:04,460 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:48:04,460 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:48:04,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:48:04,461 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:48:04,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:48:04,461 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:48:04,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:48:04,462 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:04,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:48:04,462 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:04,463 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:04,463 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:04,463 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:48:04,463 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:48:04,463 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:48:04,463 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:48:04,467 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:48:04,467 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:04,468 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:04,468 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:48:04,470 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:04,470 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:04,470 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:04,471 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:04,515 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5267, Threshold=0.5833, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:48:04,515 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.5267
2025-08-04 20:48:15,795 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:15,795 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:48:15,795 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:48:15,795 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:48:15,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:48:15,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:16,168 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:16,169 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:16,261 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:48:16,306 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:48:16,306 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:16,406 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:16,415 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:16,415 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:16,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:48:16,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:16,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:48:16,429 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:16,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:16,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:48:16,439 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:16,442 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,444 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:16,446 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:16,449 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:16,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:16,454 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,457 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:16,459 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:16,461 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:16,463 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:16,473 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:16,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:48:16,478 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:48:16,478 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:48:16,483 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:16,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:48:16,494 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:16,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:48:16,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:16,512 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:16,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:48:16,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:48:16,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:16,525 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:16,525 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:16,526 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:16,526 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:16,526 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:48:16,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:16,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:48:16,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:16,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:48:16,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:48:16,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:48:16,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:48:16,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:48:16,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:48:16,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:48:16,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:48:16,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:48:16,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:48:16,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:48:16,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:48:16,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:48:16,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:16,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:48:16,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:16,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:16,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:16,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:48:16,534 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:48:16,534 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:48:16,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:48:16,538 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:48:16,538 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:16,540 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:16,540 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:48:16,542 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:16,542 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:16,542 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:16,543 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:16,588 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5600, Threshold=0.6182, Accuracy=0.7273, F1=0.8115, Precision=0.9785, Recall=0.6933
2025-08-04 20:48:16,588 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7273, F1: 0.8115, Prec: 0.9785, Rec: 0.6933, Avg Anomaly Score: 0.5600
2025-08-04 20:48:27,868 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:27,868 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:48:27,868 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:48:27,868 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:48:27,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:48:27,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:28,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:28,134 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:28,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:48:28,251 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:48:28,252 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:28,370 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:28,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:28,378 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:28,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:48:28,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:28,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:48:28,408 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:28,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:28,409 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:48:28,417 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:28,420 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,422 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:28,425 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:28,427 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:28,430 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:28,432 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,435 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:28,438 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:28,439 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:28,442 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:28,455 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:28,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:48:28,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:48:28,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:48:28,468 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:28,468 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:48:28,483 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:28,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:48:28,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:28,501 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:28,507 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:48:28,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:48:28,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:28,515 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:28,515 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:28,516 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:28,516 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:28,516 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:48:28,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:28,516 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:48:28,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:28,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:48:28,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:48:28,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:28,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:48:28,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:48:28,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:48:28,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:48:28,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:48:28,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:48:28,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:48:28,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:48:28,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:48:28,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:48:28,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:28,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:48:28,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:28,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:28,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:28,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:48:28,523 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:48:28,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:48:28,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:48:28,529 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:48:28,529 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:28,531 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:28,531 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:48:28,532 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:28,532 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:28,533 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:28,533 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:28,579 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4690, Threshold=0.5148, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:48:28,580 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4690
2025-08-04 20:48:42,863 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:42,864 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:48:42,864 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:48:42,864 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:48:42,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:48:42,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:43,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:43,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:43,224 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:48:43,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:48:43,263 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:43,366 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:43,373 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:43,373 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:43,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:48:43,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:43,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:48:43,386 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:43,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:43,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:48:43,395 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:43,398 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,401 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:43,403 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:43,406 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:43,408 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:43,411 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,413 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:43,416 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:43,418 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:43,420 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:43,430 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:43,433 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:48:43,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:48:43,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:48:43,443 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:43,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:48:43,453 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:43,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:48:43,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:43,470 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:43,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:48:43,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:48:43,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:43,483 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:43,483 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:43,484 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:43,484 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:43,484 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:48:43,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:43,485 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:48:43,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:43,486 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:48:43,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:48:43,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:48:43,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:48:43,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:48:43,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:48:43,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:48:43,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:48:43,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:48:43,489 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:48:43,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:48:43,490 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:48:43,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:48:43,490 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:43,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:48:43,490 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:43,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:43,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:43,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:48:43,491 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:48:43,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:48:43,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:48:43,497 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:48:43,497 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:43,499 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:43,499 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:48:43,500 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:43,501 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:43,501 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:43,501 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:43,545 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4899, Threshold=0.5306, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:48:43,545 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4899
2025-08-04 20:48:48,796 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:48,797 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:48:48,797 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:48:48,797 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:48:48,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:48:48,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:49,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:49,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:49,131 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:48:49,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:48:49,156 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:49,248 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:49,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:49,255 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:49,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:48:49,265 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:49,265 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:48:49,266 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:49,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:49,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:48:49,274 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:49,277 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:49,280 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:49,282 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:49,284 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:49,287 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:49,289 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:49,292 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:49,294 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:49,296 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:49,298 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:49,308 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:49,308 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:48:49,312 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:48:49,312 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:48:49,317 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:49,317 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:48:49,325 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:49,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:48:49,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:49,341 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:49,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:48:49,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:48:49,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:49,351 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:49,351 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:49,351 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:49,352 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:49,352 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:48:49,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:49,352 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:48:49,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:49,354 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:48:49,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:48:49,354 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:49,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:48:49,355 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:49,355 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:49,355 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:49,355 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:48:49,355 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:48:49,356 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:48:49,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:48:49,356 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:48:49,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:48:49,356 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:48:49,357 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:48:49,357 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:48:49,357 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:48:49,357 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:48:49,357 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:48:49,358 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:49,358 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:48:49,358 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:49,358 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:49,359 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:49,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:48:49,359 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:48:49,359 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:48:49,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:48:49,363 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:48:49,363 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:49,364 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:49,364 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:48:49,366 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 118/400.
2025-08-04 20:48:49,467 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:49,467 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:49,469 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 51 anomalous samples to GAN training data (target: 51).
2025-08-04 20:48:49,469 - ClientAppLogger [Client 4] - INFO - [Client] Round 118: Training GAN with 222 samples (171 normal, 51 anomalous).
2025-08-04 20:48:49,470 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:49,646 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.7849
2025-08-04 20:48:49,646 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.7849
2025-08-04 20:48:49,646 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:49,689 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5492, Threshold=0.6142, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:48:49,690 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8097
2025-08-04 20:48:49,690 - ClientAppLogger [Client 4] - INFO - Fit completed for round 118. Duration: 0.32s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 118, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0830113213341517, 'd_loss': 0.7849276525480253, 'post_fit_local_f1': 0.8097091825051522, 'fit_time_seconds': 0.32391858100891113, 'cpu_percent_fit': 18.5125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 222}
2025-08-04 20:48:49,690 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:48:54,958 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:54,958 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:48:54,959 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:48:54,959 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:48:54,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:48:54,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:55,228 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:55,228 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:55,315 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:48:55,353 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:48:55,354 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:55,454 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:55,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:55,461 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:55,467 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:48:55,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:55,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:48:55,473 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:55,474 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:55,474 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:48:55,483 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:55,486 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,489 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:55,491 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:55,494 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:55,496 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:55,499 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,501 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:55,504 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:55,506 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:55,509 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:55,520 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:55,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:48:55,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:48:55,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:48:55,531 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:55,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:48:55,542 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:55,542 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:48:55,542 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:55,560 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:55,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:48:55,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:48:55,571 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:55,571 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:55,571 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:55,571 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:55,572 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:55,572 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:48:55,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:55,572 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:48:55,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:55,574 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:48:55,574 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:48:55,574 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:55,574 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:48:55,575 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:48:55,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:48:55,576 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:48:55,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:48:55,576 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:48:55,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:48:55,577 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:48:55,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:48:55,577 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:55,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:48:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:55,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:55,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:48:55,579 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:48:55,579 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:48:55,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:48:55,583 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:48:55,583 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:55,585 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:55,585 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:48:55,586 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:55,586 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:55,586 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:55,587 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:55,642 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5193, Threshold=0.5718, Accuracy=0.7273, F1=0.8115, Precision=0.9785, Recall=0.6933
2025-08-04 20:48:55,642 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7273, F1: 0.8115, Prec: 0.9785, Rec: 0.6933, Avg Anomaly Score: 0.5193
2025-08-04 20:49:06,911 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:06,911 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:49:06,912 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:49:06,912 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:49:06,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:49:06,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:07,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:07,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:07,371 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:49:07,399 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:49:07,400 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:07,529 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:07,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:07,540 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:07,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:49:07,567 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:07,567 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:49:07,568 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:07,568 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:07,568 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:49:07,577 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:07,581 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,584 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:07,586 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:07,590 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:07,592 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:07,596 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,599 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:07,601 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:07,603 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:07,606 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:07,616 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:07,616 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:49:07,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:49:07,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:49:07,628 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:07,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:49:07,639 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:07,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:49:07,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:07,655 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:07,660 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:49:07,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:49:07,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:07,668 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:07,669 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:07,669 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:07,669 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:07,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:49:07,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:07,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:49:07,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:07,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:49:07,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:49:07,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:07,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:49:07,673 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:07,673 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:07,673 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:07,673 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:49:07,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:49:07,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:49:07,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:49:07,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:49:07,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:49:07,674 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:49:07,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:49:07,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:49:07,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:49:07,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:49:07,675 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:49:07,675 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:07,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:49:07,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:07,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:07,676 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:07,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:49:07,677 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:49:07,677 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:49:07,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:49:07,685 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:49:07,685 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:07,686 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:07,687 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:49:07,688 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:07,688 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:07,688 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:07,689 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:07,736 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4996, Threshold=0.5460, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:49:07,737 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.4996
2025-08-04 20:49:25,030 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:25,030 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:49:25,030 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:49:25,031 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:49:25,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:49:25,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:25,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:25,310 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:25,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:49:25,447 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:49:25,448 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:25,555 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:25,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:25,564 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:25,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:49:25,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:25,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:49:25,577 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:25,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:25,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:49:25,587 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:25,590 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:25,595 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:25,598 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:25,601 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:25,604 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,608 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:25,612 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:25,615 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:25,618 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:25,628 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:25,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:49:25,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:49:25,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:49:25,639 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:25,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:49:25,653 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:25,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:49:25,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:25,672 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:25,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:49:25,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:49:25,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:25,686 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:25,687 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:25,687 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:25,687 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:25,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:49:25,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:25,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:49:25,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:25,690 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:49:25,690 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:49:25,690 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:25,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:49:25,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:25,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:25,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:25,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:49:25,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:49:25,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:49:25,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:49:25,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:49:25,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:49:25,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:49:25,693 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:49:25,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:49:25,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:49:25,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:49:25,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:49:25,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:25,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:49:25,695 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:25,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:25,696 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:25,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:49:25,697 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:49:25,697 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:49:25,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:49:25,701 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:49:25,701 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:25,703 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:25,703 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:49:25,704 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:25,704 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:25,705 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:25,705 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:25,751 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5178, Threshold=0.5664, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:49:25,752 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5178
2025-08-04 20:49:37,030 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:37,030 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:49:37,030 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:49:37,030 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:49:37,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:49:37,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:37,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:37,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:37,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:49:37,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:49:37,421 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:37,538 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:37,546 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:37,547 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:37,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:49:37,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:37,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:49:37,577 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:37,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:37,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:49:37,586 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:37,590 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,592 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:37,594 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:37,597 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:37,600 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:37,602 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,605 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:37,608 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:37,610 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:37,613 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:37,626 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:37,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:49:37,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:49:37,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:49:37,638 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:37,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:49:37,651 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:37,651 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:49:37,651 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:37,668 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:37,674 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:49:37,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:49:37,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:37,679 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:37,679 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:37,680 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:37,680 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:37,680 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:49:37,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:37,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:49:37,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:37,682 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:49:37,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:49:37,683 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:37,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:49:37,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:37,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:37,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:37,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:49:37,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:49:37,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:49:37,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:49:37,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:49:37,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:49:37,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:49:37,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:49:37,686 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:49:37,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:49:37,686 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:49:37,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:49:37,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:37,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:49:37,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:37,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:37,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:37,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:49:37,688 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:49:37,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:49:37,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:49:37,697 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:49:37,697 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:37,698 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:37,699 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:49:37,700 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:37,700 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:37,700 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:37,701 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:37,745 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4589, Threshold=0.4851, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:49:37,746 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4589
2025-08-04 20:49:43,002 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:43,002 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:49:43,002 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:49:43,003 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:49:43,003 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:49:43,003 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:43,268 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:43,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:43,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:49:43,392 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:49:43,393 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:43,488 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:43,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:43,495 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:43,501 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:49:43,508 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:43,508 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:49:43,509 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:43,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:43,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:49:43,518 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:43,521 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:43,523 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:43,525 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:43,528 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:43,530 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:43,532 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:43,535 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:43,537 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:43,539 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:43,542 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:43,551 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:43,551 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:49:43,556 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:49:43,556 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:49:43,560 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:43,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:49:43,569 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:43,569 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:49:43,569 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:43,585 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:43,590 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:49:43,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:49:43,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:43,596 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:43,596 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:43,596 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:43,597 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:43,597 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:49:43,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:43,597 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:49:43,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:43,599 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:49:43,599 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:49:43,599 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:43,599 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:49:43,600 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:49:43,601 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:49:43,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:49:43,601 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:49:43,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:49:43,601 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:49:43,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:49:43,602 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:49:43,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:49:43,602 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:43,602 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:49:43,602 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:43,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:43,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:43,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:49:43,603 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:49:43,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:49:43,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:49:43,607 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:49:43,607 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:43,608 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:43,608 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:49:43,609 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 122/400.
2025-08-04 20:49:43,711 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:43,711 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:43,712 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 54 anomalous samples to GAN training data (target: 54).
2025-08-04 20:49:43,713 - ClientAppLogger [Client 4] - INFO - [Client] Round 122: Training GAN with 234 samples (180 normal, 54 anomalous).
2025-08-04 20:49:43,713 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:43,917 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7871
2025-08-04 20:49:43,917 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7871
2025-08-04 20:49:43,918 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:43,959 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5408, Threshold=0.6085, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:49:43,960 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8102
2025-08-04 20:49:43,960 - ClientAppLogger [Client 4] - INFO - Fit completed for round 122. Duration: 0.35s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 122, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083870089563549, 'd_loss': 0.7871394197146098, 'post_fit_local_f1': 0.8101671628119991, 'fit_time_seconds': 0.35045552253723145, 'cpu_percent_fit': 18.30625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 234}
2025-08-04 20:49:43,960 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:49:49,226 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:49,226 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:49:49,227 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:49:49,227 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:49:49,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:49:49,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:49,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:49,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:49,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:49:49,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:49:49,591 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:49,705 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:49,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:49,711 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:49,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:49:49,758 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:49,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:49:49,759 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:49,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:49,760 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:49:49,769 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:49,772 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:49,774 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:49,777 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:49,780 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:49,782 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:49,785 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:49,788 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:49,790 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:49,793 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:49,795 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:49,806 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:49,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:49:49,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:49:49,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:49:49,819 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:49,819 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:49:49,835 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:49,835 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:49:49,835 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:49,856 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:49,861 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:49:49,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:49:49,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:49,868 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:49,868 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:49,869 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:49,869 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:49,869 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:49:49,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:49,870 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:49:49,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:49,872 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:49:49,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:49:49,872 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:49,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:49:49,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:49,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:49,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:49,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:49:49,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:49:49,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:49:49,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:49:49,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:49:49,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:49:49,875 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:49:49,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:49:49,875 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:49:49,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:49:49,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:49:49,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:49:49,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:49,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:49:49,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:49,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:49,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:49,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:49:49,878 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:49:49,878 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:49:49,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:49:49,885 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:49:49,886 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:49,887 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:49,888 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:49:49,889 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:49,890 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:49,890 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:49,890 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:49,937 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5283, Threshold=0.5931, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:49:49,937 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7247, F1: 0.8097, Prec: 0.9763, Rec: 0.6917, Avg Anomaly Score: 0.5283
2025-08-04 20:49:55,190 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:55,190 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:49:55,190 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:49:55,190 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:49:55,191 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:49:55,191 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:55,469 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:55,469 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:55,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:49:55,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:49:55,596 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:55,697 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:55,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:55,704 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:55,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:49:55,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:55,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:49:55,719 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:55,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:55,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:49:55,728 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:55,731 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:55,734 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:55,736 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:55,739 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:55,742 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:55,744 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:55,747 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:55,750 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:55,752 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:55,755 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:55,767 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:55,767 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:49:55,772 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:49:55,772 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:49:55,779 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:55,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:49:55,791 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:55,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:49:55,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:55,810 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:55,816 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:49:55,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:49:55,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:55,825 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:55,825 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:55,826 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:55,826 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:55,826 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:49:55,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:55,826 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:49:55,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:55,828 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:49:55,828 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:49:55,829 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:55,829 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:49:55,829 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:55,829 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:49:55,830 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:49:55,831 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:49:55,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:49:55,831 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:49:55,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:49:55,832 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:49:55,832 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:49:55,832 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:55,832 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:49:55,832 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:55,833 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:55,837 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:55,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:49:55,837 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:49:55,837 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:49:55,838 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:49:55,844 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:49:55,844 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:55,846 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:55,846 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:49:55,847 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 123/400.
2025-08-04 20:49:55,949 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:55,949 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:55,950 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 54 anomalous samples to GAN training data (target: 54).
2025-08-04 20:49:55,954 - ClientAppLogger [Client 4] - INFO - [Client] Round 123: Training GAN with 236 samples (182 normal, 54 anomalous).
2025-08-04 20:49:55,954 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:56,170 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.7865
2025-08-04 20:49:56,170 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.7865
2025-08-04 20:49:56,171 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:56,221 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5278, Threshold=0.5874, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:49:56,222 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8102
2025-08-04 20:49:56,222 - ClientAppLogger [Client 4] - INFO - Fit completed for round 123. Duration: 0.37s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 123, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0845022201538086, 'd_loss': 0.7864801777621447, 'post_fit_local_f1': 0.8101671628119991, 'fit_time_seconds': 0.3744990825653076, 'cpu_percent_fit': 18.30625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 236}
2025-08-04 20:49:56,222 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:50:04,480 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:04,480 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:04,481 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:04,481 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:04,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:04,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:04,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:04,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:04,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:04,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:04,868 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:05,014 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:05,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:05,022 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:05,029 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:05,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:05,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:05,037 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:05,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:05,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:05,049 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:05,053 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,056 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:05,058 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:05,062 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:05,064 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:05,068 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,070 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:05,073 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:05,075 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:05,077 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:05,088 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:05,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:05,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:05,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:05,100 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:05,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:05,113 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:05,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:05,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:05,129 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:05,134 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:05,140 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:05,141 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:05,141 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:05,141 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:05,141 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:05,142 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:05,142 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:05,142 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:05,143 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:05,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:05,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:05,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:05,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:05,145 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:05,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:05,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:05,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:05,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:05,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:05,146 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:05,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:05,146 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:05,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:05,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:05,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:05,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:05,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:05,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:05,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:05,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:05,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:05,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:05,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:05,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:05,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:05,150 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:05,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:05,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:05,155 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:05,156 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:05,157 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:05,157 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:05,159 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:05,159 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:05,159 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:05,160 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:05,203 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5455, Threshold=0.6116, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:50:05,204 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5455
2025-08-04 20:50:10,455 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:10,455 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:10,455 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:10,455 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:10,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:10,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:10,722 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:10,722 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:10,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:10,836 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:10,836 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:10,929 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:10,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:10,937 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:10,962 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:11,010 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:11,010 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:11,010 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:11,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:11,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:11,020 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:11,023 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:11,025 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:11,027 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:11,030 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:11,032 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:11,035 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:11,037 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:11,040 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:11,042 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:11,044 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:11,056 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:11,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:11,061 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:11,061 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:11,067 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:11,067 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:11,079 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:11,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:11,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:11,095 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:11,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:11,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:11,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:11,106 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:11,106 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:11,106 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:11,107 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:11,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:11,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:11,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:11,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:11,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:11,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:11,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:11,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:11,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:11,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:11,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:11,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:11,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:11,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:11,111 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:11,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:11,111 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:11,111 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:11,111 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:11,112 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:11,112 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:11,112 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:11,112 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:11,112 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:11,112 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:11,113 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:11,113 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:11,113 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:11,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:11,114 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:11,114 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:11,114 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:11,120 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:11,120 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:11,121 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:11,122 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:11,123 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 124/400.
2025-08-04 20:50:11,224 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:11,224 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:11,225 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 55 anomalous samples to GAN training data (target: 55).
2025-08-04 20:50:11,226 - ClientAppLogger [Client 4] - INFO - [Client] Round 124: Training GAN with 240 samples (185 normal, 55 anomalous).
2025-08-04 20:50:11,226 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:11,421 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7857
2025-08-04 20:50:11,422 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7857
2025-08-04 20:50:11,422 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:11,463 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5451, Threshold=0.6125, Accuracy=0.7253, F1=0.8102, Precision=0.9768, Recall=0.6921
2025-08-04 20:50:11,464 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8102
2025-08-04 20:50:11,464 - ClientAppLogger [Client 4] - INFO - Fit completed for round 124. Duration: 0.34s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 124, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0837063550949098, 'd_loss': 0.7857455309232075, 'post_fit_local_f1': 0.8101671628119991, 'fit_time_seconds': 0.34096288681030273, 'cpu_percent_fit': 18.7125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 240}
2025-08-04 20:50:11,464 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:50:19,724 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:19,724 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:19,724 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:19,724 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:19,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:19,725 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:19,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:19,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:20,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:20,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:20,119 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:20,274 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:20,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:20,284 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:20,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:20,304 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:20,304 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:20,305 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:20,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:20,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:20,315 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:20,318 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,321 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:20,323 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:20,326 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:20,328 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:20,331 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,334 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:20,336 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:20,338 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:20,341 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:20,356 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:20,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:20,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:20,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:20,377 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:20,377 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:20,400 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:20,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:20,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:20,420 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:20,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:20,436 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:20,437 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:20,437 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:20,437 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:20,437 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:20,438 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:20,438 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:20,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:20,438 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:20,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:20,440 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:20,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:20,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:20,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:20,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:20,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:20,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:20,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:20,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:20,442 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:20,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:20,442 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:20,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:20,443 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:20,443 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:20,444 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:20,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:20,444 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:20,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:20,444 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:20,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:20,445 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:20,445 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:20,445 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:20,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:20,446 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:20,446 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:20,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:20,452 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:20,452 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:20,454 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:20,454 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:20,456 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:20,456 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:20,456 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:20,457 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:20,505 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5246, Threshold=0.5888, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:50:20,505 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5246
2025-08-04 20:50:28,764 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:28,764 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:28,764 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:28,764 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:28,764 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:28,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:28,998 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:28,998 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:29,086 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:29,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:29,114 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:29,213 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:29,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:29,220 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:29,229 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:29,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:29,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:29,241 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:29,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:29,242 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:29,251 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:29,254 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:29,257 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:29,259 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:29,262 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:29,264 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:29,267 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:29,270 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:29,273 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:29,275 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:29,277 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:29,287 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:29,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:29,293 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:29,293 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:29,299 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:29,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:29,311 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:29,311 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:29,312 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:29,328 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:29,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:29,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:29,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:29,339 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:29,339 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:29,340 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:29,340 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:29,340 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:29,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:29,341 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:29,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:29,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:29,343 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:29,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:29,343 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:29,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:29,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:29,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:29,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:29,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:29,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:29,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:29,345 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:29,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:29,345 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:29,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:29,346 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:29,346 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:29,346 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:29,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:29,347 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:29,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:29,348 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:29,348 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:29,349 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:29,349 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:29,349 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:29,349 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:29,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:29,353 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:29,353 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:29,355 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:29,355 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:29,356 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 125/400.
2025-08-04 20:50:29,458 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:29,458 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:29,459 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 56 anomalous samples to GAN training data (target: 56).
2025-08-04 20:50:29,460 - ClientAppLogger [Client 4] - INFO - [Client] Round 125: Training GAN with 243 samples (187 normal, 56 anomalous).
2025-08-04 20:50:29,460 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:29,686 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.7747
2025-08-04 20:50:29,687 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.7747
2025-08-04 20:50:29,687 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:29,732 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5427, Threshold=0.6142, Accuracy=0.7247, F1=0.8097, Precision=0.9763, Recall=0.6917
2025-08-04 20:50:29,732 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8097
2025-08-04 20:50:29,732 - ClientAppLogger [Client 4] - INFO - Fit completed for round 125. Duration: 0.38s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 125, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083253089881238, 'd_loss': 0.7746771064069536, 'post_fit_local_f1': 0.8097091825051522, 'fit_time_seconds': 0.3757319450378418, 'cpu_percent_fit': 18.65625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 243}
2025-08-04 20:50:29,733 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:50:37,993 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:37,994 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:37,994 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:37,994 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:37,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:37,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:38,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:38,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:38,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:38,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:38,391 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:38,496 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:38,503 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:38,503 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:38,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:38,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:38,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:38,515 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:38,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:38,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:38,524 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:38,527 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,529 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:38,531 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:38,534 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:38,536 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:38,539 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,541 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:38,544 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:38,546 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:38,548 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:38,559 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:38,559 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:38,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:38,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:38,570 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:38,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:38,583 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:38,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:38,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:38,600 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:38,606 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:38,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:38,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:38,616 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:38,616 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:38,616 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:38,616 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:38,617 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:38,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:38,617 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:38,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:38,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:38,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:38,619 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:38,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:38,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:38,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:38,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:38,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:38,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:38,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:38,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:38,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:38,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:38,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:38,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:38,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:38,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:38,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:38,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:38,624 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:38,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:38,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:38,629 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:38,629 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:38,630 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:38,631 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:38,632 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:38,632 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:38,632 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:38,633 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:38,679 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5314, Threshold=0.5896, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:50:38,679 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.5314
2025-08-04 20:50:43,931 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:43,932 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:43,932 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:43,932 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:43,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:43,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:44,197 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:44,197 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:44,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:44,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:44,315 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:44,406 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:44,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:44,412 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:44,419 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:44,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:44,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:44,427 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:44,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:44,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:44,436 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:44,439 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:44,441 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:44,443 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:44,446 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:44,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:44,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:44,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:44,456 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:44,458 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:44,460 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:44,470 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:44,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:44,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:44,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:44,479 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:44,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:44,488 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:44,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:44,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:44,505 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:44,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:44,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:44,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:44,516 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:44,516 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:44,516 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:44,516 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:44,517 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:44,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:44,517 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:44,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:44,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:44,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:44,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:44,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:44,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:44,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:44,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:44,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:44,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:44,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:44,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:44,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:44,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:44,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:44,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:44,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:44,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:44,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:44,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:44,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:44,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:44,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:44,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:44,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:44,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:44,523 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:44,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:44,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:44,527 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:44,527 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:44,528 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:44,528 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:44,530 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 126/400.
2025-08-04 20:50:44,632 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:44,632 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:44,633 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 57 anomalous samples to GAN training data (target: 57).
2025-08-04 20:50:44,633 - ClientAppLogger [Client 4] - INFO - [Client] Round 126: Training GAN with 247 samples (190 normal, 57 anomalous).
2025-08-04 20:50:44,634 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:44,825 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0825, Avg D Loss: 0.7725
2025-08-04 20:50:44,825 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0825, Avg D Loss: 0.7725
2025-08-04 20:50:44,825 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:44,865 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5410, Threshold=0.6147, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:50:44,865 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:50:44,865 - ClientAppLogger [Client 4] - INFO - Fit completed for round 126. Duration: 0.34s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 126, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0825250811905027, 'd_loss': 0.7724943731236554, 'post_fit_local_f1': 0.8124570643462331, 'fit_time_seconds': 0.3350801467895508, 'cpu_percent_fit': 18.7125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 247}
2025-08-04 20:50:44,865 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:50:50,128 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:50,128 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:50,128 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:50,128 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:50,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:50,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:50,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:50,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:50,632 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:50,676 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:50,676 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:50,796 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:50,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:50,806 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:50,814 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:50,824 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:50,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:50,825 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:50,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:50,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:50,837 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:50,840 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,843 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:50,845 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:50,848 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:50,851 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:50,854 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,856 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:50,859 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:50,862 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:50,865 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:50,878 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:50,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:50,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:50,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:50,892 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:50,892 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:50,919 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:50,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:50,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:50,944 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:50,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:50,958 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:50,958 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:50,958 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:50,959 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:50,959 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:50,959 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:50,959 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:50,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:50,960 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:50,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:50,961 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:50,961 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:50,962 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:50,962 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:50,962 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:50,962 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:50,963 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:50,963 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:50,963 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:50,963 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:50,963 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:50,963 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:50,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:50,964 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:50,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:50,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:50,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:50,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:50,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:50,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:50,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:50,966 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:50,966 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:50,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:50,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:50,970 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:50,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:50,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:50,974 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:50,974 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:50,976 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:50,977 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:50,978 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:50,979 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:50,979 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:50,980 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:51,035 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5222, Threshold=0.5872, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:50:51,036 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5222
2025-08-04 20:50:59,297 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:59,298 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:50:59,298 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:50:59,298 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:50:59,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:50:59,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:59,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:59,572 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:59,656 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:50:59,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:50:59,681 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:59,780 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:59,785 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:59,786 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:59,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:50:59,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:59,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:50:59,803 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:59,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:59,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:50:59,812 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:59,816 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:59,819 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:59,821 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:59,824 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:59,827 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:59,829 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:59,831 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:59,834 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:59,836 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:59,838 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:59,848 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:59,849 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:50:59,853 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:50:59,854 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:50:59,860 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:59,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:50:59,873 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:59,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:50:59,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:59,896 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:59,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:50:59,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:50:59,907 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:59,907 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:59,907 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:59,907 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:59,907 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:59,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:50:59,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:59,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:50:59,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:59,910 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:50:59,910 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:50:59,910 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:59,910 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:50:59,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:59,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:59,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:59,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:50:59,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:50:59,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:50:59,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:50:59,912 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:50:59,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:50:59,912 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:50:59,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:50:59,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:50:59,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:50:59,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:50:59,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:50:59,913 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:59,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:50:59,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:59,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:59,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:59,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:50:59,918 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:50:59,918 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:50:59,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:50:59,925 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:50:59,925 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:59,926 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:59,926 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:50:59,928 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 127/400.
2025-08-04 20:51:00,029 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:00,030 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:00,031 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 57 anomalous samples to GAN training data (target: 57).
2025-08-04 20:51:00,034 - ClientAppLogger [Client 4] - INFO - [Client] Round 127: Training GAN with 248 samples (191 normal, 57 anomalous).
2025-08-04 20:51:00,035 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:00,232 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.7832
2025-08-04 20:51:00,232 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.7832
2025-08-04 20:51:00,232 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:00,274 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5437, Threshold=0.6113, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:51:00,274 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:51:00,275 - ClientAppLogger [Client 4] - INFO - Fit completed for round 127. Duration: 0.35s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 127, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0845239139372302, 'd_loss': 0.7832039973428173, 'post_fit_local_f1': 0.8124570643462331, 'fit_time_seconds': 0.3465707302093506, 'cpu_percent_fit': 18.6, 'ram_mb_fit': 1.71875, 'accumulated_train_samples_this_round': 248}
2025-08-04 20:51:00,275 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:51:05,533 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:05,533 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:51:05,534 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:51:05,534 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:51:05,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:51:05,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:05,801 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:05,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:05,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:51:05,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:51:05,937 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:06,078 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:06,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:06,090 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:06,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:51:06,115 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:06,115 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:51:06,117 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:06,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:06,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:51:06,129 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:06,134 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,137 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:06,140 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:06,144 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:06,146 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:06,150 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,153 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:06,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:06,160 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:06,163 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:06,178 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:06,178 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:51:06,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:51:06,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:51:06,194 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:06,194 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:51:06,214 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:06,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:51:06,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:06,249 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:06,257 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:51:06,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:51:06,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:06,269 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:06,270 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:06,270 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:06,271 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:06,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:51:06,271 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:06,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:51:06,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:06,274 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:51:06,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:51:06,274 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:06,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:51:06,275 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:06,276 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:06,276 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:06,276 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:51:06,276 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:51:06,278 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:51:06,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:51:06,278 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:51:06,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:51:06,279 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:51:06,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:51:06,280 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:51:06,281 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:51:06,281 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:51:06,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:51:06,282 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:06,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:51:06,286 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:06,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:06,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:06,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:51:06,288 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:51:06,289 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:51:06,289 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:51:06,293 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:51:06,297 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:06,299 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:06,299 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:51:06,301 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:06,301 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:06,302 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:06,302 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:06,360 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5247, Threshold=0.5884, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:51:06,360 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5247
2025-08-04 20:51:14,609 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:14,609 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:51:14,610 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:51:14,610 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:51:14,610 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:51:14,610 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:14,859 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:14,859 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:14,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:51:14,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:51:14,974 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:15,062 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:15,067 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:15,068 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:15,074 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:51:15,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:15,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:51:15,083 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:15,083 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:15,083 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:51:15,092 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:15,095 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:15,097 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:15,099 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:15,102 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:15,104 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:15,107 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:15,109 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:15,112 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:15,114 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:15,116 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:15,125 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:15,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:51:15,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:51:15,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:51:15,135 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:15,135 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:51:15,143 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:15,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:51:15,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:15,160 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:15,164 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:51:15,170 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:51:15,170 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:15,170 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:15,170 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:15,171 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:15,171 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:15,171 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:51:15,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:15,171 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:51:15,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:15,173 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:51:15,173 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:51:15,173 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:15,173 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:51:15,173 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:15,173 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:51:15,174 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:51:15,175 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:51:15,175 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:51:15,175 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:51:15,175 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:51:15,175 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:15,175 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:51:15,176 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:15,176 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:15,176 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:15,176 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:51:15,176 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:51:15,177 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:51:15,177 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:51:15,180 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:51:15,180 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:15,181 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:15,181 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:51:15,183 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 128/400.
2025-08-04 20:51:15,284 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:15,284 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:15,287 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 57 anomalous samples to GAN training data (target: 57).
2025-08-04 20:51:15,287 - ClientAppLogger [Client 4] - INFO - [Client] Round 128: Training GAN with 250 samples (193 normal, 57 anomalous).
2025-08-04 20:51:15,288 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:15,489 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7869
2025-08-04 20:51:15,489 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7869
2025-08-04 20:51:15,490 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:15,530 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5214, Threshold=0.5781, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:51:15,530 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8120
2025-08-04 20:51:15,530 - ClientAppLogger [Client 4] - INFO - Fit completed for round 128. Duration: 0.35s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 128, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0847495990753173, 'd_loss': 0.7868621413707734, 'post_fit_local_f1': 0.8119990840393863, 'fit_time_seconds': 0.34769177436828613, 'cpu_percent_fit': 18.2375, 'ram_mb_fit': 2.9296875, 'accumulated_train_samples_this_round': 250}
2025-08-04 20:51:15,531 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:51:20,793 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:20,793 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:51:20,794 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:51:20,794 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:51:20,794 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:51:20,794 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:21,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:21,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:21,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:51:21,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:51:21,261 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:21,388 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:21,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:21,396 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:21,403 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:51:21,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:21,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:51:21,413 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:21,414 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:21,414 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:51:21,425 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:21,429 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,431 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:21,434 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:21,436 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:21,439 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:21,442 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,445 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:21,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:21,452 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:21,454 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:21,465 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:21,465 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:51:21,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:51:21,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:51:21,475 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:21,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:51:21,489 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:21,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:51:21,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:21,507 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:21,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:51:21,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:51:21,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:21,519 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:21,519 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:21,519 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:21,519 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:21,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:51:21,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:21,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:51:21,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:21,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:51:21,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:51:21,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:21,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:51:21,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:21,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:51:21,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:51:21,524 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:51:21,524 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:51:21,524 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:51:21,524 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:51:21,525 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:51:21,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:51:21,525 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:21,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:51:21,525 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:21,526 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:21,526 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:21,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:51:21,526 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:51:21,526 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:51:21,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:51:21,531 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:51:21,531 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:21,532 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:21,532 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:51:21,534 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:21,534 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:21,534 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:21,535 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:21,582 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5191, Threshold=0.5762, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:51:21,582 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5191
2025-08-04 20:51:29,860 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:29,860 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:51:29,860 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:51:29,860 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:51:29,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:51:29,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:30,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:30,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:30,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:51:30,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:51:30,273 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:30,377 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:30,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:30,385 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:30,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:51:30,415 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:30,415 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:51:30,416 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:30,417 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:30,417 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:51:30,430 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:30,433 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,435 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:30,437 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:30,440 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:30,443 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:30,446 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:30,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:30,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:30,455 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:30,465 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:30,465 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:51:30,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:51:30,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:51:30,475 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:30,476 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:51:30,486 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:30,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:51:30,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:30,503 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:30,508 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:51:30,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:51:30,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:30,518 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:30,518 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:30,518 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:30,518 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:30,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:51:30,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:30,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:51:30,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:30,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:51:30,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:51:30,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:30,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:51:30,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:30,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:30,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:30,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:51:30,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:51:30,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:51:30,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:51:30,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:51:30,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:51:30,524 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:51:30,524 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:51:30,525 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:51:30,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:51:30,526 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:51:30,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:51:30,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:30,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:51:30,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:30,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:30,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:30,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:51:30,530 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:51:30,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:51:30,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:51:30,536 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:51:30,536 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:30,538 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:30,538 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:51:30,539 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 129/400.
2025-08-04 20:51:30,641 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:30,641 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:30,643 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 58 anomalous samples to GAN training data (target: 58).
2025-08-04 20:51:30,645 - ClientAppLogger [Client 4] - INFO - [Client] Round 129: Training GAN with 252 samples (194 normal, 58 anomalous).
2025-08-04 20:51:30,645 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:30,860 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.7732
2025-08-04 20:51:30,860 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.7732
2025-08-04 20:51:30,860 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:30,905 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5317, Threshold=0.6015, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:51:30,905 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:51:30,905 - ClientAppLogger [Client 4] - INFO - Fit completed for round 129. Duration: 0.37s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 129, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0833022072201683, 'd_loss': 0.7732375063593425, 'post_fit_local_f1': 0.8124570643462331, 'fit_time_seconds': 0.3656940460205078, 'cpu_percent_fit': 18.20625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 252}
2025-08-04 20:51:30,905 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:51:39,192 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:39,192 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:51:39,192 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:51:39,193 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:51:39,193 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:51:39,193 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:39,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:39,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:39,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:51:39,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:51:39,734 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:39,844 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:39,853 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:39,853 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:39,861 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:51:39,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:39,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:51:39,869 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:39,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:39,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:51:39,878 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:39,881 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,883 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:39,885 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:39,888 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:39,890 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:39,893 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,896 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:39,898 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:39,900 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:39,903 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:39,913 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:39,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:51:39,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:51:39,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:51:39,923 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:39,923 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:51:39,932 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:39,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:51:39,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:39,950 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:39,955 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:51:39,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:51:39,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:39,964 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:39,964 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:39,965 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:39,965 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:39,965 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:51:39,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:39,966 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:51:39,966 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:39,967 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:51:39,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:51:39,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:39,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:51:39,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:51:39,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:51:39,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:51:39,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:51:39,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:51:39,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:51:39,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:51:39,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:51:39,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:39,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:51:39,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:39,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:39,972 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:39,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:51:39,972 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:51:39,972 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:51:39,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:51:39,978 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:51:39,979 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:39,980 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:39,980 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:51:39,981 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:39,981 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:39,981 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:39,982 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:40,025 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5189, Threshold=0.5806, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:51:40,025 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5189
2025-08-04 20:51:54,332 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:54,332 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:51:54,333 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:51:54,333 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:51:54,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:51:54,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,794 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,794 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:54,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:51:54,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:51:54,923 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:55,030 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:55,037 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:55,037 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:55,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:51:55,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:55,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:51:55,057 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:55,057 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:55,057 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:51:55,067 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:55,069 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:55,072 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:55,074 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:55,076 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:55,078 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:55,081 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:55,083 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:55,086 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:55,088 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:55,090 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:55,100 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:55,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:51:55,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:51:55,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:51:55,110 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:55,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:51:55,121 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:55,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:51:55,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:55,138 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:55,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:51:55,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:51:55,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:55,151 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:55,151 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:55,151 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:55,151 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:55,152 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:51:55,152 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:55,152 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:51:55,152 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:55,153 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:51:55,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:51:55,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:55,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:51:55,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:55,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:51:55,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:51:55,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:51:55,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:51:55,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:51:55,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:51:55,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:51:55,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:51:55,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:55,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:51:55,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:55,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:55,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:55,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:51:55,158 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:51:55,159 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:51:55,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:51:55,164 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:51:55,164 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:55,165 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:55,166 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:51:55,167 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:55,167 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:55,168 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:55,168 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:55,212 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4910, Threshold=0.5327, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:51:55,213 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.4910
2025-08-04 20:52:00,487 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:00,487 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:00,487 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:00,487 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:00,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:00,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:00,817 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:00,817 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:00,910 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:00,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:00,946 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:01,041 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:01,047 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:01,048 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:01,053 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:01,059 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:01,059 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:01,059 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:01,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:01,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:01,068 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:01,071 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:01,074 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:01,076 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:01,079 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:01,081 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:01,084 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:01,086 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:01,089 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:01,091 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:01,093 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:01,103 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:01,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:01,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:01,108 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:01,112 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:01,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:01,121 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:01,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:01,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:01,139 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:01,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:01,153 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:01,153 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:01,153 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:01,153 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:01,154 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:01,154 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:01,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:01,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:01,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:01,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:01,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:01,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:01,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:01,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:01,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:01,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:01,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:01,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:01,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:01,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:01,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:01,159 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:01,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:01,159 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:01,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:01,159 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:01,160 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:01,160 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:01,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:01,160 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:01,160 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:01,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:01,167 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:01,167 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:01,168 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:01,168 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:01,170 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 131/400.
2025-08-04 20:52:01,271 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:01,271 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:01,272 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 59 anomalous samples to GAN training data (target: 59).
2025-08-04 20:52:01,272 - ClientAppLogger [Client 4] - INFO - [Client] Round 131: Training GAN with 258 samples (199 normal, 59 anomalous).
2025-08-04 20:52:01,273 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:01,498 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0831, Avg D Loss: 0.7723
2025-08-04 20:52:01,498 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0831, Avg D Loss: 0.7723
2025-08-04 20:52:01,499 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:01,542 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5256, Threshold=0.5920, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:01,542 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8120
2025-08-04 20:52:01,543 - ClientAppLogger [Client 4] - INFO - Fit completed for round 131. Duration: 0.37s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 131, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0830838013064956, 'd_loss': 0.7723496165386466, 'post_fit_local_f1': 0.8119990840393863, 'fit_time_seconds': 0.3727889060974121, 'cpu_percent_fit': 18.4, 'ram_mb_fit': 0.5078125, 'accumulated_train_samples_this_round': 258}
2025-08-04 20:52:01,543 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:52:06,860 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,861 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:06,861 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:06,862 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:06,862 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:06,862 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:07,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:07,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:07,323 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:07,371 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:07,371 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:07,492 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:07,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:07,498 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:07,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:07,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:07,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:07,510 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:07,510 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:07,510 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:07,519 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:07,522 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,524 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:07,526 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:07,529 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:07,531 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:07,534 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,536 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:07,539 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:07,541 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:07,543 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:07,555 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:07,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:07,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:07,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:07,566 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:07,566 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:07,574 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:07,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:07,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:07,589 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:07,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:07,599 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:07,599 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:07,599 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:07,600 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:07,600 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:07,600 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:07,601 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:07,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:07,601 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:07,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:07,602 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:07,603 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:07,604 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:07,605 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:07,605 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:07,605 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:07,605 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:07,606 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:07,606 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:07,606 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:07,606 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:07,606 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:07,606 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:07,607 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:07,607 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:07,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:07,610 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:07,610 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:07,612 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:07,612 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:07,613 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:07,614 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:07,614 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:07,615 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:07,656 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5168, Threshold=0.5735, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:07,656 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5168
2025-08-04 20:52:12,934 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:12,934 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:12,934 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:12,934 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:12,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:12,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:13,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:13,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:13,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:13,353 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:13,353 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:13,449 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:13,455 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:13,455 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:13,463 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:13,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:13,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:13,472 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:13,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:13,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:13,482 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:13,485 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:13,487 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:13,489 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:13,492 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:13,494 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:13,497 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:13,500 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:13,503 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:13,505 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:13,508 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:13,517 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:13,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:13,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:13,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:13,527 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:13,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:13,535 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:13,536 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:13,536 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:13,550 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:13,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:13,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:13,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:13,560 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:13,560 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:13,561 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:13,561 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:13,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:13,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:13,561 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:13,562 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:13,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:13,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:13,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:13,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:13,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:13,565 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:13,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:13,565 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:13,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:13,565 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:13,566 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:13,566 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:13,566 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:13,566 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:13,566 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:13,567 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:13,567 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:13,567 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:13,567 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:13,568 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:13,568 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:13,568 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:13,571 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:13,571 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:13,573 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:13,573 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:13,574 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 132/400.
2025-08-04 20:52:13,675 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:13,675 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:13,677 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 60 anomalous samples to GAN training data (target: 60).
2025-08-04 20:52:13,677 - ClientAppLogger [Client 4] - INFO - [Client] Round 132: Training GAN with 260 samples (200 normal, 60 anomalous).
2025-08-04 20:52:13,677 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:13,906 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0810, Avg D Loss: 0.7797
2025-08-04 20:52:13,907 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0810, Avg D Loss: 0.7797
2025-08-04 20:52:13,907 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:13,950 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5585, Threshold=0.6219, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:52:13,950 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:52:13,950 - ClientAppLogger [Client 4] - INFO - Fit completed for round 132. Duration: 0.38s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 132, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0809547996521, 'd_loss': 0.7797456894471095, 'post_fit_local_f1': 0.8124570643462331, 'fit_time_seconds': 0.37609410285949707, 'cpu_percent_fit': 18.38125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 260}
2025-08-04 20:52:13,951 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:52:19,254 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:19,254 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:19,255 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:19,255 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:19,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:19,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:19,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:19,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:19,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:19,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:19,672 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:19,778 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:19,786 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:19,786 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:19,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:19,799 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:19,799 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:19,799 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:19,799 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:19,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:19,808 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:19,811 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,816 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:19,821 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:19,825 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:19,828 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:19,831 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,835 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:19,838 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:19,840 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:19,842 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:19,852 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:19,852 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:19,857 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:19,857 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:19,862 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:19,862 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:19,870 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:19,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:19,872 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:19,889 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:19,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:19,902 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:19,902 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:19,902 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:19,902 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:19,903 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:19,903 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:19,903 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:19,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:19,903 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:19,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:19,905 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:19,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:19,905 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:19,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:19,905 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:19,906 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:19,907 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:19,907 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:19,907 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:19,907 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:19,907 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:19,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:19,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:19,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:19,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:19,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:19,909 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:19,909 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:19,909 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:19,909 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:19,909 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:19,909 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:19,917 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:19,917 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:19,918 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:19,918 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:19,920 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:19,920 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:19,920 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:19,921 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:19,962 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5369, Threshold=0.5969, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:19,962 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5369
2025-08-04 20:52:37,275 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:37,275 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:37,276 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:37,277 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:37,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:37,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:37,584 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:37,584 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:37,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:37,700 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:37,700 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:37,833 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:37,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:37,841 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:37,861 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:37,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:37,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:37,886 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:37,886 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:37,886 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:37,894 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:37,899 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,904 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:37,906 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:37,909 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:37,912 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:37,915 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,918 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:37,921 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:37,924 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:37,926 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:37,936 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:37,936 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:37,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:37,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:37,946 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:37,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:37,959 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:37,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:37,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:37,977 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:37,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:37,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:37,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:37,988 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:37,988 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:37,988 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:37,989 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:37,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:37,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:37,989 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:37,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:37,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:37,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:37,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:37,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:37,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:37,991 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:37,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:37,993 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:37,993 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:37,994 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:37,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:37,994 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:37,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:37,994 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:37,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:37,995 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:37,995 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:37,995 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:37,995 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:37,995 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:37,996 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:37,996 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:38,003 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:38,003 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:38,005 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:38,005 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:38,007 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:38,007 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:38,007 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:38,008 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:38,049 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5744, Threshold=0.6426, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:38,049 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5744
2025-08-04 20:52:43,320 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:43,320 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:43,320 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:43,321 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:43,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:43,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:43,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:43,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:43,713 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:43,750 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:43,750 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:43,842 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:43,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:43,848 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:43,853 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:43,858 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:43,858 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:43,858 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:43,858 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:43,859 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:43,867 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:43,869 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:43,872 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:43,874 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:43,877 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:43,879 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:43,881 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:43,884 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:43,887 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:43,888 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:43,891 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:43,900 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:43,900 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:43,904 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:43,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:43,909 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:43,909 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:43,918 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:43,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:43,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:43,933 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:43,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:43,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:43,942 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:43,942 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:43,942 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:43,943 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:43,943 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:43,943 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:43,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:43,944 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:43,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:43,945 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:43,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:43,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:43,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:43,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:43,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:43,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:43,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:43,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:43,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:43,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:43,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:43,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:43,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:43,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:43,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:43,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:43,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:43,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:43,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:43,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:43,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:43,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:43,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:43,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:43,950 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:43,951 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:43,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:43,955 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:43,955 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:43,956 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:43,956 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:43,958 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 134/400.
2025-08-04 20:52:44,059 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:44,059 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:44,060 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 60 anomalous samples to GAN training data (target: 60).
2025-08-04 20:52:44,060 - ClientAppLogger [Client 4] - INFO - [Client] Round 134: Training GAN with 263 samples (203 normal, 60 anomalous).
2025-08-04 20:52:44,060 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:44,277 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0854, Avg D Loss: 0.7747
2025-08-04 20:52:44,278 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0854, Avg D Loss: 0.7747
2025-08-04 20:52:44,278 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:44,320 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5265, Threshold=0.5836, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:44,320 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8120
2025-08-04 20:52:44,321 - ClientAppLogger [Client 4] - INFO - Fit completed for round 134. Duration: 0.36s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 134, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.08540670907996, 'd_loss': 0.7747404111428858, 'post_fit_local_f1': 0.8119990840393863, 'fit_time_seconds': 0.3627488613128662, 'cpu_percent_fit': 18.6125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 263}
2025-08-04 20:52:44,321 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:52:49,619 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:49,619 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:49,620 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:49,620 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:49,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:49,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:49,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:49,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:50,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:50,049 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:50,049 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:50,147 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:50,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:50,154 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:50,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:50,170 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:50,170 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:50,170 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:50,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:50,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:50,180 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:50,183 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,186 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:50,188 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:50,191 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:50,193 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:50,196 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,199 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:50,202 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:50,204 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:50,207 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:50,219 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:50,219 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:50,224 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:50,224 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:50,230 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:50,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:50,239 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:50,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:50,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:50,255 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:50,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:50,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:50,266 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:50,266 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:50,266 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:50,266 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:50,267 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:50,267 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:50,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:50,268 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:50,268 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:50,269 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:50,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:50,270 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:50,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:50,270 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:50,270 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:50,270 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:50,270 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:50,271 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:50,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:50,271 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:50,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:50,271 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:50,271 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:50,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:50,272 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:50,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:50,272 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:50,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:50,272 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:50,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:50,273 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:50,273 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:50,273 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:50,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:50,274 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:50,274 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:50,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:50,278 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:50,278 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:50,280 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:50,280 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:50,282 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:50,282 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:50,282 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:50,283 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:50,329 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5127, Threshold=0.5608, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:50,330 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5127
2025-08-04 20:52:55,592 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:55,592 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:52:55,592 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:52:55,592 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:52:55,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:52:55,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:55,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:55,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:56,010 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:52:56,047 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:52:56,047 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:56,143 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:56,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:56,149 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:56,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:52:56,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:56,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:52:56,161 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:56,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:56,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:52:56,169 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:56,172 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:56,174 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:56,177 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:56,179 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:56,182 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:56,184 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:56,187 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:56,190 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:56,192 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:56,194 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:56,205 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:56,205 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:52:56,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:52:56,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:52:56,214 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:56,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:52:56,223 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:56,223 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:52:56,223 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:56,239 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:56,244 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:52:56,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:52:56,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:56,253 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:56,253 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:56,254 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:56,254 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:56,254 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:52:56,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:56,255 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:52:56,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:56,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:52:56,257 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:52:56,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:56,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:52:56,258 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:56,258 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:56,258 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:56,258 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:52:56,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:52:56,259 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:52:56,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:52:56,259 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:52:56,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:52:56,259 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:52:56,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:52:56,260 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:52:56,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:52:56,260 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:52:56,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:52:56,261 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:56,261 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:52:56,261 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:56,261 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:56,261 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:56,262 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:52:56,262 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:52:56,262 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:52:56,262 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:52:56,268 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:52:56,268 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:56,270 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:56,270 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:52:56,271 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 135/400.
2025-08-04 20:52:56,373 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:56,373 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:56,374 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 61 anomalous samples to GAN training data (target: 61).
2025-08-04 20:52:56,374 - ClientAppLogger [Client 4] - INFO - [Client] Round 135: Training GAN with 265 samples (204 normal, 61 anomalous).
2025-08-04 20:52:56,375 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:56,595 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7740
2025-08-04 20:52:56,595 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7740
2025-08-04 20:52:56,595 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:56,636 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5323, Threshold=0.5986, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:52:56,636 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8120
2025-08-04 20:52:56,636 - ClientAppLogger [Client 4] - INFO - Fit completed for round 135. Duration: 0.36s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 135, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.08405431072667, 'd_loss': 0.7740052248396964, 'post_fit_local_f1': 0.8119990840393863, 'fit_time_seconds': 0.3647623062133789, 'cpu_percent_fit': 18.725, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 265}
2025-08-04 20:52:56,637 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:53:01,896 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:01,896 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:53:01,897 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:53:01,897 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:53:01,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:53:01,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:02,245 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:02,245 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:02,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:53:02,359 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:53:02,360 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:02,482 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:02,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:02,489 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:02,501 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:53:02,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:02,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:53:02,526 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:02,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:02,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:53:02,536 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:02,540 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,542 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:02,544 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:02,549 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:02,552 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:02,555 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,557 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:02,560 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:02,562 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:02,565 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:02,575 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:02,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:53:02,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:53:02,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:53:02,586 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:02,586 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:53:02,594 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:02,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:53:02,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:02,609 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:02,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:53:02,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:53:02,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:02,619 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:02,619 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:02,619 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:02,620 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:02,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:53:02,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:02,622 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:53:02,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:02,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:53:02,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:53:02,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:02,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:53:02,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:02,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:02,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:02,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:53:02,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:53:02,628 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:53:02,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:53:02,628 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:53:02,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:53:02,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:02,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:53:02,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:02,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:02,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:02,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:53:02,630 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:53:02,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:53:02,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:53:02,636 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:53:02,636 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:02,638 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:02,638 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:53:02,640 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:02,640 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:02,641 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:02,642 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:02,686 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5188, Threshold=0.5800, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:53:02,686 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5188
2025-08-04 20:53:13,955 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:13,955 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:53:13,956 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:53:13,956 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:53:13,956 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:53:13,956 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:14,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:14,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:14,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:53:14,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:53:14,403 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:14,528 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:14,536 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:14,536 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:14,543 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:53:14,551 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:14,552 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:53:14,553 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:14,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:14,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:53:14,564 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:14,570 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,574 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:14,576 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:14,580 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:14,582 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:14,585 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,587 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:14,591 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:14,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:14,596 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:14,607 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:14,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:53:14,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:53:14,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:53:14,618 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:14,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:53:14,630 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:14,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:53:14,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:14,645 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:14,650 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:53:14,656 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:53:14,656 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:14,656 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:14,657 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:14,657 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:14,658 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:14,658 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:53:14,658 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:14,658 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:53:14,659 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:14,660 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:53:14,660 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:53:14,661 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:14,662 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:53:14,662 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:14,662 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:14,662 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:14,664 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:53:14,664 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:53:14,664 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:53:14,664 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:53:14,665 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:53:14,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:53:14,665 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:53:14,665 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:53:14,666 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:53:14,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:53:14,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:53:14,670 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:53:14,670 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:14,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:53:14,671 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:14,671 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:14,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:14,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:53:14,672 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:53:14,672 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:53:14,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:53:14,677 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:53:14,678 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:14,679 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:14,679 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:53:14,680 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:14,680 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:14,681 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:14,681 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:14,727 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5484, Threshold=0.6095, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:53:14,728 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5484
2025-08-04 20:53:35,004 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:35,004 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:53:35,004 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:53:35,005 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:53:35,005 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:53:35,005 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:35,290 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:35,290 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:35,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:53:35,403 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:53:35,403 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:35,552 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:35,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:35,563 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:35,571 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:53:35,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:35,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:53:35,580 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:35,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:35,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:53:35,590 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:35,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,596 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:35,598 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:35,601 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:35,603 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:35,606 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,608 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:35,611 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:35,613 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:35,615 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:35,627 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:35,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:53:35,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:53:35,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:53:35,644 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:35,645 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:53:35,660 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:35,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:53:35,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:35,685 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:35,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:53:35,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:53:35,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:35,699 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:35,700 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:35,700 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:35,701 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:35,702 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:53:35,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:35,702 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:53:35,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:35,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:53:35,706 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:53:35,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:35,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:53:35,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:35,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:35,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:35,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:53:35,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:53:35,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:53:35,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:53:35,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:53:35,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:53:35,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:53:35,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:53:35,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:53:35,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:53:35,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:53:35,713 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:53:35,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:35,714 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:53:35,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:35,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:35,715 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:35,715 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:53:35,716 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:53:35,716 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:53:35,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:53:35,724 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:53:35,724 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:35,727 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:35,727 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:53:35,728 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:35,728 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:35,729 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:35,729 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:35,773 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5473, Threshold=0.6038, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:53:35,773 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5473
2025-08-04 20:53:41,033 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:41,034 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:53:41,034 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:53:41,034 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:53:41,034 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:53:41,034 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:41,352 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:41,353 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:41,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:53:41,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:53:41,481 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:41,602 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:41,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:41,609 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:41,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:53:41,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:41,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:53:41,621 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:41,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:41,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:53:41,629 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:41,632 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:41,634 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:41,636 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:41,639 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:41,641 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:41,644 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:41,646 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:41,649 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:41,651 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:41,653 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:41,662 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:41,662 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:53:41,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:53:41,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:53:41,671 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:41,671 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:53:41,680 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:41,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:53:41,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:41,696 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:41,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:53:41,706 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:53:41,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:41,707 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:41,707 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:41,707 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:41,708 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:41,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:53:41,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:41,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:53:41,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:41,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:53:41,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:53:41,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:41,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:53:41,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:53:41,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:53:41,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:53:41,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:53:41,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:53:41,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:53:41,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:53:41,713 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:53:41,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:41,713 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:53:41,713 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:41,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:41,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:41,714 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:53:41,714 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:53:41,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:53:41,715 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:53:41,718 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:53:41,718 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:41,719 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:41,720 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:53:41,721 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 138/400.
2025-08-04 20:53:41,822 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:41,823 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:41,824 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 62 anomalous samples to GAN training data (target: 62).
2025-08-04 20:53:41,824 - ClientAppLogger [Client 4] - INFO - [Client] Round 138: Training GAN with 270 samples (208 normal, 62 anomalous).
2025-08-04 20:53:41,824 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:42,041 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7803
2025-08-04 20:53:42,042 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7803
2025-08-04 20:53:42,042 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:42,083 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5549, Threshold=0.6227, Accuracy=0.7266, F1=0.8111, Precision=0.9779, Recall=0.6929
2025-08-04 20:53:42,084 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8111
2025-08-04 20:53:42,084 - ClientAppLogger [Client 4] - INFO - Fit completed for round 138. Duration: 0.36s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 138, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0841195088845716, 'd_loss': 0.7802776200683028, 'post_fit_local_f1': 0.8110831234256927, 'fit_time_seconds': 0.36230921745300293, 'cpu_percent_fit': 18.6375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 270}
2025-08-04 20:53:42,084 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:53:56,353 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:56,353 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:53:56,353 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:53:56,354 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:53:56,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:53:56,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:56,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:56,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:56,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:53:56,833 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:53:56,833 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:56,945 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:56,955 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:56,956 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:56,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:53:57,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:57,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:53:57,017 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:57,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:57,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:53:57,027 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:57,031 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,033 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:57,036 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:57,039 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:57,041 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:57,043 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,046 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:57,049 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:57,051 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:57,054 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:57,070 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:57,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:53:57,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:53:57,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:53:57,087 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:57,087 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:53:57,103 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:57,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:53:57,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:57,121 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:57,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:53:57,132 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:53:57,132 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:57,133 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:57,133 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:57,133 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:57,133 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:57,134 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:53:57,135 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:57,135 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:53:57,135 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:57,137 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:53:57,137 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:53:57,137 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:57,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:53:57,138 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:57,138 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:57,139 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:57,140 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:53:57,140 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:53:57,140 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:53:57,141 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:53:57,141 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:53:57,141 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:53:57,142 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:53:57,142 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:53:57,143 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:53:57,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:53:57,143 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:53:57,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:53:57,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:57,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:53:57,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:57,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:57,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:57,145 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:53:57,145 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:53:57,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:53:57,145 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:53:57,152 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:53:57,152 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:57,154 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:57,154 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:53:57,156 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:57,156 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:57,156 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:57,157 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:57,203 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5383, Threshold=0.5998, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:53:57,203 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7286, F1: 0.8125, Prec: 0.9796, Rec: 0.6941, Avg Anomaly Score: 0.5383
2025-08-04 20:54:14,499 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:14,499 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:54:14,499 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:54:14,499 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:54:14,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:54:14,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:15,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:15,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:15,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:54:15,188 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:54:15,189 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:15,356 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:15,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:15,366 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:15,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:54:15,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:15,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:54:15,386 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:15,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:15,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:54:15,396 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:15,401 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,403 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:15,406 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:15,412 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:15,416 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:15,420 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,424 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:15,429 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:15,433 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:15,437 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:15,459 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:15,459 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:54:15,465 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:54:15,466 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:54:15,481 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:15,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:54:15,507 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:15,508 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:54:15,508 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:15,529 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:15,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:54:15,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:54:15,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:15,553 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:15,553 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:15,554 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:15,554 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:15,554 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:54:15,554 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:15,555 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:54:15,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:15,556 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:54:15,556 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:54:15,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:15,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:54:15,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:15,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:15,557 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:15,558 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:54:15,558 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:54:15,558 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:54:15,558 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:54:15,558 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:54:15,558 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:54:15,559 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:54:15,559 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:54:15,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:54:15,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:54:15,560 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:54:15,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:54:15,562 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:15,562 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:54:15,562 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:15,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:15,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:15,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:54:15,563 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:54:15,563 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:54:15,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:54:15,575 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:54:15,575 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:15,576 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:15,577 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:54:15,578 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:15,578 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:15,579 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:15,579 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:15,632 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5746, Threshold=0.6436, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:54:15,633 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5746
2025-08-04 20:54:20,926 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:20,926 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:54:20,926 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:54:20,926 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:54:20,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:54:20,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:21,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:21,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:21,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:54:21,399 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:54:21,399 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:21,501 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:21,507 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:21,507 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:21,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:54:21,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:21,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:54:21,534 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:21,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:21,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:54:21,543 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:21,547 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:21,549 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:21,551 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:21,554 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:21,557 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:21,559 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:21,562 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:21,565 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:21,567 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:21,570 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:21,579 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:21,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:54:21,584 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:54:21,584 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:54:21,589 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:21,589 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:54:21,598 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:21,598 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:54:21,598 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:21,615 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:21,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:54:21,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:54:21,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:21,625 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:21,625 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:21,626 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:21,626 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:21,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:54:21,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:21,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:54:21,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:21,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:54:21,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:54:21,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:21,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:54:21,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:21,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:21,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:21,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:54:21,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:54:21,631 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:54:21,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:54:21,631 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:54:21,632 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:54:21,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:54:21,632 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:54:21,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:54:21,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:54:21,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:54:21,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:54:21,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:21,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:54:21,634 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:21,634 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:21,634 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:21,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:54:21,635 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:54:21,635 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:54:21,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:54:21,643 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:54:21,643 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:21,644 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:21,644 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:54:21,646 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 140/400.
2025-08-04 20:54:21,747 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:21,747 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:21,748 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 63 anomalous samples to GAN training data (target: 63).
2025-08-04 20:54:21,749 - ClientAppLogger [Client 4] - INFO - [Client] Round 140: Training GAN with 275 samples (212 normal, 63 anomalous).
2025-08-04 20:54:21,749 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:21,970 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7710
2025-08-04 20:54:21,970 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7710
2025-08-04 20:54:21,970 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:22,013 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5671, Threshold=0.6451, Accuracy=0.7280, F1=0.8119, Precision=0.9795, Recall=0.6933
2025-08-04 20:54:22,014 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:54:22,014 - ClientAppLogger [Client 4] - INFO - Fit completed for round 140. Duration: 0.37s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 140, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838605764562432, 'd_loss': 0.771038760878823, 'post_fit_local_f1': 0.8119129438717068, 'fit_time_seconds': 0.36800289154052734, 'cpu_percent_fit': 18.4625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 275}
2025-08-04 20:54:22,014 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:54:33,331 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:33,332 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:54:33,332 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:54:33,332 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:54:33,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:54:33,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,855 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,856 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:33,989 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:54:34,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:54:34,036 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:34,182 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:34,191 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:34,191 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:34,198 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:54:34,212 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:34,213 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:54:34,213 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:34,213 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:34,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:54:34,226 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:34,229 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,231 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:34,233 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:34,236 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:34,239 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:34,243 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,246 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:34,249 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:34,251 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:34,254 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:34,268 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:34,268 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:54:34,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:54:34,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:54:34,282 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:34,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:54:34,297 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:34,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:54:34,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:34,316 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:34,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:54:34,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:54:34,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:34,331 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:34,332 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:34,332 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:34,332 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:34,333 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:54:34,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:34,333 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:54:34,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:34,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:54:34,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:54:34,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:34,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:54:34,335 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:34,336 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:34,336 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:34,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:54:34,337 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:54:34,337 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:54:34,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:54:34,338 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:54:34,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:54:34,339 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:54:34,339 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:54:34,340 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:54:34,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:54:34,341 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:54:34,341 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:54:34,342 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:34,342 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:54:34,343 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:34,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:34,344 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:34,344 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:54:34,345 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:54:34,345 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:54:34,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:54:34,354 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:54:34,354 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:34,357 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:34,357 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:54:34,358 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:34,359 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:34,359 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:34,359 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:34,411 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5321, Threshold=0.5857, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:54:34,411 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5321
2025-08-04 20:54:54,762 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:54,762 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:54:54,762 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:54:54,762 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:54:54,762 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:54:54,763 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:55,229 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:55,229 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:55,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:54:55,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:54:55,351 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:55,498 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:55,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:55,505 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:55,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:54:55,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:55,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:54:55,522 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:55,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:55,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:54:55,531 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:55,534 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,536 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:55,538 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:55,541 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:55,544 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:55,546 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,549 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:55,553 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:55,555 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:55,558 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:55,569 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:55,569 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:54:55,574 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:54:55,574 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:54:55,580 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:55,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:54:55,590 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:55,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:54:55,591 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:55,607 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:55,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:54:55,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:54:55,620 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:55,620 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:55,620 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:55,621 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:55,621 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:55,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:54:55,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:55,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:54:55,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:55,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:54:55,623 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:54:55,623 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:54:55,624 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:54:55,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:54:55,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:54:55,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:54:55,625 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:54:55,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:54:55,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:54:55,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:54:55,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:54:55,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:54:55,626 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:55,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:54:55,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:55,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:55,627 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:55,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:54:55,628 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:54:55,628 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:54:55,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:54:55,636 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:54:55,636 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:55,637 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:55,637 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:54:55,639 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:55,639 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:55,639 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:55,640 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:55,690 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5625, Threshold=0.6194, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:54:55,690 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5625
2025-08-04 20:55:16,029 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:16,030 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:55:16,030 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:55:16,030 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:55:16,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:55:16,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:16,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:16,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:16,507 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:55:16,544 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:55:16,545 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:16,650 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:16,659 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:16,659 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:16,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:55:16,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:16,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:55:16,678 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:16,678 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:16,678 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:55:16,687 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:16,690 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,692 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:16,695 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:16,697 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:16,700 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:16,703 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,705 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:16,708 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:16,711 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:16,713 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:16,724 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:16,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:55:16,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:55:16,729 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:55:16,734 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:16,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:55:16,745 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:16,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:55:16,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:16,763 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:16,768 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:55:16,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:55:16,783 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:16,783 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:16,783 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:16,783 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:16,784 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:16,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:55:16,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:16,784 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:55:16,784 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:16,786 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:55:16,786 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:55:16,786 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:16,786 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:55:16,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:16,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:16,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:16,787 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:55:16,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:55:16,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:55:16,788 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:55:16,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:55:16,788 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:55:16,788 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:55:16,789 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:55:16,789 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:55:16,789 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:55:16,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:55:16,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:55:16,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:16,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:55:16,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:16,790 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:16,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:16,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:55:16,791 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:55:16,791 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:55:16,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:55:16,800 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:55:16,800 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:16,801 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:16,802 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:55:16,803 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:16,803 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:16,803 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:16,804 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:16,848 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5471, Threshold=0.6034, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:55:16,848 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5471
2025-08-04 20:55:34,139 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:34,139 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:55:34,139 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:55:34,139 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:55:34,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:55:34,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:34,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:34,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:34,656 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:55:34,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:55:34,682 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:34,814 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:34,823 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:34,824 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:34,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:55:34,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:34,844 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:55:34,845 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:34,845 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:34,845 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:55:34,855 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:34,858 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,861 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:34,865 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:34,868 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:34,870 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:34,873 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,877 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:34,880 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:34,882 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:34,884 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:34,895 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:34,895 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:55:34,900 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:55:34,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:55:34,907 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:34,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:55:34,926 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:34,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:55:34,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:34,946 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:34,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:55:34,962 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:55:34,962 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:34,963 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:34,963 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:34,963 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:34,964 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:34,964 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:55:34,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:34,964 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:55:34,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:34,966 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:55:34,966 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:55:34,967 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:34,967 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:55:34,967 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:34,967 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:34,967 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:34,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:55:34,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:55:34,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:55:34,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:55:34,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:55:34,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:55:34,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:55:34,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:55:34,969 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:55:34,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:55:34,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:55:34,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:55:34,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:34,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:55:34,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:34,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:34,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:34,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:55:34,971 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:55:34,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:55:34,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:55:34,979 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:55:34,979 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:34,980 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:34,981 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:55:34,982 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:34,982 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:34,982 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:34,983 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:35,029 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4811, Threshold=0.5100, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:55:35,029 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4811
2025-08-04 20:55:40,283 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:40,283 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:55:40,283 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:55:40,283 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:55:40,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:55:40,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:40,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:40,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:40,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:55:40,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:55:40,749 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:40,847 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:40,855 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:40,855 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:40,863 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:55:40,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:40,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:55:40,871 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:40,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:40,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:55:40,880 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:40,883 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:40,885 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:40,888 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:40,891 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:40,893 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:40,896 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:40,899 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:40,902 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:40,904 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:40,906 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:40,916 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:40,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:55:40,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:55:40,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:55:40,927 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:40,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:55:40,936 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:40,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:55:40,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:40,955 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:40,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:55:40,967 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:55:40,967 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:40,967 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:40,967 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:40,968 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:40,968 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:40,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:55:40,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:40,968 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:55:40,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:40,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:55:40,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:55:40,970 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:55:40,971 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:55:40,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:55:40,972 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:55:40,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:55:40,972 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:55:40,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:55:40,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:55:40,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:55:40,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:55:40,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:55:40,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:40,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:55:40,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:40,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:40,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:40,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:55:40,974 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:55:40,975 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:55:40,975 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:55:40,980 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:55:40,981 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:40,982 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:40,982 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:55:40,983 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 144/400.
2025-08-04 20:55:41,085 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:41,085 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:41,087 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 65 anomalous samples to GAN training data (target: 65).
2025-08-04 20:55:41,087 - ClientAppLogger [Client 4] - INFO - [Client] Round 144: Training GAN with 282 samples (217 normal, 65 anomalous).
2025-08-04 20:55:41,087 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:41,311 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.7761
2025-08-04 20:55:41,311 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.7761
2025-08-04 20:55:41,311 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:41,354 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5655, Threshold=0.6358, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:55:41,355 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8129
2025-08-04 20:55:41,355 - ClientAppLogger [Client 4] - INFO - Fit completed for round 144. Duration: 0.37s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 144, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0841955374318655, 'd_loss': 0.7761282494304874, 'post_fit_local_f1': 0.81291504465308, 'fit_time_seconds': 0.37131690979003906, 'cpu_percent_fit': 18.50625, 'ram_mb_fit': 4.26171875, 'accumulated_train_samples_this_round': 282}
2025-08-04 20:55:41,355 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:55:55,681 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:55,681 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:55:55,681 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:55:55,681 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:55:55,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:55:55,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:56,099 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:56,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:56,226 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:55:56,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:55:56,269 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:56,370 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:56,377 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:56,377 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:56,397 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:55:56,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,429 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,429 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:55:56,439 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,441 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,444 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,446 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,455 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,458 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,460 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,462 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,472 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:55:56,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:55:56,483 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:55:56,496 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:55:56,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,512 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:55:56,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:55:56,524 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,524 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,524 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,524 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,525 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,525 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:55:56,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,525 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:55:56,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:55:56,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,528 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:55:56,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:55:56,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:55:56,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:55:56,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:55:56,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:55:56,529 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:55:56,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:55:56,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:55:56,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:55:56,530 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:55:56,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:55:56,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:55:56,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,531 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:55:56,532 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:55:56,532 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:55:56,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:55:56,540 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:55:56,541 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,542 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,542 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:55:56,544 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,544 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,544 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,545 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,591 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5814, Threshold=0.6497, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:55:56,591 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5814
2025-08-04 20:56:07,912 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:07,913 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:56:07,914 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:56:07,914 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:56:07,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:56:07,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:08,460 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:08,460 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,571 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:56:08,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:56:08,634 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:08,829 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:08,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:08,838 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:08,845 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:56:08,854 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:08,854 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:56:08,855 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:08,855 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:08,855 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:56:08,864 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:08,867 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,870 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:08,872 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:08,875 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:08,877 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:08,880 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,882 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:08,886 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:08,888 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:08,890 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:08,900 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:08,900 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:56:08,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:56:08,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:56:08,911 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:08,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:56:08,924 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:08,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:56:08,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:08,942 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:08,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:56:08,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:56:08,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:08,953 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:08,954 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:08,954 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:08,954 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:08,954 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:56:08,954 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:08,955 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:56:08,955 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:08,956 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:56:08,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:56:08,957 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:08,957 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:56:08,957 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:08,957 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:08,958 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:08,958 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:56:08,958 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:56:08,958 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:56:08,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:56:08,959 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:56:08,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:56:08,959 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:56:08,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:56:08,960 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:56:08,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:56:08,960 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:56:08,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:56:08,961 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:08,961 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:56:08,961 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:08,962 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:08,962 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:08,962 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:56:08,962 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:56:08,962 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:56:08,963 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:56:08,967 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:56:08,967 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:08,969 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:08,969 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:56:08,970 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:08,970 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:08,971 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:08,971 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:09,016 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5090, Threshold=0.5354, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:56:09,016 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5090
2025-08-04 20:56:26,334 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:26,334 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:56:26,335 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:56:26,335 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:56:26,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:56:26,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:26,762 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:26,762 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:26,850 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:56:26,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:56:26,876 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:27,001 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:27,008 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:27,008 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:27,014 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:56:27,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:27,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:56:27,023 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:27,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:27,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:56:27,032 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:27,035 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:27,037 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:27,040 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:27,042 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:27,044 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:27,047 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:27,049 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:27,052 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:27,054 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:27,056 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:27,066 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:27,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:56:27,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:56:27,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:56:27,076 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:27,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:56:27,088 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:27,088 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:56:27,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:27,105 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:27,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:56:27,116 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:56:27,116 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:27,117 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:27,117 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:27,117 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:27,117 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:27,118 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:56:27,118 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:27,118 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:56:27,118 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:27,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:56:27,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:56:27,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:27,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:56:27,120 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:27,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:27,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:27,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:56:27,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:56:27,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:56:27,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:56:27,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:56:27,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:56:27,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:56:27,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:56:27,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:56:27,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:56:27,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:56:27,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:56:27,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:27,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:56:27,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:27,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:27,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:27,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:56:27,125 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:56:27,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:56:27,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:56:27,131 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:56:27,131 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:27,133 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:27,133 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:56:27,134 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:27,135 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:27,135 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:27,136 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:27,180 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5636, Threshold=0.6250, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 20:56:27,180 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5636
2025-08-04 20:56:47,512 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:47,513 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:56:47,513 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:56:47,513 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:56:47,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:56:47,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:47,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:47,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:48,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:56:48,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:56:48,138 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:48,260 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:48,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:48,267 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:48,273 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:56:48,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:48,281 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:56:48,282 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:48,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:48,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:56:48,290 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:48,294 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,296 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:48,298 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:48,301 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:48,303 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:48,306 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,308 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:48,311 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:48,313 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:48,315 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:48,326 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:48,326 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:56:48,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:56:48,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:56:48,337 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:48,337 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:56:48,349 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:48,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:56:48,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:48,369 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:48,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:56:48,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:56:48,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:48,387 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:48,387 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:48,388 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:48,388 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:48,388 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:56:48,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:48,389 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:56:48,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:48,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:56:48,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:56:48,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:48,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:56:48,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:56:48,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:56:48,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:56:48,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:56:48,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:56:48,394 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:56:48,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:56:48,394 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:56:48,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:56:48,395 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:48,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:56:48,395 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:48,395 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:48,396 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:48,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:56:48,396 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:56:48,396 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:56:48,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:56:48,403 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:56:48,403 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:48,405 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:48,405 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:56:48,406 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:48,407 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:48,407 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:48,407 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:48,449 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4800, Threshold=0.5013, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:56:48,449 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4800
2025-08-04 20:57:05,757 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:05,758 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:57:05,758 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:57:05,759 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:57:05,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:57:05,760 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:06,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:06,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:06,326 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:57:06,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:57:06,356 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:06,498 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:06,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:06,505 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:06,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:57:06,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:06,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:57:06,577 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:06,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:06,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:57:06,588 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:06,591 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:06,596 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:06,600 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:06,603 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:06,606 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,608 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:06,611 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:06,613 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:06,616 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:06,628 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:06,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:57:06,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:57:06,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:57:06,649 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:06,650 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:57:06,666 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:06,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:57:06,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:06,684 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:06,689 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:57:06,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:57:06,697 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:06,697 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:06,697 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:06,697 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:06,698 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:06,698 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:57:06,698 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:06,698 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:57:06,699 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:06,700 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:57:06,700 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:57:06,701 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:06,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:57:06,701 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:06,701 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:06,701 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:06,702 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:57:06,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:57:06,702 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:57:06,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:57:06,702 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:57:06,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:57:06,703 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:57:06,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:57:06,703 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:57:06,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:57:06,704 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:57:06,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:57:06,704 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:06,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:57:06,704 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:06,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:06,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:06,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:57:06,705 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:57:06,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:57:06,706 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:57:06,713 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:57:06,714 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:06,715 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:06,715 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:57:06,717 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:06,717 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:06,717 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:06,718 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:06,763 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5354, Threshold=0.5807, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:57:06,763 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5354
2025-08-04 20:57:12,034 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:12,035 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:57:12,035 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:57:12,035 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:57:12,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:57:12,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:12,414 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:12,414 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:12,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:57:12,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:57:12,553 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:12,711 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:12,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:12,718 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:12,724 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:57:12,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:12,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:57:12,731 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:12,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:12,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:57:12,740 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:12,743 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:12,745 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:12,748 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:12,751 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:12,753 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:12,756 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:12,758 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:12,762 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:12,764 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:12,766 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:12,777 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:12,777 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:57:12,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:57:12,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:57:12,793 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:12,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:57:12,804 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:12,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:57:12,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:12,823 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:12,828 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:57:12,835 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:57:12,835 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:12,835 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:12,835 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:12,835 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:12,839 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:12,839 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:57:12,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:12,839 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:57:12,840 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:12,841 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:57:12,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:57:12,841 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:12,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:57:12,844 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:12,844 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:12,844 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:12,844 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:57:12,844 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:57:12,845 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:57:12,845 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:57:12,845 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:57:12,845 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:57:12,845 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:57:12,845 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:57:12,846 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:57:12,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:57:12,846 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:57:12,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:57:12,846 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:12,847 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:57:12,847 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:12,847 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:12,847 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:12,847 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:57:12,848 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:57:12,848 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:57:12,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:57:12,855 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:57:12,855 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:12,856 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:12,856 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:57:12,857 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 149/400.
2025-08-04 20:57:12,959 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:12,959 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:12,960 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 66 anomalous samples to GAN training data (target: 66).
2025-08-04 20:57:12,961 - ClientAppLogger [Client 4] - INFO - [Client] Round 149: Training GAN with 289 samples (223 normal, 66 anomalous).
2025-08-04 20:57:12,961 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:13,194 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7737
2025-08-04 20:57:13,194 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7737
2025-08-04 20:57:13,194 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:13,238 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5865, Threshold=0.6634, Accuracy=0.7286, F1=0.8125, Precision=0.9796, Recall=0.6941
2025-08-04 20:57:13,239 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:57:13,239 - ClientAppLogger [Client 4] - INFO - Fit completed for round 149. Duration: 0.38s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 149, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0835142661130965, 'd_loss': 0.7737313729668982, 'post_fit_local_f1': 0.8124570643462331, 'fit_time_seconds': 0.38164806365966797, 'cpu_percent_fit': 18.5125, 'ram_mb_fit': 5.046875, 'accumulated_train_samples_this_round': 289}
2025-08-04 20:57:13,239 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:57:27,575 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:27,575 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:57:27,575 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:57:27,575 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:57:27,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:57:27,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:27,998 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:27,998 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:28,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:57:28,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:57:28,131 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:28,286 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:28,293 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:28,293 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:28,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:57:28,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:28,305 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:57:28,306 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:28,306 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:28,306 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:57:28,316 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:28,319 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,322 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:28,324 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:28,328 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:28,333 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:28,337 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,340 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:28,343 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:28,346 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:28,348 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:28,364 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:28,364 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:57:28,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:57:28,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:57:28,376 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:28,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:57:28,388 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:28,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:57:28,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:28,407 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:28,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:57:28,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:57:28,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:28,420 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:28,420 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:28,421 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:28,421 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:28,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:57:28,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:28,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:57:28,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:28,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:57:28,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:57:28,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:28,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:57:28,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:57:28,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:57:28,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:57:28,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:57:28,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:57:28,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:57:28,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:57:28,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:57:28,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:57:28,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:57:28,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:57:28,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:57:28,428 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:28,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:57:28,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:28,429 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:28,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:28,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:57:28,430 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:57:28,430 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:57:28,430 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:57:28,435 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:57:28,435 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:28,437 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:28,437 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:57:28,439 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:28,439 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:28,439 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:28,440 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:28,481 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5436, Threshold=0.5902, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:57:28,481 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5436
2025-08-04 20:57:48,802 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:48,803 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:57:48,803 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:57:48,803 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:57:48,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:57:48,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:49,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:49,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:49,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:57:49,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:57:49,325 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:49,444 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:49,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:49,454 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:49,463 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:57:49,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:49,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:57:49,473 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:49,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:49,473 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:57:49,483 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:49,487 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,490 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:49,493 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:49,496 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:49,498 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:49,502 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,504 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:49,508 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:49,511 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:49,514 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:49,525 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:49,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:57:49,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:57:49,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:57:49,537 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:49,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:57:49,549 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:49,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:57:49,550 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:49,565 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:49,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:57:49,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:57:49,576 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:49,576 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:49,577 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:49,577 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:49,577 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:49,577 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:57:49,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:49,578 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:57:49,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:49,580 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:57:49,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:57:49,580 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:49,580 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:57:49,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:49,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:49,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:49,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:57:49,581 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:57:49,581 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:57:49,582 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:57:49,582 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:57:49,582 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:57:49,582 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:57:49,582 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:57:49,583 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:57:49,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:57:49,583 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:57:49,583 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:57:49,583 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:49,584 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:57:49,584 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:49,584 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:49,584 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:49,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:57:49,585 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:57:49,585 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:57:49,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:57:49,590 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:57:49,590 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:49,592 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:49,592 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:57:49,593 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:49,594 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:49,594 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:49,594 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:49,638 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5484, Threshold=0.5998, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:57:49,638 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5484
2025-08-04 20:58:06,963 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:06,963 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:58:06,964 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:58:06,964 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:58:06,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:58:06,964 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:07,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:07,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:07,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:58:07,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:58:07,519 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:07,646 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:07,654 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:07,654 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:07,660 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:58:07,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:07,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:58:07,668 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:07,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:07,668 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:58:07,677 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:07,681 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,683 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:07,685 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:07,688 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:07,691 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:07,694 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,696 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:07,699 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:07,701 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:07,704 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:07,714 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:07,714 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:58:07,720 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:58:07,720 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:58:07,726 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:07,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:58:07,738 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:07,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:58:07,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:07,754 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:07,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:58:07,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:58:07,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:07,805 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:07,806 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:07,806 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:07,806 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:07,807 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:58:07,807 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:07,807 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:58:07,807 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:07,809 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:58:07,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:58:07,809 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:07,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:58:07,810 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:58:07,811 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:58:07,811 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:58:07,811 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:58:07,812 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:58:07,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:58:07,812 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:58:07,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:58:07,813 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:07,813 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:58:07,813 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:07,813 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:07,814 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:07,815 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:58:07,815 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:58:07,816 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:58:07,816 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:58:07,824 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:58:07,824 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:07,826 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:07,826 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:58:07,827 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:07,828 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:07,828 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:07,828 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:07,871 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5250, Threshold=0.5690, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:58:07,871 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5250
2025-08-04 20:58:28,193 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:28,193 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:58:28,193 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:58:28,193 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:58:28,193 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:58:28,194 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:28,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:28,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:28,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:58:28,666 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:58:28,666 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:28,811 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:28,819 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:28,819 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:28,828 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:58:28,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:28,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:58:28,837 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:28,838 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:28,838 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:58:28,848 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:28,851 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,854 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:28,856 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:28,859 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:28,862 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:28,865 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,869 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:28,871 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:28,874 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:28,877 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:28,888 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:28,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:58:28,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:58:28,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:58:28,900 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:28,900 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:58:28,915 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:28,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:58:28,916 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:28,932 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:28,937 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:58:28,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:58:28,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:28,943 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:28,943 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:28,944 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:28,944 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:28,944 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:58:28,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:28,945 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:58:28,945 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:28,946 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:58:28,946 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:58:28,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:28,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:58:28,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:28,947 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:28,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:28,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:58:28,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:58:28,948 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:58:28,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:58:28,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:58:28,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:58:28,949 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:58:28,949 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:58:28,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:58:28,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:58:28,950 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:58:28,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:58:28,951 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:28,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:58:28,951 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:28,952 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:28,952 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:28,952 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:58:28,952 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:58:28,952 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:58:28,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:58:28,960 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:58:28,961 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:28,962 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:28,962 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:58:28,964 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:28,964 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:28,964 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:28,965 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:29,015 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5777, Threshold=0.6410, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:58:29,016 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5777
2025-08-04 20:58:46,332 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:46,332 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:58:46,332 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:58:46,332 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:58:46,332 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:58:46,332 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:46,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:46,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:46,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:58:46,854 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:58:46,855 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:46,975 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:46,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:46,986 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:46,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:58:47,019 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:47,019 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:58:47,020 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:47,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:47,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:58:47,029 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:47,032 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,035 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:47,037 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:47,040 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:47,042 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:47,044 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,047 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:47,050 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:47,052 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:47,055 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:47,066 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:47,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:58:47,071 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:58:47,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:58:47,078 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:47,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:58:47,092 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:47,093 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:58:47,093 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:47,109 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:47,115 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:58:47,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:58:47,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:47,121 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:47,121 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:47,122 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:47,122 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:47,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:58:47,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:47,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:58:47,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:47,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:58:47,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:58:47,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:47,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:58:47,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:47,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:47,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:47,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:58:47,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:58:47,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:58:47,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:58:47,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:58:47,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:58:47,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:58:47,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:58:47,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:58:47,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:58:47,129 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:58:47,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:58:47,129 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:47,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:58:47,129 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:47,130 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:47,130 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:47,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:58:47,130 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:58:47,130 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:58:47,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:58:47,137 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:58:47,138 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:47,139 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:47,139 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:58:47,141 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:47,141 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:47,141 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:47,142 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:47,192 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4813, Threshold=0.5098, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:58:47,192 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.4813
2025-08-04 20:59:07,486 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:07,486 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:59:07,486 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:59:07,486 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:59:07,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:59:07,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:07,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:07,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:07,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:59:07,958 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:59:07,958 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:08,112 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:08,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:08,121 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:08,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:59:08,132 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:08,132 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:59:08,132 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:08,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:08,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:59:08,141 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:08,144 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,147 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:08,149 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:08,152 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:08,154 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:08,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,159 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:08,162 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:08,164 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:08,166 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:08,178 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:08,178 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:59:08,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:59:08,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:59:08,190 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:08,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:59:08,203 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:08,203 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:59:08,204 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:08,220 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:08,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:59:08,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:59:08,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:08,232 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:08,233 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:08,233 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:08,233 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:08,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:59:08,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:08,234 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:59:08,234 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:08,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:59:08,236 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:59:08,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:08,236 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:59:08,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:08,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:08,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:08,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:59:08,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:59:08,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:59:08,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:59:08,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:59:08,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:59:08,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:59:08,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:59:08,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:59:08,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:59:08,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:59:08,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:59:08,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:08,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:59:08,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:08,240 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:08,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:08,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:59:08,241 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:59:08,241 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:59:08,241 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:59:08,247 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:59:08,247 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:08,249 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:08,249 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:59:08,250 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:08,250 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:08,251 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:08,251 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:08,294 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5402, Threshold=0.5897, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:59:08,294 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5402
2025-08-04 20:59:13,559 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:13,560 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:59:13,560 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:59:13,560 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:59:13,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:59:13,560 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:13,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:13,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:13,977 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:59:14,004 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:59:14,004 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:14,123 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:14,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:14,129 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:14,135 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:59:14,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:14,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:59:14,157 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:14,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:14,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:59:14,167 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:14,170 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:14,172 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:14,174 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:14,177 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:14,179 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:14,182 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:14,184 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:14,187 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:14,189 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:14,192 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:14,202 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:14,202 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:59:14,207 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:59:14,208 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:59:14,214 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:14,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:59:14,225 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:14,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:59:14,226 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:14,242 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:14,247 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:59:14,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:59:14,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:14,252 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:14,252 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:14,253 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:14,253 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:14,253 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:59:14,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:14,254 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:59:14,254 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:14,255 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:59:14,256 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:59:14,256 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:14,256 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:59:14,257 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:59:14,258 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:59:14,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:59:14,258 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:59:14,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:59:14,259 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:59:14,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:59:14,259 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:59:14,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:59:14,259 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:14,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:59:14,260 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:14,260 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:14,260 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:14,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:59:14,261 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:59:14,261 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:59:14,261 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:59:14,269 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:59:14,269 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:14,270 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:14,271 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:59:14,272 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 155/400.
2025-08-04 20:59:14,373 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:14,373 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:14,375 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 69 anomalous samples to GAN training data (target: 69).
2025-08-04 20:59:14,375 - ClientAppLogger [Client 4] - INFO - [Client] Round 155: Training GAN with 299 samples (230 normal, 69 anomalous).
2025-08-04 20:59:14,375 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:14,622 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.7680
2025-08-04 20:59:14,622 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.7680
2025-08-04 20:59:14,623 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:14,666 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5455, Threshold=0.6058, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:59:14,666 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8129
2025-08-04 20:59:14,666 - ClientAppLogger [Client 4] - INFO - Fit completed for round 155. Duration: 0.39s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 155, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084497658783776, 'd_loss': 0.7679780657873504, 'post_fit_local_f1': 0.81291504465308, 'fit_time_seconds': 0.3938608169555664, 'cpu_percent_fit': 18.75625, 'ram_mb_fit': 0.14453125, 'accumulated_train_samples_this_round': 299}
2025-08-04 20:59:14,666 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:59:25,955 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:25,955 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:59:25,956 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:59:25,956 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:59:25,956 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:59:25,956 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:26,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:26,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:26,465 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:59:26,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:59:26,517 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:26,666 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:26,673 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:26,674 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:26,680 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:59:26,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:26,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:59:26,688 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:26,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:26,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:59:26,699 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:26,702 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,705 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:26,708 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:26,711 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:26,713 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:26,716 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,718 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:26,721 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:26,723 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:26,725 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:26,736 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:26,737 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:59:26,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:59:26,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:59:26,749 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:26,749 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:59:26,762 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:26,763 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:59:26,763 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:26,781 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:26,787 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:59:26,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:59:26,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:26,796 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:26,796 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:26,796 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:26,797 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:26,797 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:59:26,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:26,797 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:59:26,797 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:26,799 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:59:26,799 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:59:26,799 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:26,799 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:59:26,799 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:59:26,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:59:26,801 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:59:26,801 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:59:26,801 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:59:26,801 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:59:26,802 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:59:26,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:59:26,802 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:26,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:59:26,802 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:26,803 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:26,803 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:26,803 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:59:26,803 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:59:26,803 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:59:26,804 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:59:26,809 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:59:26,810 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:26,811 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:26,811 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:59:26,812 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:26,812 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:26,813 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:26,813 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:26,861 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5332, Threshold=0.5783, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:59:26,861 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5332
2025-08-04 20:59:38,149 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:38,149 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:59:38,149 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:59:38,149 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:59:38,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:59:38,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:38,600 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:38,600 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:38,696 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:59:38,721 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:59:38,721 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:38,858 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:38,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:38,864 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:38,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:59:38,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:38,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:59:38,895 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:38,895 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:38,895 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:59:38,904 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:38,907 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,909 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:38,911 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:38,914 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:38,916 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:38,918 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,921 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:38,924 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:38,926 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:38,928 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:38,938 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:38,938 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:59:38,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:59:38,944 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:59:38,949 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:38,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:59:38,965 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:38,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:59:38,965 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:38,982 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:38,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:59:38,995 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:59:38,996 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:38,996 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:38,996 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:38,996 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:38,997 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:38,997 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:59:38,997 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:38,997 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:59:38,997 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:38,999 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:59:38,999 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:59:38,999 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:38,999 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:59:38,999 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:38,999 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:59:39,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:59:39,001 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:59:39,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:59:39,001 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:59:39,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:59:39,002 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:59:39,002 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:59:39,002 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:39,002 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:59:39,002 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:39,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:39,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:39,003 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:59:39,003 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:59:39,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:59:39,003 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:59:39,013 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:59:39,013 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:39,014 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:39,014 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:59:39,016 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:39,016 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:39,016 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:39,017 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:39,063 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5107, Threshold=0.5647, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 20:59:39,063 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5107
2025-08-04 20:59:53,356 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:53,356 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:59:53,356 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:59:53,357 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:59:53,357 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:59:53,357 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:53,755 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:53,755 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:53,849 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:59:53,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:59:53,887 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:53,981 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:53,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:53,988 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:53,994 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:59:54,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:54,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:59:54,001 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:54,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:54,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:59:54,011 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:54,014 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:54,016 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:54,019 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:54,021 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:54,024 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:54,027 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:54,029 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:54,032 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:54,034 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:54,037 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:54,048 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:54,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:59:54,053 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:59:54,053 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:59:54,060 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:54,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:59:54,073 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:54,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:59:54,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:54,090 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:54,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:59:54,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:59:54,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:54,102 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:54,102 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:54,102 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:54,103 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:54,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:59:54,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:54,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:59:54,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:54,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:59:54,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:59:54,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:54,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:59:54,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:54,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:54,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:54,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:59:54,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:59:54,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:59:54,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:59:54,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:59:54,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:59:54,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:59:54,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:59:54,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:59:54,108 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:59:54,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:59:54,108 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:59:54,108 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:54,109 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:59:54,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:54,109 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:54,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:54,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:59:54,110 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:59:54,110 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:59:54,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:59:54,114 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:59:54,114 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:54,115 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:54,116 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:59:54,117 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:54,117 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:54,118 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:54,118 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:54,169 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5171, Threshold=0.5549, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 20:59:54,170 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5171
