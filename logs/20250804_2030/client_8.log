2025-08-04 20:30:04,201 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:04,201 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:04,202 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:04,202 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:30:04,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:30:04,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:04,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:04,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:04,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:30:04,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:30:04,545 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:04,636 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:04,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:04,641 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:04,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:30:04,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:04,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:30:04,655 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:04,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:04,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:30:04,664 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:04,667 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:04,669 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:04,671 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:04,674 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:04,676 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:04,679 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:04,681 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:04,684 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:04,686 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:04,688 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:04,698 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:04,698 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:30:04,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:30:04,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:30:04,709 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:04,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:30:04,720 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:04,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:30:04,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:04,736 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:04,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:30:04,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:30:04,746 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:04,746 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:04,746 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:04,746 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:04,746 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:04,747 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:30:04,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:04,747 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:30:04,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:04,748 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:30:04,748 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:30:04,749 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:04,749 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:30:04,749 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:04,749 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:04,749 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:04,749 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:30:04,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:30:04,751 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:30:04,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:30:04,751 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:30:04,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:30:04,752 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:04,752 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:30:04,752 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:04,752 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:04,752 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:04,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:30:04,756 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:30:04,756 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:30:04,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:30:04,760 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:30:04,760 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:04,762 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:04,762 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:04,764 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:04,764 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:04,764 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:04,765 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:04,777 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3504, Threshold=0.3696, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:30:04,777 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3504
2025-08-04 20:30:19,050 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:19,051 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:19,051 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:19,051 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:30:19,051 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:30:19,051 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:19,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:19,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:19,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:30:19,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:30:19,412 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:19,504 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:19,509 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:19,509 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:19,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:30:19,520 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:19,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:30:19,521 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:19,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:19,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:30:19,529 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:19,532 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:19,534 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:19,536 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:19,539 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:19,542 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:19,544 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:19,547 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:19,550 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:19,552 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:19,555 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:19,564 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:19,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:30:19,569 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:30:19,569 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:30:19,575 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:19,575 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:30:19,586 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:19,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:30:19,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:19,603 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:19,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:30:19,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:30:19,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:19,615 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:19,616 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:19,616 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:19,616 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:19,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:30:19,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:19,617 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:30:19,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:19,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:30:19,618 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:30:19,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:19,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:30:19,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:19,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:19,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:19,620 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:30:19,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:30:19,620 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:30:19,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:30:19,620 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:30:19,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:30:19,621 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:30:19,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:30:19,621 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:30:19,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:30:19,622 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:30:19,622 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:30:19,622 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:19,622 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:30:19,622 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:19,623 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:19,623 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:19,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:30:19,626 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:30:19,626 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:30:19,627 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:30:19,628 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:30:19,628 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:19,630 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:19,630 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:19,631 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:19,632 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:19,632 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:19,632 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:19,644 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3403, Threshold=0.3592, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:30:19,644 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3403
2025-08-04 20:30:30,909 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:30,909 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:30,909 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:30,909 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:30:30,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:30:30,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:31,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:31,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:31,268 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:30:31,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:30:31,286 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:31,370 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:31,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:31,377 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:31,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:30:31,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:31,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:30:31,389 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:31,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:31,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:30:31,398 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:31,400 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:31,402 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:31,405 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:31,407 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:31,409 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:31,412 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:31,415 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:31,418 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:31,420 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:31,422 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:31,431 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:31,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:30:31,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:30:31,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:30:31,441 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:31,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:30:31,451 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:31,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:30:31,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:31,467 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:31,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:30:31,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:30:31,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:31,479 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:31,480 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:31,480 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:31,480 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:31,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:30:31,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:31,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:30:31,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:31,482 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:30:31,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:30:31,483 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:31,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:30:31,483 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:31,483 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:31,484 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:31,484 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:30:31,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:30:31,484 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:30:31,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:30:31,484 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:30:31,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:30:31,485 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:30:31,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:30:31,485 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:30:31,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:30:31,486 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:30:31,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:30:31,486 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:31,487 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:30:31,487 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:31,487 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:31,488 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:31,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:30:31,488 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:30:31,488 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:30:31,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:30:31,491 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:30:31,492 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:31,494 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:31,494 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:31,496 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:31,496 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:31,496 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:31,497 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:31,510 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3482, Threshold=0.3675, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:30:31,510 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3482
2025-08-04 20:30:45,777 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:45,777 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:45,777 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:45,777 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:30:45,778 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:30:45,778 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:46,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:46,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:46,108 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:30:46,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:30:46,125 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:46,215 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:46,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:46,221 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:46,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:30:46,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:46,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:30:46,234 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:46,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:46,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:30:46,242 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:46,246 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:46,248 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:46,251 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:46,253 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:46,256 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:46,258 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:46,261 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:46,264 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:46,266 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:46,268 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:46,278 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:46,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:30:46,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:30:46,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:30:46,289 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:46,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:30:46,300 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:46,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:30:46,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:46,315 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:46,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:30:46,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:30:46,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:46,326 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:46,326 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:46,327 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:46,327 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:46,327 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:30:46,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:46,328 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:30:46,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:46,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:30:46,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:30:46,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:46,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:30:46,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:46,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:46,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:46,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:30:46,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:30:46,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:30:46,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:30:46,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:30:46,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:30:46,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:30:46,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:30:46,334 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:30:46,334 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:30:46,335 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:30:46,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:30:46,335 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:46,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:30:46,336 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:46,336 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:46,336 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:46,339 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:30:46,340 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:30:46,340 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:30:46,340 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:30:46,343 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:30:46,343 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:46,344 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:46,345 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:46,346 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:46,346 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:46,346 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:46,347 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:46,360 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3391, Threshold=0.3580, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:30:46,361 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3391
2025-08-04 20:30:54,615 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:54,615 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:54,616 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:54,616 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:30:54,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:30:54,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:54,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:54,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:54,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:30:54,931 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:30:54,931 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:55,018 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:55,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:55,024 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:55,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:30:55,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:55,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:30:55,036 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:55,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:55,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:30:55,044 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:55,047 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:55,049 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:55,051 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:55,054 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:55,056 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:55,059 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:55,061 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:55,064 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:55,066 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:55,068 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:55,076 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:55,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:30:55,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:30:55,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:30:55,085 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:55,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:30:55,094 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:55,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:30:55,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:55,109 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:55,113 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:30:55,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:30:55,119 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:55,119 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:55,119 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:55,119 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:55,119 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:55,119 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:30:55,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:55,120 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:30:55,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:55,121 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:30:55,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:30:55,121 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:30:55,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:30:55,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:30:55,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:30:55,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:30:55,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:30:55,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:30:55,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:30:55,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:30:55,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:30:55,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:30:55,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:55,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:30:55,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:55,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:55,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:55,128 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:30:55,129 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:30:55,129 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:30:55,129 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:30:55,131 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:30:55,131 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:55,132 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:55,132 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:55,133 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 45/400.
2025-08-04 20:30:55,234 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:55,235 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:55,236 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:30:55,237 - ClientAppLogger [Client 8] - INFO - [Client] Round 45: Training GAN with 6 samples (5 normal, 1 anomalous).
2025-08-04 20:30:55,237 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:55,260 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0690, Avg D Loss: 0.8686
2025-08-04 20:30:55,261 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0690, Avg D Loss: 0.8686
2025-08-04 20:30:55,261 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:55,272 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3201, Threshold=0.3383, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:30:55,272 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:30:55,272 - ClientAppLogger [Client 8] - INFO - Fit completed for round 45. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 45, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.069028615951538, 'd_loss': 0.8686426937580108, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.1388719081878662, 'cpu_percent_fit': 29.79375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 6}
2025-08-04 20:30:55,272 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:31:06,592 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:06,592 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:06,592 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:06,592 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:06,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:06,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:06,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:06,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:07,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:07,034 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:07,034 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:07,141 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:07,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:07,148 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:07,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:07,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:07,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:07,167 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:07,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:07,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:07,179 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:07,183 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,186 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:07,188 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:07,191 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:07,193 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:07,196 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,199 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:07,202 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:07,203 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:07,207 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:07,220 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:07,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:07,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:07,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:07,233 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:07,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:07,246 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:07,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:07,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:07,268 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:07,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:07,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:07,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:07,282 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:07,282 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:07,283 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:07,283 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:07,284 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:07,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:07,284 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:07,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:07,286 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:07,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:07,287 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:07,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:07,287 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:07,287 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:07,288 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:07,288 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:07,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:07,289 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:07,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:07,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:07,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:07,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:07,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:07,291 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:07,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:07,291 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:07,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:07,292 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:07,292 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:07,292 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:07,292 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:07,293 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:07,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:07,297 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:07,297 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:07,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:07,302 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:07,303 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:07,304 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:07,304 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:07,305 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:07,306 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:07,306 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:07,307 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:07,320 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3467, Threshold=0.3650, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:07,320 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3467
2025-08-04 20:31:15,575 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:15,575 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:15,576 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:15,576 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:15,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:15,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:15,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:15,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:15,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:15,923 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:15,923 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:16,016 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:16,022 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:16,023 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:16,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:16,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:16,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:16,039 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:16,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:16,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:16,048 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:16,051 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:16,053 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:16,055 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:16,058 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:16,060 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:16,064 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:16,066 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:16,069 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:16,070 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:16,073 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:16,082 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:16,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:16,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:16,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:16,093 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:16,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:16,104 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:16,104 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:16,104 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:16,121 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:16,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:16,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:16,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:16,135 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:16,135 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:16,135 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:16,136 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:16,136 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:16,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:16,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:16,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:16,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:16,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:16,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:16,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:16,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:16,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:16,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:16,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:16,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:16,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:16,142 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:16,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:16,142 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:16,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:16,143 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:16,143 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:16,143 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:16,143 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:16,143 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:16,144 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:16,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:16,146 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:16,146 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:16,147 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:16,147 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:16,149 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 46/400.
2025-08-04 20:31:16,250 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:16,250 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:16,252 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:31:16,252 - ClientAppLogger [Client 8] - INFO - [Client] Round 46: Training GAN with 7 samples (6 normal, 1 anomalous).
2025-08-04 20:31:16,252 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:16,276 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0722, Avg D Loss: 0.8443
2025-08-04 20:31:16,276 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0722, Avg D Loss: 0.8443
2025-08-04 20:31:16,276 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:16,287 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3263, Threshold=0.3438, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:16,287 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:31:16,288 - ClientAppLogger [Client 8] - INFO - Fit completed for round 46. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 46, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.072164463996887, 'd_loss': 0.844310176372528, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.13863420486450195, 'cpu_percent_fit': 27.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7}
2025-08-04 20:31:16,288 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:31:24,567 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:24,567 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:24,567 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:24,567 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:24,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:24,568 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:24,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:24,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:24,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:24,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:24,938 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:25,033 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:25,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:25,041 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:25,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:25,053 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:25,053 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:25,053 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:25,054 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:25,054 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:25,063 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:25,066 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:25,068 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:25,070 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:25,073 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:25,075 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:25,078 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:25,080 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:25,083 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:25,085 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:25,087 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:25,097 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:25,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:25,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:25,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:25,110 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:25,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:25,124 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:25,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:25,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:25,140 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:25,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:25,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:25,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:25,152 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:25,152 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:25,153 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:25,153 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:25,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:25,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:25,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:25,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:25,155 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:25,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:25,155 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:25,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:25,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:25,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:25,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:25,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:25,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:25,157 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:25,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:25,157 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:25,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:25,157 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:25,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:25,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:25,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:25,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:25,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:25,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:25,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:25,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:25,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:25,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:25,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:25,160 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:25,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:25,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:25,163 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:25,163 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:25,164 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:25,164 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:25,166 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:25,166 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:25,166 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:25,167 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:25,180 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3487, Threshold=0.3672, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:25,180 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3487
2025-08-04 20:31:30,435 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:30,435 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:30,436 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:30,436 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:30,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:30,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:30,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:30,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:30,737 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:30,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:30,751 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:30,830 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:30,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:30,837 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:30,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:30,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:30,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:30,849 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:30,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:30,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:30,858 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:30,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:30,864 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:30,866 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:30,869 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:30,871 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:30,874 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:30,877 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:30,880 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:30,881 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:30,884 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:30,893 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:30,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:30,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:30,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:30,903 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:30,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:30,912 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:30,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:30,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:30,927 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:30,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:30,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:30,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:30,937 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:30,937 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:30,937 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:30,937 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:30,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:30,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:30,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:30,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:30,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:30,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:30,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:30,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:30,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:30,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:30,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:30,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:30,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:30,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:30,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:30,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:30,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:30,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:30,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:30,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:30,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:30,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:30,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:30,943 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:30,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:30,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:30,946 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:30,946 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:30,947 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:30,948 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:30,949 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 47/400.
2025-08-04 20:31:31,050 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:31,051 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:31,052 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:31:31,052 - ClientAppLogger [Client 8] - INFO - [Client] Round 47: Training GAN with 7 samples (6 normal, 1 anomalous).
2025-08-04 20:31:31,052 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:31,077 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0664, Avg D Loss: 0.8428
2025-08-04 20:31:31,077 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0664, Avg D Loss: 0.8428
2025-08-04 20:31:31,077 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:31,089 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3280, Threshold=0.3454, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:31,089 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:31:31,089 - ClientAppLogger [Client 8] - INFO - Fit completed for round 47. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 47, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0664162397384644, 'd_loss': 0.8427694201469421, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.1398301124572754, 'cpu_percent_fit': 29.2125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7}
2025-08-04 20:31:31,089 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:31:36,365 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:36,365 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:36,365 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:36,365 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:36,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:36,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:36,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:36,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:36,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:36,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:36,718 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:36,825 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:36,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:36,832 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:36,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:36,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:36,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:36,865 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:36,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:36,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:36,875 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:36,878 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:36,881 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:36,883 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:36,886 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:36,889 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:36,892 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:36,895 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:36,898 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:36,900 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:36,903 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:36,916 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:36,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:36,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:36,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:36,928 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:36,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:36,940 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:36,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:36,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:36,958 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:36,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:36,969 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:36,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:36,970 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:36,970 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:36,970 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:36,971 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:36,971 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:36,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:36,971 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:36,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:36,973 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:36,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:36,973 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:36,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:36,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:36,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:36,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:36,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:36,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:36,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:36,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:36,976 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:36,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:36,976 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:36,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:36,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:36,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:36,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:36,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:36,978 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:36,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:36,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:36,982 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:36,983 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:36,984 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:36,985 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:36,986 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:36,986 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:36,986 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:36,987 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:36,999 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3280, Threshold=0.3454, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:36,999 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3280
2025-08-04 20:31:42,266 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:42,266 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:42,266 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:42,266 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:42,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:42,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:42,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:42,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:42,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:42,569 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:42,569 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:42,653 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:42,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:42,659 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:42,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:42,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:42,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:42,671 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:42,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:42,672 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:42,680 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:42,682 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:42,685 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:42,687 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:42,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:42,692 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:42,695 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:42,697 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:42,700 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:42,702 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:42,704 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:42,713 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:42,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:42,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:42,718 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:42,722 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:42,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:42,732 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:42,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:42,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:42,747 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:42,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:42,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:42,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:42,757 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:42,757 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:42,757 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:42,757 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:42,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:42,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:42,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:42,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:42,759 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:42,759 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:42,760 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:42,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:42,762 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:42,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:42,762 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:42,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:42,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:42,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:42,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:42,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:42,763 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:42,764 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:42,764 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:42,766 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:42,766 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:42,768 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:42,768 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:42,769 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 48/400.
2025-08-04 20:31:42,870 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:42,871 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:42,872 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:31:42,872 - ClientAppLogger [Client 8] - INFO - [Client] Round 48: Training GAN with 7 samples (6 normal, 1 anomalous).
2025-08-04 20:31:42,872 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:42,897 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0700, Avg D Loss: 0.8354
2025-08-04 20:31:42,897 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0700, Avg D Loss: 0.8354
2025-08-04 20:31:42,897 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:42,908 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3091, Threshold=0.3242, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:42,908 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:31:42,908 - ClientAppLogger [Client 8] - INFO - Fit completed for round 48. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 48, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0699719905853273, 'd_loss': 0.8353720247745514, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.13898730278015137, 'cpu_percent_fit': 27.825, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7}
2025-08-04 20:31:42,909 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:31:48,182 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:48,182 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:48,182 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:48,182 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:48,182 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:48,182 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:48,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:48,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:48,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:48,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:48,538 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:48,632 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:48,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:48,708 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:48,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:48,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:48,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:48,730 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:48,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:48,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:48,741 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:48,744 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:48,747 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:48,749 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:48,752 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:48,755 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:48,757 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:48,760 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:48,762 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:48,764 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:48,767 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:48,777 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:48,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:48,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:48,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:48,787 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:48,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:48,800 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:48,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:48,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:48,816 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:48,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:48,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:48,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:48,829 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:48,829 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:48,830 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:48,830 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:48,830 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:48,830 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:48,831 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:48,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:48,832 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:48,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:48,833 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:48,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:48,833 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:48,833 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:48,833 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:48,833 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:48,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:48,834 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:48,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:48,834 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:48,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:48,834 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:48,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:48,835 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:48,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:48,835 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:48,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:48,836 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:48,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:48,836 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:48,836 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:48,837 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:48,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:48,837 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:48,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:48,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:48,840 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:48,840 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:48,842 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:48,842 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:48,843 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:48,843 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:48,844 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:48,844 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:48,860 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3481, Threshold=0.3676, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:48,860 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3481
2025-08-04 20:31:57,115 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:57,115 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:57,115 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:57,115 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:31:57,115 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:31:57,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:57,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:57,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:57,439 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:31:57,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:31:57,455 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:57,545 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:57,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:57,550 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:57,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:31:57,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:57,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:31:57,562 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:57,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:57,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:31:57,570 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:57,573 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:57,575 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:57,577 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:57,579 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:57,581 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:57,584 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:57,586 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:57,589 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:57,590 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:57,593 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:57,602 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:57,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:31:57,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:31:57,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:31:57,613 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:57,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:31:57,623 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:57,623 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:31:57,624 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:57,638 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:57,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:31:57,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:31:57,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:57,647 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:57,648 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:57,648 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:57,648 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:57,648 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:31:57,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:57,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:31:57,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:57,650 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:31:57,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:31:57,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:57,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:31:57,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:57,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:57,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:57,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:31:57,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:31:57,653 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:31:57,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:31:57,653 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:31:57,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:31:57,653 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:57,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:31:57,654 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:57,654 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:57,654 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:57,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:31:57,657 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:31:57,658 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:31:57,658 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:31:57,660 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:31:57,660 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:57,662 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:57,662 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:57,663 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 49/400.
2025-08-04 20:31:57,764 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:57,765 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:57,768 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:31:57,769 - ClientAppLogger [Client 8] - INFO - [Client] Round 49: Training GAN with 7 samples (6 normal, 1 anomalous).
2025-08-04 20:31:57,769 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:57,801 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0637, Avg D Loss: 0.8413
2025-08-04 20:31:57,801 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0637, Avg D Loss: 0.8413
2025-08-04 20:31:57,801 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:57,812 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3273, Threshold=0.3456, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:31:57,813 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:31:57,813 - ClientAppLogger [Client 8] - INFO - Fit completed for round 49. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 49, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.063660001754761, 'd_loss': 0.8413052380084991, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.14964985847473145, 'cpu_percent_fit': 27.04375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7}
2025-08-04 20:31:57,813 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:32:06,074 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:06,074 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:06,075 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:06,075 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:32:06,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:32:06,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:06,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:06,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:06,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:32:06,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:32:06,425 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:06,525 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:06,531 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:06,531 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:06,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:32:06,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:06,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:32:06,573 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:06,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:06,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:32:06,582 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:06,585 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:06,587 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:06,590 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:06,593 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:06,595 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:06,597 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:06,600 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:06,602 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:06,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:06,606 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:06,617 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:06,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:32:06,622 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:32:06,623 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:32:06,629 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:06,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:32:06,641 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:06,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:32:06,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:06,657 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:06,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:32:06,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:32:06,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:06,667 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:06,668 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:06,668 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:06,668 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:06,668 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:32:06,669 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:06,669 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:32:06,669 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:06,671 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:32:06,672 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:32:06,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:32:06,673 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:32:06,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:32:06,673 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:06,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:32:06,673 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:06,674 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:06,674 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:06,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:32:06,674 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:32:06,674 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:32:06,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:32:06,681 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:32:06,681 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:06,682 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:06,682 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:06,684 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:06,684 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:06,684 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:06,685 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:06,697 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3517, Threshold=0.3747, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:32:06,697 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3517
2025-08-04 20:32:17,985 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:17,985 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:17,985 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:17,985 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:32:17,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:32:17,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:18,217 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:18,217 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:18,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:32:18,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:32:18,317 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:18,411 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:18,417 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:18,417 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:18,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:32:18,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:18,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:32:18,430 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:18,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:18,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:32:18,440 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:18,442 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:18,445 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:18,447 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:18,449 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:18,451 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:18,454 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:18,456 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:18,459 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:18,461 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:18,464 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:18,475 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:18,476 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:32:18,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:32:18,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:32:18,486 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:18,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:32:18,497 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:18,497 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:32:18,498 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:18,513 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:18,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:32:18,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:32:18,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:18,523 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:18,523 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:18,524 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:18,524 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:18,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:32:18,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:18,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:32:18,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:18,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:32:18,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:32:18,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:32:18,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:32:18,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:32:18,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:32:18,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:32:18,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:32:18,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:32:18,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:32:18,529 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:32:18,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:32:18,529 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:18,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:32:18,530 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:18,530 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:18,530 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:18,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:32:18,530 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:32:18,531 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:32:18,531 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:32:18,534 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:32:18,534 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:18,535 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:18,536 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:18,537 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:18,537 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:18,537 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:18,538 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:18,550 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3455, Threshold=0.3673, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:32:18,550 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3455
2025-08-04 20:32:29,815 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:29,816 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:29,816 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:29,816 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:32:29,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:32:29,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:30,054 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:30,055 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:30,150 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:32:30,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:32:30,165 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:30,253 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:30,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:30,261 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:30,279 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:32:30,299 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:30,299 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:32:30,299 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:30,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:30,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:32:30,308 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:30,311 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,313 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:30,315 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:30,318 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:30,320 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:30,325 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,327 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:30,330 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:30,332 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:30,334 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:30,344 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:30,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:32:30,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:32:30,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:32:30,356 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:30,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:32:30,368 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:30,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:32:30,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:30,384 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:30,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:32:30,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:32:30,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:30,393 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:30,393 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:30,394 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:30,394 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:30,394 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:32:30,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:30,394 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:32:30,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:30,396 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:32:30,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:32:30,396 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:30,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:32:30,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:32:30,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:32:30,398 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:32:30,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:32:30,398 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:32:30,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:32:30,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:32:30,399 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:32:30,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:30,399 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:32:30,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:30,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:30,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:30,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:32:30,400 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:32:30,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:32:30,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:32:30,405 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:32:30,406 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:30,407 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:30,407 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:30,409 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:30,413 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:30,413 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:30,414 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:30,425 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3530, Threshold=0.3775, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:32:30,426 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3530
2025-08-04 20:32:44,704 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:44,704 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:44,704 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:44,704 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:32:44,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:32:44,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:44,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:44,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:44,992 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:32:45,009 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:32:45,009 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:45,101 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:45,106 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:45,107 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:45,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:32:45,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:45,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:32:45,118 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:45,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:45,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:32:45,127 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:45,129 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:45,132 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:45,134 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:45,137 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:45,139 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:45,141 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:45,144 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:45,147 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:45,149 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:45,151 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:45,159 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:45,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:32:45,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:32:45,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:32:45,170 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:45,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:32:45,181 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:45,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:32:45,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:45,195 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:45,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:32:45,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:32:45,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:45,205 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:45,205 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:45,205 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:45,205 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:45,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:32:45,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:45,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:32:45,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:45,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:32:45,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:32:45,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:45,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:32:45,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:45,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:45,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:45,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:32:45,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:32:45,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:32:45,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:32:45,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:45,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:32:45,212 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:32:45,212 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:32:45,212 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:32:45,215 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:32:45,215 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:45,216 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:45,217 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:45,218 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:45,218 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:45,218 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:45,219 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:45,230 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3643, Threshold=0.3910, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:32:45,230 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3643
2025-08-04 20:32:53,490 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:53,490 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:53,491 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:53,491 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:32:53,491 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:32:53,491 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:53,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:53,725 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:53,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:32:53,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:32:53,820 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:53,906 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:53,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:53,916 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:53,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:32:53,931 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:53,931 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:32:53,931 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:53,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:53,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:32:53,941 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:53,944 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:53,946 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:53,948 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:53,950 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:53,953 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:53,955 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:53,958 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:53,961 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:53,963 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:53,965 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:53,974 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:53,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:32:53,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:32:53,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:32:53,984 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:53,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:32:53,994 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:53,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:32:53,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:54,010 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:54,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:32:54,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:32:54,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:54,020 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:54,020 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:54,020 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:54,021 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:54,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:32:54,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:54,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:32:54,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:54,023 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:32:54,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:32:54,023 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:32:54,024 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:32:54,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:32:54,025 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:32:54,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:32:54,025 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:32:54,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:32:54,025 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:32:54,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:32:54,026 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:32:54,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:32:54,026 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:54,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:32:54,027 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:54,027 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:54,027 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:54,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:32:54,027 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:32:54,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:32:54,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:32:54,030 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:32:54,030 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:54,032 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:54,032 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:54,033 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 53/400.
2025-08-04 20:32:54,135 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:54,135 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:54,136 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:32:54,137 - ClientAppLogger [Client 8] - INFO - [Client] Round 53: Training GAN with 9 samples (7 normal, 2 anomalous).
2025-08-04 20:32:54,137 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:54,161 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0817, Avg D Loss: 0.8436
2025-08-04 20:32:54,162 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0817, Avg D Loss: 0.8436
2025-08-04 20:32:54,162 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:54,174 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3498, Threshold=0.3727, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:32:54,174 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:32:54,175 - ClientAppLogger [Client 8] - INFO - Fit completed for round 53. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 53, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.081718349456787, 'd_loss': 0.8435708463191987, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.14125943183898926, 'cpu_percent_fit': 28.20625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9}
2025-08-04 20:32:54,175 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:33:02,442 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:02,443 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:02,443 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:02,443 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:02,443 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:02,443 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:02,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:02,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:02,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:02,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:02,812 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:02,922 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:02,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:02,931 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:02,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:02,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:02,948 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:02,950 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:02,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:02,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:02,960 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:02,963 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:02,966 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:02,969 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:02,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:02,974 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:02,977 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:02,980 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:02,983 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:02,985 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:02,988 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:02,999 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:02,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:03,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:03,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:03,010 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:03,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:03,026 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:03,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:03,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:03,047 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:03,052 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:03,059 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:03,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:03,060 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:03,060 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:03,060 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:03,061 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:03,061 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:03,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:03,061 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:03,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:03,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:03,063 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:03,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:03,063 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:03,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:03,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:03,064 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:03,064 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:03,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:03,064 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:03,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:03,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:03,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:03,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:03,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:03,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:03,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:03,066 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:03,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:03,066 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:03,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:03,067 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:03,067 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:03,067 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:03,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:03,068 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:03,068 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:03,068 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:03,071 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:03,072 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:03,073 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:03,073 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:03,075 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:03,075 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:03,075 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:03,076 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:03,089 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3653, Threshold=0.3941, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:33:03,089 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3653
2025-08-04 20:33:08,332 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:08,333 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:08,333 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:08,333 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:08,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:08,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:08,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:08,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:08,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:08,630 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:08,630 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:08,709 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:08,716 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:08,716 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:08,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:08,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:08,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:08,728 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:08,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:08,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:08,737 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:08,740 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:08,742 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:08,744 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:08,746 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:08,748 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:08,751 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:08,753 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:08,756 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:08,758 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:08,760 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:08,768 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:08,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:08,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:08,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:08,777 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:08,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:08,785 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:08,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:08,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:08,800 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:08,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:08,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:08,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:08,809 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:08,809 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:08,810 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:08,810 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:08,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:08,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:08,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:08,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:08,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:08,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:08,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:08,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:08,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:08,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:08,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:08,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:08,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:08,815 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:08,816 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:08,816 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:08,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:08,816 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:08,816 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:08,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:08,818 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:08,819 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:08,820 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:08,820 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:08,822 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 54/400.
2025-08-04 20:33:08,923 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:08,923 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:08,924 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:33:08,924 - ClientAppLogger [Client 8] - INFO - [Client] Round 54: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:33:08,925 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:08,948 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0726, Avg D Loss: 0.8501
2025-08-04 20:33:08,948 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0726, Avg D Loss: 0.8501
2025-08-04 20:33:08,948 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:08,959 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3422, Threshold=0.3656, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:33:08,959 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:33:08,959 - ClientAppLogger [Client 8] - INFO - Fit completed for round 54. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 54, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.072589564323425, 'd_loss': 0.8501477301120758, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.13754010200500488, 'cpu_percent_fit': 29.2875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:33:08,959 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:33:14,220 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:14,220 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:14,221 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:14,221 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:14,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:14,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:14,470 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:14,470 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:14,553 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:14,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:14,570 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:14,676 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:14,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:14,685 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:14,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:14,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:14,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:14,711 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:14,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:14,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:14,721 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:14,724 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:14,726 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:14,756 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:14,759 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:14,761 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:14,764 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:14,767 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:14,769 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:14,771 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:14,773 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:14,783 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:14,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:14,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:14,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:14,793 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:14,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:14,804 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:14,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:14,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:14,821 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:14,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:14,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:14,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:14,835 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:14,835 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:14,836 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:14,837 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:14,837 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:14,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:14,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:14,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:14,840 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:14,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:14,841 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:14,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:14,841 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:14,842 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:14,842 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:14,842 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:14,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:14,843 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:14,843 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:14,844 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:14,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:14,844 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:14,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:14,845 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:14,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:14,846 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:14,847 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:14,847 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:14,847 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:14,848 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:14,849 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:14,849 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:14,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:14,849 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:14,850 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:14,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:14,854 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:14,854 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:14,856 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:14,856 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:14,857 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:14,858 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:14,858 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:14,859 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:14,872 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3501, Threshold=0.3765, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:33:14,873 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3501
2025-08-04 20:33:23,129 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:23,129 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:23,129 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:23,129 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:23,129 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:23,129 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:23,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:23,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:23,438 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:23,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:23,451 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:23,534 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:23,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:23,539 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:23,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:23,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:23,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:23,550 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:23,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:23,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:23,558 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:23,561 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:23,563 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:23,565 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:23,568 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:23,570 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:23,572 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:23,575 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:23,577 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:23,579 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:23,581 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:23,589 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:23,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:23,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:23,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:23,599 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:23,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:23,610 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:23,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:23,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:23,624 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:23,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:23,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:23,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:23,633 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:23,633 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:23,633 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:23,634 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:23,634 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:23,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:23,634 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:23,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:23,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:23,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:23,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:23,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:23,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:23,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:23,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:23,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:23,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:23,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:23,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:23,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:23,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:23,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:23,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:23,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:23,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:23,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:23,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:23,640 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:23,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:23,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:23,643 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:23,643 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:23,645 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:23,645 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:23,646 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 55/400.
2025-08-04 20:33:23,747 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:23,747 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:23,748 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:33:23,749 - ClientAppLogger [Client 8] - INFO - [Client] Round 55: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:33:23,749 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:23,772 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0734, Avg D Loss: 0.8457
2025-08-04 20:33:23,772 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0734, Avg D Loss: 0.8457
2025-08-04 20:33:23,772 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:23,783 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3285, Threshold=0.3509, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:33:23,783 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:33:23,784 - ClientAppLogger [Client 8] - INFO - Fit completed for round 55. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 55, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0734295129776, 'd_loss': 0.8457354068756103, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.13712239265441895, 'cpu_percent_fit': 29.11875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:33:23,784 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:33:29,026 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:29,026 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:29,027 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:29,027 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:29,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:29,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:29,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:29,250 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:29,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:29,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:29,351 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:29,440 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:29,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:29,447 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:29,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:29,461 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:29,461 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:29,462 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:29,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:29,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:29,471 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:29,474 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:29,476 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:29,478 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:29,481 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:29,484 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:29,486 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:29,489 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:29,491 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:29,493 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:29,496 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:29,505 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:29,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:29,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:29,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:29,516 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:29,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:29,528 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:29,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:29,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:29,545 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:29,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:29,557 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:29,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:29,558 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:29,558 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:29,559 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:29,559 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:29,559 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:29,559 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:29,559 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:29,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:29,561 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:29,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:29,561 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:29,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:29,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:29,563 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:29,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:29,563 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:29,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:29,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:29,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:29,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:29,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:29,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:29,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:29,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:29,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:29,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:29,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:29,566 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:29,566 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:29,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:29,568 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:29,568 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:29,569 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:29,569 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:29,571 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:29,571 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:29,571 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:29,572 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:29,583 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3285, Threshold=0.3509, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:33:29,583 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3285
2025-08-04 20:33:37,843 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:37,843 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:37,844 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:37,844 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:37,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:37,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:38,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:38,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:38,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:38,195 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:38,195 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:38,294 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:38,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:38,301 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:38,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:38,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:38,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:38,315 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:38,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:38,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:38,323 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:38,325 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:38,328 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:38,330 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:38,333 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:38,335 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:38,337 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:38,339 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:38,342 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:38,344 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:38,346 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:38,355 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:38,355 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:38,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:38,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:38,365 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:38,365 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:38,376 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:38,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:38,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:38,391 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:38,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:38,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:38,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:38,402 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:38,402 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:38,403 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:38,403 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:38,403 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:38,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:38,404 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:38,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:38,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:38,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:38,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:38,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:38,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:38,408 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:38,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:38,408 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:38,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:38,408 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:38,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:38,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:38,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:38,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:38,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:38,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:38,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:38,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:38,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:38,410 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:38,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:38,411 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:38,413 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:38,413 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:38,415 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:38,415 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:38,416 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 56/400.
2025-08-04 20:33:38,518 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:38,518 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:38,519 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:33:38,520 - ClientAppLogger [Client 8] - INFO - [Client] Round 56: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:33:38,520 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:38,544 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0779, Avg D Loss: 0.8427
2025-08-04 20:33:38,544 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0779, Avg D Loss: 0.8427
2025-08-04 20:33:38,544 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:38,556 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3156, Threshold=0.3363, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:33:38,556 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:33:38,557 - ClientAppLogger [Client 8] - INFO - Fit completed for round 56. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 56, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0779223442077637, 'd_loss': 0.8427130937576294, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.13983583450317383, 'cpu_percent_fit': 29.04375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:33:38,557 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:33:46,803 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:46,803 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:46,803 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:46,803 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:46,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:46,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:47,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:47,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:47,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:47,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:47,163 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:47,303 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:47,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:47,312 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:47,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:47,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:47,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:47,345 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:47,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:47,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:47,354 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:47,357 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,360 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:47,362 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:47,365 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:47,367 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:47,370 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,372 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:47,375 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:47,376 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:47,379 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:47,388 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:47,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:47,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:47,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:47,400 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:47,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:47,416 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:47,416 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:47,416 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:47,435 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:47,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:47,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:47,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:47,452 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:47,452 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:47,452 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:47,452 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:47,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:47,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:47,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:47,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:47,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:47,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:47,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:47,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:47,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:47,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:47,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:47,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:47,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:47,457 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:47,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:47,457 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:47,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:47,457 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:47,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:47,458 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:47,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:47,459 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:47,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:47,459 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:47,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:47,459 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:47,459 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:47,460 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:47,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:47,460 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:47,460 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:47,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:47,469 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:47,469 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:47,473 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:47,474 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:47,476 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:47,476 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:47,476 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:47,477 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:47,493 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3651, Threshold=0.3937, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:33:47,493 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3651
2025-08-04 20:33:58,749 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:58,749 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:58,749 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:58,750 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:33:58,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:33:58,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:59,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:59,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:59,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:33:59,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:33:59,111 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:59,209 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:59,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:59,222 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:59,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:33:59,257 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:59,257 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:33:59,258 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:59,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:59,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:33:59,268 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:59,271 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:59,275 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:59,277 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:59,280 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:59,285 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:59,290 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:59,296 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:59,299 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:59,301 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:59,304 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:59,314 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:59,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:33:59,320 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:33:59,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:33:59,329 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:59,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:33:59,344 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:59,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:33:59,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:59,366 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:59,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:33:59,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:33:59,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:59,379 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:59,379 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:59,380 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:59,380 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:59,380 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:33:59,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:59,381 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:33:59,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:59,382 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:33:59,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:33:59,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:59,383 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:33:59,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:59,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:59,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:59,384 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:33:59,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:33:59,384 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:33:59,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:33:59,384 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:33:59,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:33:59,385 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:33:59,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:33:59,385 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:33:59,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:33:59,386 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:33:59,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:33:59,386 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:59,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:33:59,386 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:59,386 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:59,387 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:59,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:33:59,387 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:33:59,387 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:33:59,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:33:59,392 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:33:59,392 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:59,394 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:59,394 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:59,395 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:59,395 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:59,396 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:59,396 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:59,408 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3608, Threshold=0.3889, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:33:59,408 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3608
2025-08-04 20:34:07,665 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:07,665 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:07,665 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:07,665 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:07,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:07,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:07,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:07,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:08,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:08,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:08,044 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:08,133 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:08,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:08,138 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:08,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:08,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:08,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:08,152 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:08,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:08,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:08,161 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:08,164 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:08,166 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:08,168 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:08,171 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:08,173 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:08,175 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:08,179 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:08,181 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:08,183 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:08,186 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:08,196 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:08,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:08,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:08,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:08,206 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:08,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:08,215 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:08,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:08,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:08,230 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:08,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:08,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:08,240 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:08,240 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:08,240 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:08,240 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:08,240 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:08,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:08,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:08,241 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:08,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:08,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:08,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:08,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:08,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:08,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:08,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:08,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:08,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:08,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:08,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:08,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:08,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:08,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:08,246 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:08,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:08,246 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:08,246 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:08,247 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:08,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:08,247 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:08,247 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:08,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:08,250 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:08,250 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:08,251 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:08,251 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:08,253 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 58/400.
2025-08-04 20:34:08,354 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:08,354 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:08,356 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:34:08,356 - ClientAppLogger [Client 8] - INFO - [Client] Round 58: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:34:08,357 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:08,385 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0789, Avg D Loss: 0.8280
2025-08-04 20:34:08,385 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0789, Avg D Loss: 0.8280
2025-08-04 20:34:08,385 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:08,396 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3367, Threshold=0.3601, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:08,397 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:34:08,397 - ClientAppLogger [Client 8] - INFO - Fit completed for round 58. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 58, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.078858733177185, 'd_loss': 0.8279860436916351, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.14385652542114258, 'cpu_percent_fit': 29.3625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:34:08,397 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:34:13,688 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:13,688 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:13,689 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:13,689 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:13,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:13,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:13,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:13,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:14,074 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:14,092 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:14,093 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:14,199 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:14,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:14,205 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:14,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:14,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:14,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:14,224 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:14,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:14,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:14,233 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:14,235 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,238 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:14,240 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:14,242 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:14,244 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:14,247 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,249 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:14,252 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:14,254 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:14,256 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:14,266 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:14,267 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:14,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:14,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:14,278 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:14,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:14,294 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:14,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:14,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:14,312 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:14,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:14,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:14,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:14,325 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:14,325 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:14,325 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:14,326 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:14,326 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:14,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:14,326 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:14,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:14,328 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:14,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:14,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:14,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:14,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:14,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:14,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:14,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:14,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:14,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:14,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:14,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:14,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:14,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:14,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:14,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:14,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:14,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:14,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:14,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:14,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:14,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:14,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:14,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:14,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:14,333 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:14,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:14,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:14,336 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:14,337 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:14,338 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:14,338 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:14,340 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:14,340 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:14,340 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:14,341 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:14,353 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3704, Threshold=0.4032, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:14,353 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3704
2025-08-04 20:34:19,632 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:19,632 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:19,633 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:19,633 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:19,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:19,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:19,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:19,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:20,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:20,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:20,031 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:20,153 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:20,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:20,159 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:20,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:20,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:20,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:20,173 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:20,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:20,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:20,182 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:20,185 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:20,187 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:20,189 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:20,192 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:20,194 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:20,197 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:20,200 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:20,202 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:20,204 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:20,207 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:20,215 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:20,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:20,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:20,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:20,226 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:20,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:20,238 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:20,238 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:20,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:20,255 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:20,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:20,267 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:20,267 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:20,267 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:20,267 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:20,267 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:20,268 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:20,268 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:20,268 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:20,268 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:20,268 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:20,270 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:20,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:20,271 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:20,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:20,272 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:20,273 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:20,273 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:20,274 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:20,275 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:20,275 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:20,276 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:20,276 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:20,276 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:20,277 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:20,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:20,278 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:20,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:20,278 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:20,279 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:20,279 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:20,279 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:20,279 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:20,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:20,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:20,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:20,282 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:20,283 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:20,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:20,287 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:20,287 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:20,288 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:20,289 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:20,291 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 59/400.
2025-08-04 20:34:20,392 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:20,393 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:20,394 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:34:20,394 - ClientAppLogger [Client 8] - INFO - [Client] Round 59: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:34:20,395 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:20,429 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0683, Avg D Loss: 0.8266
2025-08-04 20:34:20,429 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0683, Avg D Loss: 0.8266
2025-08-04 20:34:20,429 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:20,449 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3449, Threshold=0.3757, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:20,449 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:34:20,450 - ClientAppLogger [Client 8] - INFO - Fit completed for round 59. Duration: 0.16s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 59, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.068264865875244, 'd_loss': 0.8266223549842835, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.15874528884887695, 'cpu_percent_fit': 28.33125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:34:20,450 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:34:28,770 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:28,770 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:28,771 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:28,771 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:28,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:28,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:29,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:29,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:29,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:29,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:29,210 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:29,333 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:29,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:29,347 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:29,353 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:29,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:29,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:29,362 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:29,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:29,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:29,372 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:29,375 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,378 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:29,381 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:29,384 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:29,386 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:29,388 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,391 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:29,394 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:29,395 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:29,398 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:29,407 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:29,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:29,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:29,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:29,420 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:29,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:29,432 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:29,433 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:29,433 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:29,449 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:29,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:29,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:29,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:29,459 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:29,459 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:29,460 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:29,460 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:29,460 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:29,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:29,461 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:29,461 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:29,462 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:29,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:29,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:29,463 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:29,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:29,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:29,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:29,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:29,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:29,464 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:29,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:29,464 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:29,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:29,464 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:29,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:29,465 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:29,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:29,465 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:29,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:29,466 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:29,466 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:29,466 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:29,466 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:29,466 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:29,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:29,467 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:29,467 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:29,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:29,471 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:29,471 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:29,473 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:29,473 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:29,474 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:29,474 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:29,475 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:29,476 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:29,487 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3669, Threshold=0.4020, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:29,487 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3669
2025-08-04 20:34:40,774 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,774 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:40,774 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:40,774 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:40,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:40,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:41,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:41,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:41,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:41,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:41,187 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:41,305 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:41,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:41,314 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:41,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:41,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:41,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:41,331 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:41,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:41,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:41,341 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:41,344 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,347 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:41,350 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:41,352 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:41,355 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:41,358 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,360 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:41,363 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:41,365 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:41,368 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:41,379 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:41,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:41,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:41,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:41,391 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:41,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:41,407 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:41,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:41,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:41,427 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:41,432 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:41,439 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:41,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:41,440 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:41,440 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:41,440 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:41,441 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:41,441 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:41,441 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:41,441 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:41,441 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:41,443 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:41,443 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:41,443 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:41,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:41,444 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:41,444 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:41,444 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:41,444 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:41,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:41,445 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:41,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:41,445 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:41,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:41,445 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:41,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:41,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:41,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:41,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:41,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:41,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:41,447 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:41,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:41,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:41,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:41,448 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:41,448 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:41,448 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:41,448 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:41,451 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:41,451 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:41,453 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:41,453 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:41,455 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:41,456 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:41,456 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:41,456 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:41,472 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3580, Threshold=0.3900, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:41,472 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3580
2025-08-04 20:34:46,716 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:46,716 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:46,716 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:46,717 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:46,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:46,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:46,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:46,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:47,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:47,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:47,037 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:47,129 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:47,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:47,135 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:47,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:47,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:47,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:47,147 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:47,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:47,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:47,155 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:47,158 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:47,160 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:47,162 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:47,165 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:47,167 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:47,169 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:47,172 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:47,175 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:47,177 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:47,179 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:47,189 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:47,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:47,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:47,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:47,200 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:47,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:47,212 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:47,212 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:47,212 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:47,227 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:47,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:47,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:47,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:47,236 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:47,237 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:47,237 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:47,237 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:47,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:47,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:47,238 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:47,238 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:47,239 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:47,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:47,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:47,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:47,242 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:47,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:47,242 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:47,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:47,242 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:47,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:47,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:47,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:47,243 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:47,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:47,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:47,247 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:47,247 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:47,248 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:47,248 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:47,250 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 61/400.
2025-08-04 20:34:47,351 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:47,352 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:47,353 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:34:47,353 - ClientAppLogger [Client 8] - INFO - [Client] Round 61: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:34:47,353 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:47,378 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0786, Avg D Loss: 0.8385
2025-08-04 20:34:47,379 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0786, Avg D Loss: 0.8385
2025-08-04 20:34:47,379 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:47,391 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3370, Threshold=0.3689, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:47,391 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:34:47,391 - ClientAppLogger [Client 8] - INFO - Fit completed for round 61. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 61, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.07861008644104, 'd_loss': 0.8384526610374451, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.14139819145202637, 'cpu_percent_fit': 28.1, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:34:47,392 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:34:52,675 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:52,675 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:52,676 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:52,676 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:34:52,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:34:52,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:52,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:52,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:53,096 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:34:53,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:34:53,124 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:53,259 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:53,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:53,267 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:53,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:34:53,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:53,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:34:53,295 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:53,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:53,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:34:53,306 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:53,309 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,312 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:53,314 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:53,317 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:53,321 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:53,324 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,327 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:53,330 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:53,332 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:53,335 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:53,350 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:53,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:34:53,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:34:53,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:34:53,364 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:53,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:34:53,384 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:53,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:34:53,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:53,403 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:53,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:34:53,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:34:53,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,423 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,423 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,424 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,424 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:34:53,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,426 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:34:53,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:34:53,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:34:53,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:34:53,431 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:34:53,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:34:53,432 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:34:53,432 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:34:53,433 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:34:53,433 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:34:53,434 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:34:53,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:34:53,436 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:34:53,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:34:53,436 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,437 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:34:53,437 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,438 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,439 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:34:53,440 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:34:53,440 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:34:53,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:34:53,448 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:34:53,448 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,450 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,450 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:53,451 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,452 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,452 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,453 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,467 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3637, Threshold=0.3947, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:34:53,467 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3637
2025-08-04 20:35:01,722 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:01,722 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:01,722 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:01,722 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:01,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:01,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:01,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:01,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:02,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:02,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:02,049 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:02,152 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:02,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:02,161 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:02,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:02,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:02,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:02,233 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:02,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:02,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:02,243 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:02,246 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,248 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:02,250 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:02,253 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:02,255 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:02,258 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,260 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:02,263 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:02,265 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:02,267 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:02,278 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:02,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:02,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:02,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:02,288 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:02,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:02,298 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:02,298 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:02,299 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:02,314 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:02,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:02,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:02,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:02,326 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:02,326 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:02,327 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:02,327 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:02,327 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:02,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:02,328 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:02,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:02,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:02,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:02,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:02,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:02,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:02,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:02,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:02,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:02,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:02,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:02,332 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:02,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:02,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:02,333 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:02,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:02,334 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:02,334 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:02,334 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:02,334 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:02,335 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:02,335 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:02,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:02,338 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:02,339 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:02,340 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:02,340 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:02,342 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 62/400.
2025-08-04 20:35:02,444 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:02,444 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:02,445 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:35:02,446 - ClientAppLogger [Client 8] - INFO - [Client] Round 62: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:35:02,446 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:02,473 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0789, Avg D Loss: 0.8391
2025-08-04 20:35:02,473 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0789, Avg D Loss: 0.8391
2025-08-04 20:35:02,473 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:02,485 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3411, Threshold=0.3720, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:02,485 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:35:02,485 - ClientAppLogger [Client 8] - INFO - Fit completed for round 62. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 62, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.078904414176941, 'd_loss': 0.8390811204910278, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.142866849899292, 'cpu_percent_fit': 28.64375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:35:02,485 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:35:10,740 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:10,741 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:10,741 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:10,741 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:10,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:10,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:10,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:10,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:11,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:11,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:11,085 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:11,185 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:11,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:11,194 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:11,199 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:11,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:11,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:11,207 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:11,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:11,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:11,216 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:11,219 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:11,221 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:11,223 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:11,226 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:11,228 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:11,230 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:11,233 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:11,235 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:11,237 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:11,239 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:11,249 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:11,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:11,253 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:11,253 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:11,261 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:11,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:11,274 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:11,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:11,275 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:11,290 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:11,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:11,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:11,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:11,300 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:11,300 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:11,301 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:11,301 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:11,301 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:11,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:11,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:11,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:11,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:11,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:11,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:11,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:11,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:11,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:11,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:11,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:11,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:11,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:11,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:11,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:11,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:11,307 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:11,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:11,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:11,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:11,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:11,308 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:11,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:11,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:11,312 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:11,312 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:11,313 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:11,313 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:11,315 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:11,315 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:11,315 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:11,316 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:11,328 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3698, Threshold=0.4060, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:11,328 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3698
2025-08-04 20:35:22,599 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:22,599 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:22,599 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:22,599 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:22,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:22,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:22,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:22,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:22,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:22,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:22,957 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:23,053 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:23,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:23,060 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:23,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:23,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:23,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:23,077 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:23,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:23,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:23,085 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:23,088 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,090 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:23,092 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:23,095 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:23,097 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:23,100 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,102 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:23,106 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:23,108 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:23,111 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:23,122 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:23,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:23,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:23,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:23,134 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:23,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:23,146 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:23,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:23,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:23,162 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:23,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:23,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:23,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:23,172 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:23,172 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:23,173 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:23,173 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:23,173 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:23,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:23,173 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:23,174 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:23,175 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:23,175 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:23,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:23,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:23,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:23,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:23,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:23,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:23,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:23,177 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:23,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:23,178 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:23,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:23,178 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:23,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:23,178 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:23,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:23,179 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:23,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:23,179 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:23,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:23,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:23,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:23,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:23,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:23,181 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:23,181 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:23,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:23,183 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:23,183 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:23,185 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:23,185 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:23,186 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:23,187 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:23,187 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:23,188 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:23,199 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3864, Threshold=0.4228, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:23,199 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3864
2025-08-04 20:35:34,464 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:34,464 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:34,464 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:34,464 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:34,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:34,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:34,716 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:34,718 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:34,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:34,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:34,822 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:34,921 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:34,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:34,928 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:34,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:34,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:34,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:34,997 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:34,998 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:34,998 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:35,007 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:35,010 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,012 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:35,015 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:35,018 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:35,020 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:35,022 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,025 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:35,027 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:35,029 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:35,031 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:35,042 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:35,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:35,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:35,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:35,053 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:35,054 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:35,065 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:35,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:35,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:35,082 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:35,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:35,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:35,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:35,094 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:35,095 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:35,095 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:35,095 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:35,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:35,096 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:35,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:35,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:35,098 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:35,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:35,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:35,099 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:35,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:35,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:35,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:35,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:35,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:35,100 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:35,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:35,100 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:35,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:35,100 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:35,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:35,101 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:35,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:35,102 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:35,102 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:35,102 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:35,102 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:35,103 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:35,103 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:35,103 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:35,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:35,104 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:35,104 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:35,104 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:35,109 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:35,109 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:35,111 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:35,111 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:35,113 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:35,113 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:35,113 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:35,114 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:35,126 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3575, Threshold=0.3949, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:35,126 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3575
2025-08-04 20:35:40,386 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:40,386 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:40,386 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:40,387 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:40,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:40,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:40,590 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:40,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:40,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:40,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:40,690 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:40,777 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:40,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:40,782 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:40,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:40,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:40,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:40,795 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:40,795 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:40,795 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:40,803 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:40,806 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:40,808 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:40,810 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:40,813 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:40,815 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:40,818 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:40,820 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:40,823 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:40,825 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:40,827 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:40,836 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:40,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:40,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:40,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:40,847 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:40,847 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:40,858 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:40,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:40,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:40,874 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:40,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:40,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:40,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:40,883 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:40,883 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:40,883 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:40,884 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:40,884 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:40,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:40,884 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:40,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:40,886 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:40,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:40,886 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:40,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:40,887 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:40,887 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:40,887 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:40,887 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:40,887 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:40,888 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:40,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:40,888 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:40,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:40,888 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:40,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:40,890 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:40,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:40,890 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:40,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:40,890 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:40,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:40,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:40,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:40,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:40,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:40,892 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:40,892 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:40,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:40,896 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:40,896 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:40,897 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:40,897 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:40,899 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 65/400.
2025-08-04 20:35:41,001 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:41,004 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:41,005 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:35:41,005 - ClientAppLogger [Client 8] - INFO - [Client] Round 65: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:35:41,006 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:41,033 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0778, Avg D Loss: 0.8355
2025-08-04 20:35:41,033 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0778, Avg D Loss: 0.8355
2025-08-04 20:35:41,033 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:41,046 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3348, Threshold=0.3698, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:41,046 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:35:41,047 - ClientAppLogger [Client 8] - INFO - Fit completed for round 65. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 65, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0778300762176514, 'd_loss': 0.8354664981365204, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.14740347862243652, 'cpu_percent_fit': 27.1375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:35:41,047 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:35:46,316 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:46,316 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:46,316 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:46,316 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:46,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:46,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:46,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:46,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:46,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:46,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:46,665 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:46,759 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:46,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:46,766 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:46,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:46,780 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:46,780 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:46,781 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:46,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:46,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:46,791 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:46,794 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,796 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:46,798 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:46,800 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:46,802 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:46,805 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,808 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:46,811 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:46,813 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:46,815 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:46,825 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:46,825 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:46,830 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:46,830 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:46,836 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:46,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:46,849 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:46,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:46,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:46,865 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:46,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:46,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:46,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:46,879 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:46,879 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:46,879 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:46,880 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:46,880 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:46,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:46,880 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:46,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:46,882 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:46,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:46,882 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:46,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:46,882 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:46,883 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:46,883 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:46,883 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:46,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:46,883 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:46,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:46,884 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:46,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:46,884 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:46,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:46,884 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:46,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:46,885 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:46,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:46,885 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:46,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:46,886 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:46,886 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:46,886 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:46,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:46,887 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:46,887 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:46,887 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:46,890 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:46,890 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:46,892 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:46,892 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:46,894 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:46,894 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:46,894 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:46,895 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:46,908 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3719, Threshold=0.4128, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:46,908 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3719
2025-08-04 20:35:52,160 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:52,160 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:52,160 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:52,160 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:52,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:52,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:52,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:52,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:52,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:52,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:52,475 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:52,557 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:52,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:52,562 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:52,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:52,574 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:52,574 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:52,575 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:52,575 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:52,575 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:52,583 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:52,585 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:52,587 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:52,590 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:52,592 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:52,594 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:52,597 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:52,599 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:52,602 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:52,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:52,606 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:52,615 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:52,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:52,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:52,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:52,625 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:52,625 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:52,636 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:52,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:52,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:52,650 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:52,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:52,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:52,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:52,659 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:52,659 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:52,659 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:52,660 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:52,660 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:52,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:52,660 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:52,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:52,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:52,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:52,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:52,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:52,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:52,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:52,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:52,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:52,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:52,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:52,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:52,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:52,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:52,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:52,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:52,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:52,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:52,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:52,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:52,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:52,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:52,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:52,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:52,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:52,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:52,666 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:52,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:52,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:52,669 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:52,669 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:52,670 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:52,670 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:52,672 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 66/400.
2025-08-04 20:35:52,773 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:52,773 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:52,774 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:35:52,774 - ClientAppLogger [Client 8] - INFO - [Client] Round 66: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:35:52,774 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:52,798 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0728, Avg D Loss: 0.8357
2025-08-04 20:35:52,798 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0728, Avg D Loss: 0.8357
2025-08-04 20:35:52,798 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:52,809 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3462, Threshold=0.3849, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:52,809 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:35:52,809 - ClientAppLogger [Client 8] - INFO - Fit completed for round 66. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 66, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0728268384933473, 'd_loss': 0.8357485473155976, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.13753008842468262, 'cpu_percent_fit': 28.93125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:35:52,809 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:35:58,075 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:58,075 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:58,075 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:58,076 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:35:58,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:35:58,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:58,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:58,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:58,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:35:58,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:35:58,431 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:58,532 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:58,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:58,541 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:58,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:35:58,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:58,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:35:58,559 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:58,559 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:58,559 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:35:58,568 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:58,571 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:58,573 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:58,575 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:58,578 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:58,581 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:58,584 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:58,586 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:58,589 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:58,591 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:58,593 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:58,602 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:58,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:35:58,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:35:58,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:35:58,613 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:58,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:35:58,624 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:58,624 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:35:58,624 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:58,641 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:58,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:35:58,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:35:58,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:58,652 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:58,652 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:58,652 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:58,653 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:58,653 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:35:58,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:58,653 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:35:58,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:58,655 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:35:58,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:35:58,655 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:58,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:35:58,655 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:35:58,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:35:58,657 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:35:58,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:35:58,657 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:35:58,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:35:58,658 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:35:58,658 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:35:58,658 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:58,658 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:35:58,658 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:58,658 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:58,659 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:58,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:35:58,663 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:35:58,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:35:58,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:35:58,666 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:35:58,666 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:58,668 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:58,668 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:58,669 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:58,669 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:58,670 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:58,670 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:58,681 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3834, Threshold=0.4240, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:35:58,682 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3834
2025-08-04 20:36:15,960 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:15,960 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:15,960 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:15,961 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:36:15,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:36:15,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:16,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:16,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:16,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:36:16,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:36:16,335 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:16,439 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:16,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:16,445 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:16,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:36:16,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:16,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:36:16,459 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:16,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:16,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:36:16,468 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:16,471 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:16,473 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:16,475 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:16,478 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:16,480 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:16,482 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:16,485 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:16,488 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:16,490 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:16,492 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:16,501 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:16,501 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:36:16,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:36:16,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:16,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:36:16,527 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:16,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:36:16,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:16,543 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:16,548 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:36:16,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:36:16,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:16,560 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:16,560 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:16,561 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:16,561 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:16,561 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:36:16,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:16,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:36:16,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:16,563 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:36:16,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:36:16,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:16,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:36:16,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:16,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:16,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:36:16,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:16,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:36:16,567 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:16,567 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:16,567 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:16,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:36:16,571 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:36:16,571 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:36:16,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:36:16,573 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:36:16,573 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:16,574 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:16,575 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:16,576 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:16,576 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:16,576 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:16,577 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:16,588 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3676, Threshold=0.4034, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:36:16,588 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3676
2025-08-04 20:36:21,839 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:21,840 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:21,840 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:21,840 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:36:21,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:36:21,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:22,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:22,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:22,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:36:22,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:36:22,169 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:22,263 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:22,269 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:22,269 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:22,276 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:36:22,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:22,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:36:22,284 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:22,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:22,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:36:22,293 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:22,296 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:22,298 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:22,300 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:22,303 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:22,305 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:22,307 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:22,310 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:22,312 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:22,314 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:22,316 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:22,326 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:22,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:36:22,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:36:22,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:36:22,336 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:22,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:36:22,346 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:22,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:36:22,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:22,362 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:22,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:36:22,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:36:22,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:22,371 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:22,371 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:22,371 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:22,371 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:22,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:36:22,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:22,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:36:22,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:22,373 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:22,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:36:22,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:36:22,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:36:22,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:36:22,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:36:22,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:22,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:36:22,377 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:22,377 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:22,377 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:22,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:36:22,381 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:36:22,381 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:36:22,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:36:22,383 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:36:22,383 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:22,384 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:22,385 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:22,386 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 68/400.
2025-08-04 20:36:22,487 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:22,487 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:22,488 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:36:22,489 - ClientAppLogger [Client 8] - INFO - [Client] Round 68: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:36:22,489 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:22,515 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0779, Avg D Loss: 0.8319
2025-08-04 20:36:22,515 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0779, Avg D Loss: 0.8319
2025-08-04 20:36:22,515 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:22,526 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3417, Threshold=0.3755, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:36:22,527 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:36:22,527 - ClientAppLogger [Client 8] - INFO - Fit completed for round 68. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 68, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0778730630874636, 'd_loss': 0.8318506717681885, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.14094018936157227, 'cpu_percent_fit': 29.625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:36:22,527 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:36:27,792 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:27,792 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:27,792 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:27,793 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:36:27,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:36:27,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:28,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:28,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:28,130 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:36:28,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:36:28,147 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:28,239 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:28,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:28,244 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:28,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:36:28,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:28,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:36:28,257 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:28,257 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:28,257 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:36:28,265 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:28,268 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:28,270 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:28,272 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:28,274 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:28,277 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:28,279 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:28,282 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:28,285 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:28,287 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:28,289 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:28,298 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:28,298 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:36:28,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:36:28,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:36:28,309 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:28,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:36:28,320 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:28,320 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:36:28,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:28,336 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:28,340 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:36:28,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:36:28,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:28,345 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:28,346 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:28,346 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:28,346 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:28,346 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:36:28,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:28,347 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:36:28,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:28,349 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:36:28,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:36:28,349 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:28,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:36:28,349 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:36:28,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:36:28,351 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:36:28,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:36:28,351 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:36:28,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:36:28,352 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:36:28,352 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:36:28,352 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:28,352 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:36:28,352 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:28,352 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:28,353 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:28,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:36:28,356 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:36:28,356 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:36:28,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:36:28,359 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:36:28,359 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:28,360 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:28,360 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:28,362 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:28,362 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:28,362 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:28,363 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:28,375 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3755, Threshold=0.4194, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:36:28,375 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3755
2025-08-04 20:36:45,668 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:45,668 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:45,669 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:45,669 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:36:45,669 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:36:45,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:45,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:45,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:46,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:36:46,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:36:46,021 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:46,113 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:46,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:46,119 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:46,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:36:46,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:46,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:36:46,131 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:46,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:46,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:36:46,140 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:46,143 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:46,146 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:46,148 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:46,151 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:46,153 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:46,155 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:46,158 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:46,161 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:46,163 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:46,165 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:46,174 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:46,174 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:36:46,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:36:46,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:36:46,185 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:46,185 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:36:46,196 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:46,196 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:36:46,196 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:46,212 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:46,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:36:46,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:36:46,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:46,221 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:46,221 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:46,222 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:46,222 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:46,222 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:36:46,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:46,222 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:36:46,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:46,224 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:36:46,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:36:46,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:36:46,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:36:46,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:36:46,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:36:46,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:36:46,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:46,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:36:46,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:46,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:46,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:46,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:36:46,232 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:36:46,232 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:36:46,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:36:46,235 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:36:46,236 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:46,237 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:46,237 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:46,238 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:46,239 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:46,239 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:46,239 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:46,251 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3943, Threshold=0.4408, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:36:46,251 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3943
2025-08-04 20:37:00,535 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:00,535 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:00,535 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:00,536 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:00,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:00,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:00,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:00,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:00,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:01,007 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:01,007 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:01,149 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:01,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:01,159 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:01,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:01,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:01,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:01,245 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:01,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:01,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:01,255 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:01,258 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:01,260 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:01,262 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:01,265 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:01,267 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:01,270 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:01,272 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:01,275 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:01,277 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:01,280 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:01,291 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:01,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:01,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:01,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:01,303 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:01,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:01,315 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:01,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:01,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:01,331 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:01,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:01,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:01,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:01,341 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:01,341 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:01,341 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:01,341 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:01,342 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:01,342 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:01,342 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:01,342 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:01,344 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:01,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:01,344 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:01,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:01,345 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:01,345 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:01,345 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:01,345 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:01,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:01,345 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:01,346 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:01,346 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:01,346 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:01,347 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:01,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:01,347 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:01,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:01,348 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:01,348 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:01,348 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:01,348 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:01,348 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:01,348 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:01,349 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:01,352 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:01,352 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:01,352 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:01,352 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:01,357 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:01,357 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:01,358 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:01,359 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:01,360 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:01,360 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:01,360 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:01,361 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:01,372 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3829, Threshold=0.4348, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:37:01,372 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.3829
2025-08-04 20:37:06,629 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:06,629 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:06,629 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:06,629 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:06,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:06,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:06,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:06,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:07,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:07,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:07,037 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:07,136 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:07,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:07,142 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:07,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:07,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:07,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:07,155 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:07,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:07,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:07,164 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:07,167 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:07,170 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:07,172 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:07,175 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:07,177 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:07,180 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:07,182 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:07,186 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:07,187 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:07,190 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:07,204 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:07,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:07,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:07,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:07,216 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:07,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:07,229 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:07,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:07,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:07,245 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:07,250 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:07,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:07,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:07,256 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:07,257 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:07,257 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:07,257 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:07,257 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:07,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:07,258 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:07,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:07,259 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:07,259 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:07,260 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:07,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:07,260 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:07,260 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:07,260 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:07,260 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:07,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:07,261 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:07,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:07,261 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:07,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:07,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:07,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:07,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:07,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:07,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:07,263 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:07,263 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:07,263 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:07,263 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:07,263 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:07,264 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:07,264 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:07,264 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:07,264 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:07,264 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:07,268 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:07,268 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:07,269 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:07,270 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:07,271 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 71/400.
2025-08-04 20:37:07,372 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:07,372 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:07,374 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:37:07,374 - ClientAppLogger [Client 8] - INFO - [Client] Round 71: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:37:07,374 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:07,401 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0765, Avg D Loss: 0.8207
2025-08-04 20:37:07,401 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0765, Avg D Loss: 0.8207
2025-08-04 20:37:07,401 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:07,415 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3510, Threshold=0.3958, Accuracy=0.7146, F1=0.8034, Precision=0.9711, Recall=0.6851
2025-08-04 20:37:07,416 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8034
2025-08-04 20:37:07,416 - ClientAppLogger [Client 8] - INFO - Fit completed for round 71. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 71, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0765339374542235, 'd_loss': 0.8207321166992188, 'post_fit_local_f1': 0.8034188034188035, 'fit_time_seconds': 0.14499783515930176, 'cpu_percent_fit': 28.30625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:37:07,416 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:37:15,677 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:15,677 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:15,677 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:15,677 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:15,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:15,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:15,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:15,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:16,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:16,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:16,025 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:16,125 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:16,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:16,131 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:16,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:16,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:16,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:16,148 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:16,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:16,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:16,156 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:16,159 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:16,161 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:16,164 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:16,166 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:16,169 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:16,171 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:16,174 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:16,176 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:16,178 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:16,181 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:16,191 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:16,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:16,196 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:16,196 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:16,202 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:16,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:16,213 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:16,213 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:16,213 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:16,229 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:16,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:16,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:16,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:16,239 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:16,239 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:16,240 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:16,240 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:16,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:16,240 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:16,240 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:16,240 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:16,241 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:16,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:16,242 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:16,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:16,242 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:16,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:16,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:16,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:16,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:16,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:16,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:16,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:16,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:16,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:16,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:16,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:16,245 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:16,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:16,249 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:16,249 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:16,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:16,252 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:16,252 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:16,254 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:16,254 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:16,256 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:16,256 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:16,256 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:16,257 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:16,268 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3879, Threshold=0.4430, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:37:16,268 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3879
2025-08-04 20:37:21,517 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:21,517 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:21,517 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:21,517 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:21,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:21,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:21,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:21,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:21,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:21,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:21,842 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:21,924 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:21,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:21,928 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:21,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:21,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:21,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:21,940 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:21,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:21,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:21,948 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:21,951 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:21,953 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:21,955 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:21,958 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:21,960 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:21,963 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:21,965 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:21,968 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:21,969 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:21,972 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:21,980 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:21,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:21,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:21,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:21,991 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:21,991 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:22,002 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:22,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:22,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:22,016 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:22,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:22,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:22,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:22,025 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:22,025 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:22,025 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:22,025 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:22,026 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:22,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:22,026 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:22,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:22,027 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:22,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:22,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:22,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:22,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:22,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:22,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:22,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:22,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:22,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:22,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:22,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:22,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:22,030 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:22,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:22,030 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:22,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:22,030 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:22,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:22,031 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:22,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:22,031 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:22,031 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:22,032 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:22,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:22,035 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:22,035 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:22,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:22,038 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:22,038 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:22,039 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:22,040 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:22,041 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 72/400.
2025-08-04 20:37:22,142 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:22,142 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:22,143 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:37:22,144 - ClientAppLogger [Client 8] - INFO - [Client] Round 72: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:37:22,144 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:22,167 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0775, Avg D Loss: 0.8193
2025-08-04 20:37:22,168 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0775, Avg D Loss: 0.8193
2025-08-04 20:37:22,171 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:22,182 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3547, Threshold=0.4064, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:37:22,182 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:37:22,183 - ClientAppLogger [Client 8] - INFO - Fit completed for round 72. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 72, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.077525758743286, 'd_loss': 0.8192638456821442, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14162230491638184, 'cpu_percent_fit': 29.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:37:22,183 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:37:27,437 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:27,437 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:27,437 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:27,437 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:27,437 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:27,437 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:27,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:27,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:27,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:27,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:27,789 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:27,895 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:27,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:27,903 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:27,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:27,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:27,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:27,933 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:27,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:27,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:27,942 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:27,945 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:27,948 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:27,950 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:27,953 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:27,955 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:27,957 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:27,960 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:27,963 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:27,965 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:27,968 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:27,979 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:27,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:27,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:27,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:27,992 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:27,992 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:28,005 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:28,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:28,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:28,021 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:28,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:28,033 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:28,034 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:28,034 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:28,034 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:28,034 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:28,035 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:28,035 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:28,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:28,036 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:28,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:28,037 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:28,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:28,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:28,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:28,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:28,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:28,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:28,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:28,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:28,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:28,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:28,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:28,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:28,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:28,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:28,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:28,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:28,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:28,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:28,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:28,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:28,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:28,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:28,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:28,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:28,045 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:28,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:28,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:28,051 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:28,051 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:28,052 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:28,053 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:28,054 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:28,054 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:28,054 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:28,055 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:28,068 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3636, Threshold=0.4184, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:37:28,069 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.3636
2025-08-04 20:37:33,320 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:33,320 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:33,320 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:33,320 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:33,320 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:33,320 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:33,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:33,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:33,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:33,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:33,664 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:33,745 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:33,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:33,750 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:33,754 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:33,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:33,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:33,763 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:33,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:33,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:33,771 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:33,774 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:33,776 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:33,778 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:33,780 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:33,782 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:33,785 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:33,788 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:33,790 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:33,792 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:33,794 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:33,803 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:33,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:33,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:33,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:33,813 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:33,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:33,824 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:33,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:33,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:33,839 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:33,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:33,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:33,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:33,848 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:33,848 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:33,849 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:33,849 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:33,849 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:33,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:33,849 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:33,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:33,851 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:33,851 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:33,851 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:33,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:33,853 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:33,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:33,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:33,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:33,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:33,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:33,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:33,858 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:33,858 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:33,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:33,861 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:33,861 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:33,862 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:33,863 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:33,864 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 73/400.
2025-08-04 20:37:33,964 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:33,964 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:33,965 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:37:33,966 - ClientAppLogger [Client 8] - INFO - [Client] Round 73: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:37:33,966 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:33,990 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0794, Avg D Loss: 0.8154
2025-08-04 20:37:33,990 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0794, Avg D Loss: 0.8154
2025-08-04 20:37:33,993 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:34,004 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3424, Threshold=0.3952, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:37:34,004 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:37:34,004 - ClientAppLogger [Client 8] - INFO - Fit completed for round 73. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 73, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.079387640953064, 'd_loss': 0.8154396772384643, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.1406543254852295, 'cpu_percent_fit': 27.95625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:37:34,005 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:37:42,262 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:42,262 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:42,262 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:42,262 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:42,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:42,263 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:42,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:42,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:42,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:42,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:42,638 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:42,755 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:42,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:42,762 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:42,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:42,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:42,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:42,790 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:42,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:42,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:42,799 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:42,802 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:42,804 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:42,806 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:42,809 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:42,811 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:42,814 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:42,816 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:42,819 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:42,821 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:42,824 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:42,836 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:42,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:42,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:42,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:42,851 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:42,851 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:42,868 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:42,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:42,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:42,889 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:42,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:42,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:42,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:42,905 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:42,905 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:42,906 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:42,906 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:42,907 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:42,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:42,908 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:42,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:42,910 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:42,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:42,910 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:42,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:42,911 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:42,912 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:42,912 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:42,912 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:42,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:42,913 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:42,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:42,913 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:42,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:42,914 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:42,914 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:42,915 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:42,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:42,915 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:42,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:42,916 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:42,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:42,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:42,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:42,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:42,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:42,919 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:42,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:42,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:42,927 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:42,927 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:42,928 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:42,928 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:42,930 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:42,930 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:42,930 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:42,931 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:42,944 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3794, Threshold=0.4397, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:37:42,944 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3794
2025-08-04 20:37:51,203 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:51,203 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:51,204 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:51,204 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:51,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:51,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:51,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:51,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:51,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:51,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:51,518 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:51,603 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:51,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:51,610 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:51,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:51,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:51,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:51,621 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:51,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:51,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:51,629 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:51,632 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:51,634 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:51,636 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:51,639 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:51,641 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:51,643 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:51,646 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:51,648 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:51,650 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:51,652 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:51,660 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:51,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:51,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:51,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:51,670 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:51,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:51,681 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:51,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:51,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:51,696 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:51,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:51,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:51,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:51,704 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:51,705 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:51,705 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:51,705 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:51,705 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:51,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:51,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:51,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:51,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:51,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:51,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:51,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:51,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:51,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:51,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:51,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:51,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:51,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:51,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:51,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:51,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:51,711 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:51,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:51,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:51,713 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:51,713 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:51,715 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:51,715 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:51,716 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 74/400.
2025-08-04 20:37:51,817 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:51,817 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:51,819 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:37:51,819 - ClientAppLogger [Client 8] - INFO - [Client] Round 74: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:37:51,819 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:51,845 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0777, Avg D Loss: 0.8140
2025-08-04 20:37:51,845 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0777, Avg D Loss: 0.8140
2025-08-04 20:37:51,845 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:51,856 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3509, Threshold=0.4056, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:37:51,857 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:37:51,857 - ClientAppLogger [Client 8] - INFO - Fit completed for round 74. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 74, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.077673149108887, 'd_loss': 0.814033979177475, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14035415649414062, 'cpu_percent_fit': 28.3375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:37:51,857 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:37:57,134 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:57,134 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:57,135 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:57,135 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:37:57,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:37:57,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:57,359 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:57,359 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:57,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:37:57,452 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:37:57,453 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:57,534 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:57,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:57,539 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:57,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:37:57,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:57,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:37:57,550 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:57,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:57,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:37:57,558 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:57,560 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:57,562 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:57,564 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:57,567 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:57,569 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:57,572 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:57,574 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:57,577 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:57,579 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:57,581 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:57,591 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:57,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:37:57,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:37:57,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:37:57,601 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:57,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:37:57,611 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:57,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:37:57,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:57,626 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:57,630 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:37:57,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:37:57,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:57,634 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:57,634 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:57,635 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:57,635 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:57,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:37:57,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:57,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:37:57,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:57,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:37:57,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:37:57,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:57,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:37:57,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:37:57,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:37:57,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:37:57,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:37:57,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:37:57,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:37:57,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:37:57,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:37:57,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:57,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:37:57,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:57,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:57,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:57,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:37:57,641 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:37:57,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:37:57,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:37:57,644 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:37:57,644 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:57,645 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:57,645 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:57,646 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:57,647 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:57,647 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:57,647 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:57,658 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3850, Threshold=0.4435, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:37:57,658 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3850
2025-08-04 20:38:02,919 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:02,919 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:02,919 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:02,920 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:02,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:02,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:03,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:03,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:03,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:03,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:03,256 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:03,340 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:03,346 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:03,346 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:03,353 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:03,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:03,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:03,361 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:03,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:03,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:03,371 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:03,374 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:03,376 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:03,378 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:03,381 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:03,383 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:03,386 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:03,389 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:03,391 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:03,393 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:03,396 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:03,404 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:03,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:03,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:03,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:03,413 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:03,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:03,423 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:03,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:03,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:03,440 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:03,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:03,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:03,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:03,450 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:03,450 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:03,450 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:03,451 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:03,451 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:03,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:03,451 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:03,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:03,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:03,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:03,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:03,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:03,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:03,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:03,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:03,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:03,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:03,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:03,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:03,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:03,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:03,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:03,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:03,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:03,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:03,457 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:03,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:03,460 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:03,461 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:03,461 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:03,463 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:03,463 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:03,464 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:03,464 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:03,466 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 75/400.
2025-08-04 20:38:03,567 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:03,567 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:03,569 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:38:03,569 - ClientAppLogger [Client 8] - INFO - [Client] Round 75: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:38:03,569 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:03,592 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0783, Avg D Loss: 0.8135
2025-08-04 20:38:03,592 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0783, Avg D Loss: 0.8135
2025-08-04 20:38:03,595 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:03,607 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3552, Threshold=0.4086, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:03,607 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:38:03,607 - ClientAppLogger [Client 8] - INFO - Fit completed for round 75. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 75, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0783273935317994, 'd_loss': 0.8134609937667847, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14110326766967773, 'cpu_percent_fit': 28.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:38:03,607 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:38:08,882 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:08,882 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:08,882 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:08,882 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:08,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:08,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:09,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:09,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:09,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:09,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:09,277 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:09,379 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:09,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:09,387 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:09,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:09,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:09,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:09,409 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:09,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:09,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:09,418 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:09,421 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,423 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:09,425 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:09,428 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:09,430 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:09,433 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,435 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:09,438 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:09,439 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:09,442 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:09,452 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:09,452 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:09,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:09,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:09,464 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:09,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:09,478 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:09,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:09,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:09,498 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:09,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:09,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:09,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:09,512 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:09,512 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:09,515 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:09,515 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:09,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:09,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:09,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:09,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:09,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:09,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:09,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:09,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:09,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:09,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:09,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:09,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:09,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:09,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:09,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:09,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:09,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:09,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:09,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:09,520 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:09,520 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:09,520 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:09,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:09,523 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:09,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:09,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:09,528 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:09,528 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:09,530 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:09,530 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:09,531 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:09,532 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:09,532 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:09,532 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:09,545 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3861, Threshold=0.4537, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:09,545 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3861
2025-08-04 20:38:14,815 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:14,815 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:14,816 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:14,816 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:14,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:14,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:15,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:15,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:15,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:15,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:15,208 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:15,304 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:15,313 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:15,313 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:15,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:15,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:15,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:15,329 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:15,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:15,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:15,338 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:15,340 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:15,343 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:15,345 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:15,347 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:15,350 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:15,352 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:15,355 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:15,358 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:15,360 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:15,362 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:15,371 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:15,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:15,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:15,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:15,382 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:15,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:15,392 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:15,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:15,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:15,409 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:15,415 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:15,422 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:15,423 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:15,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:15,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:15,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:15,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:15,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:15,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:15,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:15,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:15,426 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:15,426 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:15,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:15,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:15,427 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:15,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:15,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:15,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:15,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:15,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:15,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:15,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:15,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:15,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:15,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:15,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:15,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:15,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:15,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:15,431 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:15,434 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:15,434 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:15,435 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:15,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:15,437 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:15,437 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:15,438 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:15,439 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:15,440 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 76/400.
2025-08-04 20:38:15,541 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:15,541 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:15,543 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:38:15,543 - ClientAppLogger [Client 8] - INFO - [Client] Round 76: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:38:15,543 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:15,567 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0786, Avg D Loss: 0.8113
2025-08-04 20:38:15,569 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0786, Avg D Loss: 0.8113
2025-08-04 20:38:15,569 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:15,582 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3549, Threshold=0.4170, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:15,582 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:38:15,583 - ClientAppLogger [Client 8] - INFO - Fit completed for round 76. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 76, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.078570771217346, 'd_loss': 0.811296570301056, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.1425774097442627, 'cpu_percent_fit': 28.66875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:38:15,583 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:38:23,865 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:23,865 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:23,866 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:23,866 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:23,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:23,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:24,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:24,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:24,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:24,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:24,197 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:24,300 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:24,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:24,309 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:24,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:24,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:24,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:24,330 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:24,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:24,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:24,341 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:24,344 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,346 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:24,348 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:24,351 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:24,353 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:24,355 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,358 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:24,361 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:24,363 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:24,365 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:24,375 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:24,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:24,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:24,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:24,387 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:24,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:24,398 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:24,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:24,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:24,413 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:24,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:24,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:24,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:24,423 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:24,424 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:24,424 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:24,424 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:24,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:24,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:24,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:24,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:24,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:24,427 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:24,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:24,427 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:24,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:24,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:24,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:24,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:24,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:24,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:24,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:24,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:24,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:24,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:24,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:24,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:24,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:24,430 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:24,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:24,431 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:24,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:24,431 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:24,431 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:24,431 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:24,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:24,435 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:24,436 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:24,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:24,439 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:24,439 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:24,441 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:24,441 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:24,443 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:24,443 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:24,443 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:24,443 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:24,456 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3839, Threshold=0.4538, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:24,456 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3839
2025-08-04 20:38:29,721 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:29,721 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:29,722 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:29,722 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:29,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:29,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:29,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:29,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:30,062 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:30,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:30,082 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:30,173 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:30,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:30,179 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:30,183 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:30,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:30,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:30,191 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:30,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:30,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:30,199 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:30,202 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:30,204 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:30,206 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:30,208 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:30,211 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:30,213 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:30,215 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:30,218 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:30,220 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:30,222 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:30,230 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:30,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:30,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:30,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:30,241 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:30,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:30,252 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:30,252 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:30,252 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:30,266 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:30,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:30,276 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:30,276 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:30,276 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:30,276 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:30,277 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:30,277 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:30,277 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:30,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:30,278 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:30,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:30,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:30,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:30,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:30,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:30,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:30,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:30,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:30,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:30,281 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:30,282 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:30,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:30,282 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:30,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:30,282 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:30,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:30,283 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:30,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:30,283 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:30,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:30,284 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:30,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:30,284 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:30,284 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:30,285 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:30,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:30,285 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:30,286 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:30,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:30,289 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:30,290 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:30,291 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:30,291 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:30,293 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 77/400.
2025-08-04 20:38:30,394 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:30,394 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:30,395 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:38:30,396 - ClientAppLogger [Client 8] - INFO - [Client] Round 77: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:38:30,396 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:30,421 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0793, Avg D Loss: 0.8208
2025-08-04 20:38:30,421 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0793, Avg D Loss: 0.8208
2025-08-04 20:38:30,421 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:30,433 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3910, Threshold=0.4620, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:30,433 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:38:30,433 - ClientAppLogger [Client 8] - INFO - Fit completed for round 77. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 77, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.079324150085449, 'd_loss': 0.82083939909935, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14002656936645508, 'cpu_percent_fit': 29.0375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:38:30,433 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:38:35,710 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:35,711 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:35,711 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:35,711 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:35,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:35,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:35,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:35,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:36,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:36,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:36,093 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:36,212 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:36,219 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:36,219 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:36,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:36,269 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:36,269 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:36,270 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:36,270 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:36,270 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:36,279 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:36,282 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,284 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:36,286 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:36,289 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:36,291 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:36,294 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,296 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:36,299 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:36,301 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:36,304 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:36,314 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:36,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:36,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:36,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:36,325 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:36,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:36,339 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:36,339 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:36,339 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:36,356 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:36,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:36,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:36,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:36,370 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:36,370 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:36,371 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:36,371 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:36,371 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:36,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:36,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:36,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:36,373 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:36,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:36,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:36,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:36,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:36,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:36,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:36,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:36,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:36,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:36,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:36,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:36,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:36,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:36,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:36,377 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:36,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:36,377 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:36,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:36,377 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:36,378 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:36,378 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:36,378 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:36,378 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:36,378 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:36,379 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:36,379 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:36,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:36,384 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:36,385 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:36,386 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:36,386 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:36,388 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:36,388 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:36,388 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:36,389 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:36,403 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3833, Threshold=0.4556, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:36,403 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3833
2025-08-04 20:38:41,673 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:41,673 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:41,673 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:41,673 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:41,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:41,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:41,906 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:41,906 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:41,993 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:42,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:42,010 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:42,104 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:42,109 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:42,110 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:42,115 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:42,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:42,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:42,123 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:42,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:42,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:42,132 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:42,136 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:42,138 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:42,140 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:42,143 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:42,145 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:42,147 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:42,150 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:42,153 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:42,155 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:42,157 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:42,167 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:42,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:42,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:42,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:42,178 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:42,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:42,189 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:42,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:42,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:42,205 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:42,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:42,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:42,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:42,215 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:42,215 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:42,215 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:42,216 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:42,216 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:42,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:42,216 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:42,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:42,218 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:42,218 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:42,218 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:42,218 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:42,219 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:42,219 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:42,219 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:42,219 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:42,219 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:42,219 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:42,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:42,220 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:42,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:42,220 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:42,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:42,220 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:42,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:42,221 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:42,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:42,221 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:42,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:42,222 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:42,222 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:42,222 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:42,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:42,223 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:42,223 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:42,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:42,226 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:42,227 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:42,228 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:42,228 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:42,230 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 78/400.
2025-08-04 20:38:42,330 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:42,331 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:42,332 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:38:42,332 - ClientAppLogger [Client 8] - INFO - [Client] Round 78: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:38:42,332 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:42,361 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0820, Avg D Loss: 0.8179
2025-08-04 20:38:42,361 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0820, Avg D Loss: 0.8179
2025-08-04 20:38:42,362 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:42,377 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3926, Threshold=0.4677, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:42,377 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:38:42,378 - ClientAppLogger [Client 8] - INFO - Fit completed for round 78. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 78, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082028388977051, 'd_loss': 0.8179426074028016, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14783501625061035, 'cpu_percent_fit': 29.075, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:38:42,378 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:38:47,644 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:47,644 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:47,644 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:47,644 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:47,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:47,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:47,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:47,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:47,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:47,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:47,997 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:48,120 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:48,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:48,127 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:48,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:48,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:48,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:48,157 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:48,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:48,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:48,168 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:48,171 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,174 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:48,176 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:48,179 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:48,181 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:48,184 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,187 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:48,189 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:48,191 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:48,195 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:48,206 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:48,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:48,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:48,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:48,218 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:48,218 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:48,229 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:48,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:48,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:48,246 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:48,251 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:48,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:48,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:48,258 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:48,258 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:48,258 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:48,259 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:48,259 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:48,259 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:48,259 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:48,259 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:48,261 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:48,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:48,261 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:48,262 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:48,263 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:48,263 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:48,263 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:48,263 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:48,263 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:48,263 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:48,264 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:48,264 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:48,264 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:48,264 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:48,265 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:48,265 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:48,265 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:48,265 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:48,265 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:48,266 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:48,266 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:48,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:48,271 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:48,271 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:48,273 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:48,273 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:48,274 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:48,274 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:48,274 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:48,275 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:48,287 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3837, Threshold=0.4530, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:48,288 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3837
2025-08-04 20:38:53,540 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:53,540 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:53,540 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:53,540 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:38:53,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:38:53,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:53,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:53,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:53,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:38:53,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:38:53,878 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:53,971 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:53,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:53,978 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:53,983 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:38:53,990 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:53,990 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:38:53,991 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:53,991 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:53,991 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:38:54,000 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:54,002 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:54,005 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:54,007 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:54,010 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:54,012 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:54,015 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:54,017 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:54,020 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:54,022 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:54,024 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:54,033 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:54,034 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:38:54,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:38:54,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:38:54,045 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:54,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:38:54,056 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:54,056 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:38:54,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:54,072 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:54,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:38:54,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:38:54,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:54,081 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:54,082 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:54,082 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:54,082 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:54,082 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:38:54,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:54,083 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:38:54,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:54,084 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:38:54,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:38:54,085 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:54,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:38:54,085 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:38:54,086 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:38:54,087 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:38:54,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:38:54,087 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:38:54,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:38:54,087 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:38:54,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:38:54,088 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:54,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:38:54,088 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:54,088 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:54,089 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:54,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:38:54,089 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:38:54,089 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:38:54,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:38:54,092 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:38:54,092 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:54,093 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:54,094 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:54,095 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 79/400.
2025-08-04 20:38:54,197 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:54,197 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:54,198 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:38:54,198 - ClientAppLogger [Client 8] - INFO - [Client] Round 79: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:38:54,199 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:54,224 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0789, Avg D Loss: 0.8172
2025-08-04 20:38:54,225 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0789, Avg D Loss: 0.8172
2025-08-04 20:38:54,225 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:54,238 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3949, Threshold=0.4729, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:38:54,238 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:38:54,238 - ClientAppLogger [Client 8] - INFO - Fit completed for round 79. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 79, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0788578271865843, 'd_loss': 0.8171839594841004, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14292120933532715, 'cpu_percent_fit': 28.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:38:54,238 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:39:02,515 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:02,515 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:02,515 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:02,516 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:02,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:02,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:02,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:02,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:02,897 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:02,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:02,918 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:03,054 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:03,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:03,062 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:03,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:03,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:03,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:03,082 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:03,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:03,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:03,093 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:03,096 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,099 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:03,101 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:03,104 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:03,107 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:03,109 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,112 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:03,115 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:03,117 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:03,120 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:03,130 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:03,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:03,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:03,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:03,142 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:03,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:03,156 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:03,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:03,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:03,173 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:03,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:03,186 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:03,186 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:03,186 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:03,187 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:03,187 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:03,187 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:03,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:03,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:03,188 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:03,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:03,189 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:03,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:03,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:03,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:03,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:03,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:03,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:03,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:03,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:03,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:03,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:03,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:03,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:03,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:03,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:03,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:03,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:03,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:03,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:03,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:03,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:03,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:03,194 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:03,194 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:03,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:03,194 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:03,195 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:03,195 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:03,201 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:03,201 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:03,202 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:03,202 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:03,204 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:03,204 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:03,204 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:03,205 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:03,216 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3789, Threshold=0.4422, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:03,216 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3789
2025-08-04 20:39:17,486 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:17,486 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:17,486 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:17,486 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:17,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:17,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:17,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:17,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:17,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:17,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:17,827 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:18,002 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:18,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:18,028 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:18,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:18,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:18,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:18,051 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:18,051 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:18,051 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:18,064 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:18,070 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,073 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:18,075 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:18,078 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:18,081 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:18,084 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,087 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:18,090 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:18,092 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:18,095 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:18,106 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:18,106 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:18,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:18,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:18,119 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:18,119 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:18,134 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:18,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:18,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:18,150 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:18,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:18,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:18,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:18,163 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:18,163 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:18,164 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:18,164 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:18,164 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:18,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:18,164 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:18,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:18,166 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:18,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:18,166 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:18,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:18,167 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:18,167 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:18,167 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:18,167 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:18,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:18,168 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:18,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:18,168 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:18,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:18,168 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:18,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:18,169 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:18,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:18,169 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:18,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:18,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:18,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:18,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:18,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:18,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:18,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:18,171 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:18,171 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:18,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:18,176 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:18,177 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:18,179 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:18,179 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:18,181 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:18,181 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:18,182 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:18,182 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:18,229 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4057, Threshold=0.4700, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:18,230 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.4057
2025-08-04 20:39:23,480 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:23,480 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:23,480 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:23,480 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:23,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:23,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:23,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:23,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:23,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:23,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:23,817 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:23,917 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:23,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:23,924 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:23,929 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:23,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:23,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:23,947 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:23,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:23,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:23,956 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:23,960 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:23,962 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:23,965 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:23,967 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:23,970 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:23,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:23,975 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:23,978 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:23,980 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:23,982 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:23,992 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:23,992 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:23,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:23,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:24,002 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:24,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:24,012 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:24,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:24,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:24,028 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:24,033 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:24,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:24,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:24,038 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:24,039 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:24,039 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:24,039 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:24,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:24,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:24,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:24,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:24,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:24,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:24,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:24,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:24,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:24,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:24,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:24,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:24,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:24,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:24,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:24,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:24,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:24,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:24,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:24,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:24,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:24,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:24,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:24,047 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:24,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:24,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:24,050 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:24,051 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:24,052 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:24,052 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:24,054 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 81/400.
2025-08-04 20:39:24,156 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:24,156 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:24,157 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:39:24,158 - ClientAppLogger [Client 8] - INFO - [Client] Round 81: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:39:24,158 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:24,187 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0758, Avg D Loss: 0.8194
2025-08-04 20:39:24,187 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0758, Avg D Loss: 0.8194
2025-08-04 20:39:24,187 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:24,198 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3783, Threshold=0.4390, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:24,198 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:39:24,199 - ClientAppLogger [Client 8] - INFO - Fit completed for round 81. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 81, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0757928609848024, 'd_loss': 0.8193951964378356, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.1443161964416504, 'cpu_percent_fit': 29.175, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:39:24,199 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:39:29,465 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:29,465 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:29,465 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:29,465 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:29,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:29,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:29,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:29,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:29,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:29,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:29,861 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:29,973 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:29,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:29,981 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:29,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:30,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:30,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:30,024 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:30,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:30,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:30,034 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:30,037 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,039 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:30,041 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:30,044 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:30,046 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:30,049 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,052 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:30,055 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:30,057 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:30,059 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:30,070 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:30,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:30,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:30,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:30,087 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:30,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:30,101 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:30,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:30,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:30,119 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:30,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:30,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:30,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:30,141 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:30,141 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:30,142 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:30,142 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:30,142 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:30,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:30,143 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:30,143 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:30,144 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:30,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:30,145 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:30,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:30,146 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:30,146 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:30,146 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:30,146 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:30,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:30,147 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:30,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:30,147 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:30,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:30,147 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:30,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:30,148 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:30,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:30,148 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:30,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:30,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:30,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:30,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:30,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:30,150 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:30,150 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:30,150 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:30,150 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:30,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:30,152 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:30,152 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:30,154 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:30,154 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:30,163 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:30,163 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:30,163 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:30,164 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:30,178 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3940, Threshold=0.4507, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:30,178 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3940
2025-08-04 20:39:35,434 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:35,434 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:35,434 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:35,434 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:35,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:35,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:35,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:35,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:35,780 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:35,796 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:35,797 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:35,883 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:35,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:35,889 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:35,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:35,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:35,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:35,903 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:35,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:35,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:35,912 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:35,915 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:35,918 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:35,920 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:35,923 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:35,925 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:35,928 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:35,931 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:35,934 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:35,936 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:35,939 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:35,948 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:35,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:35,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:35,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:35,960 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:35,960 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:35,973 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:35,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:35,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:35,988 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:35,993 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:35,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:35,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:35,999 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:35,999 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:35,999 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:36,000 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:36,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:36,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:36,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:36,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:36,002 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:36,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:36,002 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:36,003 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:36,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:36,005 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:36,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:36,005 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:36,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:36,005 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:36,005 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:36,006 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:36,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:36,006 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:36,006 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:36,007 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:36,008 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:36,008 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:36,010 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:36,010 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:36,012 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 82/400.
2025-08-04 20:39:36,113 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:36,113 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:36,114 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:39:36,115 - ClientAppLogger [Client 8] - INFO - [Client] Round 82: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:39:36,115 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:36,140 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0732, Avg D Loss: 0.8182
2025-08-04 20:39:36,140 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0732, Avg D Loss: 0.8182
2025-08-04 20:39:36,140 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:36,154 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3797, Threshold=0.4385, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:36,154 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:39:36,155 - ClientAppLogger [Client 8] - INFO - Fit completed for round 82. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 82, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.073166346549988, 'd_loss': 0.8182242512702942, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14297819137573242, 'cpu_percent_fit': 28.3625, 'ram_mb_fit': 0.1484375, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:39:36,155 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:39:41,424 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:41,424 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:41,424 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:41,424 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:41,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:41,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:41,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:41,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:41,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:41,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:41,752 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:41,853 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:41,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:41,861 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:41,868 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:41,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:41,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:41,877 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:41,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:41,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:41,886 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:41,889 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:41,891 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:41,893 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:41,896 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:41,898 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:41,901 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:41,903 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:41,906 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:41,908 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:41,910 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:41,920 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:41,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:41,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:41,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:41,932 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:41,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:41,945 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:41,945 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:41,945 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:41,961 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:41,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:41,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:41,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:41,970 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:41,970 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:41,971 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:41,971 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:41,971 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:41,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:41,972 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:41,972 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:41,973 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:41,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:41,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:41,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:41,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:41,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:41,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:41,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:41,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:41,976 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:41,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:41,976 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:41,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:41,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:41,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:41,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:41,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:41,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:41,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:41,978 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:41,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:41,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:41,981 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:41,981 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:41,983 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:41,983 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:41,984 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:41,984 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:41,985 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:41,986 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:41,997 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3825, Threshold=0.4348, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:41,997 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.3825
2025-08-04 20:39:47,246 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:47,246 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:47,246 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:47,246 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:47,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:47,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:47,503 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:47,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:47,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:47,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:47,604 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:47,687 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:47,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:47,693 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:47,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:47,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:47,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:47,710 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:47,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:47,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:47,719 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:47,722 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:47,724 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:47,726 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:47,728 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:47,731 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:47,733 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:47,736 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:47,739 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:47,740 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:47,743 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:47,752 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:47,752 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:47,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:47,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:47,761 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:47,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:47,769 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:47,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:47,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:47,785 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:47,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:47,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:47,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:47,794 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:47,795 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:47,795 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:47,795 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:47,795 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:47,795 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:47,795 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:47,796 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:47,797 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:47,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:47,797 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:47,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:47,797 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:47,797 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:47,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:47,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:47,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:47,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:47,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:47,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:47,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:47,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:47,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:47,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:47,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:47,801 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:47,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:47,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:47,804 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:47,805 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:47,806 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:47,806 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:47,807 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 83/400.
2025-08-04 20:39:47,909 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:47,909 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:47,910 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:39:47,911 - ClientAppLogger [Client 8] - INFO - [Client] Round 83: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:39:47,911 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:47,935 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0767, Avg D Loss: 0.8164
2025-08-04 20:39:47,935 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0767, Avg D Loss: 0.8164
2025-08-04 20:39:47,935 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:47,947 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3779, Threshold=0.4366, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:47,947 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:39:47,947 - ClientAppLogger [Client 8] - INFO - Fit completed for round 83. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 83, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0767332553863525, 'd_loss': 0.8164433777332306, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.13980484008789062, 'cpu_percent_fit': 29.04375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:39:47,948 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:39:56,224 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:56,225 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:56,225 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:56,225 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:39:56,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:39:56,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:56,494 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:56,494 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:56,585 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:39:56,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:39:56,601 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:56,698 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:56,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:56,708 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:56,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:39:56,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:56,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:39:56,721 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:56,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:56,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:39:56,731 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:56,734 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,736 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:56,738 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:56,741 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:56,743 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:56,746 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,748 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:56,751 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:56,753 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:56,755 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:56,765 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:56,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:39:56,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:39:56,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:39:56,775 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:56,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:39:56,786 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:56,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:39:56,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:56,806 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:56,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:39:56,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:39:56,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:56,820 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:56,820 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:56,820 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:56,821 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:56,821 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:39:56,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:56,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:39:56,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:56,823 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:39:56,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:39:56,824 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:56,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:39:56,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:56,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:56,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:56,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:39:56,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:39:56,826 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:39:56,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:39:56,826 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:39:56,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:39:56,826 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:39:56,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:39:56,827 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:39:56,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:39:56,828 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:39:56,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:39:56,828 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:56,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:39:56,829 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:56,829 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:56,829 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:56,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:39:56,830 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:39:56,830 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:39:56,830 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:39:56,833 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:39:56,833 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:56,834 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:56,834 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:56,836 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:56,836 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:56,837 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:56,837 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:56,849 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4142, Threshold=0.4713, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:39:56,850 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.4142
2025-08-04 20:40:11,123 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:11,123 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:11,123 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:11,123 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:40:11,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:40:11,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:11,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:11,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:11,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:40:11,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:40:11,475 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:11,572 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:11,578 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:11,579 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:11,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:40:11,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:11,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:40:11,592 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:11,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:11,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:40:11,601 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:11,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:11,606 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:11,608 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:11,611 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:11,613 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:11,616 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:11,619 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:11,621 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:11,623 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:11,625 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:11,635 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:11,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:40:11,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:40:11,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:40:11,646 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:11,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:40:11,659 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:11,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:40:11,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:11,678 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:11,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:40:11,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:40:11,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:11,695 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:11,696 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:11,696 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:11,697 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:11,697 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:40:11,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:11,697 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:40:11,698 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:11,699 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:40:11,699 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:40:11,700 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:11,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:40:11,700 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:11,700 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:11,700 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:40:11,701 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:40:11,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:40:11,702 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:40:11,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:40:11,702 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:40:11,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:40:11,703 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:11,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:40:11,703 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:11,703 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:11,704 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:11,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:40:11,704 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:40:11,704 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:40:11,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:40:11,708 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:40:11,708 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:11,710 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:11,710 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:11,711 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:11,712 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:11,712 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:11,713 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:11,724 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4179, Threshold=0.4740, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:40:11,725 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4179
2025-08-04 20:40:16,981 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:16,981 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:16,981 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:16,981 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:40:16,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:40:16,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:17,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:17,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:17,276 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:40:17,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:40:17,288 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:17,371 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:17,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:17,376 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:17,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:40:17,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:17,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:40:17,389 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:17,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:17,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:40:17,398 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:17,401 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:17,403 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:17,405 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:17,408 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:17,410 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:17,413 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:17,416 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:17,418 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:17,420 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:17,423 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:17,431 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:17,431 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:40:17,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:40:17,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:40:17,440 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:17,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:40:17,448 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:17,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:40:17,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:17,464 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:17,468 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:40:17,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:40:17,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:17,474 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:17,474 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:17,475 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:17,475 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:17,475 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:40:17,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:17,475 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:40:17,476 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:17,477 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:40:17,477 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:40:17,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:17,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:40:17,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:17,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:17,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:17,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:40:17,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:40:17,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:40:17,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:40:17,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:40:17,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:40:17,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:40:17,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:40:17,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:40:17,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:40:17,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:40:17,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:40:17,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:17,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:40:17,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:17,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:17,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:17,482 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:40:17,482 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:40:17,482 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:40:17,482 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:40:17,484 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:40:17,484 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:17,486 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:17,486 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:17,488 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 85/400.
2025-08-04 20:40:17,589 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:17,589 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:17,590 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:40:17,590 - ClientAppLogger [Client 8] - INFO - [Client] Round 85: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:40:17,591 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:17,617 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0743, Avg D Loss: 0.8231
2025-08-04 20:40:17,618 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0743, Avg D Loss: 0.8231
2025-08-04 20:40:17,618 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:17,631 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3935, Threshold=0.4485, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:40:17,631 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:40:17,631 - ClientAppLogger [Client 8] - INFO - Fit completed for round 85. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 85, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0743443965911865, 'd_loss': 0.8231216549873352, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14347219467163086, 'cpu_percent_fit': 29.45, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:40:17,631 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:40:22,879 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:22,879 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:22,879 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:22,879 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:40:22,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:40:22,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:23,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:23,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:23,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:40:23,217 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:40:23,218 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:23,309 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:23,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:23,316 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:23,320 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:40:23,327 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:23,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:40:23,328 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:23,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:23,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:40:23,337 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:23,340 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:23,343 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:23,345 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:23,347 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:23,349 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:23,352 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:23,355 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:23,357 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:23,359 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:23,362 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:23,371 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:23,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:40:23,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:40:23,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:40:23,381 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:23,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:40:23,389 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:23,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:40:23,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:23,406 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:23,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:40:23,417 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:40:23,417 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:23,417 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:23,417 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:23,417 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:23,418 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:23,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:40:23,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:23,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:40:23,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:23,419 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:23,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:40:23,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:40:23,421 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:40:23,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:40:23,421 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:40:23,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:40:23,421 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:40:23,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:40:23,422 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:40:23,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:40:23,422 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:40:23,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:40:23,422 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:23,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:40:23,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:23,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:23,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:23,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:40:23,424 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:40:23,424 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:40:23,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:40:23,426 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:40:23,426 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:23,428 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:23,428 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:23,430 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:23,430 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:23,430 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:23,431 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:23,442 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3952, Threshold=0.4427, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:40:23,443 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.3952
2025-08-04 20:40:28,689 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:28,689 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:28,689 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:28,690 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:40:28,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:40:28,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:28,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:28,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:28,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:40:29,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:40:29,014 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:29,101 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:29,106 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:29,106 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:29,113 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:40:29,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:29,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:40:29,121 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:29,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:29,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:40:29,130 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:29,133 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:29,135 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:29,137 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:29,140 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:29,142 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:29,144 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:29,146 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:29,149 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:29,151 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:29,153 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:29,161 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:29,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:40:29,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:40:29,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:40:29,171 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:29,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:40:29,179 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:29,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:40:29,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:29,195 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:29,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:40:29,203 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:40:29,203 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:29,204 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:29,204 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:29,204 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:29,204 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:29,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:40:29,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:29,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:40:29,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:29,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:40:29,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:40:29,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:29,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:40:29,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:29,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:29,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:29,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:40:29,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:40:29,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:40:29,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:40:29,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:40:29,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:40:29,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:40:29,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:40:29,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:40:29,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:40:29,209 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:40:29,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:40:29,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:29,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:40:29,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:29,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:29,210 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:29,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:40:29,214 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:40:29,214 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:40:29,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:40:29,217 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:40:29,217 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:29,219 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:29,219 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:29,220 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 86/400.
2025-08-04 20:40:29,322 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:29,322 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:29,323 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:40:29,323 - ClientAppLogger [Client 8] - INFO - [Client] Round 86: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:40:29,323 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:29,349 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0800, Avg D Loss: 0.8197
2025-08-04 20:40:29,349 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0800, Avg D Loss: 0.8197
2025-08-04 20:40:29,353 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:29,364 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3874, Threshold=0.4393, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:40:29,364 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:40:29,365 - ClientAppLogger [Client 8] - INFO - Fit completed for round 86. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 86, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0799534559249877, 'd_loss': 0.8196615636348724, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14402079582214355, 'cpu_percent_fit': 27.85, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:40:29,365 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:40:37,612 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:37,612 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:37,613 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:37,613 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:40:37,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:40:37,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:37,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:37,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:37,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:40:37,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:40:37,934 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:38,019 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:38,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:38,024 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:38,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:40:38,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:38,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:40:38,036 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:38,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:38,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:40:38,044 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:38,047 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:38,049 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:38,051 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:38,054 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:38,056 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:38,058 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:38,061 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:38,063 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:38,065 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:38,067 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:38,076 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:38,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:40:38,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:40:38,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:40:38,087 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:38,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:40:38,097 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:38,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:40:38,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:38,113 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:38,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:40:38,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:40:38,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:38,121 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:38,121 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:38,122 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:38,122 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:38,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:40:38,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:38,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:40:38,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:38,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:40:38,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:40:38,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:40:38,126 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:40:38,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:40:38,127 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:40:38,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:40:38,127 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:38,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:40:38,127 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:38,128 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:38,128 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:38,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:40:38,131 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:40:38,132 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:40:38,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:40:38,135 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:40:38,135 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:38,136 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:38,136 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:38,138 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:38,138 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:38,138 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:38,139 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:38,150 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4275, Threshold=0.4890, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:40:38,151 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.4275
2025-08-04 20:40:55,471 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:55,471 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:55,471 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:55,472 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:40:55,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:40:55,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:55,749 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:55,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:55,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:40:55,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:40:55,850 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:55,937 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:55,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:55,944 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:55,948 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:40:55,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:55,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:40:55,955 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:55,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:55,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:40:55,964 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:55,967 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,969 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:55,971 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:55,974 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:55,976 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:55,979 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,981 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:55,984 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:55,985 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:55,988 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:55,996 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:55,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:40:56,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:40:56,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:40:56,005 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:56,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:40:56,013 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:56,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:40:56,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:56,028 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:56,032 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:40:56,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:40:56,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:56,038 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:56,038 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:56,038 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:56,038 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:56,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:40:56,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:56,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:40:56,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:56,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:40:56,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:40:56,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:56,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:40:56,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:56,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:56,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:56,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:40:56,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:40:56,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:40:56,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:40:56,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:40:56,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:40:56,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:40:56,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:40:56,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:40:56,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:40:56,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:40:56,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:40:56,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:56,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:40:56,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:56,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:56,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:56,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:40:56,048 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:40:56,049 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:40:56,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:40:56,051 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:40:56,051 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:56,052 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:56,052 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:56,054 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:56,054 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:56,054 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:56,055 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:56,066 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4317, Threshold=0.4868, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:40:56,066 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4317
2025-08-04 20:41:01,324 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:01,324 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:01,324 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:01,325 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:01,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:01,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:01,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:01,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:01,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:01,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:01,706 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:01,799 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:01,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:01,804 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:01,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:01,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:01,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:01,817 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:01,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:01,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:01,825 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:01,828 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:01,830 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:01,832 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:01,835 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:01,837 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:01,840 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:01,842 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:01,845 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:01,847 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:01,849 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:01,859 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:01,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:01,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:01,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:01,870 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:01,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:01,884 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:01,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:01,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:01,901 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:01,906 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:01,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:01,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:01,914 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:01,914 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:01,915 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:01,915 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:01,915 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:01,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:01,916 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:01,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:01,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:01,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:01,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:01,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:01,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:01,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:01,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:01,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:01,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:01,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:01,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:01,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:01,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:01,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:01,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:01,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:01,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:01,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:01,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:01,926 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:01,926 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:01,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:01,929 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:01,929 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:01,931 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:01,931 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:01,933 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 88/400.
2025-08-04 20:41:02,034 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:02,034 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:02,035 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:41:02,036 - ClientAppLogger [Client 8] - INFO - [Client] Round 88: Training GAN with 15 samples (12 normal, 3 anomalous).
2025-08-04 20:41:02,036 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:02,062 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0765, Avg D Loss: 0.8102
2025-08-04 20:41:02,063 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0765, Avg D Loss: 0.8102
2025-08-04 20:41:02,066 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:02,077 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3982, Threshold=0.4498, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:41:02,077 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:41:02,077 - ClientAppLogger [Client 8] - INFO - Fit completed for round 88. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 88, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0764569520950316, 'd_loss': 0.8102029681205749, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14465785026550293, 'cpu_percent_fit': 28.70625, 'ram_mb_fit': 1.4765625, 'accumulated_train_samples_this_round': 15}
2025-08-04 20:41:02,078 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:41:10,378 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:10,378 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:10,379 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:10,379 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:10,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:10,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:10,715 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:10,715 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:10,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:10,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:10,840 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:10,936 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:10,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:10,943 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:10,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:10,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:10,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:10,955 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:10,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:10,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:10,963 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:10,966 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,968 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:10,970 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:10,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:10,974 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:10,977 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,980 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:10,982 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:10,984 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:10,987 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:10,995 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:10,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:11,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:11,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:11,004 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:11,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:11,013 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:11,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:11,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:11,029 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:11,034 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:11,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:11,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:11,039 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:11,039 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:11,039 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:11,039 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:11,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:11,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:11,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:11,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:11,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:11,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:11,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:11,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:11,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:11,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:11,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:11,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:11,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:11,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:11,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:11,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:11,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:11,049 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:11,049 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:11,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:11,051 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:11,051 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:11,053 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:11,053 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:11,054 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:11,054 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:11,055 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:11,055 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:11,066 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4005, Threshold=0.4439, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:41:11,067 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4005
2025-08-04 20:41:16,330 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:16,330 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:16,330 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:16,331 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:16,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:16,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:16,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:16,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:16,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:16,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:16,695 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:16,791 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:16,796 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:16,796 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:16,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:16,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:16,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:16,812 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:16,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:16,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:16,820 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:16,823 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:16,826 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:16,828 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:16,830 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:16,833 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:16,836 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:16,839 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:16,842 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:16,844 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:16,847 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:16,858 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:16,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:16,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:16,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:16,874 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:16,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:16,890 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:16,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:16,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:16,907 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:16,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:16,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:16,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:16,917 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:16,917 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:16,918 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:16,918 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:16,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:16,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:16,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:16,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:16,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:16,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:16,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:16,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:16,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:16,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:16,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:16,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:16,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:16,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:16,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:16,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:16,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:16,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:16,923 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:16,923 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:16,923 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:16,923 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:16,923 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:16,924 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:16,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:16,924 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:16,924 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:16,924 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:16,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:16,925 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:16,925 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:16,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:16,927 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:16,927 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:16,929 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:16,929 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:16,931 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 89/400.
2025-08-04 20:41:17,032 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:17,032 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:17,033 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:41:17,033 - ClientAppLogger [Client 8] - INFO - [Client] Round 89: Training GAN with 15 samples (12 normal, 3 anomalous).
2025-08-04 20:41:17,034 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:17,059 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0816, Avg D Loss: 0.8088
2025-08-04 20:41:17,059 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0816, Avg D Loss: 0.8088
2025-08-04 20:41:17,059 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:17,070 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3922, Threshold=0.4411, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:41:17,070 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:41:17,071 - ClientAppLogger [Client 8] - INFO - Fit completed for round 89. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 89, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.08155243396759, 'd_loss': 0.8088331818580627, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.13989567756652832, 'cpu_percent_fit': 27.425, 'ram_mb_fit': 0.125, 'accumulated_train_samples_this_round': 15}
2025-08-04 20:41:17,071 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:41:22,355 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:22,355 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:22,355 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:22,356 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:22,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:22,356 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:22,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:22,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:22,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:22,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:22,848 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:22,967 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:22,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:22,979 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:22,990 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:23,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:23,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:23,005 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:23,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:23,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:23,016 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:23,019 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:23,022 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:23,025 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:23,028 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:23,031 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:23,034 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:23,037 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:23,040 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:23,042 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:23,045 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:23,061 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:23,062 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:23,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:23,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:23,078 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:23,079 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:23,097 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:23,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:23,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:23,118 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:23,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:23,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:23,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:23,132 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:23,132 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:23,133 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:23,133 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:23,133 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:23,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:23,134 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:23,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:23,136 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:23,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:23,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:23,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:23,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:23,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:23,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:23,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:23,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:23,143 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:23,143 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:23,143 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:23,144 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:23,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:23,144 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:23,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:23,148 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:23,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:23,148 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:23,148 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:23,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:23,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:23,149 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:23,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:23,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:23,153 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:23,153 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:23,155 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:23,156 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:23,157 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:23,157 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:23,158 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:23,159 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:23,171 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4048, Threshold=0.4413, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:41:23,171 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4048
2025-08-04 20:41:34,445 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:34,445 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:34,445 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:34,445 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:34,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:34,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:34,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:34,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:34,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:34,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:34,977 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:35,104 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:35,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:35,121 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:35,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:35,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:35,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:35,152 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:35,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:35,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:35,165 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:35,168 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,170 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:35,173 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:35,178 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:35,182 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:35,185 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,188 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:35,192 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:35,194 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:35,197 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:35,210 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:35,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:35,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:35,217 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:35,224 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:35,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:35,241 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:35,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:35,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:35,265 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:35,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:35,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:35,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:35,284 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:35,285 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:35,286 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:35,286 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:35,286 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:35,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:35,287 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:35,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:35,289 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:35,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:35,289 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:35,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:35,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:35,291 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:35,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:35,291 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:35,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:35,291 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:35,292 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:35,292 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:35,292 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:35,292 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:35,293 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:35,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:35,311 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:35,312 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:35,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:35,315 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:35,316 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:35,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:35,319 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:35,319 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:35,326 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:35,328 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:35,333 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:35,334 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:35,334 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:35,336 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:35,387 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4486, Threshold=0.5051, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:41:35,387 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4486
2025-08-04 20:41:49,655 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:49,655 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:49,655 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:49,655 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:49,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:49,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:49,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:49,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:50,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:50,109 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:50,109 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:50,231 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:50,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:50,244 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:50,253 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:50,281 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:50,281 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:50,282 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:50,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:50,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:50,295 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:50,298 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,300 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:50,302 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:50,305 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:50,307 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:50,311 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,315 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:50,318 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:50,320 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:50,322 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:50,332 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:50,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:50,337 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:50,338 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:50,345 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:50,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:50,361 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:50,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:50,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:50,382 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:50,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:50,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:50,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:50,396 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:50,397 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:50,397 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:50,397 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:50,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:50,397 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:50,398 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:50,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:50,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:50,399 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:50,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:50,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:50,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:50,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:50,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:50,401 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:50,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:50,401 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:50,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:50,402 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:50,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:50,402 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:50,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:50,403 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:50,403 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:50,403 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:50,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:50,404 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:50,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:50,405 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:50,405 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:50,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:50,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:50,406 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:50,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:50,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:50,413 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:50,413 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:50,415 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:50,416 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:50,418 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:50,418 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:50,418 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:50,419 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:50,436 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4385, Threshold=0.5011, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:41:50,436 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4385
2025-08-04 20:41:58,690 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:58,690 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:58,691 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:58,691 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:41:58,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:41:58,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:58,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:58,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:58,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:41:59,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:41:59,010 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:59,094 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:59,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:59,101 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:59,106 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:41:59,113 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:59,114 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:41:59,114 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:59,114 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:59,114 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:41:59,123 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:59,126 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:59,128 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:59,130 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:59,133 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:59,135 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:59,138 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:59,141 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:59,143 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:59,145 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:59,147 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:59,156 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:59,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:41:59,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:41:59,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:41:59,166 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:59,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:41:59,177 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:59,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:41:59,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:59,193 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:59,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:41:59,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:41:59,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:59,201 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:59,202 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:59,202 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:59,202 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:59,202 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:41:59,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:59,203 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:41:59,203 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:59,204 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:41:59,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:41:59,204 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:41:59,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:41:59,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:41:59,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:59,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:41:59,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:59,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:59,207 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:59,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:41:59,208 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:41:59,208 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:41:59,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:41:59,210 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:41:59,211 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:59,212 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:59,212 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:59,214 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 92/400.
2025-08-04 20:41:59,315 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:59,315 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:59,316 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:41:59,317 - ClientAppLogger [Client 8] - INFO - [Client] Round 92: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:41:59,317 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:59,342 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0779, Avg D Loss: 0.8187
2025-08-04 20:41:59,342 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0779, Avg D Loss: 0.8187
2025-08-04 20:41:59,343 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:59,354 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3815, Threshold=0.4305, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:41:59,354 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:41:59,354 - ClientAppLogger [Client 8] - INFO - Fit completed for round 92. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 92, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.077898955345154, 'd_loss': 0.8186727225780487, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14047718048095703, 'cpu_percent_fit': 30.35625, 'ram_mb_fit': 7.984375, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:41:59,354 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:42:04,607 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:04,607 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:04,607 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:04,607 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:42:04,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:42:04,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:04,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:04,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:04,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:42:04,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:42:04,943 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:05,105 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:05,113 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:05,113 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:05,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:42:05,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:05,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:42:05,161 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:05,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:05,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:42:05,173 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:05,176 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,179 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:05,182 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:05,185 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:05,187 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:05,191 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,194 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:05,197 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:05,199 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:05,201 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:05,214 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:05,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:42:05,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:42:05,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:42:05,227 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:05,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:42:05,243 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:05,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:42:05,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:05,260 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:05,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:42:05,275 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:42:05,275 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:05,275 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:05,276 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:05,276 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:05,276 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:05,277 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:42:05,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:05,277 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:42:05,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:05,278 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:42:05,279 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:42:05,279 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:05,279 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:42:05,279 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:05,279 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:05,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:05,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:42:05,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:42:05,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:42:05,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:42:05,280 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:42:05,281 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:42:05,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:42:05,281 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:42:05,281 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:42:05,281 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:42:05,282 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:42:05,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:42:05,282 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:05,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:42:05,283 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:05,283 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:05,283 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:05,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:42:05,285 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:42:05,285 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:42:05,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:42:05,293 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:42:05,294 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:05,295 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:05,296 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:05,297 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:05,297 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:05,298 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:05,298 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:05,310 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4021, Threshold=0.4509, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:42:05,311 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.4021
2025-08-04 20:42:22,578 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:22,578 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:22,578 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:22,578 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:42:22,578 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:42:22,579 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:22,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:22,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:22,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:42:22,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:42:22,903 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:22,993 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:23,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:23,000 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:23,008 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:42:23,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:23,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:42:23,018 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:23,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:23,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:42:23,028 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:23,032 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,034 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:23,036 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:23,039 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:23,041 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:23,043 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,046 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:23,051 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:23,053 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:23,055 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:23,066 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:23,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:42:23,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:42:23,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:42:23,078 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:23,078 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:42:23,089 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:23,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:42:23,090 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:23,107 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:23,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:42:23,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:42:23,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:23,116 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:23,117 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:23,117 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:23,117 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:23,117 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:42:23,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:23,118 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:42:23,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:23,119 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:42:23,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:42:23,120 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:23,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:42:23,120 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:23,120 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:23,121 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:23,121 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:42:23,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:42:23,121 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:42:23,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:42:23,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:42:23,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:42:23,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:42:23,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:42:23,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:42:23,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:42:23,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:42:23,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:42:23,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:23,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:42:23,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:23,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:23,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:23,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:42:23,124 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:42:23,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:42:23,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:42:23,128 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:42:23,128 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:23,130 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:23,130 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:23,131 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:23,132 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:23,132 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:23,133 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:23,145 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4202, Threshold=0.4612, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:42:23,145 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4202
2025-08-04 20:42:31,401 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:31,401 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:31,401 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:31,401 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:42:31,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:42:31,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:31,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:31,620 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:31,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:42:31,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:42:31,713 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:31,795 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:31,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:31,801 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:31,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:42:31,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:31,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:42:31,811 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:31,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:31,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:42:31,820 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:31,824 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:31,827 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:31,829 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:31,832 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:31,834 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:31,837 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:31,840 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:31,842 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:31,845 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:31,847 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:31,857 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:31,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:42:31,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:42:31,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:42:31,868 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:31,868 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:42:31,878 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:31,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:42:31,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:31,893 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:31,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:42:31,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:42:31,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:31,903 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:31,903 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:31,904 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:31,904 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:31,904 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:42:31,904 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:31,905 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:42:31,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:31,906 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:42:31,906 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:42:31,907 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:31,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:42:31,907 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:31,907 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:31,907 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:31,908 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:42:31,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:42:31,908 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:42:31,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:42:31,908 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:42:31,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:42:31,909 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:42:31,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:42:31,909 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:42:31,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:42:31,910 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:42:31,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:42:31,910 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:31,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:42:31,910 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:31,911 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:31,911 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:31,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:42:31,911 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:42:31,912 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:42:31,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:42:31,915 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:42:31,915 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:31,917 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:31,917 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:31,919 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 94/400.
2025-08-04 20:42:32,019 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:32,020 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:32,021 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:42:32,021 - ClientAppLogger [Client 8] - INFO - [Client] Round 94: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:42:32,021 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:32,049 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0776, Avg D Loss: 0.8180
2025-08-04 20:42:32,049 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0776, Avg D Loss: 0.8180
2025-08-04 20:42:32,049 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:32,063 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3747, Threshold=0.4095, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:42:32,063 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:42:32,063 - ClientAppLogger [Client 8] - INFO - Fit completed for round 94. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 94, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0775975465774534, 'd_loss': 0.8180254101753235, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14459943771362305, 'cpu_percent_fit': 28.34375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:42:32,064 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:42:37,311 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:37,311 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:37,311 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:37,311 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:42:37,311 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:42:37,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:37,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:37,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:37,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:42:37,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:42:37,646 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:37,741 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:37,748 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:37,748 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:37,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:42:37,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:37,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:42:37,766 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:37,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:37,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:42:37,775 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:37,778 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:37,780 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:37,783 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:37,786 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:37,788 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:37,791 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:37,793 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:37,796 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:37,798 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:37,800 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:37,810 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:37,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:42:37,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:42:37,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:42:37,821 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:37,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:42:37,830 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:37,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:42:37,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:37,846 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:37,851 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:42:37,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:42:37,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:37,857 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:37,857 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:37,858 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:37,858 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:37,858 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:42:37,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:37,858 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:42:37,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:37,860 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:42:37,860 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:42:37,861 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:37,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:42:37,861 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:37,862 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:37,862 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:37,862 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:42:37,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:42:37,862 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:42:37,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:42:37,863 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:42:37,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:42:37,863 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:42:37,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:42:37,863 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:42:37,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:42:37,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:42:37,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:42:37,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:37,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:42:37,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:37,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:37,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:37,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:42:37,869 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:42:37,870 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:42:37,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:42:37,872 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:42:37,872 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:37,873 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:37,874 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:37,875 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:37,876 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:37,876 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:37,876 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:37,890 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3973, Threshold=0.4309, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:42:37,890 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.3973
2025-08-04 20:42:46,143 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:46,144 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:46,144 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:46,144 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:42:46,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:42:46,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:46,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:46,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:46,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:42:46,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:42:46,485 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:46,581 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:46,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:46,587 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:46,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:42:46,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:46,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:42:46,640 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:46,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:46,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:42:46,648 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:46,650 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:46,653 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:46,655 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:46,658 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:46,660 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:46,662 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:46,665 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:46,668 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:46,669 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:46,672 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:46,682 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:46,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:42:46,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:42:46,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:42:46,693 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:46,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:42:46,706 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:46,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:42:46,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:46,724 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:46,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:42:46,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:42:46,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:46,735 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:46,735 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:46,735 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:46,735 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:46,736 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:42:46,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:46,736 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:42:46,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:46,737 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:42:46,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:42:46,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:46,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:42:46,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:46,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:46,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:42:46,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:42:46,740 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:42:46,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:42:46,740 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:42:46,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:42:46,740 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:46,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:42:46,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:46,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:46,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:46,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:42:46,744 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:42:46,744 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:42:46,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:42:46,749 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:42:46,749 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:46,750 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:46,750 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:46,752 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 95/400.
2025-08-04 20:42:46,861 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:46,862 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:46,864 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:42:46,872 - ClientAppLogger [Client 8] - INFO - [Client] Round 95: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:42:46,873 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:46,900 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0808, Avg D Loss: 0.8145
2025-08-04 20:42:46,901 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0808, Avg D Loss: 0.8145
2025-08-04 20:42:46,904 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:46,916 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3727, Threshold=0.4072, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:42:46,916 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:42:46,916 - ClientAppLogger [Client 8] - INFO - Fit completed for round 95. Duration: 0.16s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 95, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0807809591293336, 'd_loss': 0.8145014822483063, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.16399002075195312, 'cpu_percent_fit': 22.7625, 'ram_mb_fit': 5.1484375, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:42:46,916 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:42:55,174 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:55,174 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:55,174 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:55,175 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:42:55,175 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:42:55,175 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:55,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:55,403 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:55,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:42:55,502 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:42:55,502 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:55,589 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:55,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:55,596 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:55,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:42:55,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:55,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:42:55,608 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:55,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:55,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:42:55,616 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:55,619 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:55,621 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:55,623 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:55,626 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:55,628 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:55,631 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:55,634 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:55,637 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:55,639 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:55,641 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:55,649 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:55,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:42:55,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:42:55,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:42:55,658 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:55,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:42:55,666 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:55,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:42:55,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:55,681 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:55,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:42:55,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:42:55,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:55,690 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:55,690 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:55,690 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:55,691 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:55,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:42:55,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:55,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:42:55,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:55,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:42:55,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:42:55,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:55,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:42:55,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:42:55,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:42:55,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:55,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:42:55,696 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:55,696 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:55,696 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:55,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:42:55,700 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:42:55,700 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:42:55,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:42:55,702 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:42:55,703 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:55,704 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:55,704 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:55,705 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:55,705 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:55,705 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:55,706 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:55,718 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4168, Threshold=0.4433, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:42:55,719 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4168
2025-08-04 20:43:03,969 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:03,969 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:03,969 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:03,969 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:43:03,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:43:03,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:04,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:04,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:04,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:43:04,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:43:04,274 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:04,362 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:04,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:04,369 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:04,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:43:04,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:04,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:43:04,381 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:04,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:04,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:43:04,391 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:04,393 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:04,396 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:04,398 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:04,401 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:04,403 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:04,406 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:04,408 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:04,411 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:04,413 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:04,415 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:04,428 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:04,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:43:04,434 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:43:04,434 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:43:04,438 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:04,439 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:43:04,447 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:04,448 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:43:04,448 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:04,463 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:04,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:43:04,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:43:04,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:04,473 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:04,473 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:04,474 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:04,474 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:04,474 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:43:04,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:04,475 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:43:04,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:04,476 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:43:04,477 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:43:04,477 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:04,477 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:43:04,477 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:43:04,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:43:04,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:43:04,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:43:04,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:43:04,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:43:04,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:43:04,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:43:04,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:43:04,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:04,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:43:04,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:04,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:04,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:04,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:43:04,485 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:43:04,485 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:43:04,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:43:04,487 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:43:04,487 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:04,488 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:04,489 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:04,490 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 96/400.
2025-08-04 20:43:04,591 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:04,591 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:04,592 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:43:04,592 - ClientAppLogger [Client 8] - INFO - [Client] Round 96: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:43:04,592 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:04,620 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0733, Avg D Loss: 0.8006
2025-08-04 20:43:04,620 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0733, Avg D Loss: 0.8006
2025-08-04 20:43:04,623 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:04,635 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3693, Threshold=0.3915, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:43:04,636 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:43:04,636 - ClientAppLogger [Client 8] - INFO - Fit completed for round 96. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 96, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.073302698135376, 'd_loss': 0.8006438374519348, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14574289321899414, 'cpu_percent_fit': 28.9375, 'ram_mb_fit': 2.96484375, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:43:04,636 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:43:09,889 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:09,889 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:09,889 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:09,889 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:43:09,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:43:09,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:10,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:10,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:10,196 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:43:10,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:43:10,210 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:10,291 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:10,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:10,296 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:10,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:43:10,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:10,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:43:10,306 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:10,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:10,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:43:10,315 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:10,318 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:10,320 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:10,322 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:10,325 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:10,327 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:10,329 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:10,332 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:10,334 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:10,336 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:10,339 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:10,349 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:10,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:43:10,354 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:43:10,354 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:43:10,360 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:10,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:43:10,371 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:10,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:43:10,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:10,386 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:10,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:43:10,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:43:10,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:10,395 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:10,396 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:10,396 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:10,396 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:10,396 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:43:10,397 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:10,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:43:10,397 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:10,398 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:43:10,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:43:10,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:10,399 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:43:10,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:10,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:10,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:10,399 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:43:10,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:43:10,401 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:43:10,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:43:10,401 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:43:10,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:43:10,401 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:10,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:43:10,402 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:10,402 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:10,402 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:10,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:43:10,406 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:43:10,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:43:10,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:43:10,409 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:43:10,409 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:10,410 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:10,410 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:10,412 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:10,412 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:10,413 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:10,413 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:10,425 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4516, Threshold=0.4846, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:43:10,426 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4516
2025-08-04 20:43:24,700 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:24,700 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:24,700 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:24,701 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:43:24,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:43:24,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:24,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:24,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:24,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:43:25,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:43:25,002 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:25,083 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:25,090 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:25,090 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:25,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:43:25,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:25,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:43:25,101 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:25,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:25,101 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:43:25,109 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:25,112 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:25,114 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:25,116 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:25,119 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:25,121 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:25,124 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:25,126 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:25,129 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:25,131 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:25,133 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:25,143 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:25,143 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:43:25,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:43:25,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:43:25,153 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:25,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:43:25,162 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:25,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:43:25,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:25,178 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:25,183 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:43:25,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:43:25,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:25,189 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:25,189 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:25,189 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:25,189 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:25,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:43:25,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:25,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:43:25,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:25,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:43:25,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:25,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:43:25,195 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:25,195 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:25,195 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:25,199 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:43:25,199 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:43:25,199 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:43:25,199 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:43:25,201 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:43:25,201 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:25,202 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:25,203 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:25,204 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:25,204 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:25,204 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:25,205 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:25,216 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4243, Threshold=0.4492, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:43:25,217 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4243
2025-08-04 20:43:42,536 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:42,536 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:42,536 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:42,536 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:43:42,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:43:42,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:42,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:42,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:42,860 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:43:42,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:43:42,878 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:42,977 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:42,984 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:42,984 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:42,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:43:42,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:42,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:43:42,996 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:42,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:42,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:43:43,004 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:43,007 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:43,009 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:43,011 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:43,014 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:43,016 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:43,018 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:43,021 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:43,023 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:43,025 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:43,027 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:43,037 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:43,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:43:43,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:43:43,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:43:43,048 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:43,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:43:43,059 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:43,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:43:43,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:43,077 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:43,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:43:43,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:43:43,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:43,087 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:43,087 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:43,088 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:43,088 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:43,088 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:43:43,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:43,088 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:43:43,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:43,090 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:43:43,090 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:43:43,091 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:43:43,092 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:43:43,092 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:43:43,092 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:43:43,092 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:43:43,092 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:43:43,092 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:43:43,093 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:43:43,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:43:43,093 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:43:43,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:43:43,093 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:43,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:43:43,094 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:43,094 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:43,094 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:43,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:43:43,098 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:43:43,098 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:43:43,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:43:43,101 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:43:43,101 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:43,102 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:43,102 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:43,104 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:43,104 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:43,104 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:43,105 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:43,117 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4618, Threshold=0.4850, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:43:43,117 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4618
2025-08-04 20:43:57,405 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:57,405 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:57,405 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:57,405 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:43:57,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:43:57,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:57,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:57,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:57,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:43:57,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:43:57,804 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:57,904 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:57,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:57,917 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:57,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:43:57,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:57,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:43:57,943 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:57,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:57,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:43:57,953 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:57,956 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,958 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:57,960 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:57,963 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:57,965 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:57,968 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,970 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:57,974 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:57,976 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:57,978 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:57,988 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:57,988 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:43:57,993 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:43:57,993 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:43:57,999 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:57,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:43:58,014 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:58,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:43:58,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:58,031 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:58,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:43:58,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:43:58,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:58,042 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:58,042 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:58,042 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:58,042 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:58,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:43:58,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:58,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:43:58,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:58,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:43:58,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:43:58,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:58,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:43:58,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:58,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:43:58,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:43:58,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:43:58,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:43:58,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:43:58,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:43:58,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:43:58,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:58,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:43:58,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:58,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:58,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:58,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:43:58,051 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:43:58,052 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:43:58,052 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:43:58,055 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:43:58,056 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:58,057 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:58,057 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:58,059 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:58,059 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:58,059 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:58,060 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:58,072 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3990, Threshold=0.4041, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:43:58,073 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.3990
2025-08-04 20:44:03,322 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:03,322 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:03,322 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:03,322 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:44:03,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:44:03,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:03,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:03,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:03,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:44:03,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:44:03,663 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:03,752 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:03,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:03,758 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:03,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:44:03,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:03,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:44:03,782 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:03,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:03,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:44:03,791 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:03,793 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:03,795 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:03,798 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:03,800 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:03,802 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:03,805 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:03,807 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:03,810 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:03,812 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:03,814 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:03,824 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:03,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:44:03,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:44:03,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:44:03,835 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:03,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:44:03,846 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:03,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:44:03,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:03,860 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:03,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:44:03,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:44:03,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:03,870 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:03,870 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:03,871 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:03,871 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:03,871 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:44:03,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:03,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:44:03,872 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:03,873 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:44:03,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:44:03,874 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:44:03,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:44:03,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:44:03,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:44:03,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:03,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:44:03,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:03,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:03,877 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:03,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:44:03,881 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:44:03,881 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:44:03,881 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:44:03,884 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:44:03,884 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:03,885 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:03,885 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:03,887 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 100/400.
2025-08-04 20:44:03,988 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:03,988 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:03,989 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:03,990 - ClientAppLogger [Client 8] - INFO - [Client] Round 100: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:44:03,990 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:04,015 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7919
2025-08-04 20:44:04,015 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7919
2025-08-04 20:44:04,019 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:04,029 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4191, Threshold=0.4452, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:44:04,029 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:44:04,030 - ClientAppLogger [Client 8] - INFO - Fit completed for round 100. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 100, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0837017059326173, 'd_loss': 0.7918526947498321, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14309430122375488, 'cpu_percent_fit': 28.15, 'ram_mb_fit': 0.4453125, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:44:04,030 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:44:09,294 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:09,294 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:09,294 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:09,294 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:44:09,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:44:09,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:09,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:09,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:09,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:44:09,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:44:09,695 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:09,786 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:09,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:09,794 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:09,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:44:09,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:09,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:44:09,805 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:09,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:09,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:44:09,814 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:09,816 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:09,819 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:09,821 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:09,823 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:09,825 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:09,828 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:09,831 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:09,833 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:09,835 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:09,837 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:09,846 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:09,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:44:09,851 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:44:09,851 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:44:09,856 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:09,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:44:09,866 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:09,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:44:09,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:09,882 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:09,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:44:09,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:44:09,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:09,892 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:09,892 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:09,892 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:09,892 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:09,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:44:09,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:09,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:44:09,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:09,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:44:09,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:44:09,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:09,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:44:09,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:09,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:09,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:09,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:44:09,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:44:09,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:44:09,897 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:44:09,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:44:09,897 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:44:09,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:09,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:44:09,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:09,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:09,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:09,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:44:09,902 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:44:09,902 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:44:09,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:44:09,904 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:44:09,904 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:09,905 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:09,905 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:09,907 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:09,907 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:09,907 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:09,908 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:09,920 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4222, Threshold=0.4317, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:44:09,920 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4222
2025-08-04 20:44:18,179 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:18,179 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:18,179 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:18,180 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:44:18,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:44:18,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:18,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:18,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:18,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:44:18,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:44:18,506 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:18,599 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:18,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:18,608 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:18,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:44:18,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:18,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:44:18,627 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:18,627 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:18,627 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:44:18,636 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:18,639 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:18,641 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:18,644 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:18,647 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:18,649 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:18,652 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:18,654 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:18,657 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:18,659 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:18,661 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:18,671 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:18,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:44:18,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:44:18,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:44:18,681 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:18,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:44:18,692 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:18,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:44:18,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:18,709 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:18,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:44:18,719 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:44:18,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:18,720 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:18,720 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:18,720 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:18,721 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:18,721 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:44:18,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:18,721 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:44:18,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:18,723 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:44:18,723 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:44:18,723 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:18,723 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:44:18,723 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:44:18,724 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:44:18,725 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:44:18,725 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:44:18,725 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:44:18,725 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:44:18,725 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:44:18,726 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:44:18,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:44:18,726 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:18,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:44:18,726 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:18,727 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:18,727 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:18,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:44:18,731 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:44:18,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:44:18,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:44:18,733 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:44:18,733 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:18,735 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:18,735 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:18,736 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 101/400.
2025-08-04 20:44:18,838 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:18,838 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:18,840 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:18,840 - ClientAppLogger [Client 8] - INFO - [Client] Round 101: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:44:18,840 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:18,870 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7880
2025-08-04 20:44:18,870 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7880
2025-08-04 20:44:18,870 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:18,883 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4191, Threshold=0.4465, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:44:18,883 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:44:18,883 - ClientAppLogger [Client 8] - INFO - Fit completed for round 101. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 101, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0841156959533693, 'd_loss': 0.7880063056945801, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.1467418670654297, 'cpu_percent_fit': 27.4, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:44:18,884 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:44:30,151 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:30,152 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:30,152 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:30,152 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:44:30,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:44:30,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:30,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:30,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:30,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:44:30,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:44:30,521 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:30,636 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:30,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:30,645 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:30,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:44:30,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:30,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:44:30,676 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:30,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:30,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:44:30,686 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:30,689 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:30,691 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:30,694 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:30,696 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:30,698 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:30,701 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:30,704 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:30,706 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:30,708 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:30,710 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:30,721 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:30,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:44:30,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:44:30,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:44:30,734 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:30,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:44:30,745 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:30,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:44:30,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:30,760 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:30,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:44:30,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:44:30,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:30,770 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:30,770 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:30,770 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:30,770 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:30,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:44:30,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:30,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:44:30,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:30,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:44:30,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:44:30,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:44:30,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:44:30,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:44:30,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:44:30,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:44:30,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:44:30,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:44:30,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:44:30,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:44:30,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:44:30,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:30,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:44:30,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:30,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:30,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:30,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:44:30,776 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:44:30,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:44:30,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:44:30,782 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:44:30,782 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:30,783 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:30,783 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:30,785 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:30,785 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:30,785 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:30,786 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:30,797 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4336, Threshold=0.4413, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:44:30,797 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4336
2025-08-04 20:44:48,066 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:48,066 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:48,066 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:48,067 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:44:48,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:44:48,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:48,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:48,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:48,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:44:48,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:44:48,421 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:48,514 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:48,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:48,521 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:48,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:44:48,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:48,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:44:48,552 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:48,552 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:48,552 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:44:48,561 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:48,564 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:48,566 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:48,568 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:48,571 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:48,573 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:48,576 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:48,579 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:48,582 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:48,584 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:48,586 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:48,598 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:48,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:44:48,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:44:48,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:44:48,610 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:48,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:44:48,628 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:48,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:44:48,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:48,646 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:48,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:44:48,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:44:48,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:48,659 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:48,659 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:48,660 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:48,660 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:48,660 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:44:48,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:48,660 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:44:48,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:48,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:44:48,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:44:48,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:44:48,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:44:48,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:44:48,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:44:48,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:44:48,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:44:48,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:44:48,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:44:48,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:44:48,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:44:48,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:44:48,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:48,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:44:48,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:48,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:48,667 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:48,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:44:48,667 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:44:48,667 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:44:48,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:44:48,671 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:44:48,671 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:48,672 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:48,673 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:48,674 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:48,675 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:48,675 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:48,676 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:48,690 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4550, Threshold=0.4680, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:44:48,691 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.4550
2025-08-04 20:44:59,960 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:59,960 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:59,961 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:59,961 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:44:59,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:44:59,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:00,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:00,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:00,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:45:00,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:45:00,309 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:00,399 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:00,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:00,406 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:00,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:45:00,417 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:00,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:45:00,418 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:00,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:00,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:45:00,427 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:00,430 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:00,432 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:00,434 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:00,437 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:00,440 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:00,442 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:00,445 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:00,448 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:00,450 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:00,452 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:00,462 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:00,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:45:00,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:45:00,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:45:00,473 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:00,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:45:00,485 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:00,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:45:00,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:00,502 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:00,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:45:00,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:45:00,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:00,513 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:00,513 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:00,513 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:00,513 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:00,513 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:45:00,514 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:00,514 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:45:00,514 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:00,515 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:45:00,515 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:45:00,515 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:45:00,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:45:00,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:45:00,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:45:00,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:45:00,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:45:00,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:45:00,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:45:00,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:45:00,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:45:00,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:00,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:45:00,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:00,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:00,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:00,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:45:00,523 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:45:00,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:45:00,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:45:00,527 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:45:00,527 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:00,528 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:00,528 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:00,530 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 103/400.
2025-08-04 20:45:00,631 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:00,631 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:00,632 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:45:00,633 - ClientAppLogger [Client 8] - INFO - [Client] Round 103: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:45:00,633 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:00,659 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0793, Avg D Loss: 0.7757
2025-08-04 20:45:00,659 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0793, Avg D Loss: 0.7757
2025-08-04 20:45:00,659 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:00,673 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4374, Threshold=0.4614, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:45:00,673 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:45:00,673 - ClientAppLogger [Client 8] - INFO - Fit completed for round 103. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 103, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0792935609817507, 'd_loss': 0.7757001042366027, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14320683479309082, 'cpu_percent_fit': 28.025, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:45:00,673 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:45:11,963 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:11,963 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:11,963 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:11,963 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:45:11,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:45:11,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:12,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:12,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:12,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:45:12,433 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:45:12,433 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:12,566 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:12,574 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:12,574 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:12,580 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:45:12,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:12,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:45:12,600 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:12,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:12,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:45:12,611 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:12,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,616 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:12,618 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:12,621 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:12,623 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:12,625 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,629 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:12,631 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:12,634 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:12,636 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:12,648 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:12,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:45:12,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:45:12,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:45:12,660 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:12,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:45:12,673 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:12,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:45:12,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:12,689 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:12,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:45:12,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:45:12,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:12,701 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:12,701 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:12,701 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:12,701 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:12,701 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:45:12,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:12,702 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:45:12,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:12,703 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:45:12,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:45:12,704 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:12,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:45:12,704 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:12,704 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:12,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:12,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:45:12,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:45:12,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:45:12,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:45:12,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:45:12,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:45:12,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:45:12,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:45:12,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:45:12,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:45:12,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:45:12,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:45:12,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:12,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:45:12,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:12,712 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:12,712 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:12,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:45:12,712 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:45:12,712 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:45:12,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:45:12,721 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:45:12,722 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:12,723 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:12,723 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:12,725 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:12,725 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:12,725 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:12,726 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:12,738 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4730, Threshold=0.4923, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:45:12,738 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.4730
2025-08-04 20:45:33,021 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:33,021 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:33,021 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:33,021 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:45:33,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:45:33,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:33,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:33,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:33,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:45:33,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:45:33,440 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:33,547 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:33,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:33,556 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:33,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:45:33,574 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:33,575 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:45:33,575 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:33,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:33,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:45:33,585 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:33,587 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,590 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:33,592 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:33,595 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:33,597 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:33,600 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,603 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:33,606 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:33,608 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:33,610 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:33,621 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:33,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:45:33,627 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:45:33,627 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:45:33,634 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:33,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:45:33,648 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:33,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:45:33,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:33,665 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:33,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:45:33,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:45:33,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:33,681 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:33,682 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:33,683 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:33,683 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:33,683 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:45:33,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:33,683 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:45:33,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:33,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:45:33,689 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:33,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:33,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:33,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:45:33,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:45:33,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:45:33,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:45:33,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:45:33,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:45:33,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:45:33,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:45:33,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:45:33,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:45:33,692 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:45:33,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:45:33,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:33,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:45:33,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:33,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:33,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:33,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:45:33,694 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:45:33,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:45:33,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:45:33,697 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:45:33,697 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:33,699 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:33,700 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:33,702 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:33,702 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:33,702 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:33,703 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:33,717 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5063, Threshold=0.5323, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:45:33,717 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5063
2025-08-04 20:45:47,989 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:47,989 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:47,989 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:47,989 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:45:47,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:45:47,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:48,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:48,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:48,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:45:48,311 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:45:48,311 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:48,402 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:48,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:48,409 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:48,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:45:48,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:48,441 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:45:48,441 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:48,441 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:48,441 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:45:48,450 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:48,453 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:48,455 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:48,457 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:48,460 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:48,462 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:48,464 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:48,467 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:48,470 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:48,471 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:48,474 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:48,483 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:48,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:45:48,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:45:48,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:45:48,495 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:48,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:45:48,508 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:48,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:45:48,509 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:48,526 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:48,532 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:45:48,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:45:48,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:48,538 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:48,538 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:48,538 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:48,538 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:48,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:45:48,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:48,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:45:48,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:48,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:45:48,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:45:48,541 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:48,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:45:48,541 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:48,541 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:45:48,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:45:48,543 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:45:48,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:45:48,543 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:45:48,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:45:48,543 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:45:48,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:45:48,544 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:48,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:45:48,544 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:48,545 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:48,545 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:48,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:45:48,545 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:45:48,545 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:45:48,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:45:48,550 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:45:48,550 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:48,551 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:48,552 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:48,553 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:48,553 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:48,554 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:48,554 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:48,567 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5190, Threshold=0.5658, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:45:48,567 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5190
2025-08-04 20:45:59,846 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:59,846 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:59,846 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:59,846 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:45:59,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:45:59,847 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:00,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:00,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:00,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:00,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:00,190 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:00,284 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:00,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:00,291 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:00,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:00,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:00,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:00,309 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:00,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:00,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:00,318 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:00,321 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:00,323 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:00,325 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:00,328 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:00,330 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:00,332 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:00,335 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:00,337 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:00,340 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:00,342 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:00,352 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:00,353 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:00,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:00,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:00,365 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:00,365 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:00,379 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:00,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:00,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:00,395 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:00,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:00,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:00,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:00,405 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:00,405 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:00,406 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:00,406 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:00,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:00,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:00,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:00,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:00,408 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:00,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:00,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:00,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:00,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:00,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:00,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:00,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:00,411 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:00,411 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:00,411 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:00,411 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:00,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:00,412 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:00,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:00,412 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:00,412 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:00,413 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:00,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:00,413 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:00,413 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:00,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:00,415 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:00,416 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:00,417 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:00,417 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:00,419 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:00,419 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:00,419 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:00,420 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:00,432 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4736, Threshold=0.5015, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:46:00,432 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4736
2025-08-04 20:46:05,700 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:05,700 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:05,700 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:05,700 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:05,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:05,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:05,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:05,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:06,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:06,034 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:06,034 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:06,157 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:06,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:06,162 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:06,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:06,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:06,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:06,179 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:06,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:06,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:06,188 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:06,191 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:06,193 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:06,196 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:06,199 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:06,201 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:06,204 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:06,206 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:06,209 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:06,211 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:06,214 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:06,222 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:06,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:06,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:06,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:06,232 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:06,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:06,241 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:06,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:06,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:06,257 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:06,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:06,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:06,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:06,266 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:06,266 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:06,267 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:06,267 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:06,267 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:06,267 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:06,267 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:06,268 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:06,269 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:06,269 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:06,269 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:06,270 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:06,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:06,272 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:06,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:06,272 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:06,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:06,273 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:06,273 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:06,273 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:06,273 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:06,274 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:06,274 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:06,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:06,278 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:06,278 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:06,280 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:06,280 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:06,282 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 107/400.
2025-08-04 20:46:06,383 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:06,383 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:06,384 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:46:06,384 - ClientAppLogger [Client 8] - INFO - [Client] Round 107: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:46:06,384 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:06,410 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0727, Avg D Loss: 0.7605
2025-08-04 20:46:06,411 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0727, Avg D Loss: 0.7605
2025-08-04 20:46:06,411 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:06,423 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4583, Threshold=0.4839, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:46:06,424 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:46:06,424 - ClientAppLogger [Client 8] - INFO - Fit completed for round 107. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 107, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0727452516555784, 'd_loss': 0.7605276942253113, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14241290092468262, 'cpu_percent_fit': 28.625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:46:06,424 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:46:14,693 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:14,694 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:14,694 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:14,694 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:14,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:14,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:14,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:14,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:14,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:15,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:15,011 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:15,107 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:15,114 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:15,114 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:15,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:15,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:15,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:15,136 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:15,136 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:15,136 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:15,145 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:15,148 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:15,150 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:15,152 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:15,155 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:15,157 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:15,160 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:15,162 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:15,165 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:15,167 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:15,169 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:15,179 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:15,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:15,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:15,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:15,189 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:15,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:15,197 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:15,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:15,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:15,213 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:15,217 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:15,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:15,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:15,224 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:15,224 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:15,224 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:15,225 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:15,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:15,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:15,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:15,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:15,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:15,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:15,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:15,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:15,228 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:15,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:15,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:15,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:15,230 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:15,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:15,230 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:15,230 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:15,231 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:15,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:15,235 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:15,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:15,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:15,237 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:15,238 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:15,239 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:15,239 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:15,241 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:15,241 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:15,241 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:15,241 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:15,253 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4801, Threshold=0.5081, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:46:15,253 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4801
2025-08-04 20:46:29,514 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:29,514 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:29,515 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:29,515 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:29,515 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:29,515 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:29,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:29,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:29,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:29,874 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:29,875 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:29,964 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:29,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:29,970 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:29,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:29,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:29,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:29,983 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:29,983 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:29,983 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:29,992 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:29,995 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:29,997 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:29,999 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:30,002 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:30,004 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:30,006 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:30,009 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:30,012 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:30,013 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:30,016 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:30,025 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:30,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:30,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:30,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:30,035 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:30,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:30,047 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:30,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:30,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:30,064 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:30,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:30,074 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:30,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:30,075 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:30,075 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:30,075 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:30,075 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:30,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:30,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:30,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:30,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:30,077 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:30,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:30,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:30,078 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:30,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:30,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:30,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:30,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:30,079 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:30,079 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:30,079 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:30,079 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:30,079 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:30,079 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:30,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:30,080 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:30,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:30,081 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:30,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:30,081 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:30,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:30,081 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:30,082 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:30,082 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:30,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:30,086 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:30,086 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:30,086 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:30,089 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:30,089 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:30,090 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:30,090 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:30,092 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:30,092 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:30,092 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:30,093 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:30,104 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5004, Threshold=0.5350, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:46:30,105 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5004
2025-08-04 20:46:38,360 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:38,360 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:38,360 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:38,360 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:38,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:38,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:38,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:38,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:38,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:38,699 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:38,699 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:38,781 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:38,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:38,788 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:38,796 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:38,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:38,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:38,804 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:38,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:38,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:38,813 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:38,816 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:38,819 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:38,821 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:38,824 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:38,826 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:38,829 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:38,832 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:38,835 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:38,837 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:38,840 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:38,848 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:38,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:38,853 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:38,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:38,858 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:38,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:38,866 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:38,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:38,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:38,880 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:38,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:38,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:38,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:38,889 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:38,889 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:38,889 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:38,890 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:38,890 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:38,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:38,890 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:38,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:38,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:38,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:38,892 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:38,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:38,892 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:38,892 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:38,892 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:38,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:38,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:38,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:38,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:38,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:38,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:38,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:38,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:38,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:38,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:38,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:38,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:38,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:38,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:38,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:38,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:38,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:38,899 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:38,900 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:38,900 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:38,900 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:38,902 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:38,902 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:38,903 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:38,904 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:38,905 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 109/400.
2025-08-04 20:46:39,006 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:39,007 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:39,008 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:46:39,008 - ClientAppLogger [Client 8] - INFO - [Client] Round 109: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:46:39,008 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:39,033 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0730, Avg D Loss: 0.7599
2025-08-04 20:46:39,033 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0730, Avg D Loss: 0.7599
2025-08-04 20:46:39,036 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:39,047 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4643, Threshold=0.4914, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:46:39,048 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:46:39,048 - ClientAppLogger [Client 8] - INFO - Fit completed for round 109. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 109, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0730465412139893, 'd_loss': 0.7598598062992096, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14258456230163574, 'cpu_percent_fit': 28.725, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:46:39,048 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:46:44,295 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:44,295 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:44,295 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:44,295 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:44,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:44,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:44,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:44,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:44,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:44,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:44,616 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:44,710 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:44,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:44,717 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:44,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:44,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:44,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:44,729 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:44,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:44,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:44,737 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:44,740 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:44,743 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:44,745 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:44,747 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:44,749 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:44,752 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:44,754 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:44,757 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:44,759 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:44,761 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:44,769 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:44,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:44,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:44,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:44,779 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:44,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:44,789 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:44,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:44,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:44,808 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:44,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:44,818 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:44,818 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:44,818 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:44,819 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:44,819 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:44,819 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:44,819 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:44,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:44,820 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:44,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:44,821 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:44,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:44,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:44,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:44,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:44,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:44,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:44,823 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:44,823 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:44,823 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:44,823 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:44,823 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:44,823 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:44,824 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:44,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:44,824 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:44,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:44,824 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:44,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:44,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:44,825 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:44,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:44,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:44,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:44,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:44,829 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:44,829 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:44,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:44,831 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:44,831 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:44,832 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:44,832 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:44,834 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:44,834 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:44,834 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:44,835 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:44,846 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4831, Threshold=0.5124, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:46:44,846 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4831
2025-08-04 20:46:50,102 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:50,102 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:50,102 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:50,103 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:50,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:50,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:50,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:50,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:50,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:50,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:50,414 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:50,494 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:50,498 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:50,499 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:50,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:50,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:50,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:50,512 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:50,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:50,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:50,521 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:50,524 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:50,526 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:50,528 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:50,531 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:50,533 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:50,535 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:50,538 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:50,541 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:50,542 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:50,544 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:50,553 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:50,553 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:50,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:50,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:50,563 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:50,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:50,572 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:50,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:50,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:50,587 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:50,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:50,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:50,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:50,597 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:50,597 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:50,597 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:50,597 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:50,597 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:50,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:50,598 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:50,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:50,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:50,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:50,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:50,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:50,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:50,602 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:50,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:50,602 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:50,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:50,602 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:50,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:50,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:50,606 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:50,607 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:50,607 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:50,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:50,610 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:50,611 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:50,612 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:50,613 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:50,615 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 110/400.
2025-08-04 20:46:50,715 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:50,716 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:50,717 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:46:50,717 - ClientAppLogger [Client 8] - INFO - [Client] Round 110: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:46:50,717 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:50,743 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0736, Avg D Loss: 0.7596
2025-08-04 20:46:50,743 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0736, Avg D Loss: 0.7596
2025-08-04 20:46:50,745 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:50,757 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4611, Threshold=0.4937, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:46:50,757 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:46:50,757 - ClientAppLogger [Client 8] - INFO - Fit completed for round 110. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 110, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0736294269561766, 'd_loss': 0.7595597982406617, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14219236373901367, 'cpu_percent_fit': 28.625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:46:50,757 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:46:59,018 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:59,018 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:59,018 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:59,019 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:46:59,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:46:59,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:59,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:59,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:59,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:46:59,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:46:59,377 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:59,474 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:59,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:59,483 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:59,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:46:59,499 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:59,499 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:46:59,499 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:59,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:59,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:46:59,509 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:59,512 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:59,515 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:59,517 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:59,519 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:59,522 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:59,524 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:59,527 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:59,529 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:59,532 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:59,534 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:59,543 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:59,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:46:59,548 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:46:59,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:46:59,554 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:59,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:46:59,564 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:59,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:46:59,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:59,580 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:59,585 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:46:59,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:46:59,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:59,591 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:59,592 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:59,592 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:59,592 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:59,593 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:46:59,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:59,593 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:46:59,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:59,595 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:46:59,595 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:46:59,595 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:59,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:46:59,596 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:59,596 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:59,596 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:59,596 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:46:59,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:46:59,597 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:46:59,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:46:59,597 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:46:59,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:46:59,598 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:46:59,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:46:59,598 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:46:59,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:46:59,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:46:59,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:46:59,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:59,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:46:59,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:59,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:59,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:59,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:46:59,600 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:46:59,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:46:59,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:46:59,603 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:46:59,603 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:59,604 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:59,604 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:59,606 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:59,606 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:59,606 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:59,607 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:59,619 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5230, Threshold=0.5608, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:46:59,619 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5230
2025-08-04 20:47:13,885 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:13,885 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:13,885 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:13,885 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:47:13,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:47:13,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:14,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:14,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:14,248 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:47:14,270 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:47:14,270 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:14,365 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:14,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:14,374 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:14,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:47:14,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:14,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:47:14,391 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:14,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:14,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:47:14,399 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:14,403 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:14,405 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:14,407 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:14,410 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:14,412 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:14,415 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:14,417 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:14,420 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:14,422 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:14,424 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:14,435 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:14,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:47:14,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:47:14,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:47:14,445 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:14,491 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:47:14,502 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:14,503 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:47:14,503 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:14,524 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:14,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:47:14,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:47:14,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:14,536 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:14,536 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:14,537 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:14,537 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:14,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:47:14,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:14,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:47:14,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:14,541 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:47:14,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:47:14,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:14,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:47:14,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:14,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:14,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:14,543 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:47:14,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:47:14,543 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:47:14,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:47:14,543 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:47:14,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:47:14,544 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:47:14,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:47:14,544 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:47:14,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:47:14,545 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:47:14,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:47:14,546 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:14,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:47:14,546 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:14,546 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:14,547 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:14,547 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:47:14,547 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:47:14,547 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:47:14,547 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:47:14,550 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:47:14,550 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:14,553 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:14,553 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:14,554 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:14,554 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:14,554 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:14,555 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:14,567 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4933, Threshold=0.5260, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:47:14,567 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4933
2025-08-04 20:47:31,838 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:31,839 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:31,839 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:31,839 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:47:31,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:47:31,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:32,109 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:32,109 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:32,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:47:32,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:47:32,208 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:32,306 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:32,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:32,313 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:32,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:47:32,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:32,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:47:32,327 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:32,327 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:32,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:47:32,337 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:32,341 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:32,343 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:32,346 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:32,349 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:32,351 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:32,354 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:32,357 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:32,360 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:32,363 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:32,365 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:32,375 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:32,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:47:32,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:47:32,383 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:47:32,390 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:32,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:47:32,408 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:32,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:47:32,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:32,430 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:32,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:47:32,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:47:32,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:32,442 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:32,442 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:32,443 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:32,443 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:32,443 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:47:32,443 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:32,443 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:47:32,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:32,445 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:47:32,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:47:32,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:32,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:47:32,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:32,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:32,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:32,446 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:47:32,447 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:47:32,448 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:47:32,448 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:47:32,448 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:47:32,448 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:47:32,449 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:32,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:47:32,449 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:32,449 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:32,450 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:32,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:47:32,450 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:47:32,450 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:47:32,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:47:32,452 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:47:32,452 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:32,454 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:32,454 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:32,455 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:32,455 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:32,456 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:32,456 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:32,468 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4613, Threshold=0.4794, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:47:32,468 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4613
2025-08-04 20:47:43,730 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:43,731 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:43,731 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:43,731 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:47:43,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:47:43,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:43,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:43,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:44,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:47:44,079 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:47:44,079 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:44,173 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:44,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:44,181 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:44,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:47:44,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:44,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:47:44,197 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:44,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:44,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:47:44,207 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:44,209 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:44,211 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:44,214 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:44,216 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:44,219 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:44,221 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:44,224 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:44,227 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:44,229 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:44,231 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:44,240 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:44,241 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:47:44,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:47:44,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:47:44,252 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:44,252 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:47:44,265 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:44,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:47:44,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:44,282 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:44,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:47:44,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:47:44,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:44,297 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:44,297 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:44,298 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:44,298 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:44,298 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:47:44,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:44,300 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:47:44,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:44,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:47:44,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:47:44,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:44,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:47:44,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:44,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:44,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:44,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:47:44,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:47:44,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:47:44,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:47:44,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:47:44,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:47:44,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:47:44,307 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:47:44,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:47:44,307 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:47:44,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:47:44,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:47:44,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:44,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:47:44,310 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:44,310 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:44,311 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:44,311 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:47:44,311 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:47:44,312 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:47:44,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:47:44,316 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:47:44,316 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:44,318 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:44,318 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:44,320 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:44,320 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:44,320 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:44,321 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:44,334 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5061, Threshold=0.5477, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:47:44,334 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5061
2025-08-04 20:48:01,608 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:01,608 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:01,608 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:01,608 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:01,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:01,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:01,881 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:01,881 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:01,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:01,984 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:01,984 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:02,076 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:02,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:02,082 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:02,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:02,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:02,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:02,096 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:02,096 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:02,096 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:02,104 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:02,107 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:02,109 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:02,111 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:02,114 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:02,116 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:02,118 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:02,121 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:02,124 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:02,128 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:02,130 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:02,140 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:02,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:02,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:02,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:02,151 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:02,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:02,162 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:02,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:02,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:02,177 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:02,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:02,186 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:02,186 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:02,186 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:02,186 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:02,187 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:02,187 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:02,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:02,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:02,188 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:02,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:02,189 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:02,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:02,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:02,191 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:02,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:02,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:02,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:02,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:02,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:02,192 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:02,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:02,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:02,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:02,193 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:02,193 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:02,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:02,196 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:02,196 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:02,198 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:02,198 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:02,200 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:02,200 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:02,200 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:02,201 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:02,212 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5378, Threshold=0.5858, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:48:02,212 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5378
2025-08-04 20:48:07,469 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:07,470 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:07,470 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:07,470 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:07,470 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:07,471 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:07,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:07,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:07,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:07,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:07,837 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:07,934 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:07,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:07,944 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:07,950 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:07,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:07,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:07,958 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:07,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:07,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:07,967 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:07,969 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:07,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:07,974 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:07,976 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:07,979 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:07,981 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:07,984 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:07,987 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:07,989 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:07,991 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:08,001 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:08,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:08,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:08,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:08,012 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:08,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:08,024 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:08,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:08,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:08,042 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:08,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:08,052 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:08,053 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:08,053 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:08,054 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:08,054 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:08,054 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:08,055 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:08,055 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:08,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:08,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:08,058 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:08,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:08,058 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:08,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:08,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:08,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:08,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:08,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:08,059 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:08,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:08,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:08,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:08,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:08,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:08,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:08,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:08,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:08,061 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:08,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:08,061 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:08,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:08,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:08,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:08,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:08,062 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:08,062 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:08,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:08,063 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:08,065 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:08,066 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:08,067 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:08,067 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:08,068 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 115/400.
2025-08-04 20:48:08,169 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:08,169 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:08,172 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:08,172 - ClientAppLogger [Client 8] - INFO - [Client] Round 115: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:48:08,172 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:08,202 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0807, Avg D Loss: 0.7760
2025-08-04 20:48:08,202 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0807, Avg D Loss: 0.7760
2025-08-04 20:48:08,202 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:08,215 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4729, Threshold=0.5064, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:48:08,215 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:48:08,216 - ClientAppLogger [Client 8] - INFO - Fit completed for round 115. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 115, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080703616142273, 'd_loss': 0.7760209739208221, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14754891395568848, 'cpu_percent_fit': 27.88125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:48:08,216 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:48:13,468 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:13,468 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:13,469 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:13,469 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:13,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:13,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:13,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:13,723 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:13,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:13,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:13,826 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:13,919 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:13,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:13,926 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:13,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:13,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:13,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:13,950 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:13,950 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:13,950 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:13,959 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:13,962 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:13,964 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:13,966 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:13,969 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:13,971 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:13,973 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:13,976 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:13,978 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:13,980 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:13,982 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:13,995 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:13,995 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:14,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:14,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:14,005 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:14,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:14,013 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:14,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:14,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:14,029 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:14,034 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:14,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:14,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:14,039 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:14,039 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:14,039 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:14,040 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:14,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:14,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:14,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:14,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:14,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:14,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:14,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:14,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:14,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:14,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:14,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:14,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:14,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:14,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:14,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:14,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:14,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:14,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:14,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:14,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:14,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:14,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:14,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:14,046 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:14,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:14,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:14,048 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:14,048 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:14,050 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:14,050 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:14,051 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:14,051 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:14,051 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:14,052 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:14,063 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5714, Threshold=0.6220, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:48:14,063 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5714
2025-08-04 20:48:22,313 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:22,313 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:22,313 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:22,314 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:22,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:22,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:22,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:22,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:22,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:22,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:22,628 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:22,706 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:22,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:22,712 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:22,716 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:22,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:22,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:22,722 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:22,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:22,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:22,730 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:22,733 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:22,735 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:22,737 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:22,739 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:22,741 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:22,744 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:22,746 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:22,749 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:22,751 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:22,753 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:22,761 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:22,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:22,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:22,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:22,771 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:22,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:22,782 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:22,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:22,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:22,799 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:22,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:22,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:22,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:22,809 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:22,809 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:22,809 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:22,809 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:22,809 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:22,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:22,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:22,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:22,811 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:22,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:22,811 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:22,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:22,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:22,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:22,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:22,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:22,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:22,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:22,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:22,815 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:22,815 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:22,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:22,817 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:22,817 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:22,818 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:22,819 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:22,820 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 116/400.
2025-08-04 20:48:22,921 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:22,921 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:22,922 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:22,922 - ClientAppLogger [Client 8] - INFO - [Client] Round 116: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:48:22,922 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:22,948 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0719, Avg D Loss: 0.7800
2025-08-04 20:48:22,948 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0719, Avg D Loss: 0.7800
2025-08-04 20:48:22,948 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:22,959 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4697, Threshold=0.5006, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:48:22,959 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:48:22,960 - ClientAppLogger [Client 8] - INFO - Fit completed for round 116. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 116, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.071896505355835, 'd_loss': 0.7799897491931915, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.13957595825195312, 'cpu_percent_fit': 28.95625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:48:22,960 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:48:28,243 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:28,243 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:28,244 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:28,244 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:28,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:28,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:28,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:28,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:28,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:28,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:28,651 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:28,744 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:28,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:28,750 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:28,755 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:28,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:28,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:28,763 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:28,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:28,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:28,772 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:28,775 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,777 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:28,779 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:28,782 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:28,784 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:28,786 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,789 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:28,791 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:28,793 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:28,795 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:28,804 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:28,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:28,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:28,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:28,815 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:28,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:28,826 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:28,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:28,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:28,840 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:28,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:28,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:28,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:28,849 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:28,849 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:28,850 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:28,850 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:28,850 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:28,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:28,850 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:28,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:28,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:28,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:28,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:28,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:28,852 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:28,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:28,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:28,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:28,853 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:28,853 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:28,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:28,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:28,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:28,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:28,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:28,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:28,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:28,855 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:28,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:28,855 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:28,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:28,856 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:28,856 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:28,856 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:28,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:28,856 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:28,857 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:28,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:28,860 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:28,860 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:28,861 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:28,861 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:28,863 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:28,863 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:28,863 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:28,864 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:28,875 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4799, Threshold=0.5167, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:48:28,875 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4799
2025-08-04 20:48:43,153 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:43,153 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:43,153 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:43,153 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:43,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:43,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:43,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:43,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:43,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:43,509 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:43,510 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:43,601 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:43,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:43,610 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:43,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:43,624 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:43,624 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:43,625 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:43,625 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:43,625 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:43,634 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:43,637 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,639 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:43,642 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:43,644 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:43,646 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:43,649 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,652 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:43,655 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:43,657 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:43,659 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:43,669 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:43,669 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:43,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:43,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:43,680 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:43,680 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:43,692 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:43,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:43,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:43,708 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:43,715 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:43,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:43,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:43,724 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:43,724 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:43,725 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:43,725 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:43,725 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:43,725 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:43,726 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:43,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:43,727 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:43,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:43,728 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:43,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:43,728 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:43,728 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:43,728 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:43,729 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:43,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:43,730 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:43,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:43,730 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:43,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:43,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:43,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:43,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:43,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:43,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:43,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:43,732 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:43,732 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:43,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:43,734 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:43,734 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:43,736 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:43,736 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:43,737 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:43,737 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:43,738 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:43,738 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:43,750 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5007, Threshold=0.5367, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:48:43,750 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5007
2025-08-04 20:48:55,018 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:55,019 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:55,019 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:55,019 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:48:55,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:48:55,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:55,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:55,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:55,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:48:55,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:48:55,401 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:55,498 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:55,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:55,505 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:55,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:48:55,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:55,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:48:55,522 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:55,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:55,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:48:55,531 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:55,534 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,536 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:55,538 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:55,541 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:55,543 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:55,546 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,548 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:55,551 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:55,553 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:55,555 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:55,565 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:55,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:48:55,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:48:55,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:48:55,576 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:55,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:48:55,587 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:55,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:48:55,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:55,602 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:55,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:48:55,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:48:55,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:55,611 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:55,612 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:55,612 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:55,612 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:55,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:48:55,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:55,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:48:55,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:55,614 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:48:55,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:48:55,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:55,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:48:55,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:48:55,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:48:55,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:48:55,617 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:48:55,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:48:55,617 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:48:55,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:55,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:55,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:48:55,619 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:48:55,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:48:55,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:48:55,622 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:48:55,622 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:55,624 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:55,624 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:55,626 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:55,626 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:55,626 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:55,627 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:55,639 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5312, Threshold=0.5774, Accuracy=0.7221, F1=0.8082, Precision=0.9793, Recall=0.6880
2025-08-04 20:48:55,639 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7221, F1: 0.8082, Prec: 0.9793, Rec: 0.6880, Avg Anomaly Score: 0.5312
2025-08-04 20:49:06,904 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:06,904 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:06,904 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:06,905 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:49:06,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:49:06,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:07,206 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:07,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:07,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:49:07,311 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:49:07,311 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:07,410 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:07,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:07,420 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:07,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:49:07,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:07,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:49:07,474 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:07,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:07,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:49:07,484 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:07,487 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,489 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:07,492 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:07,495 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:07,498 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:07,501 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,504 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:07,506 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:07,508 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:07,510 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:07,521 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:07,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:49:07,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:49:07,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:49:07,533 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:07,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:49:07,550 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:07,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:49:07,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:07,567 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:07,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:49:07,578 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:49:07,581 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:07,581 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:07,581 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:07,581 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:07,582 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:07,582 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:49:07,582 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:07,583 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:49:07,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:07,584 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:49:07,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:49:07,587 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:07,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:49:07,587 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:07,588 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:07,588 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:07,588 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:49:07,588 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:49:07,588 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:49:07,588 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:49:07,589 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:49:07,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:49:07,589 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:49:07,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:49:07,589 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:49:07,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:49:07,590 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:49:07,590 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:49:07,590 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:07,590 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:49:07,591 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:07,593 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:07,593 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:07,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:49:07,593 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:49:07,593 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:49:07,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:49:07,602 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:49:07,603 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:07,605 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:07,605 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:07,607 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:07,609 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:07,609 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:07,610 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:07,623 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5107, Threshold=0.5517, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:49:07,625 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5107
2025-08-04 20:49:24,920 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:24,920 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:24,920 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:24,920 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:49:24,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:49:24,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:25,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:25,209 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:25,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:49:25,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:49:25,317 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:25,439 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:25,452 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:25,452 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:25,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:49:25,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:25,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:49:25,489 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:25,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:25,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:49:25,499 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:25,502 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,505 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:25,507 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:25,509 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:25,512 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:25,514 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,517 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:25,520 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:25,522 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:25,524 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:25,535 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:25,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:49:25,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:49:25,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:49:25,548 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:25,548 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:49:25,565 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:25,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:49:25,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:25,584 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:25,590 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:49:25,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:49:25,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:25,598 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:25,598 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:25,599 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:25,599 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:25,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:49:25,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:25,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:49:25,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:25,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:49:25,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:49:25,602 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:25,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:49:25,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:49:25,604 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:49:25,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:49:25,604 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:49:25,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:49:25,604 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:49:25,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:49:25,605 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:49:25,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:49:25,605 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:25,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:49:25,606 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:25,606 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:25,606 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:25,606 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:49:25,606 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:49:25,607 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:49:25,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:49:25,611 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:49:25,611 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:25,613 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:25,613 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:25,615 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:25,615 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:25,615 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:25,616 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:25,628 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5288, Threshold=0.5693, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:49:25,628 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5288
2025-08-04 20:49:30,883 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:30,883 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:30,883 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:30,883 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:49:30,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:49:30,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:31,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:31,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:31,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:49:31,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:49:31,195 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:31,278 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:31,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:31,284 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:31,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:49:31,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:31,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:49:31,296 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:31,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:31,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:49:31,305 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:31,308 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:31,310 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:31,312 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:31,315 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:31,317 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:31,320 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:31,322 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:31,324 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:31,326 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:31,328 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:31,337 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:31,338 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:49:31,343 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:49:31,343 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:49:31,349 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:31,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:49:31,361 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:31,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:49:31,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:31,377 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:31,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:49:31,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:49:31,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:31,386 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:31,386 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:31,387 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:31,387 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:31,387 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:49:31,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:31,388 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:49:31,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:31,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:49:31,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:49:31,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:49:31,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:49:31,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:49:31,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:49:31,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:49:31,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:49:31,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:49:31,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:49:31,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:49:31,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:49:31,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:31,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:49:31,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:31,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:31,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:31,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:49:31,393 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:49:31,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:49:31,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:49:31,396 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:49:31,396 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:31,398 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:31,398 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:31,399 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 121/400.
2025-08-04 20:49:31,500 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:31,500 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:31,502 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:49:31,502 - ClientAppLogger [Client 8] - INFO - [Client] Round 121: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:49:31,502 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:31,528 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0784, Avg D Loss: 0.7722
2025-08-04 20:49:31,528 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0784, Avg D Loss: 0.7722
2025-08-04 20:49:31,529 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:31,541 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4680, Threshold=0.4848, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:49:31,541 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:49:31,541 - ClientAppLogger [Client 8] - INFO - Fit completed for round 121. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 121, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.078428864479065, 'd_loss': 0.7721770584583283, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14202141761779785, 'cpu_percent_fit': 28.7625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:49:31,542 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:49:36,811 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:36,812 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:36,812 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:36,812 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:49:36,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:49:36,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:37,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:37,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:37,130 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:49:37,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:49:37,152 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:37,247 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:37,255 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:37,255 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:37,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:49:37,270 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:37,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:49:37,272 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:37,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:37,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:49:37,282 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:37,285 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,288 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:37,290 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:37,293 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:37,295 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:37,298 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,301 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:37,303 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:37,305 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:37,308 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:37,318 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:37,318 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:49:37,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:49:37,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:49:37,333 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:37,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:49:37,351 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:37,352 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:49:37,352 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:37,368 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:37,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:49:37,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:49:37,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:37,378 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:37,378 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:37,378 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:37,378 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:37,379 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:49:37,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:37,379 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:49:37,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:37,381 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:49:37,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:49:37,381 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:37,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:49:37,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:49:37,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:49:37,383 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:49:37,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:49:37,383 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:49:37,383 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:49:37,383 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:49:37,384 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:49:37,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:49:37,384 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:37,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:49:37,384 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:37,385 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:37,385 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:37,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:49:37,385 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:49:37,386 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:49:37,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:49:37,390 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:49:37,390 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:37,392 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:37,392 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:37,394 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:37,394 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:37,394 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:37,395 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:37,407 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4690, Threshold=0.4888, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:49:37,407 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4690
2025-08-04 20:49:42,652 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:42,652 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:42,652 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:42,652 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:49:42,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:49:42,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:42,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:42,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:42,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:49:42,960 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:49:42,960 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:43,056 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:43,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:43,064 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:43,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:49:43,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:43,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:49:43,083 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:43,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:43,084 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:49:43,092 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:43,095 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:43,097 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:43,099 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:43,102 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:43,104 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:43,106 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:43,108 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:43,111 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:43,113 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:43,115 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:43,125 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:43,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:49:43,130 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:49:43,130 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:49:43,135 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:43,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:49:43,143 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:43,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:49:43,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:43,159 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:43,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:49:43,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:49:43,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:43,168 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:43,169 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:43,169 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:43,169 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:43,169 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:49:43,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:43,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:49:43,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:43,171 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:49:43,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:49:43,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:43,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:49:43,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:43,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:43,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:43,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:49:43,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:49:43,174 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:49:43,174 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:49:43,174 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:49:43,174 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:49:43,174 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:43,174 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:49:43,175 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:43,175 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:43,175 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:43,175 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:49:43,175 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:49:43,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:49:43,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:49:43,178 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:49:43,178 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:43,179 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:43,179 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:43,181 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 122/400.
2025-08-04 20:49:43,282 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:43,282 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:43,284 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:49:43,284 - ClientAppLogger [Client 8] - INFO - [Client] Round 122: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:49:43,284 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:43,311 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0776, Avg D Loss: 0.7858
2025-08-04 20:49:43,311 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0776, Avg D Loss: 0.7858
2025-08-04 20:49:43,311 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:43,323 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4958, Threshold=0.5334, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:49:43,323 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:49:43,323 - ClientAppLogger [Client 8] - INFO - Fit completed for round 122. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 122, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0776362657546996, 'd_loss': 0.7858302533626557, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14194250106811523, 'cpu_percent_fit': 28.74375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:49:43,323 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:49:48,583 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:48,583 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:48,583 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:48,583 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:49:48,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:49:48,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:48,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:48,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:48,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:49:48,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:49:48,890 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:48,983 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:48,990 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:48,990 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:48,994 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:49:49,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:49,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:49:49,003 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:49,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:49,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:49:49,011 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:49,014 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:49,017 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:49,019 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:49,021 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:49,023 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:49,026 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:49,028 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:49,031 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:49,032 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:49,035 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:49,045 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:49,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:49:49,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:49:49,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:49:49,056 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:49,056 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:49:49,068 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:49,068 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:49:49,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:49,083 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:49,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:49:49,092 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:49:49,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:49,093 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:49,093 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:49,093 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:49,093 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:49,094 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:49:49,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:49,094 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:49:49,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:49,096 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:49,097 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:49:49,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:49:49,097 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:49:49,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:49:49,097 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:49:49,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:49:49,098 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:49:49,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:49:49,098 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:49:49,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:49:49,098 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:49:49,099 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:49:49,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:49,099 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:49:49,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:49,099 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:49,100 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:49,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:49:49,100 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:49:49,100 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:49:49,100 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:49:49,102 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:49:49,102 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:49,104 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:49,104 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:49,105 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:49,105 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:49,106 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:49,106 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:49,118 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5403, Threshold=0.5951, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:49:49,118 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5403
2025-08-04 20:50:03,404 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:03,404 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:03,404 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:03,404 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:50:03,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:50:03,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:03,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:03,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:03,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:50:03,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:50:03,792 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:03,888 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:03,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:03,895 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:03,901 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:50:03,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:03,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:50:03,911 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:03,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:03,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:50:03,921 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:03,924 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,926 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:03,928 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:03,931 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:03,933 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:03,936 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,938 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:03,941 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:03,943 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:03,945 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:03,955 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:03,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:50:03,960 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:50:03,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:50:03,967 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:03,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:50:03,981 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:03,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:50:03,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:03,997 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:04,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:50:04,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:50:04,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:04,006 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:04,006 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:04,006 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:04,006 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:04,007 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:50:04,007 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:04,007 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:50:04,007 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:04,008 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:50:04,008 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:50:04,009 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:50:04,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:50:04,010 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:50:04,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:50:04,010 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:50:04,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:50:04,010 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:50:04,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:50:04,011 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:50:04,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:50:04,011 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:04,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:50:04,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:04,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:04,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:04,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:50:04,013 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:50:04,013 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:50:04,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:50:04,016 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:50:04,017 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:04,018 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:04,018 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:04,020 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:04,020 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:04,020 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:04,021 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:04,034 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5569, Threshold=0.6140, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:50:04,034 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5569
2025-08-04 20:50:18,332 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:18,332 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:18,333 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:18,333 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:50:18,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:50:18,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:18,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:18,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:18,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:50:18,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:50:18,747 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:18,842 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:18,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:18,849 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:18,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:50:18,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:18,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:50:18,868 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:18,868 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:18,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:50:18,878 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:18,881 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,883 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:18,885 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:18,888 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:18,890 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:18,892 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,895 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:18,897 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:18,899 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:18,901 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:18,911 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:18,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:50:18,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:50:18,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:50:18,922 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:18,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:50:18,934 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:18,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:50:18,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:18,949 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:18,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:50:18,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:50:18,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:18,959 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:18,959 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:18,960 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:18,960 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:18,960 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:50:18,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:18,961 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:50:18,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:18,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:50:18,962 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:50:18,963 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:18,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:50:18,963 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:18,963 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:18,963 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:50:18,964 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:50:18,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:50:18,965 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:50:18,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:50:18,965 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:50:18,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:50:18,966 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:18,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:50:18,966 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:18,966 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:18,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:18,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:50:18,967 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:50:18,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:50:18,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:50:18,970 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:50:18,970 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:18,971 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:18,972 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:18,973 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:18,973 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:18,973 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:18,974 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:18,990 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5364, Threshold=0.5899, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:50:18,990 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5364
2025-08-04 20:50:36,274 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:36,274 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:36,274 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:36,275 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:50:36,275 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:50:36,275 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:36,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:36,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:36,606 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:50:36,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:50:36,619 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:36,707 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:36,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:36,714 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:36,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:50:36,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:36,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:50:36,729 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:36,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:36,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:50:36,738 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:36,741 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:36,743 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:36,745 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:36,748 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:36,750 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:36,753 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:36,755 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:36,758 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:36,761 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:36,764 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:36,774 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:36,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:50:36,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:50:36,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:50:36,783 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:36,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:50:36,792 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:36,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:50:36,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:36,806 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:36,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:50:36,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:50:36,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:36,816 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:36,816 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:36,816 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:36,816 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:36,817 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:50:36,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:36,817 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:50:36,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:36,818 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:50:36,818 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:50:36,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:50:36,820 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:50:36,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:50:36,820 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:50:36,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:50:36,820 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:50:36,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:50:36,821 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:50:36,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:50:36,821 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:50:36,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:50:36,821 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:36,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:50:36,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:36,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:36,822 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:36,823 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:50:36,823 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:50:36,823 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:50:36,823 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:50:36,825 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:50:36,825 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:36,826 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:36,826 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:36,828 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:36,828 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:36,828 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:36,829 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:36,842 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5428, Threshold=0.5923, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:50:36,842 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5428
2025-08-04 20:50:48,145 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:48,146 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:48,146 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:48,146 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:50:48,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:50:48,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:48,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:48,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:48,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:50:48,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:50:48,500 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:48,595 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:48,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:48,603 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:48,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:50:48,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:48,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:50:48,615 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:48,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:48,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:50:48,624 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:48,627 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,629 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:48,631 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:48,635 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:48,637 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:48,640 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,643 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:48,646 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:48,647 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:48,650 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:48,659 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:48,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:50:48,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:50:48,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:50:48,670 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:48,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:50:48,681 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:48,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:50:48,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:48,696 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:48,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:50:48,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:50:48,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:48,706 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:48,706 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:48,706 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:48,706 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:48,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:50:48,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:48,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:50:48,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:48,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:50:48,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:50:48,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:48,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:50:48,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:48,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:48,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:48,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:50:48,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:50:48,711 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:48,712 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:48,712 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:48,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:50:48,712 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:50:48,712 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:50:48,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:50:48,716 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:50:48,716 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:48,718 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:48,718 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:48,720 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:48,720 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:48,720 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:48,720 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:48,733 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5337, Threshold=0.5899, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:50:48,733 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5337
2025-08-04 20:50:56,995 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:56,995 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:56,995 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:56,995 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:50:56,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:50:56,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:57,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:57,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:57,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:50:57,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:50:57,335 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:57,420 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:57,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:57,425 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:57,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:50:57,438 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:57,439 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:50:57,439 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:57,439 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:57,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:50:57,448 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:57,451 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:57,453 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:57,455 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:57,458 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:57,461 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:57,464 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:57,466 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:57,469 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:57,471 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:57,474 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:57,483 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:57,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:50:57,487 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:50:57,487 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:50:57,493 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:57,493 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:50:57,504 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:57,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:50:57,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:57,519 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:57,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:50:57,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:50:57,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:57,528 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:57,529 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:57,529 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:57,529 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:57,529 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:50:57,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:57,530 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:50:57,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:57,531 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:50:57,531 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:50:57,532 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:57,532 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:50:57,532 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:57,532 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:57,532 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:57,532 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:50:57,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:50:57,533 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:50:57,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:50:57,533 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:50:57,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:50:57,533 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:50:57,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:50:57,534 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:50:57,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:50:57,534 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:50:57,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:50:57,535 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:57,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:50:57,535 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:57,535 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:57,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:57,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:50:57,536 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:50:57,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:50:57,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:50:57,539 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:50:57,539 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:57,541 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:57,541 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:57,542 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 127/400.
2025-08-04 20:50:57,643 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:57,644 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:57,645 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:50:57,645 - ClientAppLogger [Client 8] - INFO - [Client] Round 127: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:50:57,645 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:57,671 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7837
2025-08-04 20:50:57,671 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7837
2025-08-04 20:50:57,671 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:57,683 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4970, Threshold=0.5335, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:50:57,683 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:50:57,683 - ClientAppLogger [Client 8] - INFO - Fit completed for round 127. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 127, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0846998929977416, 'd_loss': 0.7836677193641662, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.1411426067352295, 'cpu_percent_fit': 28.175, 'ram_mb_fit': 2.8984375, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:50:57,684 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:51:05,970 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:05,971 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:05,971 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:05,971 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:51:05,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:51:05,972 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:06,354 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:06,354 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:06,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:51:06,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:51:06,472 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:06,564 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:06,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:06,570 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:06,575 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:51:06,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:06,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:51:06,584 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:06,585 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:06,585 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:51:06,594 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:06,597 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,599 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:06,601 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:06,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:06,606 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:06,609 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,611 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:06,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:06,616 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:06,618 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:06,628 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:06,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:51:06,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:51:06,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:51:06,640 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:06,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:51:06,654 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:06,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:51:06,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:06,671 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:06,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:51:06,680 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:51:06,680 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:06,681 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:06,681 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:06,681 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:06,681 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:06,682 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:51:06,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:06,682 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:51:06,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:06,684 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:51:06,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:51:06,684 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:06,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:51:06,684 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:51:06,685 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:51:06,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:51:06,686 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:51:06,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:51:06,686 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:51:06,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:51:06,687 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:51:06,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:51:06,687 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:06,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:51:06,688 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:06,688 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:06,688 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:06,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:51:06,689 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:51:06,689 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:51:06,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:51:06,692 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:51:06,692 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:06,694 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:06,694 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:06,695 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:06,696 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:06,696 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:06,696 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:06,710 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5363, Threshold=0.5916, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:51:06,710 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5363
2025-08-04 20:51:20,980 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:20,980 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:20,980 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:20,980 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:51:20,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:51:20,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:21,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:21,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:21,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:51:21,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:51:21,450 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:21,556 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:21,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:21,563 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:21,569 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:51:21,579 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:21,579 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:51:21,580 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:21,580 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:21,580 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:51:21,590 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:21,596 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,602 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:21,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:21,608 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:21,611 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:21,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,616 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:21,619 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:21,622 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:21,625 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:21,635 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:21,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:51:21,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:51:21,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:51:21,650 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:21,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:51:21,663 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:21,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:51:21,668 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:21,685 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:21,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:51:21,698 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:51:21,699 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:21,699 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:21,699 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:21,699 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:21,699 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:21,699 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:51:21,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:21,700 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:51:21,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:21,701 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:51:21,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:51:21,705 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:21,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:51:21,705 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:21,705 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:51:21,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:51:21,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:51:21,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:51:21,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:51:21,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:51:21,707 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:51:21,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:51:21,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:21,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:51:21,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:21,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:21,708 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:21,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:51:21,709 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:51:21,709 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:51:21,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:51:21,713 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:51:21,714 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:21,716 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:21,716 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:21,718 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:21,718 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:21,718 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:21,719 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:21,734 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5301, Threshold=0.5790, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:51:21,734 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5301
2025-08-04 20:51:30,004 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:30,004 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:30,004 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:30,004 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:51:30,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:51:30,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:30,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:30,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:30,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:51:30,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:51:30,425 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:30,522 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:30,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:30,535 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:30,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:51:30,547 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:30,547 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:51:30,547 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:30,548 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:30,548 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:51:30,556 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:30,559 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,561 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:30,563 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:30,566 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:30,568 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:30,571 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,573 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:30,576 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:30,577 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:30,579 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:30,588 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:30,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:51:30,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:51:30,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:51:30,599 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:30,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:51:30,609 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:30,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:51:30,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:30,624 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:30,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:51:30,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:51:30,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:30,634 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:30,634 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:30,635 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:30,635 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:30,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:51:30,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:30,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:51:30,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:30,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:51:30,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:51:30,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:51:30,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:51:30,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:51:30,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:51:30,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:51:30,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:51:30,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:51:30,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:51:30,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:51:30,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:51:30,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:51:30,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:30,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:51:30,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:30,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:30,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:30,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:51:30,644 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:51:30,644 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:51:30,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:51:30,646 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:51:30,649 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:30,650 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:30,650 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:30,652 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 129/400.
2025-08-04 20:51:30,753 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:30,753 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:30,755 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:51:30,755 - ClientAppLogger [Client 8] - INFO - [Client] Round 129: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:51:30,755 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:30,787 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0772, Avg D Loss: 0.7835
2025-08-04 20:51:30,788 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0772, Avg D Loss: 0.7835
2025-08-04 20:51:30,788 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:30,800 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4965, Threshold=0.5294, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:51:30,800 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:51:30,800 - ClientAppLogger [Client 8] - INFO - Fit completed for round 129. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 129, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0771645069122315, 'd_loss': 0.7834673047065734, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14810752868652344, 'cpu_percent_fit': 27.675, 'ram_mb_fit': 3.03125, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:51:30,800 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:51:39,086 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:39,086 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:39,087 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:39,087 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:51:39,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:51:39,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:39,403 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:39,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:39,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:51:39,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:51:39,550 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:39,656 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:39,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:39,667 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:39,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:51:39,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:39,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:51:39,684 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:39,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:39,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:51:39,696 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:39,700 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,702 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:39,704 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:39,707 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:39,709 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:39,711 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,714 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:39,716 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:39,718 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:39,720 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:39,730 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:39,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:51:39,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:51:39,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:51:39,743 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:39,743 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:51:39,757 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:39,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:51:39,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:39,773 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:39,778 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:51:39,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:51:39,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:39,786 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:39,786 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:39,787 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:39,787 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:39,787 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:51:39,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:39,788 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:51:39,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:39,789 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:51:39,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:51:39,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:51:39,791 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:51:39,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:51:39,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:51:39,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:51:39,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:39,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:51:39,793 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:39,793 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:39,793 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:39,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:51:39,794 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:51:39,794 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:51:39,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:51:39,799 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:51:39,799 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:39,800 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:39,801 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:39,802 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:39,802 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:39,802 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:39,803 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:39,815 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5305, Threshold=0.5834, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:51:39,815 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5305
2025-08-04 20:51:45,069 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:45,069 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:45,069 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:45,069 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:51:45,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:51:45,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:45,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:45,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:45,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:51:45,411 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:51:45,411 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:45,491 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:45,499 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:45,499 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:45,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:51:45,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:45,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:51:45,512 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:45,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:45,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:51:45,523 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:45,527 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:45,530 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:45,533 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:45,537 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:45,540 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:45,544 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:45,547 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:45,551 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:45,554 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:45,557 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:45,566 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:45,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:51:45,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:51:45,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:51:45,575 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:45,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:51:45,584 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:45,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:51:45,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:45,599 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:45,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:51:45,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:51:45,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:45,609 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:45,609 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:45,609 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:45,610 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:45,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:51:45,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:45,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:51:45,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:45,612 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:51:45,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:51:45,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:51:45,614 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:51:45,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:51:45,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:51:45,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:51:45,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:45,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:51:45,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:51:45,619 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:51:45,619 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:45,620 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:45,620 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:45,622 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 130/400.
2025-08-04 20:51:45,723 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:45,723 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:45,724 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:51:45,724 - ClientAppLogger [Client 8] - INFO - [Client] Round 130: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:51:45,724 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:45,751 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7780
2025-08-04 20:51:45,752 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7780
2025-08-04 20:51:45,752 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:45,763 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4963, Threshold=0.5309, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:51:45,764 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:51:45,764 - ClientAppLogger [Client 8] - INFO - Fit completed for round 130. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 130, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0841098546981813, 'd_loss': 0.7780347883701324, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.1419389247894287, 'cpu_percent_fit': 28.8125, 'ram_mb_fit': 0.44921875, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:51:45,764 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:51:54,031 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:54,031 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:54,031 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:54,031 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:51:54,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:51:54,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,327 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:54,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:51:54,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:51:54,459 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:54,623 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:54,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:54,632 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:54,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:51:54,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:54,658 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:51:54,659 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:54,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:54,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:51:54,676 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:54,679 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,683 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:54,685 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:54,688 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:54,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:54,693 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,696 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:54,699 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:54,701 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:54,703 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:54,717 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:54,717 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:51:54,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:51:54,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:51:54,729 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:54,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:51:54,747 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:54,748 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:51:54,748 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:54,764 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:54,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:51:54,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:51:54,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:54,777 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:54,777 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:54,778 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:54,778 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:54,779 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:51:54,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:54,779 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:51:54,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:54,781 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:51:54,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:51:54,782 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:54,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:51:54,782 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:54,782 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:54,783 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:54,783 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:51:54,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:51:54,783 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:51:54,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:51:54,783 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:51:54,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:51:54,784 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:51:54,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:51:54,784 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:51:54,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:51:54,785 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:51:54,785 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:51:54,785 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:54,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:51:54,786 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:54,786 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:54,786 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:54,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:51:54,787 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:51:54,787 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:51:54,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:51:54,795 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:51:54,798 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:54,799 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:54,799 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:54,801 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:54,801 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:54,801 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:54,802 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:54,818 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5022, Threshold=0.5365, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:51:54,818 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5022
2025-08-04 20:52:00,068 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:00,068 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:00,068 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:00,068 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:00,068 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:00,068 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:00,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:00,348 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:00,434 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:00,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:00,457 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:00,574 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:00,580 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:00,580 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:00,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:00,595 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:00,595 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:00,595 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:00,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:00,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:00,604 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:00,608 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:00,610 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:00,612 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:00,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:00,616 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:00,619 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:00,622 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:00,624 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:00,626 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:00,629 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:00,640 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:00,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:00,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:00,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:00,650 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:00,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:00,659 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:00,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:00,660 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:00,676 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:00,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:00,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:00,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:00,689 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:00,689 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:00,690 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:00,690 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:00,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:00,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:00,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:00,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:00,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:00,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:00,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:00,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:00,694 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:00,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:00,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:00,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:00,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:00,695 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:00,695 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:00,696 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:00,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:00,696 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:00,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:00,696 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:00,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:00,697 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:00,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:00,698 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:00,698 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:00,698 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:00,699 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:00,699 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:00,699 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:00,703 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:00,703 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:00,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:00,712 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:00,712 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:00,714 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:00,714 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:00,716 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 131/400.
2025-08-04 20:52:00,817 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:00,817 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:00,819 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:52:00,819 - ClientAppLogger [Client 8] - INFO - [Client] Round 131: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:52:00,820 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:00,848 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0869, Avg D Loss: 0.7759
2025-08-04 20:52:00,849 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0869, Avg D Loss: 0.7759
2025-08-04 20:52:00,849 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:00,861 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4983, Threshold=0.5258, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:00,861 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:52:00,862 - ClientAppLogger [Client 8] - INFO - Fit completed for round 131. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 131, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0868632078170775, 'd_loss': 0.7759468197822571, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14563393592834473, 'cpu_percent_fit': 27.8625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:52:00,862 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:52:06,116 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,116 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:06,116 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:06,117 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:06,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:06,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:06,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:06,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:06,555 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:06,585 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:06,585 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:06,753 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:06,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:06,767 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:06,786 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:06,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:06,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:06,801 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:06,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:06,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:06,812 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:06,815 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:06,819 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:06,823 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:06,827 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:06,830 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:06,832 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:06,835 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:06,838 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:06,840 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:06,844 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:06,858 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:06,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:06,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:06,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:06,873 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:06,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:06,894 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:06,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:06,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:06,915 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:06,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:06,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:06,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:06,934 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:06,934 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:06,935 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:06,935 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:06,935 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:06,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:06,936 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:06,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:06,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:06,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:06,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:06,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:06,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:06,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:06,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:06,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:06,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:06,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:06,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:06,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:06,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:06,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:06,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:06,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:06,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:06,945 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:06,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:06,946 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:06,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:06,947 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:06,948 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:06,952 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:06,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:06,955 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:06,956 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:06,956 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:06,966 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:06,966 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:06,968 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:06,968 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:06,971 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:06,971 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:06,971 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:06,972 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:06,984 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5281, Threshold=0.5760, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:06,984 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5281
2025-08-04 20:52:12,229 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:12,229 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:12,229 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:12,229 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:12,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:12,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:12,487 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:12,487 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:12,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:12,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:12,589 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:12,685 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:12,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:12,691 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:12,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:12,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:12,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:12,706 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:12,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:12,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:12,715 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:12,718 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:12,720 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:12,722 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:12,724 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:12,727 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:12,729 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:12,732 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:12,737 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:12,739 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:12,742 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:12,752 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:12,752 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:12,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:12,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:12,765 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:12,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:12,777 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:12,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:12,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:12,792 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:12,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:12,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:12,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:12,802 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:12,802 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:12,802 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:12,803 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:12,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:12,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:12,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:12,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:12,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:12,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:12,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:12,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:12,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:12,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:12,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:12,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:12,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:12,808 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:12,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:12,808 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:12,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:12,809 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:12,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:12,809 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:12,809 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:12,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:12,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:12,810 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:12,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:12,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:12,814 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:12,814 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:12,815 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:12,815 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:12,817 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 132/400.
2025-08-04 20:52:12,918 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:12,918 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:12,920 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:52:12,920 - ClientAppLogger [Client 8] - INFO - [Client] Round 132: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:52:12,920 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:12,950 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.7772
2025-08-04 20:52:12,950 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.7772
2025-08-04 20:52:12,950 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:12,962 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4985, Threshold=0.5296, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:12,963 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:52:12,963 - ClientAppLogger [Client 8] - INFO - Fit completed for round 132. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 132, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0842323541641234, 'd_loss': 0.7772461533546448, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.1459355354309082, 'cpu_percent_fit': 29.0625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:52:12,963 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:52:18,224 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:18,225 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:18,225 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:18,225 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:18,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:18,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:18,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:18,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:18,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:18,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:18,635 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:18,744 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:18,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:18,765 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:18,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:18,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:18,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:18,789 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:18,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:18,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:18,800 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:18,803 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:18,805 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:18,807 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:18,810 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:18,812 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:18,815 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:18,818 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:18,821 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:18,823 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:18,826 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:18,839 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:18,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:18,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:18,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:18,852 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:18,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:18,876 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:18,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:18,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:18,896 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:18,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:18,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:18,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:18,913 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:18,913 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:18,913 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:18,914 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:18,914 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:18,914 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:18,915 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:18,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:18,916 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:18,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:18,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:18,917 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:18,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:18,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:18,917 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:18,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:18,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:18,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:18,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:18,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:18,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:18,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:18,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:18,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:18,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:18,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:18,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:18,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:18,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:18,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:18,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:18,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:18,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:18,922 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:18,922 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:18,923 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:18,928 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:18,928 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:18,930 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:18,930 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:18,932 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:18,932 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:18,932 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:18,933 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:18,946 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5480, Threshold=0.5995, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:18,946 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5480
2025-08-04 20:52:24,207 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:24,207 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:24,207 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:24,207 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:24,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:24,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:24,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:24,463 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:24,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:24,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:24,560 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:24,651 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:24,658 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:24,658 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:24,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:24,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:24,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:24,675 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:24,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:24,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:24,684 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:24,687 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:24,689 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:24,691 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:24,695 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:24,697 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:24,700 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:24,702 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:24,705 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:24,707 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:24,709 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:24,721 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:24,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:24,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:24,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:24,733 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:24,733 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:24,745 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:24,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:24,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:24,760 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:24,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:24,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:24,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:24,771 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:24,771 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:24,771 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:24,771 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:24,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:24,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:24,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:24,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:24,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:24,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:24,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:24,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:24,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:24,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:24,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:24,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:24,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:24,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:24,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:24,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:24,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:24,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:24,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:24,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:24,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:24,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:24,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:24,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:24,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:24,778 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:24,778 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:24,778 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:24,778 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:24,779 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:24,779 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:24,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:24,782 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:24,782 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:24,784 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:24,784 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:24,786 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 133/400.
2025-08-04 20:52:24,887 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:24,887 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:24,889 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:52:24,889 - ClientAppLogger [Client 8] - INFO - [Client] Round 133: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:52:24,889 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:24,915 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0762, Avg D Loss: 0.7781
2025-08-04 20:52:24,915 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0762, Avg D Loss: 0.7781
2025-08-04 20:52:24,915 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:24,927 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5016, Threshold=0.5333, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:24,928 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:52:24,928 - ClientAppLogger [Client 8] - INFO - Fit completed for round 133. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 133, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.076219654083252, 'd_loss': 0.778119957447052, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14215993881225586, 'cpu_percent_fit': 29.0375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:52:24,928 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:52:36,188 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:36,188 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:36,188 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:36,188 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:36,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:36,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:36,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:36,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:36,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:36,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:36,573 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:36,697 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:36,722 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:36,722 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:36,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:36,755 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:36,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:36,756 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:36,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:36,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:36,766 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:36,769 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:36,771 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:36,773 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:36,776 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:36,778 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:36,781 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:36,783 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:36,786 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:36,788 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:36,791 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:36,803 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:36,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:36,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:36,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:36,814 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:36,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:36,829 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:36,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:36,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:36,847 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:36,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:36,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:36,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:36,864 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:36,864 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:36,864 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:36,864 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:36,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:36,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:36,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:36,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:36,867 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:36,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:36,867 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:36,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:36,868 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:36,868 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:36,868 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:36,869 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:36,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:36,869 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:36,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:36,869 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:36,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:36,870 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:36,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:36,870 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:36,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:36,871 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:36,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:36,871 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:36,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:36,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:36,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:36,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:36,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:36,876 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:36,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:36,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:36,882 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:36,882 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:36,883 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:36,883 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:36,885 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:36,885 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:36,885 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:36,886 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:36,899 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5864, Threshold=0.6448, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:36,900 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5864
2025-08-04 20:52:42,149 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:42,149 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:42,149 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:42,149 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:42,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:42,150 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:42,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:42,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:42,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:42,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:42,495 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:42,580 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:42,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:42,586 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:42,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:42,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:42,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:42,598 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:42,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:42,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:42,608 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:42,610 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:42,612 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:42,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:42,617 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:42,619 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:42,621 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:42,624 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:42,627 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:42,628 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:42,631 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:42,640 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:42,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:42,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:42,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:42,651 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:42,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:42,662 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:42,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:42,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:42,677 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:42,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:42,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:42,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:42,686 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:42,687 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:42,687 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:42,687 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:42,687 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:42,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:42,688 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:42,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:42,689 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:42,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:42,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:42,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:42,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:42,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:42,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:42,690 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:42,691 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:42,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:42,692 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:42,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:42,692 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:42,692 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:42,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:42,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:42,693 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:42,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:42,697 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:42,697 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:42,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:42,699 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:42,699 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:42,701 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:42,701 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:42,702 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 134/400.
2025-08-04 20:52:42,803 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:42,803 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:42,805 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:52:42,805 - ClientAppLogger [Client 8] - INFO - [Client] Round 134: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:52:42,805 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:42,832 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0797, Avg D Loss: 0.7841
2025-08-04 20:52:42,832 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0797, Avg D Loss: 0.7841
2025-08-04 20:52:42,836 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:42,848 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5243, Threshold=0.5624, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:42,848 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:52:42,848 - ClientAppLogger [Client 8] - INFO - Fit completed for round 134. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 134, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0796778440475463, 'd_loss': 0.7841115832328797, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14581036567687988, 'cpu_percent_fit': 28.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:52:42,848 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:52:51,111 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:51,111 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:51,111 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:51,111 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:51,112 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:51,112 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:51,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:51,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:51,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:51,468 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:51,468 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:51,552 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:51,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:51,558 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:51,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:51,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:51,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:51,571 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:51,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:51,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:51,579 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:51,582 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:51,584 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:51,586 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:51,589 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:51,591 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:51,593 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:51,596 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:51,598 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:51,600 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:51,602 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:51,611 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:51,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:51,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:51,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:51,621 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:51,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:51,631 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:51,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:51,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:51,647 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:51,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:51,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:51,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:51,657 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:51,658 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:51,658 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:51,658 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:51,659 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:51,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:51,659 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:51,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:51,660 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:51,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:51,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:51,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:51,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:51,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:51,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:51,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:51,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:51,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:51,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:51,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:51,668 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:51,668 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:51,668 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:51,668 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:51,670 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:51,671 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:51,672 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:51,672 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:51,673 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:51,673 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:51,673 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:51,674 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:51,686 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5240, Threshold=0.5631, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:51,686 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5240
2025-08-04 20:52:56,937 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:56,937 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:56,937 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:56,938 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:52:56,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:52:56,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:57,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:57,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:57,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:52:57,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:52:57,273 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:57,352 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:57,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:57,360 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:57,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:52:57,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:57,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:52:57,373 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:57,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:57,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:52:57,383 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:57,386 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:57,388 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:57,390 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:57,392 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:57,394 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:57,397 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:57,399 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:57,402 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:57,404 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:57,406 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:57,415 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:57,415 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:52:57,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:52:57,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:52:57,425 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:57,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:52:57,434 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:57,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:52:57,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:57,449 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:57,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:52:57,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:52:57,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:57,458 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:57,458 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:57,459 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:57,459 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:57,459 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:52:57,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:57,460 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:52:57,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:57,461 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:52:57,461 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:52:57,462 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:52:57,463 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:52:57,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:52:57,464 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:52:57,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:52:57,464 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:57,464 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:52:57,464 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:57,465 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:57,465 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:57,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:52:57,469 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:52:57,469 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:52:57,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:52:57,471 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:52:57,471 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:57,472 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:57,472 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:57,474 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 135/400.
2025-08-04 20:52:57,575 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:57,575 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:57,576 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:52:57,576 - ClientAppLogger [Client 8] - INFO - [Client] Round 135: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:52:57,577 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:57,603 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.7810
2025-08-04 20:52:57,606 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.7810
2025-08-04 20:52:57,606 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:57,617 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5280, Threshold=0.5691, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:52:57,618 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:52:57,618 - ClientAppLogger [Client 8] - INFO - Fit completed for round 135. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 135, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082953405380249, 'd_loss': 0.7809807419776916, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14407062530517578, 'cpu_percent_fit': 28.96875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:52:57,618 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:53:02,887 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:02,887 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:02,887 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:02,887 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:53:02,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:53:02,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:03,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:03,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:03,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:53:03,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:53:03,244 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:03,365 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:03,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:03,371 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:03,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:53:03,399 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:03,399 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:53:03,400 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:03,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:03,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:53:03,410 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:03,414 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:03,416 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:03,419 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:03,422 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:03,425 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:03,427 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:03,431 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:03,434 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:03,436 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:03,438 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:03,449 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:03,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:53:03,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:53:03,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:53:03,460 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:03,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:53:03,472 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:03,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:53:03,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:03,490 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:03,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:53:03,501 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:53:03,501 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:03,502 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:03,502 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:03,502 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:03,502 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:03,502 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:53:03,503 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:03,503 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:53:03,503 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:03,504 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:53:03,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:53:03,505 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:03,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:53:03,505 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:03,505 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:03,505 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:03,505 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:53:03,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:53:03,506 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:53:03,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:53:03,506 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:53:03,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:53:03,506 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:53:03,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:53:03,507 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:53:03,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:53:03,507 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:53:03,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:53:03,508 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:03,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:53:03,508 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:03,508 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:03,509 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:03,509 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:53:03,512 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:53:03,512 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:53:03,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:53:03,517 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:53:03,517 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:03,519 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:03,519 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:03,520 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:03,520 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:03,521 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:03,521 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:03,533 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5308, Threshold=0.5824, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:53:03,533 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5308
2025-08-04 20:53:14,831 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:14,831 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:14,831 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:14,832 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:53:14,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:53:14,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:15,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:15,119 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:15,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:53:15,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:53:15,224 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:15,338 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:15,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:15,366 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:15,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:53:15,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:15,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:53:15,403 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:15,403 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:15,403 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:53:15,415 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:15,419 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,422 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:15,424 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:15,427 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:15,429 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:15,432 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,435 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:15,438 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:15,439 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:15,442 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:15,453 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:15,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:53:15,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:53:15,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:53:15,467 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:15,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:53:15,483 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:15,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:53:15,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:15,504 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:15,510 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:15,517 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:15,518 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:15,518 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:15,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:53:15,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:15,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:53:15,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:15,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:53:15,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:53:15,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:15,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:53:15,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:15,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:15,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:15,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:53:15,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:53:15,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:53:15,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:53:15,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:53:15,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:53:15,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:53:15,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:53:15,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:53:15,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:53:15,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:53:15,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:53:15,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:15,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:53:15,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:15,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:15,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:15,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:53:15,530 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:53:15,530 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:53:15,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:53:15,537 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:53:15,537 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:15,539 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:15,539 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:15,541 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:15,541 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:15,541 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:15,542 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:15,554 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5601, Threshold=0.6119, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:53:15,554 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5601
2025-08-04 20:53:20,801 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:20,801 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:20,801 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:20,801 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:53:20,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:53:20,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:21,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:21,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:21,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:53:21,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:53:21,134 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:21,219 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:21,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:21,225 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:21,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:53:21,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:21,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:53:21,236 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:21,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:21,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:53:21,245 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:21,248 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:21,250 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:21,252 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:21,255 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:21,257 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:21,259 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:21,262 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:21,264 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:21,266 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:21,268 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:21,277 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:21,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:53:21,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:53:21,283 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:53:21,288 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:21,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:53:21,301 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:21,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:53:21,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:21,316 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:21,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:53:21,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:53:21,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:21,325 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:21,325 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:21,326 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:21,326 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:21,326 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:53:21,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:21,327 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:53:21,327 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:21,328 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:53:21,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:53:21,329 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:53:21,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:53:21,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:53:21,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:53:21,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:21,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:53:21,331 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:21,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:21,332 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:21,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:53:21,336 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:53:21,336 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:53:21,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:53:21,339 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:53:21,339 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:21,340 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:21,341 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:21,342 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 137/400.
2025-08-04 20:53:21,443 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:21,443 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:21,444 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:53:21,445 - ClientAppLogger [Client 8] - INFO - [Client] Round 137: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:53:21,445 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:21,472 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0752, Avg D Loss: 0.7806
2025-08-04 20:53:21,472 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0752, Avg D Loss: 0.7806
2025-08-04 20:53:21,472 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:21,486 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5298, Threshold=0.5717, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:53:21,486 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:53:21,487 - ClientAppLogger [Client 8] - INFO - Fit completed for round 137. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 137, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.075228190422058, 'd_loss': 0.7805558204650879, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14475035667419434, 'cpu_percent_fit': 28.46875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:53:21,487 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:53:35,805 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:35,806 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:35,806 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:35,806 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:53:35,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:53:35,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:36,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:36,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:36,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:53:36,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:53:36,172 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:36,277 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:36,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:36,285 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:36,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:53:36,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:36,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:53:36,317 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:36,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:36,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:53:36,326 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:36,329 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:36,331 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:36,333 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:36,335 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:36,337 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:36,340 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:36,342 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:36,345 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:36,347 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:36,350 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:36,361 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:36,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:53:36,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:53:36,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:53:36,372 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:36,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:53:36,384 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:36,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:53:36,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:36,402 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:36,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:53:36,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:53:36,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:36,414 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:36,415 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:36,415 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:36,415 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:36,415 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:53:36,416 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:36,416 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:53:36,416 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:36,417 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:53:36,417 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:53:36,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:36,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:53:36,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:36,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:36,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:53:36,419 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:53:36,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:53:36,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:53:36,420 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:53:36,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:53:36,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:53:36,421 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:36,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:53:36,421 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:36,421 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:36,422 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:36,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:53:36,425 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:53:36,426 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:53:36,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:53:36,433 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:53:36,434 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:36,435 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:36,435 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:36,437 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:36,437 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:36,437 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:36,438 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:36,451 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5587, Threshold=0.6054, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:53:36,451 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5587
2025-08-04 20:53:56,767 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:56,767 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:56,768 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:56,768 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:53:56,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:53:56,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:57,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:57,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:57,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:53:57,186 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:53:57,186 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:57,291 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:57,346 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:57,347 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:57,353 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:53:57,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:57,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:53:57,375 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:57,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:57,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:53:57,385 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:57,388 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,390 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:57,392 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:57,395 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:57,398 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:57,400 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,403 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:57,405 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:57,407 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:57,410 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:57,421 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:57,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:53:57,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:53:57,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:53:57,433 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:57,433 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:53:57,445 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:57,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:53:57,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:57,462 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:57,466 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:53:57,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:53:57,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:57,473 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:57,473 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:57,474 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:57,474 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:57,474 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:53:57,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:57,474 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:53:57,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:57,476 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:53:57,476 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:53:57,477 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:57,477 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:53:57,477 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:57,477 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:57,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:57,478 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:53:57,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:53:57,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:53:57,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:53:57,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:53:57,479 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:53:57,479 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:53:57,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:53:57,480 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:53:57,480 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:53:57,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:53:57,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:53:57,481 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:57,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:53:57,482 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:57,482 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:57,482 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:57,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:53:57,485 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:53:57,486 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:53:57,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:53:57,491 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:53:57,491 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:57,493 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:57,493 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:57,494 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:57,495 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:57,495 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:57,496 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:57,509 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5504, Threshold=0.6024, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:53:57,509 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5504
2025-08-04 20:54:02,766 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:02,767 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:02,767 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:02,767 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:54:02,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:54:02,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:03,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:03,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:03,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:54:03,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:54:03,110 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:03,194 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:03,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:03,201 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:03,205 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:54:03,213 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:03,213 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:54:03,214 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:03,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:03,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:54:03,223 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:03,226 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:03,228 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:03,231 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:03,234 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:03,236 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:03,238 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:03,240 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:03,244 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:03,246 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:03,248 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:03,256 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:03,257 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:54:03,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:54:03,262 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:54:03,267 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:03,267 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:54:03,277 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:03,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:54:03,278 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:03,292 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:03,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:54:03,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:54:03,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:03,301 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:03,301 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:03,302 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:03,302 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:03,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:54:03,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:03,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:54:03,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:03,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:54:03,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:54:03,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:03,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:54:03,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:03,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:03,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:03,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:54:03,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:54:03,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:54:03,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:54:03,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:54:03,307 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:54:03,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:54:03,307 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:54:03,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:54:03,307 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:54:03,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:54:03,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:54:03,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:03,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:54:03,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:03,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:03,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:03,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:54:03,313 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:54:03,313 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:54:03,313 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:54:03,315 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:54:03,315 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:03,317 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:03,317 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:03,318 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 139/400.
2025-08-04 20:54:03,419 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:03,420 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:03,421 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:54:03,421 - ClientAppLogger [Client 8] - INFO - [Client] Round 139: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:54:03,421 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:03,449 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.7731
2025-08-04 20:54:03,449 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.7731
2025-08-04 20:54:03,452 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:03,464 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5331, Threshold=0.5779, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:54:03,464 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8068
2025-08-04 20:54:03,464 - ClientAppLogger [Client 8] - INFO - Fit completed for round 139. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 139, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083166170120239, 'd_loss': 0.7730660855770111, 'post_fit_local_f1': 0.8068376068376069, 'fit_time_seconds': 0.14555048942565918, 'cpu_percent_fit': 27.9875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:54:03,464 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:54:14,778 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:14,778 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:14,778 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:14,779 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:54:14,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:54:14,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:15,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:15,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:15,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:54:15,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:54:15,325 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:15,469 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:15,502 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:15,503 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:15,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:54:15,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:15,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:54:15,540 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:15,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:15,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:54:15,550 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:15,554 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,556 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:15,559 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:15,563 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:15,566 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:15,568 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,571 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:15,574 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:15,577 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:15,580 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:15,592 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:15,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:54:15,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:54:15,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:54:15,608 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:15,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:54:15,632 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:15,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:54:15,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:15,655 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:15,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:54:15,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:54:15,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:15,671 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:15,671 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:15,672 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:15,672 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:15,672 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:54:15,672 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:15,673 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:54:15,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:15,675 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:54:15,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:54:15,675 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:15,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:54:15,676 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:15,676 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:15,677 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:15,677 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:54:15,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:54:15,677 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:54:15,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:54:15,678 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:54:15,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:54:15,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:54:15,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:54:15,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:54:15,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:54:15,680 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:54:15,680 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:54:15,681 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:15,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:54:15,681 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:15,682 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:15,682 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:15,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:54:15,686 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:54:15,686 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:54:15,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:54:15,694 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:54:15,694 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:15,696 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:15,696 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:15,698 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:15,698 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:15,698 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:15,699 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:15,714 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5865, Threshold=0.6469, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:54:15,714 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5865
2025-08-04 20:54:33,021 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:33,021 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:33,021 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:33,021 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:54:33,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:54:33,022 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:33,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:54:33,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:54:33,473 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:33,600 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:33,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:33,613 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:33,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:54:33,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:33,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:54:33,702 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:33,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:33,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:54:33,716 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:33,720 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:33,723 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:33,725 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:33,729 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:33,731 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:33,734 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:33,737 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:33,741 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:33,743 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:33,746 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:33,772 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:33,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:54:33,779 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:54:33,780 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:54:33,790 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:33,791 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:54:33,814 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:33,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:54:33,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:33,840 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:33,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:54:33,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:54:33,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:33,859 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:33,859 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:33,859 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:33,860 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:33,860 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:54:33,860 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:33,861 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:54:33,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:33,862 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:54:33,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:54:33,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:33,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:54:33,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:33,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:33,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:33,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:54:33,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:54:33,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:54:33,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:54:33,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:54:33,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:54:33,866 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:54:33,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:54:33,867 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:54:33,868 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:54:33,869 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:54:33,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:54:33,869 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:33,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:54:33,885 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:33,885 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:33,886 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:33,890 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:54:33,891 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:54:33,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:54:33,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:54:33,901 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:54:33,901 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:33,906 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:33,909 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:33,913 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:33,913 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:33,913 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:33,915 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:33,952 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5436, Threshold=0.5899, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:54:33,952 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5436
2025-08-04 20:54:54,244 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:54,244 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:54,244 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:54,244 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:54:54,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:54:54,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:54,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:54,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:54,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:54:54,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:54:54,677 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:54,795 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:54,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:54,821 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:54,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:54:54,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:54,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:54:54,858 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:54,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:54,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:54:54,869 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:54,873 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:54,875 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:54,878 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:54,882 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:54,885 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:54,889 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:54,893 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:54,898 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:54,900 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:54,903 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:54,916 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:54,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:54:54,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:54:54,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:54:54,929 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:54,929 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:54:54,943 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:54,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:54:54,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:54,961 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:54,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:54:54,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:54:54,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:54,974 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:54,974 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:54,974 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:54,975 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:54,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:54:54,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:54,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:54:54,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:54,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:54:54,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:54:54,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:54,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:54:54,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:54,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:54,978 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:54,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:54:54,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:54:54,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:54:54,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:54:54,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:54:54,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:54:54,980 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:54:54,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:54:54,980 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:54:54,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:54:54,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:54:54,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:54:54,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:54,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:54:54,993 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:54,993 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:54,993 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:54,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:54:54,997 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:54:54,998 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:54:54,998 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:54:55,005 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:54:55,005 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:55,010 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:55,010 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:55,012 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:55,012 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:55,012 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:55,013 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:55,037 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5738, Threshold=0.6232, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:54:55,038 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5738
2025-08-04 20:55:15,332 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:15,332 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:15,333 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:15,333 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:55:15,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:55:15,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:15,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:15,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:15,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:55:15,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:55:15,694 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:15,806 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:15,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:15,814 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:15,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:55:15,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:15,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:55:15,829 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:15,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:15,830 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:55:15,841 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:15,846 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:15,849 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:15,851 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:15,854 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:15,856 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:15,859 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:15,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:15,865 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:15,867 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:15,870 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:15,881 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:15,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:55:15,887 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:55:15,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:55:15,897 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:15,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:55:15,921 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:15,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:55:15,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:15,941 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:15,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:55:15,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:55:15,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:15,955 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:15,955 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:15,956 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:15,957 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:15,957 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:55:15,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:15,959 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:55:15,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:15,961 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:55:15,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:55:15,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:15,962 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:55:15,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:15,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:15,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:15,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:55:15,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:55:15,963 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:55:15,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:55:15,963 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:55:15,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:55:15,965 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:55:15,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:55:15,965 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:55:15,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:55:15,966 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:55:15,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:55:15,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:15,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:55:15,968 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:15,968 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:15,969 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:15,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:55:15,974 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:55:15,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:55:15,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:55:15,982 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:55:15,982 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:15,984 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:15,984 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:15,987 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:15,987 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:15,987 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:15,988 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:16,006 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5582, Threshold=0.6076, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:55:16,007 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5582
2025-08-04 20:55:36,276 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:36,276 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:36,277 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:36,277 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:55:36,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:55:36,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:36,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:36,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:36,614 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:55:36,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:55:36,633 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:36,748 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:36,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:36,756 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:36,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:55:36,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:36,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:55:36,784 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:36,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:36,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:55:36,793 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:36,796 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:36,799 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:36,801 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:36,803 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:36,806 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:36,809 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:36,811 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:36,814 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:36,816 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:36,818 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:36,830 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:36,830 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:55:36,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:55:36,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:55:36,844 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:36,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:55:36,861 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:36,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:55:36,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:36,880 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:36,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:55:36,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:55:36,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:36,892 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:36,893 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:36,893 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:36,893 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:36,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:55:36,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:36,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:55:36,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:36,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:55:36,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:55:36,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:36,897 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:55:36,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:36,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:36,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:36,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:55:36,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:55:36,899 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:55:36,899 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:55:36,899 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:55:36,900 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:55:36,900 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:36,900 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:55:36,900 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:36,901 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:36,901 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:36,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:55:36,905 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:55:36,905 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:55:36,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:55:36,912 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:55:36,912 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:36,913 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:36,914 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:36,915 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:36,915 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:36,915 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:36,916 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:36,932 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4915, Threshold=0.5135, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:55:36,932 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4915
2025-08-04 20:55:57,215 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:57,216 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:57,216 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:57,216 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:55:57,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:55:57,216 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:57,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:57,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:57,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:55:57,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:55:57,563 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:57,650 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:57,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:57,655 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:57,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:55:57,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:57,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:55:57,677 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:57,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:57,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:55:57,686 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:57,689 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:57,691 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:57,693 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:57,696 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:57,698 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:57,701 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:57,703 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:57,706 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:57,708 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:57,710 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:57,719 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:57,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:55:57,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:55:57,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:55:57,729 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:57,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:55:57,740 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:57,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:55:57,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:57,759 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:57,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:55:57,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:55:57,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:57,770 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:57,770 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:57,771 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:57,771 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:57,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:55:57,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:57,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:55:57,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:57,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:55:57,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:55:57,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:57,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:55:57,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:57,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:57,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:55:57,775 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:55:57,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:55:57,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:55:57,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:55:57,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:55:57,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:55:57,776 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:57,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:55:57,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:57,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:57,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:57,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:55:57,781 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:55:57,781 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:55:57,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:55:57,784 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:55:57,784 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:57,785 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:57,785 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:57,787 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:57,787 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:57,787 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:57,788 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:57,800 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5928, Threshold=0.6526, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:55:57,801 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5928
2025-08-04 20:56:03,065 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:03,066 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:03,066 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:03,066 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:56:03,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:56:03,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:03,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:03,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:03,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:56:03,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:56:03,414 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:03,501 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:03,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:03,506 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:03,510 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:56:03,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:03,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:56:03,522 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:03,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:03,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:56:03,530 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:03,533 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:03,535 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:03,537 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:03,540 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:03,542 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:03,544 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:03,547 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:03,549 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:03,551 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:03,553 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:03,562 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:03,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:56:03,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:56:03,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:56:03,572 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:03,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:56:03,584 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:03,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:56:03,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:03,598 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:03,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:56:03,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:56:03,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:03,607 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:03,607 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:03,607 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:03,608 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:03,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:56:03,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:03,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:56:03,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:03,609 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:56:03,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:56:03,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:56:03,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:56:03,612 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:56:03,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:56:03,612 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:03,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:56:03,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:03,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:03,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:03,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:56:03,617 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:56:03,617 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:56:03,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:56:03,619 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:56:03,619 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:03,621 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:03,621 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:03,622 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 145/400.
2025-08-04 20:56:03,723 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:03,723 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:03,724 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:56:03,724 - ClientAppLogger [Client 8] - INFO - [Client] Round 145: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:56:03,725 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:03,751 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0828, Avg D Loss: 0.7567
2025-08-04 20:56:03,752 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0828, Avg D Loss: 0.7567
2025-08-04 20:56:03,754 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:03,765 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5102, Threshold=0.5371, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:56:03,765 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:56:03,765 - ClientAppLogger [Client 8] - INFO - Fit completed for round 145. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 145, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082789087295532, 'd_loss': 0.7567341148853302, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14282798767089844, 'cpu_percent_fit': 29.48125, 'ram_mb_fit': 3.99609375, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:56:03,765 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:56:09,055 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:09,055 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:09,055 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:09,055 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:56:09,055 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:56:09,056 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:09,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:09,330 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:09,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:56:09,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:56:09,430 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:09,526 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:09,531 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:09,532 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:09,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:56:09,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:09,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:56:09,546 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:09,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:09,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:56:09,555 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:09,558 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:09,560 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:09,562 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:09,565 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:09,567 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:09,570 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:09,573 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:09,575 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:09,577 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:09,580 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:09,589 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:09,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:56:09,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:56:09,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:56:09,600 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:09,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:56:09,612 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:09,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:56:09,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:09,627 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:09,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:56:09,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:56:09,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:09,636 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:09,636 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:09,636 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:09,636 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:09,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:56:09,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:09,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:56:09,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:09,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:56:09,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:56:09,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:09,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:56:09,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:09,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:09,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:09,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:56:09,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:56:09,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:56:09,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:56:09,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:56:09,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:56:09,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:56:09,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:56:09,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:56:09,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:56:09,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:56:09,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:56:09,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:09,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:56:09,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:09,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:09,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:09,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:56:09,647 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:56:09,647 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:56:09,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:56:09,650 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:56:09,650 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:09,652 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:09,653 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:09,655 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:09,655 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:09,655 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:09,656 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:09,669 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5187, Threshold=0.5415, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:56:09,671 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5187
2025-08-04 20:56:26,960 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:26,961 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:26,961 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:26,961 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:56:26,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:56:26,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:27,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:27,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:27,348 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:56:27,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:56:27,365 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:27,466 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:27,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:27,473 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:27,477 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:56:27,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:27,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:56:27,504 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:27,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:27,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:56:27,514 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:27,517 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:27,520 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:27,522 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:27,524 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:27,527 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:27,529 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:27,532 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:27,535 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:27,537 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:27,539 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:27,551 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:27,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:56:27,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:56:27,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:56:27,564 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:27,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:56:27,576 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:27,577 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:56:27,577 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:27,592 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:27,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:56:27,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:56:27,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:27,604 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:27,604 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:27,604 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:27,605 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:27,605 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:56:27,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:27,605 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:56:27,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:27,607 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:56:27,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:56:27,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:56:27,609 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:56:27,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:56:27,609 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:56:27,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:56:27,609 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:56:27,609 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:56:27,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:56:27,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:56:27,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:56:27,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:56:27,610 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:27,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:56:27,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:27,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:27,611 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:27,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:56:27,615 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:56:27,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:56:27,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:56:27,621 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:56:27,621 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:27,623 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:27,623 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:27,625 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:27,625 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:27,625 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:27,626 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:27,639 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5758, Threshold=0.6287, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:56:27,639 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5758
2025-08-04 20:56:47,979 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:47,979 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:47,980 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:47,980 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:56:47,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:56:47,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:48,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:48,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:48,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:56:48,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:56:48,407 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:48,494 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:48,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:48,500 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:48,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:56:48,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:48,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:56:48,514 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:48,514 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:48,514 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:56:48,523 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:48,525 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,527 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:48,530 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:48,532 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:48,534 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:48,537 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,541 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:48,544 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:48,546 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:48,548 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:48,557 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:48,557 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:56:48,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:56:48,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:56:48,570 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:48,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:56:48,582 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:48,582 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:56:48,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:48,598 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:48,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:56:48,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:56:48,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:48,612 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:48,612 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:48,612 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:48,612 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:48,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:56:48,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:48,613 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:56:48,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:48,614 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:56:48,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:56:48,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:48,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:56:48,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:48,615 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:48,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:48,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:56:48,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:56:48,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:56:48,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:56:48,616 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:56:48,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:56:48,617 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:56:48,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:56:48,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:56:48,618 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:56:48,618 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:56:48,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:56:48,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:48,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:56:48,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:48,619 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:48,620 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:48,623 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:56:48,623 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:56:48,624 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:56:48,624 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:56:48,631 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:56:48,631 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:48,633 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:48,633 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:48,634 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:48,634 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:48,634 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:48,635 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:48,648 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4898, Threshold=0.5055, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:56:48,649 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4898
2025-08-04 20:57:05,977 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:05,977 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:05,977 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:05,977 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:57:05,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:57:05,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:06,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:06,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:06,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:57:06,466 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:57:06,466 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:06,601 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:06,608 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:06,608 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:06,614 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:57:06,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:06,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:57:06,663 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:06,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:06,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:57:06,673 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:06,675 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,677 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:06,679 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:06,682 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:06,684 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:06,687 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:06,692 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:06,694 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:06,697 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:06,708 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:06,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:57:06,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:57:06,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:57:06,722 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:06,723 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:57:06,737 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:06,737 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:57:06,737 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:06,753 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:06,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:57:06,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:57:06,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:06,765 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:06,765 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:06,766 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:06,766 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:06,766 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:57:06,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:06,767 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:57:06,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:06,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:57:06,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:57:06,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:06,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:57:06,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:57:06,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:57:06,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:57:06,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:57:06,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:57:06,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:57:06,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:57:06,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:57:06,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:57:06,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:06,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:57:06,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:06,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:06,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:06,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:57:06,777 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:57:06,777 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:57:06,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:57:06,785 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:57:06,785 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:06,787 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:06,787 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:06,788 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:06,788 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:06,789 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:06,790 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:06,807 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5466, Threshold=0.5854, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:57:06,807 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5466
2025-08-04 20:57:27,141 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:27,141 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:27,141 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:27,141 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:57:27,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:57:27,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:27,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:27,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:27,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:57:27,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:57:27,645 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:27,761 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:27,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:27,774 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:27,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:57:27,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:27,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:57:27,816 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:27,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:27,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:57:27,829 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:27,833 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,835 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:27,838 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:27,841 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:27,843 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:27,846 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,849 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:27,852 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:27,854 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:27,856 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:27,875 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:27,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:57:27,881 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:57:27,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:57:27,894 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:27,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:57:27,912 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:27,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:57:27,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:27,934 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:27,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:57:27,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:57:27,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:27,951 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:27,952 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:27,952 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:27,952 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:27,953 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:57:27,953 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:27,953 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:57:27,953 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:27,955 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:57:27,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:57:27,956 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:27,956 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:57:27,956 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:27,957 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:27,957 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:27,957 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:57:27,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:57:27,958 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:57:27,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:57:27,959 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:57:27,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:57:27,959 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:57:27,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:57:27,960 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:57:27,960 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:57:27,960 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:57:27,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:57:27,961 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:27,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:57:27,961 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:27,961 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:27,962 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:27,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:57:27,967 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:57:27,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:57:27,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:57:27,975 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:57:27,975 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:27,977 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:27,977 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:27,979 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:27,979 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:27,979 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:27,981 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:27,996 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5548, Threshold=0.5954, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:57:27,996 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5548
2025-08-04 20:57:48,315 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:48,315 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:48,315 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:48,315 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:57:48,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:57:48,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:48,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:48,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:48,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:57:48,737 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:57:48,737 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:48,845 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:48,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:48,852 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:48,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:57:48,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:48,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:57:48,906 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:48,906 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:48,906 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:57:48,916 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:48,919 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:48,922 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:48,924 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:48,927 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:48,930 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:48,932 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:48,935 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:48,938 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:48,940 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:48,942 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:48,955 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:48,956 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:57:48,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:57:48,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:57:48,967 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:48,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:57:48,980 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:48,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:57:48,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:48,998 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:49,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:57:49,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:57:49,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:49,012 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:49,013 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:49,013 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:49,013 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:49,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:57:49,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:49,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:57:49,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:49,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:57:49,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:57:49,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:49,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:57:49,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:49,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:49,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:49,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:57:49,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:57:49,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:57:49,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:57:49,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:57:49,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:57:49,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:57:49,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:57:49,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:57:49,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:57:49,020 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:57:49,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:57:49,020 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:49,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:57:49,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:49,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:49,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:49,022 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:57:49,022 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:57:49,022 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:57:49,022 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:57:49,029 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:57:49,029 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:49,031 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:49,031 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:49,033 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:49,033 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:49,033 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:49,034 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:49,049 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5595, Threshold=0.6045, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:57:49,049 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5595
2025-08-04 20:57:54,327 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:54,328 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:54,328 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:54,328 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:57:54,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:57:54,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:54,588 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:54,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:54,671 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:57:54,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:57:54,689 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:54,776 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:54,782 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:54,782 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:54,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:57:54,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:54,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:57:54,797 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:54,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:54,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:57:54,806 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:54,809 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:54,811 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:54,813 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:54,816 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:54,818 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:54,822 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:54,824 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:54,827 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:54,829 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:54,831 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:54,840 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:54,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:57:54,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:57:54,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:57:54,851 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:54,851 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:57:54,863 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:54,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:57:54,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:54,880 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:54,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:57:54,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:57:54,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:54,890 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:54,890 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:54,890 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:54,890 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:54,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:57:54,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:54,891 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:57:54,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:54,892 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:57:54,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:57:54,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:54,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:57:54,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:54,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:54,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:54,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:57:54,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:57:54,894 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:57:54,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:57:54,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:57:54,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:57:54,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:57:54,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:57:54,895 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:57:54,895 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:57:54,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:57:54,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:57:54,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:54,896 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:57:54,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:54,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:54,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:54,897 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:57:54,897 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:57:54,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:57:54,897 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:57:54,901 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:57:54,901 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:54,902 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:54,902 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:54,904 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 151/400.
2025-08-04 20:57:55,006 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:55,006 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:55,007 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:57:55,008 - ClientAppLogger [Client 8] - INFO - [Client] Round 151: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:57:55,008 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:55,039 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0802, Avg D Loss: 0.7692
2025-08-04 20:57:55,039 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0802, Avg D Loss: 0.7692
2025-08-04 20:57:55,040 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:55,052 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4813, Threshold=0.4889, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:57:55,053 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:57:55,053 - ClientAppLogger [Client 8] - INFO - Fit completed for round 151. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 151, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080233573913574, 'd_loss': 0.7691614389419555, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14898014068603516, 'cpu_percent_fit': 28.8875, 'ram_mb_fit': 4.6640625, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:57:55,053 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:58:06,335 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:06,335 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:06,335 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:06,336 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:58:06,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:58:06,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:06,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:06,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:06,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:58:06,823 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:58:06,823 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:06,969 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:06,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:06,990 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:06,998 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:58:07,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:07,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:58:07,018 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:07,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:07,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:58:07,028 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:07,031 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,033 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:07,036 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:07,039 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:07,041 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:07,044 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,046 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:07,049 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:07,051 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:07,054 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:07,067 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:07,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:58:07,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:58:07,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:58:07,080 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:07,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:58:07,097 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:07,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:58:07,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:07,116 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:07,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:58:07,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:58:07,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:07,132 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:07,132 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:07,133 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:07,133 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:07,134 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:58:07,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:07,134 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:58:07,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:07,136 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:58:07,136 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:58:07,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:07,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:58:07,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:07,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:07,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:07,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:58:07,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:58:07,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:58:07,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:58:07,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:58:07,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:58:07,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:58:07,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:58:07,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:58:07,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:58:07,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:58:07,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:58:07,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:07,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:58:07,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:07,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:07,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:07,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:58:07,145 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:58:07,145 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:58:07,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:58:07,152 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:58:07,152 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:07,153 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:07,153 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:07,155 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:07,155 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:07,155 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:07,156 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:07,169 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5354, Threshold=0.5736, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:58:07,170 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5354
2025-08-04 20:58:27,468 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:27,468 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:27,468 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:27,468 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:58:27,468 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:58:27,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:27,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:27,748 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:27,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:58:27,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:58:27,855 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:27,964 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:27,972 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:27,973 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:27,994 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:58:28,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:28,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:58:28,020 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:28,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:28,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:58:28,030 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:28,033 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,035 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:28,037 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:28,040 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:28,042 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:28,045 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,048 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:28,050 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:28,052 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:28,055 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:28,064 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:28,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:58:28,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:58:28,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:58:28,075 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:28,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:58:28,086 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:28,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:58:28,087 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:28,104 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:28,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:58:28,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:58:28,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:28,118 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:28,118 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:28,119 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:28,119 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:28,119 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:58:28,119 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:28,120 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:58:28,120 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:28,121 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:58:28,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:58:28,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:28,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:58:28,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:28,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:28,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:28,122 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:58:28,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:58:28,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:58:28,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:58:28,124 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:58:28,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:58:28,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:28,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:58:28,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:28,125 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:28,126 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:28,129 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:58:28,130 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:58:28,130 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:58:28,130 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:58:28,136 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:58:28,137 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:28,138 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:28,138 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:28,140 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:28,140 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:28,140 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:28,141 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:28,153 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5896, Threshold=0.6444, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:58:28,154 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5896
2025-08-04 20:58:45,445 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:45,445 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:45,445 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:45,445 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:58:45,445 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:58:45,446 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:45,723 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:45,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:45,818 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:58:45,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:58:45,842 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:45,963 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:45,984 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:45,985 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:45,993 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:58:46,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:46,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:58:46,020 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:46,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:46,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:58:46,029 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:46,032 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,035 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:46,037 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:46,040 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:46,042 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:46,045 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,048 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:46,051 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:46,053 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:46,056 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:46,068 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:46,068 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:58:46,074 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:58:46,074 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:58:46,081 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:46,081 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:58:46,097 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:46,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:58:46,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:46,117 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:46,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:58:46,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:58:46,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:46,133 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:46,133 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:46,134 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:46,134 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:46,134 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:58:46,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:46,135 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:58:46,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:46,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:58:46,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:58:46,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:46,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:58:46,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:46,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:46,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:46,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:58:46,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:58:46,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:58:46,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:58:46,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:58:46,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:58:46,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:58:46,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:58:46,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:58:46,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:58:46,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:58:46,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:58:46,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:46,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:58:46,142 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:46,142 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:46,143 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:46,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:58:46,146 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:58:46,146 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:58:46,146 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:58:46,155 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:58:46,155 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:46,156 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:46,157 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:46,158 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:46,158 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:46,158 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:46,159 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:46,177 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4918, Threshold=0.5137, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:58:46,177 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.4918
2025-08-04 20:59:06,485 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:06,485 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:06,485 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:06,485 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:59:06,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:59:06,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:06,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:06,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:06,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:59:06,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:59:06,912 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:07,035 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:07,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:07,043 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:07,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:59:07,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:07,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:59:07,072 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:07,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:07,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:59:07,083 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:07,086 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,089 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:07,092 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:07,094 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:07,097 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:07,100 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,102 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:07,105 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:07,107 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:07,110 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:07,121 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:07,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:59:07,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:59:07,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:59:07,134 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:07,134 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:59:07,148 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:07,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:59:07,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:07,166 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:07,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:59:07,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:59:07,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:07,176 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:07,176 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:07,177 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:07,177 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:07,177 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:59:07,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:07,178 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:59:07,178 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:07,179 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:59:07,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:59:07,179 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:07,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:59:07,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:07,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:07,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:07,180 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:59:07,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:59:07,181 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:59:07,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:59:07,181 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:59:07,181 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:59:07,181 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:59:07,182 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:59:07,182 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:59:07,182 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:59:07,182 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:59:07,183 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:59:07,183 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:07,183 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:59:07,183 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:07,184 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:07,184 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:07,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:59:07,187 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:59:07,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:59:07,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:59:07,194 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:59:07,194 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:07,195 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:07,196 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:07,197 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:07,198 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:07,198 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:07,199 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:07,211 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5511, Threshold=0.5933, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:59:07,211 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5511
2025-08-04 20:59:24,496 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:24,496 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:24,497 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:24,497 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:59:24,497 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:59:24,497 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:24,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:24,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:24,913 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:59:24,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:59:24,934 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:25,062 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:25,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:25,070 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:25,091 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:59:25,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:25,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:59:25,117 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:25,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:25,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:59:25,128 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:25,130 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,133 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:25,135 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:25,139 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:25,141 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:25,144 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,146 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:25,149 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:25,151 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:25,153 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:25,164 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:25,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:59:25,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:59:25,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:59:25,175 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:25,175 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:59:25,187 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:25,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:59:25,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:25,205 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:25,211 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:59:25,219 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:59:25,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:25,220 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:25,220 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:25,220 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:25,220 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:25,221 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:59:25,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:25,221 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:59:25,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:25,222 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:59:25,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:59:25,223 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:25,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:59:25,223 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:25,223 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:25,224 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:25,224 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:59:25,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:59:25,224 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:59:25,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:59:25,224 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:59:25,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:59:25,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:59:25,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:59:25,225 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:59:25,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:59:25,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:59:25,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:59:25,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:25,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:59:25,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:25,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:25,227 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:25,231 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:59:25,231 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:59:25,231 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:59:25,231 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:59:25,240 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:59:25,240 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:25,241 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:25,242 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:25,243 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:25,243 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:25,243 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:25,244 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:25,257 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5446, Threshold=0.5841, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:59:25,257 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5446
2025-08-04 20:59:36,541 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:36,541 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:36,542 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:36,542 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:59:36,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:59:36,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:36,847 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:36,847 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:36,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:59:36,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:59:36,958 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:37,088 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:37,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:37,096 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:37,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:59:37,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:37,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:59:37,127 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:37,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:37,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:59:37,136 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:37,139 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,141 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:37,143 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:37,146 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:37,148 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:37,150 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,153 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:37,155 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:37,157 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:37,160 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:37,172 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:37,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:59:37,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:59:37,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:59:37,184 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:37,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:59:37,200 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:37,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:59:37,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:37,219 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:37,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:59:37,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:59:37,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:37,232 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:37,232 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:37,233 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:37,233 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:37,233 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:59:37,233 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:37,233 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:59:37,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:37,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:59:37,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:59:37,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:59:37,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:59:37,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:59:37,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:59:37,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:59:37,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:59:37,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:59:37,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:59:37,238 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:59:37,238 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:59:37,238 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:59:37,238 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:37,239 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:59:37,239 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:37,239 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:37,239 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:37,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:59:37,243 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:59:37,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:59:37,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:59:37,250 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:59:37,250 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:37,252 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:37,252 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:37,253 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:37,254 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:37,254 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:37,254 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:37,267 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5232, Threshold=0.5734, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:59:37,267 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5232
2025-08-04 20:59:45,544 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:45,544 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:45,545 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:45,545 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:59:45,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:59:45,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:45,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:45,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:45,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:59:45,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:59:45,954 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:46,049 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:46,067 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:46,068 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:46,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:59:46,090 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:46,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:59:46,093 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:46,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:46,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:59:46,103 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:46,106 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:46,108 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:46,110 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:46,113 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:46,116 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:46,118 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:46,121 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:46,124 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:46,126 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:46,128 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:46,137 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:46,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:59:46,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:59:46,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:59:46,147 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:46,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:59:46,155 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:46,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:59:46,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:46,171 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:46,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:59:46,182 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:59:46,182 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:46,183 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:46,183 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:46,183 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:46,184 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:46,184 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:59:46,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:46,184 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:59:46,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:46,186 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:59:46,186 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:59:46,187 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:59:46,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:59:46,189 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:59:46,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:59:46,189 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:46,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:59:46,189 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:46,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:46,190 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:46,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:59:46,194 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:59:46,194 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:59:46,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:59:46,201 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:59:46,201 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:46,202 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:46,202 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:46,204 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 157/400.
2025-08-04 20:59:46,304 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:46,305 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:46,306 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:59:46,306 - ClientAppLogger [Client 8] - INFO - [Client] Round 157: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:59:46,306 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:46,333 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0862, Avg D Loss: 0.7697
2025-08-04 20:59:46,334 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0862, Avg D Loss: 0.7697
2025-08-04 20:59:46,337 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:46,349 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4763, Threshold=0.4914, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 20:59:46,349 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 20:59:46,350 - ClientAppLogger [Client 8] - INFO - Fit completed for round 157. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 157, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0862297773361207, 'd_loss': 0.7696648716926575, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14594149589538574, 'cpu_percent_fit': 29.04375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:59:46,350 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:59:51,611 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:51,611 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:51,611 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:51,611 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:59:51,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:59:51,611 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:51,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:51,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:51,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:59:52,015 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:59:52,016 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:52,153 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:52,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:52,163 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:52,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:59:52,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:52,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:59:52,201 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:52,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:52,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:59:52,210 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:52,213 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,216 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:52,218 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:52,222 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:52,224 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:52,226 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,229 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:52,232 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:52,234 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:52,236 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:52,246 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:52,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:59:52,251 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:59:52,251 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:59:52,258 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:52,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:59:52,272 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:52,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:59:52,273 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:52,291 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:52,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:59:52,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:59:52,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:52,304 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:52,304 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:52,305 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:52,305 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:52,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:59:52,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:52,306 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:59:52,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:52,307 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:59:52,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:59:52,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:52,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:59:52,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:52,308 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:52,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:52,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:59:52,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:59:52,309 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:59:52,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:59:52,310 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:59:52,310 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:59:52,310 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:59:52,310 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:59:52,310 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:59:52,310 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:59:52,311 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:59:52,311 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:59:52,311 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:52,311 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:59:52,312 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:52,312 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:52,312 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:52,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:59:52,315 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:59:52,316 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:59:52,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:59:52,321 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:59:52,321 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:52,322 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:52,323 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:52,324 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:52,324 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:52,324 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:52,325 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:52,341 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5282, Threshold=0.5594, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 20:59:52,341 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5282
