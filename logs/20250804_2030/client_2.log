2025-08-04 20:30:04,581 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:04,581 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:04,581 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:04,581 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:04,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:04,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:04,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:04,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:04,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:04,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:04,946 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:05,037 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:05,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:05,042 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:05,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:05,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:05,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:05,076 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:05,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:05,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:05,085 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:05,088 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:05,090 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:05,093 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:05,095 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:05,097 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:05,100 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:05,102 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:05,105 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:05,107 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:05,109 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:05,118 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:05,119 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:05,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:05,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:05,129 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:05,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:05,140 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:05,140 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:05,140 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:05,156 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:05,162 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:05,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:05,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:05,168 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:05,168 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:05,168 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:05,168 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:05,169 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:05,169 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:05,169 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:05,169 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:05,170 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:05,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:05,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:05,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:05,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:05,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:05,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:05,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:05,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:05,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:05,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:05,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:05,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:05,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:05,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:05,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:05,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:05,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:05,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:05,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:05,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:05,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:05,176 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:05,176 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:05,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:05,176 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:05,177 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:05,177 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:05,182 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:05,182 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:05,183 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:05,184 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:05,185 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:05,185 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:05,185 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:05,186 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:05,195 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3473, Threshold=0.3657, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:05,196 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3473
2025-08-04 20:30:13,441 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:13,441 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:13,441 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:13,441 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:13,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:13,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:13,676 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:13,676 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:13,758 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:13,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:13,782 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:13,871 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:13,875 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:13,876 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:13,881 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:13,891 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:13,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:13,892 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:13,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:13,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:13,900 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:13,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:13,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:13,907 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:13,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:13,912 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:13,915 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:13,917 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:13,919 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:13,921 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:13,923 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:13,932 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:13,932 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:13,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:13,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:13,940 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:13,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:13,948 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:13,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:13,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:13,964 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:13,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:13,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:13,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:13,973 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:13,973 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:13,973 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:13,974 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:13,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:13,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:13,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:13,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:13,975 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:13,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:13,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:13,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:13,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:13,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:13,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:13,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:13,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:13,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:13,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:13,979 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:13,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:13,979 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:13,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:13,979 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:13,980 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:13,980 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:13,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:13,980 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:13,980 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:13,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:13,984 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:13,984 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:13,985 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:13,986 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:13,987 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 42/400.
2025-08-04 20:30:14,088 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:14,088 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:14,090 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 212 anomalous samples to GAN training data (target: 212).
2025-08-04 20:30:14,090 - ClientAppLogger [Client 2] - INFO - [Client] Round 42: Training GAN with 919 samples (707 normal, 212 anomalous).
2025-08-04 20:30:14,090 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:14,748 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0858, Avg D Loss: 0.8825
2025-08-04 20:30:14,748 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0858, Avg D Loss: 0.8825
2025-08-04 20:30:14,748 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:14,756 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3371, Threshold=0.3554, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:14,756 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:30:14,756 - ClientAppLogger [Client 2] - INFO - Fit completed for round 42. Duration: 0.77s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 42, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0858297777383448, 'd_loss': 0.8825022225086784, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.7692596912384033, 'cpu_percent_fit': 31.25, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 919}
2025-08-04 20:30:14,756 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:30:20,011 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:20,012 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:20,012 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:20,012 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:20,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:20,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:20,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:20,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:20,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:20,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:20,378 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:20,471 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:20,476 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:20,477 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:20,481 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:20,486 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:20,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:20,487 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:20,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:20,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:20,496 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:20,498 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:20,501 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:20,503 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:20,505 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:20,507 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:20,510 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:20,512 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:20,515 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:20,517 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:20,519 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:20,528 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:20,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:20,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:20,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:20,537 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:20,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:20,546 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:20,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:20,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:20,561 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:20,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:20,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:20,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:20,571 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:20,572 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:20,572 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:20,572 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:20,572 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:20,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:20,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:20,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:20,574 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:20,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:20,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:20,575 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:20,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:20,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:20,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:20,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:20,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:20,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:20,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:20,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:20,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:20,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:20,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:20,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:20,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:20,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:20,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:20,579 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:20,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:20,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:20,584 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:20,584 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:20,585 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:20,585 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:20,587 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:20,587 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:20,587 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:20,587 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:20,595 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3372, Threshold=0.3554, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:20,595 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3372
2025-08-04 20:30:25,855 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:25,855 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:25,855 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:25,855 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:25,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:25,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:26,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:26,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:26,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:26,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:26,209 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:26,291 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:26,296 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:26,296 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:26,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:26,332 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:26,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:26,333 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:26,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:26,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:26,343 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:26,346 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:26,348 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:26,350 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:26,353 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:26,355 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:26,357 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:26,360 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:26,363 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:26,365 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:26,367 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:26,376 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:26,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:26,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:26,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:26,385 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:26,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:26,393 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:26,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:26,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:26,409 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:26,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:26,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:26,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:26,420 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:26,420 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:26,420 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:26,420 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:26,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:26,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:26,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:26,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:26,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:26,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:26,423 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:26,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:26,423 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:26,423 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:26,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:26,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:26,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:26,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:26,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:26,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:26,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:26,427 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:26,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:26,427 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:26,427 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:26,428 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:26,428 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:26,428 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:26,428 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:26,428 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:26,432 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:26,432 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:26,433 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:26,433 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:26,435 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 43/400.
2025-08-04 20:30:26,535 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:26,535 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:26,537 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 216 anomalous samples to GAN training data (target: 216).
2025-08-04 20:30:26,537 - ClientAppLogger [Client 2] - INFO - [Client] Round 43: Training GAN with 939 samples (723 normal, 216 anomalous).
2025-08-04 20:30:26,537 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:27,196 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0861, Avg D Loss: 0.8781
2025-08-04 20:30:27,196 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0861, Avg D Loss: 0.8781
2025-08-04 20:30:27,196 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:27,204 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3446, Threshold=0.3631, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:27,204 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:30:27,204 - ClientAppLogger [Client 2] - INFO - Fit completed for round 43. Duration: 0.77s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 43, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0861090213980793, 'd_loss': 0.8780850604509773, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.7695448398590088, 'cpu_percent_fit': 31.2, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 939}
2025-08-04 20:30:27,204 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:30:32,463 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:32,463 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:32,463 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:32,463 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:32,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:32,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:32,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:32,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:32,770 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:32,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:32,796 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:32,892 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:32,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:32,900 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:32,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:32,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:32,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:32,938 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:32,938 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:32,938 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:32,947 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:32,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:32,952 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:32,954 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:32,957 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:32,959 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:32,961 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:32,964 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:32,967 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:32,969 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:32,971 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:32,984 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:32,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:32,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:32,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:32,995 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:32,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:33,005 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:33,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:33,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:33,024 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:33,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:33,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:33,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:33,037 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:33,038 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:33,038 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:33,039 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:33,039 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:33,039 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:33,039 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:33,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:33,041 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:33,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:33,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:33,043 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:33,043 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:33,043 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:33,043 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:33,044 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:33,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:33,045 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:33,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:33,045 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:33,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:33,045 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:33,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:33,046 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:33,046 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:33,046 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:33,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:33,046 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:33,046 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:33,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:33,053 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:33,053 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:33,055 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:33,055 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:33,056 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:33,056 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:33,057 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:33,057 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:33,067 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3445, Threshold=0.3630, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:33,068 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3445
2025-08-04 20:30:41,333 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:41,333 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:41,333 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:41,333 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:41,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:41,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:41,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:41,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:41,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:41,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:41,670 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:41,754 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:41,759 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:41,759 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:41,763 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:41,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:41,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:41,769 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:41,769 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:41,769 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:41,777 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:41,780 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:41,782 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:41,784 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:41,787 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:41,789 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:41,791 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:41,794 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:41,797 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:41,798 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:41,801 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:41,809 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:41,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:41,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:41,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:41,819 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:41,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:41,829 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:41,830 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:41,830 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:41,844 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:41,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:41,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:41,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:41,853 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:41,853 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:41,853 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:41,854 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:41,854 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:41,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:41,854 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:41,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:41,855 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:41,856 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:41,856 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:41,856 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:41,856 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:41,856 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:41,856 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:41,857 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:41,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:41,857 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:41,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:41,857 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:41,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:41,858 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:41,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:41,858 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:41,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:41,858 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:41,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:41,859 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:41,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:41,859 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:41,860 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:41,860 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:41,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:41,860 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:41,860 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:41,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:41,861 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:41,862 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:41,863 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:41,863 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:41,864 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 44/400.
2025-08-04 20:30:41,965 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:41,966 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:41,967 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 221 anomalous samples to GAN training data (target: 221).
2025-08-04 20:30:41,967 - ClientAppLogger [Client 2] - INFO - [Client] Round 44: Training GAN with 960 samples (739 normal, 221 anomalous).
2025-08-04 20:30:41,967 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:42,690 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0858, Avg D Loss: 0.8783
2025-08-04 20:30:42,690 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0858, Avg D Loss: 0.8783
2025-08-04 20:30:42,690 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:42,699 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3355, Threshold=0.3536, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:42,699 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:30:42,699 - ClientAppLogger [Client 2] - INFO - Fit completed for round 44. Duration: 0.83s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 44, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085825808048248, 'd_loss': 0.8783039746681849, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.8348934650421143, 'cpu_percent_fit': 31.16875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 960}
2025-08-04 20:30:42,700 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:30:47,961 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:47,961 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:47,961 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:47,961 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:47,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:47,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:48,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:48,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:48,362 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:48,469 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:48,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:48,479 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:48,488 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:48,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:48,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:48,561 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:48,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:48,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:48,572 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:48,575 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:48,578 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:48,581 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:48,584 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:48,586 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:48,589 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:48,591 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:48,594 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:48,596 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:48,599 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:48,613 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:48,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:48,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:48,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:48,625 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:48,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:48,641 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:48,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:48,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:48,662 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:48,667 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:48,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:48,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:48,675 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:48,675 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:48,676 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:48,677 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:48,677 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:48,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:48,678 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:48,678 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:48,680 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:48,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:48,682 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:48,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:48,682 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:48,682 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:48,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:48,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:48,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:48,684 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:48,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:48,684 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:48,685 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:48,688 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:48,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:48,691 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:48,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:48,692 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:48,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:48,693 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:48,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:48,694 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:48,695 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:48,696 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:48,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:48,697 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:48,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:48,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:48,708 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:48,708 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:48,711 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:48,711 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:48,714 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:48,715 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:48,715 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:48,716 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:48,734 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3356, Threshold=0.3536, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:48,735 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3356
2025-08-04 20:30:57,001 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:57,001 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:30:57,001 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:30:57,001 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:30:57,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:30:57,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:57,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:57,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:57,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:30:57,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:30:57,373 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:57,462 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:57,468 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:57,468 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:57,475 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:30:57,489 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:57,489 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:30:57,490 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:57,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:57,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:30:57,499 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:57,501 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:57,504 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:57,506 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:57,509 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:57,511 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:57,514 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:57,517 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:57,519 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:57,521 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:57,523 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:57,534 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:57,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:30:57,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:30:57,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:30:57,544 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:57,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:30:57,552 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:57,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:30:57,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:57,568 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:57,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:30:57,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:30:57,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:57,578 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:57,578 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:57,578 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:57,578 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:57,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:30:57,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:57,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:30:57,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:57,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:30:57,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:30:57,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:57,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:30:57,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:57,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:57,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:57,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:30:57,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:30:57,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:30:57,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:30:57,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:30:57,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:30:57,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:57,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:30:57,585 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:57,585 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:57,585 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:57,585 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:30:57,586 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:30:57,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:30:57,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:30:57,590 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:30:57,591 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:57,592 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:57,592 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:30:57,594 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 45/400.
2025-08-04 20:30:57,695 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:57,696 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:57,697 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 228 anomalous samples to GAN training data (target: 228).
2025-08-04 20:30:57,698 - ClientAppLogger [Client 2] - INFO - [Client] Round 45: Training GAN with 988 samples (760 normal, 228 anomalous).
2025-08-04 20:30:57,698 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:58,453 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0859, Avg D Loss: 0.8817
2025-08-04 20:30:58,453 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0859, Avg D Loss: 0.8817
2025-08-04 20:30:58,453 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:58,462 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3434, Threshold=0.3610, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:30:58,462 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:30:58,462 - ClientAppLogger [Client 2] - INFO - Fit completed for round 45. Duration: 0.87s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 45, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085914189516291, 'd_loss': 0.8817477933308373, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.8680052757263184, 'cpu_percent_fit': 31.14375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 988}
2025-08-04 20:30:58,462 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:31:03,724 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:03,724 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:03,725 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:03,725 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:31:03,725 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:31:03,725 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:03,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:03,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:04,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:31:04,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:31:04,109 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:04,209 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:04,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:04,215 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:04,221 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:31:04,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:04,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:31:04,245 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:04,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:04,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:31:04,256 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:04,259 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:04,261 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:04,263 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:04,266 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:04,268 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:04,270 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:04,273 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:04,276 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:04,278 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:04,280 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:04,289 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:04,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:31:04,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:31:04,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:31:04,300 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:04,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:31:04,310 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:04,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:31:04,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:04,326 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:04,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:31:04,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:31:04,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:04,336 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:04,336 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:04,337 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:04,337 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:04,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:31:04,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:04,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:31:04,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:04,339 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:31:04,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:31:04,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:04,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:31:04,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:04,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:04,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:04,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:31:04,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:31:04,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:31:04,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:31:04,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:31:04,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:31:04,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:31:04,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:31:04,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:31:04,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:31:04,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:31:04,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:31:04,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:04,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:31:04,345 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:04,345 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:04,345 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:04,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:31:04,346 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:31:04,346 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:31:04,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:31:04,353 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:31:04,354 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:04,355 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:04,355 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:04,357 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:04,357 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:04,357 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:04,358 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:04,369 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3430, Threshold=0.3606, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:31:04,369 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3430
2025-08-04 20:31:15,633 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:15,633 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:15,633 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:15,634 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:31:15,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:31:15,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:15,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:15,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:15,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:31:16,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:31:16,025 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:16,121 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:16,126 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:16,126 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:16,132 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:31:16,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:16,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:31:16,151 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:16,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:16,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:31:16,159 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:16,162 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:16,165 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:16,167 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:16,169 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:16,172 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:16,174 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:16,177 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:16,179 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:16,181 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:16,183 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:16,192 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:16,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:31:16,196 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:31:16,197 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:31:16,200 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:16,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:31:16,209 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:16,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:31:16,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:16,224 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:16,228 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:31:16,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:31:16,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:16,234 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:16,234 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:16,234 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:16,234 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:16,235 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:31:16,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:16,235 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:31:16,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:16,236 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:31:16,236 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:31:16,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:16,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:31:16,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:16,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:16,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:16,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:31:16,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:31:16,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:31:16,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:31:16,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:31:16,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:31:16,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:16,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:31:16,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:16,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:16,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:16,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:31:16,242 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:31:16,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:31:16,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:31:16,247 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:31:16,247 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:16,249 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:16,249 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:16,250 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 46/400.
2025-08-04 20:31:16,351 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:16,352 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:16,353 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 233 anomalous samples to GAN training data (target: 233).
2025-08-04 20:31:16,353 - ClientAppLogger [Client 2] - INFO - [Client] Round 46: Training GAN with 1010 samples (777 normal, 233 anomalous).
2025-08-04 20:31:16,353 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:17,128 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0861, Avg D Loss: 0.8789
2025-08-04 20:31:17,128 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0861, Avg D Loss: 0.8789
2025-08-04 20:31:17,129 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:17,137 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3455, Threshold=0.3634, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:31:17,137 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:31:17,137 - ClientAppLogger [Client 2] - INFO - Fit completed for round 46. Duration: 0.89s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 46, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.086068839932432, 'd_loss': 0.878895933061543, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.8862123489379883, 'cpu_percent_fit': 29.4375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1010}
2025-08-04 20:31:17,137 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:31:22,418 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:22,418 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:22,418 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:22,418 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:31:22,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:31:22,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:22,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:22,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:22,787 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:31:22,816 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:31:22,816 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:22,915 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:22,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:22,920 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:22,926 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:31:22,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:22,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:31:22,935 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:22,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:22,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:31:22,944 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:22,947 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,949 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:22,951 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:22,954 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:22,956 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:22,959 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,961 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:22,964 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:22,966 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:22,969 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:22,978 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:22,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:31:22,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:31:22,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:31:22,990 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:22,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:31:23,000 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:23,000 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:31:23,000 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:23,017 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:23,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:31:23,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:31:23,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:23,027 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:23,027 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:23,028 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:23,028 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:23,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:31:23,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:23,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:31:23,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:23,030 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:31:23,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:31:23,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:23,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:31:23,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:23,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:23,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:23,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:31:23,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:31:23,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:31:23,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:31:23,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:31:23,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:31:23,033 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:31:23,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:31:23,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:31:23,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:31:23,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:31:23,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:31:23,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:23,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:31:23,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:23,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:23,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:23,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:31:23,035 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:31:23,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:31:23,036 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:31:23,039 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:31:23,039 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:23,040 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:23,041 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:23,042 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:23,042 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:23,042 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:23,043 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:23,051 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3452, Threshold=0.3631, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:31:23,051 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3452
2025-08-04 20:31:34,319 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:34,319 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:34,319 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:34,320 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:31:34,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:31:34,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:34,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:34,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:34,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:31:34,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:31:34,737 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:34,837 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:34,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:34,842 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:34,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:31:34,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:34,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:31:34,859 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:34,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:34,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:31:34,870 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:34,873 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,875 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:34,877 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:34,880 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:34,883 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:34,885 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,888 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:34,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:34,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:34,895 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:34,906 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:34,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:31:34,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:31:34,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:31:34,917 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:34,919 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:31:34,928 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:34,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:31:34,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:34,944 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:34,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:31:34,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:31:34,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:34,954 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:34,954 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:34,954 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:34,954 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:34,955 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:31:34,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:34,955 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:31:34,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:34,957 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:31:34,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:31:34,957 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:34,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:31:34,957 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:34,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:34,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:34,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:31:34,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:31:34,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:31:34,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:31:34,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:31:34,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:31:34,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:34,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:31:34,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:31:34,966 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:31:34,966 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:34,967 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:34,967 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:34,969 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:34,969 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:34,969 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:34,969 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:34,977 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3248, Threshold=0.3415, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:31:34,977 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3248
2025-08-04 20:31:40,263 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:40,264 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:40,264 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:40,264 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:31:40,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:31:40,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:40,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:40,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:40,604 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:31:40,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:31:40,625 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:40,711 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:40,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:40,716 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:40,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:31:40,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:40,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:31:40,727 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:40,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:40,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:31:40,736 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:40,739 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:40,742 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:40,744 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:40,746 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:40,749 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:40,751 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:40,754 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:40,756 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:40,758 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:40,760 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:40,769 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:40,769 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:31:40,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:31:40,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:31:40,778 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:40,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:31:40,788 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:40,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:31:40,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:40,803 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:40,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:31:40,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:31:40,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:40,813 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:40,813 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:40,813 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:40,814 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:40,814 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:31:40,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:40,814 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:31:40,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:40,816 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:40,817 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:31:40,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:31:40,817 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:31:40,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:31:40,817 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:31:40,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:31:40,818 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:31:40,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:31:40,819 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:31:40,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:31:40,819 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:31:40,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:31:40,819 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:40,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:31:40,820 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:40,820 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:40,820 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:40,820 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:31:40,820 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:31:40,821 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:31:40,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:31:40,824 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:31:40,825 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:40,826 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:40,826 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:40,827 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 48/400.
2025-08-04 20:31:40,928 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:40,928 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:40,930 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 244 anomalous samples to GAN training data (target: 244).
2025-08-04 20:31:40,930 - ClientAppLogger [Client 2] - INFO - [Client] Round 48: Training GAN with 1059 samples (815 normal, 244 anomalous).
2025-08-04 20:31:40,930 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:41,728 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0869, Avg D Loss: 0.8810
2025-08-04 20:31:41,728 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0869, Avg D Loss: 0.8810
2025-08-04 20:31:41,729 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:41,736 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3450, Threshold=0.3642, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:31:41,736 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:31:41,737 - ClientAppLogger [Client 2] - INFO - Fit completed for round 48. Duration: 0.91s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 48, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0868905133183437, 'd_loss': 0.881043490190569, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.9094738960266113, 'cpu_percent_fit': 31.15625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1059}
2025-08-04 20:31:41,737 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:31:46,997 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:46,998 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:31:46,998 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:31:46,998 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:31:46,998 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:31:46,998 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:47,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:47,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:47,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:31:47,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:31:47,357 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:47,446 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:47,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:47,453 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:47,458 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:31:47,468 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:47,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:31:47,469 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:47,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:47,470 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:31:47,478 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:47,481 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:47,483 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:47,486 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:47,488 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:47,491 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:47,493 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:47,496 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:47,498 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:47,500 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:47,503 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:47,511 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:47,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:31:47,516 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:31:47,516 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:31:47,521 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:47,521 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:31:47,530 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:47,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:31:47,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:47,545 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:47,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:31:47,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:31:47,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:47,555 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:47,555 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:47,555 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:47,556 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:47,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:31:47,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:47,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:31:47,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:47,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:31:47,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:31:47,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:47,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:31:47,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:47,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:31:47,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:31:47,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:31:47,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:31:47,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:31:47,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:31:47,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:31:47,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:31:47,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:47,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:31:47,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:47,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:47,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:47,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:31:47,562 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:31:47,563 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:31:47,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:31:47,567 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:31:47,567 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:47,568 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:47,569 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:31:47,570 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:47,570 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:47,570 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:47,571 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:47,579 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3445, Threshold=0.3636, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:31:47,579 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3445
2025-08-04 20:32:04,895 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:04,895 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:04,896 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:04,896 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:04,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:04,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:05,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:05,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:05,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:05,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:05,212 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:05,297 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:05,301 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:05,302 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:05,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:05,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:05,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:05,314 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:05,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:05,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:05,323 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:05,326 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:05,328 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:05,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:05,333 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:05,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:05,337 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:05,340 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:05,343 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:05,345 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:05,347 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:05,356 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:05,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:05,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:05,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:05,366 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:05,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:05,376 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:05,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:05,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:05,391 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:05,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:05,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:05,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:05,402 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:05,402 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:05,402 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:05,402 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:05,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:05,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:05,403 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:05,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:05,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:05,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:05,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:05,406 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:05,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:05,406 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:05,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:05,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:05,408 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:05,408 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:05,408 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:05,408 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:05,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:05,409 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:05,409 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:05,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:05,411 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:05,411 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:05,412 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:05,413 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:05,414 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:05,414 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:05,414 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:05,415 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:05,423 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3477, Threshold=0.3722, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:05,423 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3477
2025-08-04 20:32:10,693 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:10,693 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:10,693 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:10,693 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:10,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:10,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:10,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:10,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:10,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:11,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:11,023 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:11,110 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:11,115 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:11,115 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:11,122 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:11,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:11,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:11,129 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:11,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:11,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:11,138 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:11,141 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:11,143 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:11,145 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:11,148 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:11,151 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:11,153 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:11,156 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:11,159 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:11,160 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:11,163 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:11,171 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:11,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:11,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:11,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:11,181 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:11,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:11,188 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:11,189 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:11,189 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:11,204 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:11,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:11,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:11,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:11,213 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:11,213 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:11,214 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:11,214 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:11,214 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:11,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:11,215 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:11,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:11,216 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:11,216 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:11,216 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:11,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:11,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:11,218 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:11,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:11,219 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:11,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:11,219 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:11,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:11,219 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:11,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:11,220 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:11,220 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:11,220 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:11,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:11,221 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:11,221 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:11,221 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:11,225 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:11,225 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:11,226 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:11,226 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:11,228 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 50/400.
2025-08-04 20:32:11,329 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:11,329 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:11,330 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 255 anomalous samples to GAN training data (target: 255).
2025-08-04 20:32:11,330 - ClientAppLogger [Client 2] - INFO - [Client] Round 50: Training GAN with 1108 samples (853 normal, 255 anomalous).
2025-08-04 20:32:11,331 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:12,115 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0858, Avg D Loss: 0.8791
2025-08-04 20:32:12,116 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0858, Avg D Loss: 0.8791
2025-08-04 20:32:12,116 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:12,124 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3414, Threshold=0.3644, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:12,124 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:32:12,124 - ClientAppLogger [Client 2] - INFO - Fit completed for round 50. Duration: 0.90s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 50, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0858466912693063, 'd_loss': 0.8790649159720658, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.8961803913116455, 'cpu_percent_fit': 31.1875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1108}
2025-08-04 20:32:12,124 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:32:17,386 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:17,386 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:17,387 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:17,387 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:17,387 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:17,387 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:17,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:17,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:17,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:17,767 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:17,767 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:17,858 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:17,863 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:17,864 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:17,873 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:17,881 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:17,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:17,882 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:17,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:17,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:17,891 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:17,894 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:17,896 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:17,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:17,901 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:17,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:17,906 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:17,908 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:17,911 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:17,913 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:17,915 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:17,925 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:17,925 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:17,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:17,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:17,935 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:17,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:17,943 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:17,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:17,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:17,960 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:17,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:17,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:17,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:17,970 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:17,970 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:17,971 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:17,971 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:17,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:17,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:17,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:17,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:17,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:17,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:17,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:17,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:17,975 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:17,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:17,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:17,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:17,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:17,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:17,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:17,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:17,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:17,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:17,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:17,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:17,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:17,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:17,979 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:17,979 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:17,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:17,984 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:17,984 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:17,986 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:17,986 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:17,988 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:17,989 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:17,989 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:17,990 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:17,998 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3416, Threshold=0.3647, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:17,998 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3416
2025-08-04 20:32:23,257 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:23,257 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:23,258 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:23,258 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:23,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:23,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:23,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:23,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:23,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:23,614 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:23,614 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:23,700 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:23,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:23,705 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:23,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:23,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:23,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:23,719 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:23,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:23,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:23,727 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:23,730 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:23,733 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:23,735 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:23,738 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:23,740 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:23,742 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:23,745 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:23,747 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:23,749 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:23,751 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:23,760 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:23,760 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:23,765 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:23,765 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:23,769 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:23,769 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:23,777 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:23,778 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:23,778 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:23,793 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:23,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:23,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:23,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:23,803 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:23,803 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:23,803 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:23,803 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:23,804 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:23,804 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:23,804 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:23,804 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:23,805 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:23,806 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:23,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:23,806 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:23,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:23,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:23,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:23,807 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:23,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:23,807 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:23,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:23,807 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:23,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:23,808 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:23,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:23,808 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:23,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:23,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:23,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:23,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:23,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:23,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:23,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:23,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:23,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:23,810 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:23,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:23,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:23,814 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:23,814 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:23,815 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:23,815 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:23,817 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 51/400.
2025-08-04 20:32:23,918 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:23,918 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:23,919 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 261 anomalous samples to GAN training data (target: 261).
2025-08-04 20:32:23,919 - ClientAppLogger [Client 2] - INFO - [Client] Round 51: Training GAN with 1131 samples (870 normal, 261 anomalous).
2025-08-04 20:32:23,920 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:24,750 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0860, Avg D Loss: 0.8709
2025-08-04 20:32:24,751 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0860, Avg D Loss: 0.8709
2025-08-04 20:32:24,751 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:24,759 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3488, Threshold=0.3745, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:24,759 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:32:24,759 - ClientAppLogger [Client 2] - INFO - Fit completed for round 51. Duration: 0.94s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 51, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085964353352284, 'd_loss': 0.8708580902411176, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.9422433376312256, 'cpu_percent_fit': 31.19375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1131}
2025-08-04 20:32:24,759 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:32:30,022 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:30,022 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:30,022 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:30,023 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:30,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:30,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:30,318 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:30,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:30,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:30,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:30,434 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:30,543 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:30,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:30,550 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:30,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:30,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:30,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:30,578 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:30,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:30,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:30,586 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:30,589 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,591 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:30,593 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:30,596 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:30,598 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:30,601 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,603 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:30,606 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:30,608 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:30,610 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:30,621 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:30,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:30,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:30,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:30,631 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:30,631 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:30,640 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:30,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:30,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:30,656 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:30,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:30,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:30,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:30,665 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:30,666 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:30,666 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:30,666 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:30,666 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:30,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:30,667 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:30,667 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:30,668 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:30,668 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:30,668 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:30,668 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:30,669 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:30,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:30,670 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:30,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:30,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:30,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:30,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:30,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:30,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:30,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:30,672 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:30,672 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:30,673 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:30,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:30,673 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:30,673 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:30,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:30,682 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:30,682 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:30,683 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:30,683 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:30,684 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:30,684 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:30,684 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:30,685 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:30,693 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3488, Threshold=0.3745, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:30,693 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3488
2025-08-04 20:32:38,944 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:38,944 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:38,944 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:38,944 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:38,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:38,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:39,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:39,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:39,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:39,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:39,288 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:39,367 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:39,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:39,372 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:39,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:39,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:39,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:39,387 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:39,387 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:39,387 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:39,395 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:39,398 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:39,400 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:39,402 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:39,405 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:39,407 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:39,409 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:39,412 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:39,415 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:39,416 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:39,419 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:39,427 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:39,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:39,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:39,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:39,436 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:39,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:39,444 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:39,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:39,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:39,460 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:39,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:39,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:39,470 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:39,470 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:39,470 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:39,471 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:39,471 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:39,471 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:39,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:39,472 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:39,472 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:39,473 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:39,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:39,474 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:39,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:39,474 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:39,474 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:39,475 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:39,475 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:39,475 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:39,475 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:39,475 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:39,475 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:39,476 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:39,477 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:39,477 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:39,477 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:39,477 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:39,477 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:39,478 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:39,478 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:39,478 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:39,478 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:39,478 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:39,479 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:39,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:39,479 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:39,479 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:39,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:39,482 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:39,482 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:39,483 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:39,483 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:39,485 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 52/400.
2025-08-04 20:32:39,586 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:39,586 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:39,587 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 266 anomalous samples to GAN training data (target: 266).
2025-08-04 20:32:39,588 - ClientAppLogger [Client 2] - INFO - [Client] Round 52: Training GAN with 1155 samples (889 normal, 266 anomalous).
2025-08-04 20:32:39,588 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:40,454 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0859, Avg D Loss: 0.8681
2025-08-04 20:32:40,454 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0859, Avg D Loss: 0.8681
2025-08-04 20:32:40,454 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:40,462 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3598, Threshold=0.3877, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:40,462 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:32:40,462 - ClientAppLogger [Client 2] - INFO - Fit completed for round 52. Duration: 0.98s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 52, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0858973674443892, 'd_loss': 0.8680660567345557, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.9776339530944824, 'cpu_percent_fit': 31.1625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1155}
2025-08-04 20:32:40,463 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:32:45,730 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:45,730 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:32:45,731 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:32:45,731 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:32:45,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:32:45,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:45,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:45,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:46,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:32:46,098 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:32:46,098 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:46,213 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:46,222 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:46,222 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:46,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:32:46,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:46,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:32:46,263 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:46,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:46,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:32:46,272 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:46,275 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,278 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:46,280 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:46,283 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:46,286 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:46,289 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,291 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:46,294 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:46,296 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:46,299 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:46,318 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:46,318 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:32:46,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:32:46,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:32:46,331 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:46,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:32:46,345 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:46,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:32:46,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:46,362 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:46,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:32:46,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:32:46,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:46,375 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:46,375 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:46,375 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:46,376 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:46,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:32:46,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:46,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:32:46,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:46,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:32:46,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:32:46,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:46,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:32:46,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:46,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:46,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:46,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:32:46,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:32:46,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:32:46,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:32:46,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:32:46,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:32:46,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:32:46,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:32:46,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:32:46,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:32:46,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:32:46,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:32:46,384 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:46,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:32:46,384 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:46,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:46,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:46,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:32:46,385 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:32:46,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:32:46,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:32:46,394 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:32:46,395 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:46,397 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:46,397 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:32:46,399 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:46,399 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:46,399 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:46,400 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:46,409 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3598, Threshold=0.3878, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:32:46,410 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3598
2025-08-04 20:33:03,696 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:03,696 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:03,696 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:03,697 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:03,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:03,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:03,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:03,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:03,999 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:04,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:04,014 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:04,110 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:04,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:04,117 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:04,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:04,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:04,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:04,143 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:04,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:04,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:04,153 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:04,156 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,158 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:04,161 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:04,164 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:04,166 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:04,168 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,171 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:04,174 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:04,176 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:04,179 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:04,188 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:04,189 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:04,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:04,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:04,200 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:04,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:04,210 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:04,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:04,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:04,227 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:04,232 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:04,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:04,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:04,239 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:04,239 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:04,239 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:04,240 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:04,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:04,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:04,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:04,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:04,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:04,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:04,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:04,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:04,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:04,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:04,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:04,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:04,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:04,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:04,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:04,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:04,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:04,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:04,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:04,246 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:04,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:04,246 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:04,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:04,247 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:04,247 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:04,247 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:04,247 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:04,248 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:04,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:04,248 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:04,248 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:04,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:04,251 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:04,251 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:04,253 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:04,253 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:04,254 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:04,255 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:04,255 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:04,255 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:04,263 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3605, Threshold=0.3914, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:04,263 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3605
2025-08-04 20:33:09,514 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:09,514 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:09,514 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:09,514 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:09,514 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:09,514 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:09,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:09,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:09,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:09,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:09,825 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:09,906 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:09,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:09,911 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:09,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:09,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:09,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:09,922 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:09,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:09,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:09,931 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:09,934 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:09,936 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:09,938 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:09,941 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:09,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:09,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:09,948 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:09,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:09,953 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:09,955 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:09,963 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:09,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:09,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:09,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:09,973 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:09,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:09,982 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:09,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:09,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:09,998 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:10,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:10,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:10,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:10,011 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:10,011 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:10,011 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:10,011 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:10,011 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:10,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:10,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:10,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:10,013 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:10,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:10,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:10,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:10,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:10,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:10,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:10,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:10,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:10,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:10,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:10,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:10,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:10,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:10,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:10,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:10,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:10,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:10,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:10,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:10,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:10,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:10,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:10,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:10,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:10,026 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:10,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:10,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:10,028 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:10,028 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:10,029 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:10,030 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:10,031 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 54/400.
2025-08-04 20:33:10,132 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:10,132 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:10,134 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 276 anomalous samples to GAN training data (target: 276).
2025-08-04 20:33:10,134 - ClientAppLogger [Client 2] - INFO - [Client] Round 54: Training GAN with 1199 samples (923 normal, 276 anomalous).
2025-08-04 20:33:10,134 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:11,055 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.8675
2025-08-04 20:33:11,055 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.8675
2025-08-04 20:33:11,056 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:11,063 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3454, Threshold=0.3732, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:11,063 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:33:11,063 - ClientAppLogger [Client 2] - INFO - Fit completed for round 54. Duration: 1.03s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 54, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0845156733446863, 'd_loss': 0.8675340793598085, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.0321929454803467, 'cpu_percent_fit': 31.20625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1199}
2025-08-04 20:33:11,064 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:33:16,334 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:16,335 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:16,335 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:16,335 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:16,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:16,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:16,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:16,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:16,801 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:16,833 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:16,833 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:16,945 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:16,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:16,955 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:16,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:17,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:17,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:17,015 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:17,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:17,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:17,025 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:17,029 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:17,031 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:17,035 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:17,039 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:17,042 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:17,048 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:17,052 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:17,054 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:17,056 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:17,060 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:17,071 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:17,071 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:17,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:17,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:17,082 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:17,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:17,094 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:17,094 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:17,094 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:17,112 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:17,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:17,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:17,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:17,124 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:17,124 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:17,124 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:17,124 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:17,124 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:17,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:17,125 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:17,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:17,126 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:17,126 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:17,127 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:17,128 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:17,128 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:17,128 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:17,128 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:17,129 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:17,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:17,129 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:17,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:17,130 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:17,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:17,130 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:17,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:17,131 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:17,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:17,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:17,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:17,135 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:17,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:17,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:17,140 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:17,141 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:17,142 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:17,142 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:17,144 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:17,144 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:17,144 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:17,145 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:17,155 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3456, Threshold=0.3733, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:17,155 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3456
2025-08-04 20:33:31,478 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:31,478 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:31,478 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:31,478 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:31,478 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:31,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:31,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:31,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:31,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:31,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:31,996 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:32,102 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:32,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:32,111 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:32,122 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:32,139 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:32,140 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:32,140 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:32,140 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:32,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:32,150 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:32,153 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,155 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:32,158 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:32,161 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:32,163 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:32,166 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,168 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:32,171 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:32,174 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:32,176 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:32,187 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:32,187 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:32,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:32,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:32,196 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:32,197 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:32,207 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:32,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:32,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:32,225 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:32,230 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:32,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:32,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:32,237 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:32,237 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:32,238 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:32,238 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:32,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:32,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:32,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:32,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:32,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:32,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:32,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:32,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:32,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:32,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:32,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:32,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:32,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:32,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:32,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:32,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:32,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:32,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:32,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:32,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:32,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:32,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:32,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:32,246 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:32,246 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:32,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:32,249 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:32,249 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:32,251 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:32,251 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:32,252 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:32,252 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:32,252 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:32,253 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:32,262 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3244, Threshold=0.3472, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:32,262 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3244
2025-08-04 20:33:40,530 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:40,530 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:40,531 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:40,531 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:40,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:40,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:40,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:40,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:40,851 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:40,864 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:40,864 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:40,953 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:40,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:40,958 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:40,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:40,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:40,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:40,968 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:40,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:40,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:40,976 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:40,979 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:40,981 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:40,983 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:40,986 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:40,988 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:40,990 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:40,993 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:40,995 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:40,998 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:41,000 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:41,008 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:41,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:41,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:41,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:41,018 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:41,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:41,029 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:41,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:41,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:41,044 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:41,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:41,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:41,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:41,055 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:41,055 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:41,055 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:41,056 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:41,056 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:41,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:41,056 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:41,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:41,058 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:41,058 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:41,058 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:41,058 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:41,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:41,060 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:41,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:41,060 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:41,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:41,061 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:41,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:41,061 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:41,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:41,061 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:41,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:41,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:41,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:41,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:41,062 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:41,063 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:41,063 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:41,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:41,065 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:41,065 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:41,066 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:41,066 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:41,068 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 56/400.
2025-08-04 20:33:41,169 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:41,169 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:41,170 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 286 anomalous samples to GAN training data (target: 286).
2025-08-04 20:33:41,171 - ClientAppLogger [Client 2] - INFO - [Client] Round 56: Training GAN with 1242 samples (956 normal, 286 anomalous).
2025-08-04 20:33:41,171 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:42,067 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.8666
2025-08-04 20:33:42,067 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.8666
2025-08-04 20:33:42,067 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:42,075 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3609, Threshold=0.3907, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:42,075 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:33:42,075 - ClientAppLogger [Client 2] - INFO - Fit completed for round 56. Duration: 1.01s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 56, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0844259982331748, 'd_loss': 0.8666465333022548, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.007237434387207, 'cpu_percent_fit': 31.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1242}
2025-08-04 20:33:42,075 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:33:47,350 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:47,351 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:47,351 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:47,351 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:47,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:47,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:47,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:47,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:47,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:47,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:47,744 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:47,845 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:47,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:47,855 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:47,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:47,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:47,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:47,870 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:47,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:47,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:47,880 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:47,883 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,885 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:47,887 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:47,890 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:47,892 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:47,894 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,897 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:47,899 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:47,901 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:47,904 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:47,913 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:47,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:47,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:47,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:47,923 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:47,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:47,933 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:47,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:47,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:47,949 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:47,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:47,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:47,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:47,961 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:47,961 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:47,962 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:47,962 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:47,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:47,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:47,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:47,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:47,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:47,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:47,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:47,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:47,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:47,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:47,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:47,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:47,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:47,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:47,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:47,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:47,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:47,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:47,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:47,969 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:47,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:47,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:47,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:47,973 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:47,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:47,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:47,979 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:47,979 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:47,980 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:47,981 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:47,982 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:47,982 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:47,982 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:47,983 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:47,991 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3604, Threshold=0.3900, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:47,992 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3604
2025-08-04 20:33:53,251 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:53,251 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:33:53,251 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:33:53,251 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:33:53,251 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:33:53,251 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:53,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:53,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:53,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:33:53,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:33:53,598 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:53,684 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:53,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:53,689 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:53,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:33:53,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:53,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:33:53,701 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:53,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:53,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:33:53,710 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:53,713 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:53,715 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:53,717 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:53,720 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:53,722 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:53,724 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:53,727 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:53,729 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:53,731 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:53,733 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:53,743 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:53,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:33:53,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:33:53,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:33:53,752 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:53,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:33:53,760 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:53,761 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:33:53,761 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:53,775 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:53,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:33:53,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:33:53,785 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:53,785 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:53,785 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:53,785 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:53,785 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:53,786 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:33:53,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:53,786 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:33:53,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:53,787 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:33:53,787 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:33:53,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:33:53,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:33:53,789 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:33:53,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:33:53,789 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:33:53,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:33:53,790 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:53,794 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:53,794 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:53,794 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:33:53,795 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:33:53,795 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:33:53,795 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:33:53,798 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:33:53,798 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:53,799 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:53,799 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:33:53,801 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 57/400.
2025-08-04 20:33:53,902 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:53,902 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:53,903 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 291 anomalous samples to GAN training data (target: 291).
2025-08-04 20:33:53,907 - ClientAppLogger [Client 2] - INFO - [Client] Round 57: Training GAN with 1262 samples (971 normal, 291 anomalous).
2025-08-04 20:33:53,907 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:54,820 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.8643
2025-08-04 20:33:54,820 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.8643
2025-08-04 20:33:54,820 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:54,828 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3559, Threshold=0.3847, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:33:54,828 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:33:54,828 - ClientAppLogger [Client 2] - INFO - Fit completed for round 57. Duration: 1.03s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 57, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0841567499324, 'd_loss': 0.8642581477218119, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.0276291370391846, 'cpu_percent_fit': 31.10625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1262}
2025-08-04 20:33:54,829 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:34:00,095 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:00,095 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:00,095 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:00,095 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:00,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:00,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:00,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:00,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:00,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:00,462 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:00,462 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:00,545 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:00,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:00,550 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:00,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:00,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:00,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:00,564 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:00,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:00,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:00,573 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:00,576 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:00,578 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:00,580 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:00,582 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:00,585 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:00,587 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:00,589 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:00,592 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:00,594 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:00,596 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:00,604 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:00,604 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:00,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:00,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:00,613 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:00,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:00,622 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:00,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:00,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:00,636 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:00,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:00,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:00,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:00,646 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:00,646 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:00,646 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:00,646 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:00,646 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:00,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:00,647 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:00,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:00,648 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:00,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:00,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:00,650 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:00,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:00,650 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:00,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:00,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:00,652 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:00,652 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:00,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:00,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:00,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:00,656 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:00,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:00,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:00,661 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:00,661 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:00,662 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:00,662 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:00,663 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:00,664 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:00,664 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:00,664 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:00,671 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3560, Threshold=0.3848, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:00,672 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3560
2025-08-04 20:34:05,927 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:05,927 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:05,927 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:05,927 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:05,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:05,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:06,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:06,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:06,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:06,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:06,265 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:06,347 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:06,353 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:06,353 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:06,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:06,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:06,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:06,365 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:06,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:06,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:06,374 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:06,377 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:06,379 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:06,381 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:06,384 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:06,386 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:06,388 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:06,391 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:06,394 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:06,396 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:06,398 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:06,406 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:06,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:06,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:06,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:06,415 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:06,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:06,424 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:06,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:06,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:06,440 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:06,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:06,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:06,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:06,449 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:06,449 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:06,449 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:06,450 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:06,450 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:06,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:06,450 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:06,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:06,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:06,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:06,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:06,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:06,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:06,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:06,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:06,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:06,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:06,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:06,455 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:06,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:06,455 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:06,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:06,455 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:06,459 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:06,459 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:06,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:06,460 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:06,460 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:06,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:06,464 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:06,464 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:06,465 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:06,465 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:06,467 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 58/400.
2025-08-04 20:34:06,567 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:06,567 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:06,568 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 296 anomalous samples to GAN training data (target: 296).
2025-08-04 20:34:06,569 - ClientAppLogger [Client 2] - INFO - [Client] Round 58: Training GAN with 1284 samples (988 normal, 296 anomalous).
2025-08-04 20:34:06,569 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:07,505 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8643
2025-08-04 20:34:07,505 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8643
2025-08-04 20:34:07,506 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:07,513 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3657, Threshold=0.4020, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:07,513 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:34:07,514 - ClientAppLogger [Client 2] - INFO - Fit completed for round 58. Duration: 1.05s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 58, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0840944575372142, 'd_loss': 0.8643357236065968, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.0470054149627686, 'cpu_percent_fit': 31.1, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1284}
2025-08-04 20:34:07,514 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:34:12,763 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:12,763 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:12,763 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:12,763 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:12,764 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:12,764 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:13,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:13,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:13,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:13,103 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:13,103 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:13,201 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:13,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:13,209 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:13,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:13,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:13,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:13,237 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:13,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:13,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:13,247 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:13,250 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:13,252 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:13,254 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:13,257 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:13,260 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:13,263 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:13,265 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:13,268 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:13,270 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:13,272 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:13,282 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:13,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:13,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:13,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:13,292 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:13,293 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:13,301 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:13,301 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:13,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:13,318 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:13,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:13,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:13,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:13,329 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:13,330 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:13,330 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:13,330 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:13,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:13,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:13,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:13,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:13,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:13,332 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:13,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:13,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:13,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:13,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:13,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:13,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:13,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:13,334 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:13,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:13,334 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:13,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:13,336 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:13,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:13,336 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:13,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:13,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:13,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:13,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:13,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:13,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:13,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:13,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:13,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:13,339 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:13,339 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:13,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:13,345 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:13,345 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:13,346 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:13,346 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:13,348 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:13,348 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:13,348 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:13,349 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:13,358 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3655, Threshold=0.4016, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:13,359 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3655
2025-08-04 20:34:18,608 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:18,608 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:18,608 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:18,608 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:18,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:18,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:18,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:18,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:18,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:18,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:18,973 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:19,073 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:19,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:19,079 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:19,085 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:19,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:19,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:19,108 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:19,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:19,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:19,116 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:19,119 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:19,121 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:19,123 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:19,126 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:19,128 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:19,130 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:19,133 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:19,135 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:19,137 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:19,140 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:19,149 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:19,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:19,155 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:19,155 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:19,159 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:19,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:19,170 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:19,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:19,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:19,187 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:19,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:19,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:19,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:19,198 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:19,198 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:19,199 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:19,199 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:19,199 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:19,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:19,200 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:19,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:19,201 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:19,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:19,202 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:19,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:19,202 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:19,202 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:19,202 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:19,202 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:19,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:19,203 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:19,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:19,203 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:19,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:19,205 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:19,206 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:19,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:19,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:19,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:19,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:19,207 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:19,207 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:19,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:19,213 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:19,213 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:19,215 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:19,215 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:19,216 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 59/400.
2025-08-04 20:34:19,317 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:19,318 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:19,319 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 300 anomalous samples to GAN training data (target: 300).
2025-08-04 20:34:19,319 - ClientAppLogger [Client 2] - INFO - [Client] Round 59: Training GAN with 1302 samples (1002 normal, 300 anomalous).
2025-08-04 20:34:19,320 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:20,444 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0840, Avg D Loss: 0.8648
2025-08-04 20:34:20,444 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0840, Avg D Loss: 0.8648
2025-08-04 20:34:20,445 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:20,454 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3608, Threshold=0.3992, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:20,454 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:34:20,455 - ClientAppLogger [Client 2] - INFO - Fit completed for round 59. Duration: 1.24s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 59, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0839604907321485, 'd_loss': 0.8647521206951728, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.2383472919464111, 'cpu_percent_fit': 31.2625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1302}
2025-08-04 20:34:20,455 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:34:28,742 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:28,742 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:28,743 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:28,743 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:28,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:28,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:29,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:29,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:29,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:29,170 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:29,170 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:29,271 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:29,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:29,279 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:29,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:29,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:29,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:29,305 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:29,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:29,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:29,316 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:29,319 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,322 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:29,324 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:29,327 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:29,329 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:29,332 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,336 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:29,339 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:29,342 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:29,345 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:29,357 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:29,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:29,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:29,363 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:29,370 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:29,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:29,380 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:29,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:29,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:29,397 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:29,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:29,408 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:29,408 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:29,408 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:29,408 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:29,409 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:29,409 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:29,409 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:29,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:29,410 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:29,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:29,411 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:29,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:29,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:29,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:29,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:29,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:29,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:29,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:29,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:29,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:29,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:29,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:29,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:29,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:29,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:29,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:29,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:29,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:29,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:29,417 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:29,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:29,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:29,422 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:29,422 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:29,423 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:29,423 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:29,425 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:29,425 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:29,425 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:29,426 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:29,435 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3621, Threshold=0.4002, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:29,435 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3621
2025-08-04 20:34:40,728 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,728 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:40,728 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:40,728 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:40,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:40,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:41,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:41,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:41,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:41,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:41,180 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:41,296 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:41,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:41,306 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:41,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:41,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:41,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:41,342 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:41,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:41,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:41,352 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:41,355 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,357 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:41,360 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:41,362 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:41,365 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:41,367 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,370 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:41,373 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:41,375 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:41,377 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:41,388 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:41,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:41,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:41,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:41,400 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:41,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:41,414 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:41,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:41,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:41,434 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:41,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:41,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:41,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:41,453 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:41,453 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:41,453 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:41,453 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:41,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:41,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:41,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:41,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:41,456 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:41,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:41,456 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:41,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:41,457 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:41,457 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:41,457 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:41,457 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:41,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:41,458 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:41,458 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:41,458 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:41,458 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:41,460 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:41,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:41,460 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:41,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:41,461 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:41,461 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:41,461 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:41,461 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:41,462 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:41,465 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:41,465 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:41,466 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:41,466 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:41,466 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:41,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:41,475 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:41,477 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:41,479 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:41,479 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:41,481 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:41,481 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:41,481 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:41,482 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:41,491 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3534, Threshold=0.3885, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:41,491 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3534
2025-08-04 20:34:52,792 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:52,793 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:34:52,793 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:34:52,793 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:34:52,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:34:52,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:53,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:53,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:53,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:34:53,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:34:53,278 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:53,411 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:53,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:53,424 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:53,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:34:53,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:53,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:34:53,441 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:53,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:53,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:34:53,450 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:53,454 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,457 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:53,460 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:53,464 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:53,468 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:53,471 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,475 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:53,478 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:53,480 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:53,482 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:53,493 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:53,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:34:53,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:34:53,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:34:53,508 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:53,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:34:53,524 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:53,525 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:34:53,525 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:53,544 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:53,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:34:53,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:34:53,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,557 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,558 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,558 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,558 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:34:53,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:34:53,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:34:53,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:34:53,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:34:53,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:34:53,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:34:53,563 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:34:53,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:34:53,564 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:34:53,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:34:53,565 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:34:53,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:34:53,565 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:34:53,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:34:53,565 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:34:53,566 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:34:53,570 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:34:53,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:34:53,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:34:53,575 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:34:53,575 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,577 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,577 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:34:53,578 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,578 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,579 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,579 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,588 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3588, Threshold=0.3932, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:34:53,588 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3588
2025-08-04 20:35:01,846 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:01,846 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:01,846 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:01,846 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:01,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:01,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:02,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:02,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:02,216 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:02,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:02,246 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:02,348 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:02,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:02,354 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:02,360 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:02,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:02,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:02,396 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:02,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:02,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:02,407 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:02,410 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,412 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:02,414 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:02,416 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:02,418 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:02,421 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,423 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:02,426 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:02,428 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:02,430 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:02,440 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:02,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:02,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:02,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:02,452 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:02,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:02,465 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:02,465 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:02,466 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:02,483 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:02,489 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:02,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:02,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:02,495 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:02,495 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:02,495 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:02,496 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:02,496 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:02,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:02,496 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:02,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:02,498 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:02,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:02,498 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:02,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:02,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:02,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:02,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:02,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:02,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:02,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:02,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:02,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:02,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:02,503 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:02,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:02,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:02,506 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:02,507 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:02,508 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:02,508 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:02,510 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 62/400.
2025-08-04 20:35:02,612 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:02,612 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:02,613 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 314 anomalous samples to GAN training data (target: 314).
2025-08-04 20:35:02,614 - ClientAppLogger [Client 2] - INFO - [Client] Round 62: Training GAN with 1363 samples (1049 normal, 314 anomalous).
2025-08-04 20:35:02,614 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:03,644 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0840, Avg D Loss: 0.8619
2025-08-04 20:35:03,644 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0840, Avg D Loss: 0.8619
2025-08-04 20:35:03,644 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:03,652 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3609, Threshold=0.4005, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:03,652 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:35:03,652 - ClientAppLogger [Client 2] - INFO - Fit completed for round 62. Duration: 1.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 62, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083950305159968, 'd_loss': 0.8618816377175527, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.1422090530395508, 'cpu_percent_fit': 31.16875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1363}
2025-08-04 20:35:03,653 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:35:08,936 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:08,937 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:08,937 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:08,937 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:08,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:08,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:09,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:09,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:09,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:09,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:09,312 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:09,395 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:09,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:09,401 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:09,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:09,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:09,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:09,413 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:09,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:09,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:09,421 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:09,424 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:09,426 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:09,428 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:09,431 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:09,433 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:09,436 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:09,439 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:09,441 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:09,443 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:09,446 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:09,453 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:09,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:09,458 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:09,459 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:09,463 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:09,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:09,471 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:09,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:09,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:09,486 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:09,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:09,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:09,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:09,496 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:09,496 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:09,496 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:09,497 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:09,497 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:09,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:09,497 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:09,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:09,498 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:09,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:09,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:09,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:09,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:09,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:09,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:09,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:09,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:09,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:09,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:09,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:09,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:09,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:09,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:09,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:09,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:09,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:09,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:09,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:09,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:09,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:09,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:09,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:09,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:09,503 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:09,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:09,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:09,507 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:09,507 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:09,508 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:09,508 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:09,510 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:09,510 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:09,510 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:09,511 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:09,518 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3646, Threshold=0.4043, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:09,518 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3646
2025-08-04 20:35:20,783 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:20,783 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:20,783 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:20,784 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:20,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:20,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:21,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:21,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:21,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:21,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:21,181 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:21,267 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:21,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:21,273 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:21,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:21,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:21,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:21,288 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:21,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:21,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:21,297 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:21,299 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:21,301 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:21,303 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:21,306 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:21,308 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:21,311 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:21,313 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:21,316 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:21,318 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:21,320 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:21,328 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:21,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:21,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:21,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:21,338 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:21,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:21,346 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:21,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:21,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:21,361 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:21,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:21,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:21,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:21,371 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:21,371 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:21,371 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:21,372 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:21,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:21,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:21,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:21,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:21,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:21,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:21,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:21,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:21,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:21,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:21,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:21,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:21,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:21,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:21,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:21,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:21,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:21,378 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:21,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:21,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:21,382 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:21,382 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:21,383 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:21,384 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:21,385 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:21,385 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:21,385 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:21,386 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:21,393 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3810, Threshold=0.4211, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:21,394 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3810
2025-08-04 20:35:26,641 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:26,641 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:26,641 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:26,641 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:26,642 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:26,642 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:26,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:26,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:26,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:26,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:26,984 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:27,072 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:27,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:27,077 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:27,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:27,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:27,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:27,090 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:27,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:27,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:27,099 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:27,102 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:27,104 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:27,106 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:27,109 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:27,111 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:27,113 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:27,116 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:27,118 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:27,120 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:27,122 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:27,131 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:27,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:27,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:27,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:27,140 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:27,140 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:27,148 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:27,148 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:27,148 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:27,164 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:27,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:27,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:27,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:27,174 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:27,174 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:27,174 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:27,174 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:27,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:27,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:27,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:27,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:27,176 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:27,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:27,177 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:27,177 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:27,177 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:27,177 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:27,178 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:27,178 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:27,178 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:27,178 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:27,178 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:27,178 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:27,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:27,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:27,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:27,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:27,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:27,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:27,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:27,181 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:27,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:27,181 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:27,181 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:27,182 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:27,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:27,182 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:27,182 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:27,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:27,186 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:27,186 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:27,187 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:27,187 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:27,189 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 64/400.
2025-08-04 20:35:27,289 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:27,290 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:27,291 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 326 anomalous samples to GAN training data (target: 326).
2025-08-04 20:35:27,291 - ClientAppLogger [Client 2] - INFO - [Client] Round 64: Training GAN with 1415 samples (1089 normal, 326 anomalous).
2025-08-04 20:35:27,292 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:28,284 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.8642
2025-08-04 20:35:28,285 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.8642
2025-08-04 20:35:28,285 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:28,292 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3524, Threshold=0.3923, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:28,292 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:35:28,293 - ClientAppLogger [Client 2] - INFO - Fit completed for round 64. Duration: 1.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 64, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0838288671978793, 'd_loss': 0.8642363757884965, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.1041011810302734, 'cpu_percent_fit': 31.2125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1415}
2025-08-04 20:35:28,293 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:35:33,544 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:33,544 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:33,544 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:33,545 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:33,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:33,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:33,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:33,799 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:33,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:33,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:33,911 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:34,004 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:34,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:34,009 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:34,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:34,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:34,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:34,026 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:34,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:34,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:34,035 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:34,038 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:34,041 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:34,043 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:34,046 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:34,048 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:34,050 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:34,053 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:34,055 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:34,057 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:34,060 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:34,069 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:34,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:34,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:34,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:34,079 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:34,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:34,088 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:34,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:34,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:34,104 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:34,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:34,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:34,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:34,116 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:34,117 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:34,117 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:34,117 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:34,117 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:34,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:34,118 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:34,118 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:34,119 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:34,119 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:34,120 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:34,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:34,121 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:34,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:34,123 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:34,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:34,123 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:34,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:34,123 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:34,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:34,124 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:34,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:34,124 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:34,124 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:34,125 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:34,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:34,125 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:34,125 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:34,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:34,130 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:34,130 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:34,131 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:34,131 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:34,133 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:34,133 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:34,133 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:34,134 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:34,142 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3528, Threshold=0.3928, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:34,142 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3528
2025-08-04 20:35:39,397 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:39,397 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:39,398 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:39,398 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:39,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:39,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:39,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:39,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:39,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:39,754 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:39,755 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:39,839 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:39,843 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:39,843 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:39,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:39,861 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:39,861 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:39,862 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:39,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:39,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:39,870 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:39,873 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:39,875 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:39,877 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:39,880 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:39,882 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:39,884 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:39,887 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:39,889 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:39,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:39,893 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:39,901 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:39,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:39,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:39,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:39,910 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:39,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:39,919 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:39,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:39,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:39,934 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:39,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:39,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:39,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:39,944 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:39,944 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:39,944 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:39,944 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:39,945 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:39,945 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:39,945 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:39,945 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:39,946 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:39,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:39,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:39,948 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:39,948 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:39,949 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:39,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:39,949 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:39,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:39,949 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:39,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:39,950 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:39,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:39,950 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:39,950 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:39,950 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:39,951 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:39,951 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:39,951 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:39,951 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:39,955 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:39,955 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:39,957 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:39,957 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:39,958 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 65/400.
2025-08-04 20:35:40,059 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:40,059 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:40,060 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 333 anomalous samples to GAN training data (target: 333).
2025-08-04 20:35:40,060 - ClientAppLogger [Client 2] - INFO - [Client] Round 65: Training GAN with 1444 samples (1111 normal, 333 anomalous).
2025-08-04 20:35:40,060 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:41,137 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.8634
2025-08-04 20:35:41,137 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.8634
2025-08-04 20:35:41,137 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:41,145 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3672, Threshold=0.4112, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:41,145 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:35:41,146 - ClientAppLogger [Client 2] - INFO - Fit completed for round 65. Duration: 1.19s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 65, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0835278074497006, 'd_loss': 0.8634006956112351, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.1874639987945557, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1444}
2025-08-04 20:35:41,146 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:35:46,409 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:46,409 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:46,409 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:46,409 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:46,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:46,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:46,675 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:46,675 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:46,762 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:46,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:46,788 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:46,886 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:46,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:46,893 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:46,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:46,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:46,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:46,908 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:46,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:46,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:46,918 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:46,921 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,923 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:46,926 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:46,928 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:46,931 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:46,933 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:46,936 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:46,939 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:46,940 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:46,943 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:46,953 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:46,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:46,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:46,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:46,964 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:46,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:46,975 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:46,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:46,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:46,992 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:46,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:47,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:47,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:47,002 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:47,002 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:47,002 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:47,003 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:47,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:47,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:47,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:47,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:47,005 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:47,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:47,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:47,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:47,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:47,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:47,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:47,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:47,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:47,007 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:47,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:47,007 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:47,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:47,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:47,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:47,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:47,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:47,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:47,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:47,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:47,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:47,010 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:47,010 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:47,010 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:47,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:47,011 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:47,011 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:47,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:47,016 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:47,016 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:47,017 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:47,017 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:47,019 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:47,019 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:47,019 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:47,020 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:47,028 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3669, Threshold=0.4108, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:47,028 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3669
2025-08-04 20:35:58,303 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:58,303 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:35:58,303 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:35:58,303 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:35:58,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:35:58,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:58,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:58,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:58,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:35:58,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:35:58,666 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:58,754 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:58,760 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:58,760 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:58,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:35:58,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:58,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:35:58,776 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:58,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:58,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:35:58,785 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:58,788 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:58,790 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:58,792 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:58,795 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:58,797 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:58,799 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:58,802 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:58,804 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:58,806 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:58,808 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:58,817 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:58,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:35:58,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:35:58,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:35:58,826 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:58,826 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:35:58,836 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:58,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:35:58,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:58,852 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:58,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:35:58,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:35:58,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:58,863 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:58,863 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:58,863 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:58,863 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:58,863 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:35:58,863 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:58,864 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:35:58,864 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:58,865 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:35:58,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:35:58,866 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:58,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:35:58,866 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:58,866 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:58,866 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:58,866 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:35:58,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:35:58,867 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:35:58,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:35:58,867 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:35:58,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:35:58,868 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:35:58,868 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:35:58,868 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:35:58,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:35:58,869 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:35:58,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:35:58,869 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:58,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:35:58,870 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:58,873 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:58,873 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:58,873 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:35:58,873 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:35:58,873 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:35:58,873 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:35:58,878 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:35:58,878 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:58,879 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:58,880 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:35:58,881 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:58,881 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:58,882 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:58,883 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:58,892 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3780, Threshold=0.4220, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:35:58,892 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3780
2025-08-04 20:36:16,189 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:16,189 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:16,189 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:16,190 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:36:16,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:36:16,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:16,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:16,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:16,518 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:36:16,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:36:16,545 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:16,636 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:16,640 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:16,640 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:16,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:36:16,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:16,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:36:16,658 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:16,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:16,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:36:16,667 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:16,670 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:16,672 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:16,674 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:16,676 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:16,678 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:16,681 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:16,683 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:16,686 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:16,687 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:16,690 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:16,699 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:16,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:36:16,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:36:16,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:36:16,707 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:16,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:36:16,715 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:16,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:36:16,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:16,730 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:16,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:36:16,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:36:16,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:16,740 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:16,740 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:16,740 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:16,740 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:16,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:36:16,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:16,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:36:16,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:16,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:36:16,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:36:16,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:16,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:36:16,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:16,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:16,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:16,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:36:16,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:36:16,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:36:16,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:36:16,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:36:16,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:36:16,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:36:16,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:36:16,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:36:16,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:36:16,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:36:16,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:36:16,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:16,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:36:16,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:16,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:16,747 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:16,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:36:16,747 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:36:16,747 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:36:16,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:36:16,751 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:36:16,751 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:16,752 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:16,752 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:16,754 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:16,754 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:16,754 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:16,755 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:16,762 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3616, Threshold=0.4008, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:36:16,762 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3616
2025-08-04 20:36:22,007 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:22,008 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:22,008 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:22,008 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:36:22,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:36:22,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:22,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:22,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:22,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:36:22,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:36:22,342 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:22,431 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:22,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:22,435 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:22,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:36:22,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:22,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:36:22,449 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:22,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:22,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:36:22,458 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:22,461 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:22,462 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:22,465 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:22,467 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:22,469 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:22,472 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:22,474 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:22,477 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:22,478 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:22,481 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:22,489 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:22,489 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:36:22,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:36:22,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:36:22,502 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:22,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:36:22,511 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:22,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:36:22,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:22,526 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:22,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:36:22,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:36:22,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:22,536 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:22,536 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:22,537 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:22,537 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:22,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:36:22,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:22,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:36:22,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:22,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:36:22,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:36:22,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:36:22,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:36:22,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:36:22,541 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:36:22,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:36:22,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:36:22,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:36:22,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:36:22,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:36:22,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:36:22,543 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:36:22,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:22,543 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:36:22,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:22,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:22,544 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:22,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:36:22,544 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:36:22,544 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:36:22,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:36:22,548 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:36:22,548 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:22,550 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:22,550 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:22,552 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 68/400.
2025-08-04 20:36:22,653 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:22,653 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:22,655 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 348 anomalous samples to GAN training data (target: 348).
2025-08-04 20:36:22,655 - ClientAppLogger [Client 2] - INFO - [Client] Round 68: Training GAN with 1511 samples (1163 normal, 348 anomalous).
2025-08-04 20:36:22,655 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:23,761 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0831, Avg D Loss: 0.8608
2025-08-04 20:36:23,761 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0831, Avg D Loss: 0.8608
2025-08-04 20:36:23,761 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:23,769 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3698, Threshold=0.4170, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:36:23,769 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:36:23,769 - ClientAppLogger [Client 2] - INFO - Fit completed for round 68. Duration: 1.22s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 68, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0831142415596426, 'd_loss': 0.8607754231445999, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.2177996635437012, 'cpu_percent_fit': 31.23125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1511}
2025-08-04 20:36:23,770 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:36:29,033 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:29,034 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:29,034 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:29,034 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:36:29,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:36:29,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:29,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:29,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:29,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:36:29,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:36:29,469 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:29,632 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:29,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:29,641 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:29,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:36:29,663 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:29,663 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:36:29,663 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:29,664 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:29,664 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:36:29,675 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:29,679 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,682 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:29,686 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:29,689 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:29,692 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:29,695 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,698 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:29,701 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:29,703 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:29,706 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:29,719 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:29,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:36:29,724 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:36:29,724 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:36:29,730 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:29,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:36:29,741 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:29,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:36:29,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:29,760 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:29,765 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:36:29,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:36:29,772 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:29,772 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:29,772 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:29,772 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:29,772 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:29,773 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:36:29,773 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:29,773 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:36:29,773 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:29,775 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:36:29,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:36:29,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:29,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:36:29,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:29,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:29,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:29,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:36:29,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:36:29,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:36:29,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:36:29,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:36:29,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:36:29,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:36:29,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:36:29,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:36:29,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:36:29,780 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:36:29,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:36:29,780 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:29,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:36:29,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:29,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:29,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:29,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:36:29,782 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:36:29,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:36:29,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:36:29,790 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:36:29,790 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:29,792 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:29,792 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:29,794 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:29,794 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:29,794 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:29,795 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:29,803 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3695, Threshold=0.4165, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:36:29,803 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3695
2025-08-04 20:36:47,088 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:47,088 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:47,088 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:47,089 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:36:47,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:36:47,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:47,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:47,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:47,472 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:36:47,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:36:47,503 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:47,618 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:47,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:47,626 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:47,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:36:47,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:47,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:36:47,646 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:47,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:47,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:36:47,656 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:47,660 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,662 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:47,664 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:47,667 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:47,670 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:47,672 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,675 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:47,677 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:47,679 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:47,682 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:47,692 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:47,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:36:47,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:36:47,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:36:47,702 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:47,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:36:47,718 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:47,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:36:47,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:47,735 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:47,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:36:47,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:36:47,748 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:47,748 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:47,748 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:47,748 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:47,748 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:47,749 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:36:47,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:47,749 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:36:47,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:47,750 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:36:47,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:36:47,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:36:47,752 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:36:47,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:36:47,752 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:36:47,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:36:47,753 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:36:47,753 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:36:47,753 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:36:47,754 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:36:47,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:36:47,754 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:36:47,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:47,754 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:36:47,755 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:47,755 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:47,755 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:47,755 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:36:47,756 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:36:47,756 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:36:47,756 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:36:47,762 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:36:47,763 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:47,764 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:47,764 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:47,765 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:47,765 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:47,766 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:47,766 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:47,774 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3874, Threshold=0.4387, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:36:47,774 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3874
2025-08-04 20:36:53,031 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:53,031 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:36:53,031 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:36:53,031 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:36:53,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:36:53,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:53,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:53,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:53,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:36:53,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:36:53,403 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:53,517 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:53,522 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:53,522 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:53,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:36:53,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:53,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:36:53,561 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:53,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:53,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:36:53,569 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:53,572 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:53,574 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:53,576 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:53,579 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:53,581 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:53,584 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:53,586 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:53,589 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:53,591 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:53,593 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:53,603 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:53,603 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:36:53,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:36:53,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:36:53,613 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:53,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:36:53,626 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:53,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:36:53,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:53,641 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:53,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:36:53,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:36:53,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:53,652 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:53,652 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:53,652 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:53,652 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:36:53,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:36:53,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:53,654 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:36:53,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:36:53,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:53,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:36:53,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:36:53,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:36:53,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:36:53,658 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:36:53,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:36:53,658 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:36:53,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:36:53,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:36:53,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:36:53,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:53,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:36:53,660 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:53,660 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:53,660 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:53,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:36:53,660 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:36:53,661 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:36:53,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:36:53,670 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:36:53,670 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:53,672 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:53,672 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:36:53,673 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 70/400.
2025-08-04 20:36:53,774 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:53,774 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:53,775 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 360 anomalous samples to GAN training data (target: 360).
2025-08-04 20:36:53,776 - ClientAppLogger [Client 2] - INFO - [Client] Round 70: Training GAN with 1561 samples (1201 normal, 360 anomalous).
2025-08-04 20:36:53,776 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:54,943 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.8561
2025-08-04 20:36:54,944 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.8561
2025-08-04 20:36:54,947 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:54,954 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3655, Threshold=0.4169, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:36:54,954 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:36:54,955 - ClientAppLogger [Client 2] - INFO - Fit completed for round 70. Duration: 1.28s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 70, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082987630420736, 'd_loss': 0.8560540415551859, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.281430959701538, 'cpu_percent_fit': 31.23125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1561}
2025-08-04 20:36:54,955 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:37:00,210 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:00,210 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:00,210 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:00,210 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:00,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:00,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:00,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:00,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:00,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:00,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:00,654 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:00,844 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:00,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:00,855 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:00,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:00,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:00,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:00,929 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:00,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:00,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:00,939 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:00,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:00,947 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:00,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:00,953 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:00,955 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:00,960 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:00,963 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:00,966 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:00,968 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:00,971 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:00,987 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:00,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:00,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:00,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:01,004 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:01,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:01,027 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:01,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:01,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:01,049 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:01,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:01,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:01,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:01,068 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:01,068 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:01,069 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:01,069 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:01,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:01,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:01,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:01,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:01,072 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:01,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:01,072 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:01,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:01,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:01,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:01,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:01,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:01,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:01,074 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:01,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:01,074 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:01,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:01,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:01,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:01,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:01,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:01,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:01,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:01,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:01,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:01,078 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:01,078 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:01,078 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:01,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:01,079 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:01,079 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:01,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:01,088 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:01,088 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:01,090 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:01,090 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:01,092 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:01,092 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:01,092 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:01,093 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:01,102 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3755, Threshold=0.4316, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:37:01,102 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3755
2025-08-04 20:37:06,349 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:06,349 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:06,349 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:06,349 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:06,350 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:06,350 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:06,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:06,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:06,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:06,720 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:06,720 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:06,826 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:06,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:06,834 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:06,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:06,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:06,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:06,885 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:06,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:06,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:06,894 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:06,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:06,900 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:06,902 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:06,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:06,907 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:06,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:06,912 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:06,915 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:06,917 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:06,920 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:06,932 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:06,932 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:06,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:06,938 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:06,942 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:06,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:06,952 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:06,952 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:06,952 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:06,969 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:06,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:06,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:06,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:06,980 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:06,980 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:06,980 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:06,981 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:06,981 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:06,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:06,981 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:06,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:06,983 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:06,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:06,983 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:06,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:06,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:06,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:06,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:06,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:06,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:06,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:06,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:06,987 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:06,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:06,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:06,993 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:06,993 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:06,994 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:06,995 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:06,996 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 71/400.
2025-08-04 20:37:07,097 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:07,097 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:07,099 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 365 anomalous samples to GAN training data (target: 365).
2025-08-04 20:37:07,100 - ClientAppLogger [Client 2] - INFO - [Client] Round 71: Training GAN with 1582 samples (1217 normal, 365 anomalous).
2025-08-04 20:37:07,100 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:08,307 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0831, Avg D Loss: 0.8580
2025-08-04 20:37:08,307 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0831, Avg D Loss: 0.8580
2025-08-04 20:37:08,307 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:08,316 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3696, Threshold=0.4264, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:37:08,316 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:37:08,316 - ClientAppLogger [Client 2] - INFO - Fit completed for round 71. Duration: 1.32s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 71, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083066592415425, 'd_loss': 0.8580021300749893, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.3203277587890625, 'cpu_percent_fit': 31.1125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1582}
2025-08-04 20:37:08,317 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:37:16,591 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:16,592 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:16,592 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:16,592 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:16,592 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:16,592 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:16,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:16,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:16,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:16,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:16,937 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:17,034 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:17,039 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:17,040 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:17,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:17,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:17,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:17,055 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:17,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:17,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:17,064 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:17,067 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,069 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:17,071 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:17,073 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:17,076 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:17,078 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,080 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:17,083 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:17,085 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:17,088 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:17,097 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:17,097 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:17,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:17,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:17,107 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:17,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:17,115 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:17,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:17,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:17,131 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:17,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:17,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:17,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:17,141 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:17,141 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:17,142 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:17,142 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:17,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:17,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:17,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:17,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:17,144 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:17,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:17,144 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:17,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:17,144 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:17,144 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:17,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:17,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:17,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:17,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:17,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:17,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:17,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:17,148 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:17,148 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:17,148 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:17,148 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:17,148 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:17,149 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:17,149 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:17,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:17,152 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:17,153 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:17,154 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:17,154 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:17,156 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:17,156 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:17,156 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:17,157 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:17,165 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3798, Threshold=0.4397, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:37:17,165 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3798
2025-08-04 20:37:22,414 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:22,414 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:22,414 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:22,414 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:22,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:22,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:22,652 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:22,652 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:22,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:22,756 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:22,756 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:22,838 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:22,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:22,843 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:22,849 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:22,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:22,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:22,859 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:22,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:22,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:22,868 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:22,871 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:22,873 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:22,875 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:22,877 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:22,879 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:22,882 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:22,884 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:22,886 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:22,888 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:22,890 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:22,899 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:22,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:22,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:22,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:22,908 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:22,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:22,916 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:22,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:22,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:22,931 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:22,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:22,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:22,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:22,940 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:22,940 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:22,940 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:22,941 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:22,941 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:22,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:22,941 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:22,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:22,943 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:22,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:22,943 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:22,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:22,943 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:22,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:22,945 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:22,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:22,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:22,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:22,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:22,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:22,948 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:22,948 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:22,948 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:22,951 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:22,952 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:22,953 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:22,953 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:22,954 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 72/400.
2025-08-04 20:37:23,055 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:23,055 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:23,056 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 371 anomalous samples to GAN training data (target: 371).
2025-08-04 20:37:23,057 - ClientAppLogger [Client 2] - INFO - [Client] Round 72: Training GAN with 1609 samples (1238 normal, 371 anomalous).
2025-08-04 20:37:23,057 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:24,250 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8555
2025-08-04 20:37:24,250 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8555
2025-08-04 20:37:24,250 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:24,258 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3561, Threshold=0.4146, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:37:24,258 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:37:24,258 - ClientAppLogger [Client 2] - INFO - Fit completed for round 72. Duration: 1.30s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 72, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083223859814845, 'd_loss': 0.8555122192747626, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 1.3037099838256836, 'cpu_percent_fit': 31.16875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1609}
2025-08-04 20:37:24,258 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:37:29,530 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:29,530 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:29,531 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:29,531 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:29,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:29,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:29,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:29,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:29,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:29,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:29,972 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:30,080 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:30,088 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:30,089 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:30,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:30,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:30,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:30,137 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:30,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:30,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:30,146 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:30,148 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:30,150 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:30,153 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:30,155 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:30,157 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:30,160 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:30,163 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:30,167 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:30,169 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:30,172 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:30,184 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:30,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:30,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:30,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:30,198 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:30,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:30,209 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:30,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:30,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:30,227 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:30,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:30,236 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:30,236 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:30,236 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:30,236 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:30,237 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:30,237 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:30,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:30,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:30,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:30,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:30,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:30,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:30,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:30,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:30,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:30,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:30,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:30,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:30,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:30,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:30,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:30,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:30,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:30,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:30,243 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:30,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:30,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:30,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:30,244 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:30,244 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:30,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:30,250 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:30,251 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:30,252 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:30,252 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:30,254 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:30,254 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:30,254 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:30,255 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:30,262 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3562, Threshold=0.4147, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:37:30,263 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3562
2025-08-04 20:37:35,512 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:35,512 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:35,512 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:35,512 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:35,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:35,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:35,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:35,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:35,856 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:35,879 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:35,879 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:35,971 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:35,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:35,977 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:35,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:35,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:35,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:35,988 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:35,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:35,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:35,997 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:35,999 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:36,002 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:36,004 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:36,007 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:36,009 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:36,011 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:36,014 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:36,016 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:36,018 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:36,020 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:36,030 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:36,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:36,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:36,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:36,049 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:36,050 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:36,050 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:36,064 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:36,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:36,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:36,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:36,073 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:36,073 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:36,073 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:36,074 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:36,074 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:36,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:36,074 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:36,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:36,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:36,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:36,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:36,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:36,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:36,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:36,078 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:36,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:36,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:36,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:36,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:36,080 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:36,081 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:36,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:36,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:36,084 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:36,084 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:36,086 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:36,086 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:36,088 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 73/400.
2025-08-04 20:37:36,188 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:36,188 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:36,189 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 377 anomalous samples to GAN training data (target: 377).
2025-08-04 20:37:36,190 - ClientAppLogger [Client 2] - INFO - [Client] Round 73: Training GAN with 1634 samples (1257 normal, 377 anomalous).
2025-08-04 20:37:36,191 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:37,346 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.8544
2025-08-04 20:37:37,347 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.8544
2025-08-04 20:37:37,347 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:37,354 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3719, Threshold=0.4339, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:37:37,354 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:37:37,355 - ClientAppLogger [Client 2] - INFO - Fit completed for round 73. Duration: 1.27s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 73, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083484506315234, 'd_loss': 0.8544276211296766, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.2668919563293457, 'cpu_percent_fit': 31.2375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1634}
2025-08-04 20:37:37,355 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:37:42,629 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:42,629 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:42,629 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:42,630 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:42,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:42,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:42,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:42,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:42,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:43,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:43,019 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:43,114 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:43,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:43,121 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:43,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:43,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:43,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:43,144 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:43,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:43,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:43,153 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:43,156 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:43,158 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:43,161 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:43,163 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:43,165 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:43,168 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:43,170 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:43,173 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:43,175 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:43,178 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:43,188 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:43,188 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:43,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:43,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:43,198 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:43,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:43,207 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:43,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:43,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:43,223 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:43,228 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:43,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:43,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:43,234 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:43,234 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:43,234 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:43,234 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:43,235 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:43,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:43,235 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:43,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:43,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:43,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:43,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:43,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:43,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:43,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:43,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:43,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:43,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:43,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:43,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:43,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:43,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:43,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:43,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:43,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:43,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:43,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:43,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:43,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:43,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:43,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:43,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:43,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:43,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:43,242 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:43,242 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:43,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:43,247 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:43,247 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:43,249 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:43,249 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:43,250 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:43,251 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:43,251 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:43,251 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:43,259 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3715, Threshold=0.4334, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:37:43,259 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3715
2025-08-04 20:37:48,506 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:48,507 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:48,507 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:48,507 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:48,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:48,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:48,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:48,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:48,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:48,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:48,862 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:48,946 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:48,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:48,950 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:48,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:48,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:48,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:48,965 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:48,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:48,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:48,973 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:48,976 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:48,978 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:48,980 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:48,983 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:48,985 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:48,988 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:48,990 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:48,993 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:48,995 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:48,997 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:49,005 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:49,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:49,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:49,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:49,014 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:49,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:49,023 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:49,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:49,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:49,038 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:49,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:49,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:49,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:49,048 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:49,048 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:49,048 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:49,048 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:49,048 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:49,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:49,049 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:49,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:49,050 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:49,050 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:49,051 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:49,051 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:49,051 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:49,051 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:49,052 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:49,052 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:49,052 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:49,052 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:49,052 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:49,053 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:49,053 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:49,054 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:49,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:49,054 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:49,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:49,054 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:49,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:49,055 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:49,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:49,055 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:49,055 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:49,055 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:49,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:49,056 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:49,056 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:49,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:49,061 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:49,061 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:49,063 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:49,063 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:49,065 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 74/400.
2025-08-04 20:37:49,165 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:49,165 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:49,167 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 380 anomalous samples to GAN training data (target: 380).
2025-08-04 20:37:49,167 - ClientAppLogger [Client 2] - INFO - [Client] Round 74: Training GAN with 1648 samples (1268 normal, 380 anomalous).
2025-08-04 20:37:49,167 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:50,358 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.8537
2025-08-04 20:37:50,358 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.8537
2025-08-04 20:37:50,358 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:50,366 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3771, Threshold=0.4364, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:37:50,366 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:37:50,367 - ClientAppLogger [Client 2] - INFO - Fit completed for round 74. Duration: 1.30s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 74, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083434486852109, 'd_loss': 0.8537381016513675, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.3019688129425049, 'cpu_percent_fit': 31.2125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1648}
2025-08-04 20:37:50,367 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:37:55,641 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:55,641 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:37:55,641 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:37:55,641 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:37:55,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:37:55,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:55,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:55,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:56,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:37:56,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:37:56,070 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:56,169 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:56,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:56,175 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:56,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:37:56,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:56,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:37:56,192 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:56,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:56,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:37:56,201 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:56,204 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,207 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:56,209 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:56,212 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:56,214 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:56,217 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,219 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:56,222 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:56,224 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:56,226 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:56,238 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:56,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:37:56,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:37:56,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:37:56,250 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:56,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:37:56,263 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:56,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:37:56,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:56,280 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:56,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:37:56,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:37:56,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:56,291 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:56,291 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:56,291 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:56,292 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:56,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:37:56,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:56,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:37:56,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:56,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:37:56,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:37:56,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:56,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:37:56,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:56,295 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:56,295 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:56,295 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:37:56,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:37:56,296 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:37:56,296 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:37:56,296 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:37:56,296 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:37:56,297 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:37:56,297 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:37:56,297 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:37:56,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:37:56,298 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:37:56,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:37:56,298 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:56,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:37:56,299 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:56,299 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:56,299 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:56,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:37:56,300 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:37:56,300 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:37:56,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:37:56,304 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:37:56,304 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:56,306 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:56,307 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:37:56,308 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:56,308 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:56,308 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:56,309 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:56,318 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3769, Threshold=0.4363, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:37:56,318 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3769
2025-08-04 20:38:01,568 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:01,568 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:01,568 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:01,568 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:01,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:01,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:01,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:01,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:01,888 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:01,915 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:01,915 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:01,998 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:02,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:02,003 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:02,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:02,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:02,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:02,016 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:02,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:02,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:02,024 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:02,027 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:02,030 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:02,032 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:02,035 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:02,037 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:02,039 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:02,042 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:02,045 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:02,047 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:02,049 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:02,058 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:02,058 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:02,062 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:02,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:02,067 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:02,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:02,075 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:02,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:02,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:02,091 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:02,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:02,101 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:02,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:02,102 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:02,102 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:02,102 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:02,102 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:02,103 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:02,103 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:02,103 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:02,103 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:02,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:02,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:02,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:02,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:02,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:02,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:02,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:02,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:02,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:02,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:02,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:02,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:02,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:02,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:02,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:02,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:02,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:02,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:02,110 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:02,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:02,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:02,113 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:02,113 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:02,115 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:02,115 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:02,116 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 75/400.
2025-08-04 20:38:02,217 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:02,218 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:02,219 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 385 anomalous samples to GAN training data (target: 385).
2025-08-04 20:38:02,219 - ClientAppLogger [Client 2] - INFO - [Client] Round 75: Training GAN with 1669 samples (1284 normal, 385 anomalous).
2025-08-04 20:38:02,220 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:03,475 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8518
2025-08-04 20:38:03,475 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8518
2025-08-04 20:38:03,475 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:03,483 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3775, Threshold=0.4444, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:03,483 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:38:03,484 - ClientAppLogger [Client 2] - INFO - Fit completed for round 75. Duration: 1.37s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 75, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0832312372932185, 'd_loss': 0.8518248413871904, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.3672161102294922, 'cpu_percent_fit': 31.2375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1669}
2025-08-04 20:38:03,484 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:38:08,760 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:08,761 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:08,761 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:08,761 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:08,761 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:08,761 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:09,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:09,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:09,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:09,232 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:09,232 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:09,331 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:09,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:09,339 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:09,360 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:09,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:09,390 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:09,391 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:09,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:09,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:09,401 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:09,404 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,407 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:09,410 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:09,415 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:09,417 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:09,419 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,423 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:09,428 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:09,430 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:09,433 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:09,445 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:09,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:09,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:09,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:09,457 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:09,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:09,470 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:09,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:09,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:09,489 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:09,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:09,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:09,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:09,502 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:09,502 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:09,502 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:09,503 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:09,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:09,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:09,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:09,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:09,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:09,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:09,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:09,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:09,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:09,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:09,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:09,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:09,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:09,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:09,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:09,508 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:09,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:09,509 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:09,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:09,510 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:09,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:09,510 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:09,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:09,511 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:09,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:09,511 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:09,512 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:09,512 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:09,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:09,512 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:09,512 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:09,513 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:09,521 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:09,523 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:09,525 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:09,525 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:09,526 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:09,527 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:09,527 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:09,528 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:09,537 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3774, Threshold=0.4443, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:09,537 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3774
2025-08-04 20:38:14,799 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:14,800 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:14,800 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:14,800 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:14,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:14,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:15,085 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:15,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:15,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:15,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:15,199 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:15,291 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:15,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:15,299 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:15,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:15,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:15,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:15,317 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:15,317 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:15,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:15,328 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:15,332 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:15,334 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:15,336 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:15,338 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:15,341 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:15,344 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:15,346 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:15,349 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:15,351 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:15,354 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:15,363 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:15,363 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:15,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:15,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:15,372 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:15,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:15,382 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:15,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:15,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:15,400 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:15,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:15,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:15,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:15,412 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:15,412 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:15,413 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:15,413 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:15,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:15,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:15,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:15,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:15,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:15,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:15,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:15,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:15,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:15,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:15,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:15,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:15,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:15,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:15,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:15,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:15,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:15,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:15,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:15,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:15,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:15,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:15,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:15,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:15,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:15,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:15,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:15,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:15,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:15,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:15,427 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:15,427 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:15,429 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:15,429 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:15,431 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 76/400.
2025-08-04 20:38:15,535 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:15,535 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:15,537 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 391 anomalous samples to GAN training data (target: 391).
2025-08-04 20:38:15,537 - ClientAppLogger [Client 2] - INFO - [Client] Round 76: Training GAN with 1695 samples (1304 normal, 391 anomalous).
2025-08-04 20:38:15,537 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:16,742 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.8511
2025-08-04 20:38:16,742 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.8511
2025-08-04 20:38:16,743 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:16,750 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3750, Threshold=0.4436, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:16,750 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:38:16,751 - ClientAppLogger [Client 2] - INFO - Fit completed for round 76. Duration: 1.32s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 76, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083470500296196, 'd_loss': 0.8511335550507964, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.316310167312622, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1695}
2025-08-04 20:38:16,751 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:38:22,005 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:22,005 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:22,005 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:22,005 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:22,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:22,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:22,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:22,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:22,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:22,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:22,471 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:22,581 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:22,592 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:22,592 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:22,604 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:22,631 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:22,631 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:22,632 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:22,632 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:22,632 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:22,641 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:22,644 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,646 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:22,649 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:22,652 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:22,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:22,657 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,659 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:22,662 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:22,664 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:22,666 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:22,677 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:22,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:22,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:22,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:22,687 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:22,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:22,696 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:22,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:22,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:22,713 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:22,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:22,725 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:22,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:22,727 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:22,728 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:22,728 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:22,728 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:22,729 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:22,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:22,729 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:22,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:22,730 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:22,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:22,731 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:22,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:22,731 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:22,731 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:22,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:22,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:22,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:22,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:22,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:22,733 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:22,733 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:22,735 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:22,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:22,735 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:22,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:22,735 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:22,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:22,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:22,736 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:22,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:22,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:22,737 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:22,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:22,737 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:22,737 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:22,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:22,743 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:22,743 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:22,745 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:22,745 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:22,747 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:22,747 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:22,747 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:22,748 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:22,756 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3748, Threshold=0.4434, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:22,758 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3748
2025-08-04 20:38:28,001 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:28,001 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:28,001 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:28,001 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:28,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:28,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:28,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:28,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:28,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:28,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:28,309 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:28,395 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:28,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:28,400 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:28,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:28,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:28,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:28,414 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:28,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:28,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:28,422 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:28,425 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:28,427 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:28,430 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:28,432 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:28,434 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:28,437 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:28,439 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:28,442 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:28,444 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:28,447 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:28,455 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:28,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:28,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:28,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:28,464 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:28,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:28,472 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:28,473 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:28,473 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:28,487 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:28,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:28,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:28,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:28,497 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:28,498 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:28,498 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:28,498 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:28,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:28,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:28,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:28,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:28,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:28,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:28,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:28,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:28,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:28,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:28,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:28,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:28,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:28,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:28,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:28,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:28,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:28,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:28,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:28,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:28,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:28,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:28,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:28,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:28,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:28,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:28,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:28,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:28,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:28,506 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:28,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:28,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:28,509 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:28,509 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:28,511 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:28,511 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:28,512 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 77/400.
2025-08-04 20:38:28,613 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:28,613 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:28,614 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 395 anomalous samples to GAN training data (target: 395).
2025-08-04 20:38:28,615 - ClientAppLogger [Client 2] - INFO - [Client] Round 77: Training GAN with 1714 samples (1319 normal, 395 anomalous).
2025-08-04 20:38:28,615 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:29,831 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.8481
2025-08-04 20:38:29,831 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.8481
2025-08-04 20:38:29,831 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:29,840 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3734, Threshold=0.4435, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:29,840 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:38:29,841 - ClientAppLogger [Client 2] - INFO - Fit completed for round 77. Duration: 1.33s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 77, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083555646176377, 'd_loss': 0.8481392976700773, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.328214406967163, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1714}
2025-08-04 20:38:29,841 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:38:35,105 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:35,105 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:35,106 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:35,106 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:35,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:35,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:35,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:35,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:35,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:35,472 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:35,472 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:35,569 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:35,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:35,577 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:35,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:35,597 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:35,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:35,598 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:35,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:35,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:35,608 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:35,611 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:35,614 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:35,616 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:35,619 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:35,621 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:35,624 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:35,626 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:35,629 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:35,631 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:35,634 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:35,644 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:35,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:35,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:35,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:35,654 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:35,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:35,664 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:35,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:35,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:35,681 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:35,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:35,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:35,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:35,692 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:35,692 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:35,693 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:35,693 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:35,694 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:35,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:35,694 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:35,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:35,696 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:35,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:35,696 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:35,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:35,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:35,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:35,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:35,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:35,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:35,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:35,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:35,698 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:35,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:35,699 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:35,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:35,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:35,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:35,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:35,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:35,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:35,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:35,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:35,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:35,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:35,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:35,702 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:35,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:35,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:35,707 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:35,708 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:35,709 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:35,709 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:35,711 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:35,711 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:35,711 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:35,712 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:35,724 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3734, Threshold=0.4436, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:35,724 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3734
2025-08-04 20:38:40,971 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:40,972 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:40,972 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:40,972 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:40,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:40,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:41,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:41,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:41,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:41,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:41,337 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:41,423 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:41,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:41,430 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:41,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:41,447 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:41,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:41,448 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:41,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:41,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:41,457 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:41,460 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:41,462 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:41,464 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:41,467 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:41,469 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:41,472 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:41,475 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:41,478 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:41,480 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:41,482 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:41,491 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:41,491 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:41,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:41,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:41,501 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:41,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:41,510 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:41,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:41,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:41,524 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:41,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:41,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:41,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:41,534 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:41,535 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:41,535 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:41,535 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:41,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:41,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:41,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:41,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:41,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:41,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:41,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:41,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:41,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:41,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:41,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:41,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:41,541 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:41,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:41,541 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:41,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:41,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:41,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:41,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:41,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:41,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:41,543 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:41,543 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:41,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:41,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:41,547 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:41,547 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:41,548 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:41,549 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:41,550 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 78/400.
2025-08-04 20:38:41,651 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:41,652 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:41,653 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 399 anomalous samples to GAN training data (target: 399).
2025-08-04 20:38:41,653 - ClientAppLogger [Client 2] - INFO - [Client] Round 78: Training GAN with 1732 samples (1333 normal, 399 anomalous).
2025-08-04 20:38:41,653 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:42,992 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.8515
2025-08-04 20:38:42,992 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.8515
2025-08-04 20:38:42,992 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:43,000 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3738, Threshold=0.4477, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:43,000 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:38:43,001 - ClientAppLogger [Client 2] - INFO - Fit completed for round 78. Duration: 1.45s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 78, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0837789951240766, 'd_loss': 0.8515237759084681, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.4505152702331543, 'cpu_percent_fit': 31.175, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1732}
2025-08-04 20:38:43,001 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:38:48,292 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:48,292 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:48,292 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:48,292 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:48,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:48,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:48,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:48,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:48,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:48,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:48,678 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:48,770 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:48,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:48,777 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:48,792 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:48,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:48,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:48,811 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:48,811 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:48,811 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:48,820 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:48,823 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,825 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:48,827 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:48,830 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:48,832 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:48,835 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,837 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:48,840 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:48,842 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:48,844 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:48,854 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:48,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:48,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:48,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:48,864 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:48,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:48,874 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:48,874 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:48,874 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:48,889 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:48,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:48,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:48,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:48,898 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:48,899 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:48,899 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:48,899 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:48,899 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:48,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:48,900 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:48,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:48,901 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:48,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:48,901 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:48,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:48,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:48,903 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:48,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:48,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:48,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:48,905 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:48,908 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:48,909 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:48,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:48,909 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:48,909 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:48,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:48,916 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:48,916 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:48,917 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:48,918 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:48,919 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:48,919 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:48,920 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:48,920 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:48,928 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3738, Threshold=0.4477, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:48,928 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3738
2025-08-04 20:38:54,185 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:54,185 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:38:54,185 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:38:54,186 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:38:54,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:38:54,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:54,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:54,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:54,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:38:54,525 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:38:54,525 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:54,609 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:54,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:54,614 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:54,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:38:54,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:54,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:38:54,628 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:54,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:54,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:38:54,636 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:54,639 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:54,641 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:54,643 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:54,646 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:54,648 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:54,650 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:54,653 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:54,656 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:54,658 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:54,660 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:54,669 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:54,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:38:54,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:38:54,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:38:54,679 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:54,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:38:54,687 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:54,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:38:54,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:54,702 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:54,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:38:54,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:38:54,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:54,712 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:54,712 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:54,712 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:54,713 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:54,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:38:54,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:54,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:38:54,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:54,714 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:38:54,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:38:54,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:54,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:38:54,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:38:54,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:38:54,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:38:54,717 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:54,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:38:54,719 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:54,722 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:54,723 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:54,723 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:38:54,723 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:38:54,723 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:38:54,723 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:38:54,727 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:38:54,727 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:54,728 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:54,728 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:38:54,729 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 79/400.
2025-08-04 20:38:54,830 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:54,831 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:54,832 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 403 anomalous samples to GAN training data (target: 403).
2025-08-04 20:38:54,835 - ClientAppLogger [Client 2] - INFO - [Client] Round 79: Training GAN with 1748 samples (1345 normal, 403 anomalous).
2025-08-04 20:38:54,836 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:56,076 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.8499
2025-08-04 20:38:56,076 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.8499
2025-08-04 20:38:56,077 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:56,084 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3690, Threshold=0.4389, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:38:56,084 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:38:56,085 - ClientAppLogger [Client 2] - INFO - Fit completed for round 79. Duration: 1.36s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 79, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0834361492632723, 'd_loss': 0.8499414325442413, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.355231523513794, 'cpu_percent_fit': 31.2, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1748}
2025-08-04 20:38:56,085 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:39:01,350 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:01,350 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:01,351 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:01,351 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:01,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:01,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:01,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:01,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:01,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:01,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:01,781 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:01,871 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:01,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:01,877 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:01,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:01,891 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:01,891 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:01,892 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:01,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:01,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:01,901 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:01,904 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,906 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:01,908 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:01,911 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:01,913 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:01,916 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,918 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:01,921 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:01,923 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:01,926 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:01,936 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:01,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:01,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:01,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:01,947 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:01,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:01,958 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:01,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:01,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:01,973 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:01,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:01,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:01,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:01,984 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:01,984 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:01,984 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:01,984 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:01,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:01,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:01,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:01,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:01,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:01,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:01,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:01,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:01,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:01,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:01,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:01,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:01,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:01,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:01,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:01,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:01,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:01,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:01,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:01,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:01,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:01,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:01,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:01,991 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:01,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:01,991 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:01,995 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:01,995 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:01,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:01,995 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:01,995 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:01,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:02,000 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:02,000 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:02,001 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:02,001 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:02,002 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:02,003 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:02,003 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:02,003 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:02,012 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3691, Threshold=0.4393, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:02,012 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3691
2025-08-04 20:39:16,287 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:16,287 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:16,287 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:16,287 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:16,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:16,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:16,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:16,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:16,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:16,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:16,677 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:16,774 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:16,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:16,783 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:16,791 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:16,801 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:16,801 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:16,801 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:16,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:16,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:16,812 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:16,815 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:16,817 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:16,819 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:16,822 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:16,824 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:16,827 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:16,830 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:16,832 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:16,834 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:16,837 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:16,847 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:16,847 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:16,852 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:16,852 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:16,857 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:16,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:16,867 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:16,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:16,868 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:16,884 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:16,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:16,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:16,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:16,898 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:16,898 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:16,898 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:16,899 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:16,899 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:16,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:16,899 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:16,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:16,901 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:16,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:16,901 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:16,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:16,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:16,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:16,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:16,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:16,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:16,903 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:16,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:16,903 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:16,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:16,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:16,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:16,905 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:16,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:16,905 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:16,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:16,905 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:16,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:16,906 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:16,910 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:16,910 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:16,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:16,910 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:16,910 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:16,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:16,914 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:16,915 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:16,916 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:16,916 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:16,917 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:16,917 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:16,918 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:16,918 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:16,927 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3930, Threshold=0.4629, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:16,927 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3930
2025-08-04 20:39:22,178 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:22,178 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:22,178 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:22,178 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:22,178 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:22,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:22,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:22,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:22,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:22,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:22,524 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:22,607 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:22,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:22,612 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:22,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:22,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:22,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:22,624 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:22,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:22,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:22,633 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:22,636 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:22,638 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:22,640 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:22,642 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:22,644 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:22,647 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:22,649 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:22,652 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:22,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:22,656 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:22,665 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:22,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:22,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:22,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:22,674 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:22,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:22,683 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:22,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:22,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:22,698 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:22,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:22,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:22,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:22,709 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:22,709 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:22,709 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:22,709 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:22,710 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:22,710 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:22,710 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:22,710 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:22,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:22,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:22,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:22,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:22,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:22,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:22,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:22,714 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:22,714 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:22,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:22,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:22,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:22,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:22,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:22,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:22,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:22,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:22,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:22,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:22,716 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:22,717 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:22,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:22,720 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:22,720 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:22,722 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:22,722 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:22,724 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 81/400.
2025-08-04 20:39:22,825 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:22,825 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:22,826 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 410 anomalous samples to GAN training data (target: 410).
2025-08-04 20:39:22,827 - ClientAppLogger [Client 2] - INFO - [Client] Round 81: Training GAN with 1778 samples (1368 normal, 410 anomalous).
2025-08-04 20:39:22,827 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:24,159 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.8452
2025-08-04 20:39:24,160 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.8452
2025-08-04 20:39:24,160 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:24,169 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3818, Threshold=0.4453, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:24,169 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:39:24,169 - ClientAppLogger [Client 2] - INFO - Fit completed for round 81. Duration: 1.45s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 81, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0835352112123213, 'd_loss': 0.8451933885586141, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.4457874298095703, 'cpu_percent_fit': 31.18125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1778}
2025-08-04 20:39:24,170 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:39:29,434 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:29,434 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:29,434 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:29,434 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:29,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:29,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:29,714 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:29,714 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:29,806 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:29,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:29,836 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:29,946 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:29,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:29,954 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:29,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:30,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:30,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:30,015 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:30,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:30,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:30,028 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:30,031 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,034 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:30,036 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:30,039 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:30,041 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:30,044 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,046 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:30,050 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:30,052 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:30,054 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:30,065 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:30,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:30,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:30,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:30,079 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:30,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:30,099 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:30,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:30,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:30,119 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:30,126 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:30,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:30,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:30,141 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:30,141 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:30,142 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:30,142 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:30,143 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:30,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:30,143 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:30,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:30,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:30,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:30,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:30,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:30,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:30,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:30,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:30,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:30,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:30,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:30,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:30,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:30,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:30,149 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:30,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:30,149 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:30,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:30,150 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:30,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:30,150 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:30,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:30,151 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:30,151 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:30,151 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:30,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:30,152 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:30,153 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:30,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:30,164 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:30,165 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:30,166 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:30,167 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:30,168 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:30,169 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:30,169 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:30,170 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:30,180 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3817, Threshold=0.4455, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:30,181 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3817
2025-08-04 20:39:35,427 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:35,427 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:35,427 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:35,427 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:35,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:35,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:35,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:35,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:35,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:35,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:35,814 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:35,911 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:35,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:35,917 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:35,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:35,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:35,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:35,931 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:35,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:35,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:35,940 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:35,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:35,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:35,947 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:35,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:35,952 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:35,955 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:35,957 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:35,960 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:35,962 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:35,965 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:35,975 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:35,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:35,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:35,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:35,984 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:35,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:35,992 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:35,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:35,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:36,012 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:36,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:36,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:36,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:36,022 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:36,022 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:36,023 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:36,023 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:36,023 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:36,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:36,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:36,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:36,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:36,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:36,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:36,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:36,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:36,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:36,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:36,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:36,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:36,027 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:36,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:36,027 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:36,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:36,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:36,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:36,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:36,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:36,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:36,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:36,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:36,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:36,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:36,030 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:36,030 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:36,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:36,031 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:36,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:36,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:36,035 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:36,035 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:36,037 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:36,037 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:36,038 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 82/400.
2025-08-04 20:39:36,139 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:36,140 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:36,143 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 416 anomalous samples to GAN training data (target: 416).
2025-08-04 20:39:36,145 - ClientAppLogger [Client 2] - INFO - [Client] Round 82: Training GAN with 1803 samples (1387 normal, 416 anomalous).
2025-08-04 20:39:36,145 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:37,511 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.8437
2025-08-04 20:39:37,511 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.8437
2025-08-04 20:39:37,511 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:37,519 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3707, Threshold=0.4274, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:37,520 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:39:37,520 - ClientAppLogger [Client 2] - INFO - Fit completed for round 82. Duration: 1.48s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 82, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0835302935529927, 'd_loss': 0.8436683446020137, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.4816536903381348, 'cpu_percent_fit': 31.1375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1803}
2025-08-04 20:39:37,520 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:39:42,812 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:42,812 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:42,812 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:42,813 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:42,813 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:42,813 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:43,093 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:43,093 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:43,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:43,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:43,211 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:43,293 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:43,297 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:43,297 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:43,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:43,310 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:43,310 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:43,311 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:43,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:43,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:43,319 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:43,322 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:43,324 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:43,326 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:43,329 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:43,331 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:43,334 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:43,336 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:43,339 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:43,341 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:43,343 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:43,352 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:43,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:43,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:43,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:43,361 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:43,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:43,370 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:43,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:43,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:43,385 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:43,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:43,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:43,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:43,395 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:43,395 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:43,395 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:43,395 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:43,395 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:43,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:43,396 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:43,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:43,397 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:43,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:43,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:43,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:43,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:43,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:43,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:43,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:43,399 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:43,399 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:43,399 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:43,399 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:43,399 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:43,400 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:43,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:43,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:43,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:43,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:43,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:43,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:43,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:43,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:43,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:43,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:43,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:43,405 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:43,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:43,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:43,408 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:43,408 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:43,409 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:43,409 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:43,411 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:43,411 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:43,411 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:43,412 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:43,420 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3709, Threshold=0.4277, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:43,420 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3709
2025-08-04 20:39:48,677 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:48,678 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:48,678 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:48,678 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:48,678 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:48,678 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:48,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:48,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:49,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:49,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:49,038 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:49,121 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:49,126 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:49,126 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:49,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:49,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:49,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:49,139 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:49,139 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:49,139 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:49,147 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:49,150 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:49,152 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:49,154 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:49,157 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:49,159 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:49,162 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:49,164 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:49,167 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:49,169 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:49,171 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:49,181 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:49,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:49,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:49,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:49,190 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:49,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:49,199 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:49,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:49,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:49,214 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:49,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:49,223 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:49,223 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:49,223 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:49,223 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:49,223 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:49,224 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:49,224 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:49,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:49,224 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:49,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:49,226 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:49,226 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:49,226 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:49,226 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:49,226 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:49,227 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:49,228 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:49,228 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:49,228 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:49,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:49,229 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:49,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:49,229 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:49,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:49,229 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:49,233 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:49,233 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:49,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:49,233 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:49,233 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:49,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:49,237 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:49,238 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:49,239 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:49,239 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:49,240 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 83/400.
2025-08-04 20:39:49,342 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:49,342 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:49,343 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 420 anomalous samples to GAN training data (target: 420).
2025-08-04 20:39:49,347 - ClientAppLogger [Client 2] - INFO - [Client] Round 83: Training GAN with 1822 samples (1402 normal, 420 anomalous).
2025-08-04 20:39:49,347 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:50,632 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.8437
2025-08-04 20:39:50,632 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.8437
2025-08-04 20:39:50,633 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:50,640 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4013, Threshold=0.4658, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:50,641 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:39:50,641 - ClientAppLogger [Client 2] - INFO - Fit completed for round 83. Duration: 1.40s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 83, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0838846986039936, 'd_loss': 0.8436825866167945, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.400418996810913, 'cpu_percent_fit': 31.225, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1822}
2025-08-04 20:39:50,641 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:39:55,902 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:55,902 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:39:55,902 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:39:55,902 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:39:55,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:39:55,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:56,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:56,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:56,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:39:56,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:39:56,285 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:56,396 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:56,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:56,402 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:56,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:39:56,431 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:56,431 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:39:56,432 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:56,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:56,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:39:56,441 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:56,444 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,446 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:56,448 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:56,451 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:56,453 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:56,456 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,458 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:56,461 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:56,463 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:56,465 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:56,475 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:56,475 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:39:56,480 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:39:56,481 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:39:56,486 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:56,486 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:39:56,500 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:56,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:39:56,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:56,517 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:56,521 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:39:56,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:39:56,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:56,528 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:56,528 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:56,529 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:56,529 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:56,529 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:39:56,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:56,530 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:39:56,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:56,531 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:39:56,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:39:56,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:56,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:39:56,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:56,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:56,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:56,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:39:56,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:39:56,533 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:39:56,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:39:56,533 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:39:56,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:39:56,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:39:56,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:39:56,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:39:56,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:39:56,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:39:56,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:39:56,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:56,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:39:56,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:56,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:56,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:56,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:39:56,540 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:39:56,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:39:56,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:39:56,546 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:39:56,546 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:56,548 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:56,548 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:39:56,549 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:56,549 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:56,549 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:56,550 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:56,558 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4007, Threshold=0.4652, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:39:56,558 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4007
2025-08-04 20:40:10,822 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:10,822 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:10,823 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:10,823 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:40:10,823 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:40:10,823 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:11,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:11,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:11,158 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:40:11,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:40:11,184 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:11,278 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:11,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:11,285 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:11,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:40:11,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:11,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:40:11,303 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:11,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:11,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:40:11,313 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:11,316 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:11,318 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:11,320 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:11,323 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:11,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:11,328 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:11,331 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:11,333 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:11,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:11,338 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:11,349 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:11,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:40:11,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:40:11,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:40:11,359 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:11,360 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:40:11,373 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:11,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:40:11,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:11,391 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:11,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:40:11,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:40:11,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:11,402 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:11,402 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:11,402 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:11,403 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:11,403 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:40:11,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:11,403 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:40:11,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:11,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:40:11,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:40:11,406 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:11,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:40:11,406 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:11,406 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:11,406 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:11,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:40:11,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:40:11,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:40:11,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:40:11,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:40:11,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:40:11,409 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:40:11,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:40:11,409 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:40:11,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:40:11,410 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:40:11,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:40:11,410 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:11,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:40:11,411 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:11,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:11,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:11,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:40:11,414 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:40:11,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:40:11,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:40:11,419 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:40:11,419 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:11,421 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:11,421 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:11,423 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:11,423 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:11,423 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:11,424 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:11,432 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4027, Threshold=0.4682, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:40:11,432 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4027
2025-08-04 20:40:16,676 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:16,676 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:16,676 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:16,676 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:40:16,676 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:40:16,676 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:16,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:16,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:16,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:40:17,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:40:17,004 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:17,099 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:17,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:17,105 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:17,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:40:17,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:17,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:40:17,117 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:17,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:17,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:40:17,126 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:17,128 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:17,130 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:17,133 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:17,135 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:17,137 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:17,140 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:17,143 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:17,146 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:17,147 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:17,150 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:17,159 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:17,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:40:17,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:40:17,165 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:40:17,170 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:17,170 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:40:17,181 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:17,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:40:17,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:17,199 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:17,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:40:17,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:40:17,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:17,209 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:17,209 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:17,209 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:17,209 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:17,210 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:40:17,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:17,210 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:40:17,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:17,211 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:40:17,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:40:17,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:17,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:40:17,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:17,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:17,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:17,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:40:17,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:40:17,213 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:40:17,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:40:17,213 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:40:17,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:40:17,214 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:40:17,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:40:17,214 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:40:17,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:40:17,215 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:40:17,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:40:17,215 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:17,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:40:17,215 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:17,219 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:17,219 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:17,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:40:17,219 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:40:17,220 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:40:17,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:40:17,224 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:40:17,224 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:17,225 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:17,225 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:17,227 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 85/400.
2025-08-04 20:40:17,328 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:17,328 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:17,330 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 431 anomalous samples to GAN training data (target: 431).
2025-08-04 20:40:17,333 - ClientAppLogger [Client 2] - INFO - [Client] Round 85: Training GAN with 1868 samples (1437 normal, 431 anomalous).
2025-08-04 20:40:17,333 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:18,717 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.8371
2025-08-04 20:40:18,717 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.8371
2025-08-04 20:40:18,717 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:18,725 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3807, Threshold=0.4330, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:40:18,726 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:40:18,726 - ClientAppLogger [Client 2] - INFO - Fit completed for round 85. Duration: 1.50s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 85, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0839332741384076, 'd_loss': 0.8370897526914607, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.499215841293335, 'cpu_percent_fit': 31.25, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1868}
2025-08-04 20:40:18,726 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:40:24,009 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:24,009 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:24,009 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:24,009 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:40:24,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:40:24,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:24,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:24,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:24,461 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:40:24,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:40:24,496 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:24,624 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:24,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:24,635 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:24,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:40:24,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:24,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:40:24,672 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:24,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:24,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:40:24,682 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:24,686 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,688 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:24,691 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:24,695 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:24,698 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:24,701 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,704 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:24,707 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:24,709 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:24,711 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:24,722 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:24,722 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:40:24,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:40:24,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:40:24,733 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:24,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:40:24,745 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:24,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:40:24,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:24,765 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:24,770 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:40:24,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:40:24,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:24,778 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:24,778 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:24,778 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:24,779 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:24,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:40:24,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:24,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:40:24,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:24,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:40:24,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:40:24,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:24,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:40:24,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:24,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:24,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:24,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:40:24,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:40:24,783 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:40:24,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:40:24,783 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:40:24,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:40:24,785 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:40:24,785 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:40:24,785 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:40:24,785 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:40:24,786 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:40:24,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:40:24,786 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:24,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:40:24,786 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:24,787 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:24,787 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:24,787 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:40:24,788 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:40:24,788 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:40:24,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:40:24,794 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:40:24,794 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:24,796 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:24,796 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:24,798 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:24,798 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:24,798 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:24,799 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:24,807 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3808, Threshold=0.4334, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:40:24,808 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3808
2025-08-04 20:40:39,097 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:39,097 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:39,097 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:39,098 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:40:39,098 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:40:39,098 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:39,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:39,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:39,465 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:40:39,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:40:39,498 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:39,674 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:39,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:39,685 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:39,765 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:40:39,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:39,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:40:39,801 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:39,801 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:39,801 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:40:39,814 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:39,819 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:39,823 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:39,826 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:39,829 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:39,833 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:39,836 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:39,839 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:39,843 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:39,846 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:39,850 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:39,866 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:39,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:40:39,872 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:40:39,872 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:40:39,883 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:39,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:40:39,902 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:39,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:40:39,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:39,927 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:39,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:40:39,945 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:40:39,946 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:39,946 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:39,946 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:39,946 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:39,947 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:39,947 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:40:39,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:39,948 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:40:39,948 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:39,950 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:40:39,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:40:39,951 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:39,951 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:40:39,951 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:39,951 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:39,952 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:39,952 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:40:39,952 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:40:39,952 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:40:39,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:40:39,953 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:40:39,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:40:39,955 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:40:39,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:40:39,955 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:40:39,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:40:39,956 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:40:39,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:40:39,956 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:39,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:40:39,957 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:39,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:39,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:39,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:40:39,961 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:40:39,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:40:39,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:40:39,972 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:40:39,973 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:39,974 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:39,975 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:39,976 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:39,977 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:39,977 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:39,977 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:39,987 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4129, Threshold=0.4810, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:40:39,987 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4129
2025-08-04 20:40:45,240 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:45,240 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:45,240 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:45,240 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:40:45,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:40:45,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:45,472 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:45,473 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:45,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:40:45,585 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:40:45,586 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:45,669 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:45,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:45,675 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:45,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:40:45,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:45,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:40:45,689 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:45,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:45,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:40:45,698 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:45,701 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:45,703 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:45,705 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:45,708 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:45,710 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:45,712 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:45,715 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:45,717 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:45,719 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:45,721 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:45,730 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:45,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:40:45,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:40:45,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:40:45,739 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:45,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:40:45,748 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:45,748 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:40:45,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:45,764 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:45,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:40:45,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:40:45,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:45,774 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:45,775 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:45,775 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:45,775 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:45,775 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:40:45,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:45,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:40:45,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:45,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:40:45,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:40:45,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:45,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:40:45,778 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:45,778 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:45,778 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:45,778 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:40:45,778 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:40:45,778 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:40:45,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:40:45,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:40:45,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:40:45,780 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:40:45,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:40:45,780 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:40:45,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:40:45,780 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:40:45,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:40:45,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:45,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:40:45,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:45,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:45,784 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:45,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:40:45,785 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:40:45,785 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:40:45,785 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:40:45,788 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:40:45,788 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:45,789 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:45,789 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:45,790 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 87/400.
2025-08-04 20:40:45,891 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:45,892 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:45,894 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 441 anomalous samples to GAN training data (target: 441).
2025-08-04 20:40:45,897 - ClientAppLogger [Client 2] - INFO - [Client] Round 87: Training GAN with 1911 samples (1470 normal, 441 anomalous).
2025-08-04 20:40:45,898 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:47,304 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8339
2025-08-04 20:40:47,304 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8339
2025-08-04 20:40:47,304 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:47,312 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4175, Threshold=0.4804, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:40:47,312 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:40:47,312 - ClientAppLogger [Client 2] - INFO - Fit completed for round 87. Duration: 1.52s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 87, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084126729206662, 'd_loss': 0.8339250303574847, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.5218884944915771, 'cpu_percent_fit': 31.225, 'ram_mb_fit': 1.7265625, 'accumulated_train_samples_this_round': 1911}
2025-08-04 20:40:47,313 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:40:52,562 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:52,562 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:40:52,563 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:40:52,563 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:40:52,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:40:52,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:52,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:52,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:52,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:40:52,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:40:52,890 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:52,979 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:52,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:52,984 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:52,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:40:52,997 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:52,997 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:40:52,998 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:52,998 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:52,998 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:40:53,007 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:53,009 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:53,012 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:53,014 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:53,017 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:53,019 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:53,021 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:53,024 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:53,027 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:53,029 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:53,031 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:53,039 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:53,039 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:40:53,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:40:53,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:40:53,049 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:53,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:40:53,057 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:53,057 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:40:53,058 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:53,073 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:53,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:40:53,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:40:53,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:53,083 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:53,083 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:53,083 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:53,083 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:53,084 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:40:53,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:53,084 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:40:53,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:53,085 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:40:53,085 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:40:53,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:40:53,087 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:40:53,087 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:40:53,087 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:40:53,087 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:40:53,088 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:40:53,088 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:40:53,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:40:53,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:40:53,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:40:53,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:40:53,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:53,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:40:53,090 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:53,093 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:53,093 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:53,094 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:40:53,094 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:40:53,094 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:40:53,094 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:40:53,097 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:40:53,097 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:53,098 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:53,098 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:40:53,100 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:53,100 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:53,100 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:53,101 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:53,108 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4163, Threshold=0.4785, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:40:53,109 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4163
2025-08-04 20:41:01,386 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:01,387 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:01,387 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:01,387 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:41:01,387 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:41:01,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:01,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:01,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:01,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:41:01,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:41:01,785 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:01,886 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:01,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:01,892 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:01,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:41:01,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:01,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:41:01,934 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:01,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:01,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:41:01,942 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:01,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:01,947 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:01,949 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:01,952 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:01,954 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:01,957 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:01,959 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:01,962 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:01,964 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:01,966 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:01,974 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:01,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:41:01,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:41:01,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:41:01,983 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:01,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:41:01,991 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:01,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:41:01,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:02,005 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:02,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:41:02,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:41:02,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:02,015 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:02,015 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:02,016 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:02,016 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:02,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:41:02,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:02,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:41:02,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:02,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:41:02,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:41:02,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:02,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:41:02,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:41:02,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:41:02,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:41:02,020 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:41:02,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:41:02,021 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:41:02,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:41:02,021 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:41:02,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:41:02,021 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:02,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:41:02,022 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:02,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:02,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:02,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:41:02,026 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:41:02,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:41:02,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:41:02,031 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:41:02,031 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:02,032 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:02,033 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:02,034 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 88/400.
2025-08-04 20:41:02,135 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:02,135 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:02,136 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 446 anomalous samples to GAN training data (target: 446).
2025-08-04 20:41:02,141 - ClientAppLogger [Client 2] - INFO - [Client] Round 88: Training GAN with 1934 samples (1488 normal, 446 anomalous).
2025-08-04 20:41:02,141 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:03,518 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.8331
2025-08-04 20:41:03,518 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.8331
2025-08-04 20:41:03,518 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:03,526 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3849, Threshold=0.4342, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:41:03,526 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:41:03,526 - ClientAppLogger [Client 2] - INFO - Fit completed for round 88. Duration: 1.49s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 88, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0841771915508773, 'd_loss': 0.8331187324846914, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.4922034740447998, 'cpu_percent_fit': 31.175, 'ram_mb_fit': 0.44140625, 'accumulated_train_samples_this_round': 1934}
2025-08-04 20:41:03,526 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:41:08,790 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:08,792 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:08,792 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:08,792 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:41:08,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:41:08,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:09,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:09,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:09,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:41:09,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:41:09,144 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:09,235 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:09,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:09,241 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:09,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:41:09,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:09,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:41:09,282 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:09,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:09,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:41:09,291 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:09,294 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:09,296 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:09,298 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:09,301 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:09,303 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:09,306 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:09,308 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:09,311 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:09,312 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:09,315 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:09,324 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:09,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:41:09,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:41:09,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:41:09,335 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:09,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:41:09,346 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:09,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:41:09,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:09,361 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:09,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:41:09,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:41:09,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:09,371 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:09,371 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:09,371 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:09,371 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:09,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:41:09,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:09,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:41:09,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:09,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:41:09,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:41:09,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:09,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:41:09,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:09,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:09,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:09,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:41:09,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:41:09,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:41:09,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:41:09,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:41:09,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:41:09,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:41:09,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:41:09,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:41:09,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:41:09,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:41:09,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:41:09,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:09,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:41:09,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:09,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:09,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:09,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:41:09,381 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:41:09,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:41:09,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:41:09,388 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:41:09,388 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:09,389 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:09,390 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:09,391 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:09,391 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:09,391 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:09,392 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:09,400 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3850, Threshold=0.4343, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:41:09,400 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3850
2025-08-04 20:41:14,659 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:14,659 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:14,659 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:14,659 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:41:14,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:41:14,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:14,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:14,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:15,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:41:15,048 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:41:15,048 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:15,131 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:15,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:15,137 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:15,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:41:15,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:15,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:41:15,149 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:15,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:15,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:41:15,158 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:15,161 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:15,164 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:15,166 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:15,168 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:15,171 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:15,173 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:15,175 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:15,178 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:15,180 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:15,183 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:15,192 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:15,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:41:15,197 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:41:15,197 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:41:15,201 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:15,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:41:15,210 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:15,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:41:15,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:15,224 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:15,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:41:15,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:41:15,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:15,234 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:15,234 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:15,235 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:15,235 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:15,235 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:41:15,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:15,236 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:41:15,236 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:15,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:41:15,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:41:15,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:15,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:41:15,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:15,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:15,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:15,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:41:15,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:41:15,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:41:15,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:41:15,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:41:15,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:41:15,240 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:15,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:41:15,241 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:15,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:15,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:15,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:41:15,245 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:41:15,245 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:41:15,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:41:15,250 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:41:15,250 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:15,251 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:15,251 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:15,253 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 89/400.
2025-08-04 20:41:15,354 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:15,354 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:15,355 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 452 anomalous samples to GAN training data (target: 452).
2025-08-04 20:41:15,359 - ClientAppLogger [Client 2] - INFO - [Client] Round 89: Training GAN with 1959 samples (1507 normal, 452 anomalous).
2025-08-04 20:41:15,359 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:16,885 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.8346
2025-08-04 20:41:16,885 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.8346
2025-08-04 20:41:16,885 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:16,897 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3882, Threshold=0.4286, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:41:16,897 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:41:16,898 - ClientAppLogger [Client 2] - INFO - Fit completed for round 89. Duration: 1.64s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 89, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0844787055220513, 'd_loss': 0.8346442501237041, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.6445019245147705, 'cpu_percent_fit': 31.175, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1959}
2025-08-04 20:41:16,898 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:41:22,183 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:22,183 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:22,183 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:22,183 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:41:22,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:41:22,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:22,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:22,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:22,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:41:22,668 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:41:22,669 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:22,837 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:22,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:22,851 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:22,874 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:41:22,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:22,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:41:22,903 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:22,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:22,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:41:22,914 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:22,917 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,919 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:22,921 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:22,924 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:22,926 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:22,929 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,932 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:22,935 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:22,937 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:22,939 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:22,956 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:22,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:41:22,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:41:22,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:41:22,975 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:22,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:41:22,999 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:23,000 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:41:23,000 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:23,021 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:23,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:41:23,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:41:23,036 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:23,036 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:23,036 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:23,036 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:23,037 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:23,037 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:41:23,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:23,037 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:41:23,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:23,039 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:41:23,039 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:41:23,040 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:23,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:41:23,040 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:23,040 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:23,040 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:23,041 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:41:23,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:41:23,041 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:41:23,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:41:23,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:41:23,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:41:23,044 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:41:23,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:41:23,044 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:41:23,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:41:23,045 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:41:23,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:41:23,045 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:23,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:41:23,046 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:23,049 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:23,049 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:23,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:41:23,049 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:41:23,050 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:41:23,050 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:41:23,060 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:41:23,060 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:23,062 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:23,065 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:23,067 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:23,067 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:23,068 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:23,069 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:23,082 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3889, Threshold=0.4300, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:41:23,082 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3889
2025-08-04 20:41:34,360 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:34,361 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:34,361 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:34,361 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:41:34,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:41:34,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:34,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:34,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:34,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:41:34,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:41:34,970 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:35,117 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:35,128 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:35,128 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:35,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:41:35,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:35,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:41:35,161 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:35,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:35,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:41:35,171 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:35,175 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,177 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:35,179 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:35,183 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:35,186 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:35,189 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,192 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:35,195 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:35,197 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:35,200 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:35,213 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:35,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:41:35,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:41:35,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:41:35,225 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:35,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:41:35,241 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:35,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:41:35,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:35,261 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:35,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:41:35,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:41:35,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:35,279 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:35,279 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:35,279 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:35,279 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:35,280 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:41:35,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:35,280 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:41:35,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:35,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:41:35,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:41:35,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:35,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:41:35,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:35,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:35,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:35,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:41:35,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:41:35,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:41:35,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:41:35,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:41:35,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:41:35,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:41:35,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:41:35,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:41:35,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:41:35,288 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:41:35,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:41:35,288 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:35,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:41:35,308 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:35,311 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:35,311 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:35,312 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:41:35,315 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:41:35,315 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:41:35,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:41:35,320 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:41:35,321 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:35,326 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:35,328 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:35,333 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:35,334 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:35,334 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:35,336 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:35,379 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4323, Threshold=0.4971, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:41:35,379 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4323
2025-08-04 20:41:49,658 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:49,658 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:41:49,658 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:41:49,658 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:41:49,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:41:49,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:50,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:50,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:50,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:41:50,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:41:50,232 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:50,344 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:50,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:50,351 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:50,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:41:50,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:50,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:41:50,378 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:50,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:50,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:41:50,389 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:50,392 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,394 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:50,397 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:50,400 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:50,403 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:50,406 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,410 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:50,414 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:50,417 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:50,420 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:50,437 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:50,437 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:41:50,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:41:50,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:41:50,449 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:50,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:41:50,464 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:50,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:41:50,465 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:50,482 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:50,488 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:41:50,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:41:50,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:50,499 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:50,499 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:50,500 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:50,500 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:50,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:41:50,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:50,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:41:50,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:50,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:41:50,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:41:50,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:50,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:41:50,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:50,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:50,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:50,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:41:50,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:41:50,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:41:50,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:41:50,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:41:50,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:41:50,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:41:50,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:41:50,508 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:41:50,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:41:50,508 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:41:50,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:41:50,508 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:50,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:41:50,509 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:50,509 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:50,510 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:50,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:41:50,510 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:41:50,510 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:41:50,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:41:50,515 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:41:50,515 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:50,517 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:50,517 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:41:50,518 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:50,519 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:50,519 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:50,520 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:50,529 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4228, Threshold=0.4907, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:41:50,530 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4228
2025-08-04 20:42:04,799 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:04,799 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:04,799 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:04,799 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:04,799 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:04,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:05,058 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:05,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:05,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:05,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:05,190 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:05,330 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:05,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:05,340 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:05,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:05,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:05,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:05,389 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:05,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:05,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:05,399 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:05,402 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,404 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:05,407 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:05,410 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:05,412 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:05,415 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,417 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:05,421 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:05,423 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:05,426 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:05,439 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:05,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:05,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:05,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:05,451 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:05,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:05,463 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:05,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:05,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:05,482 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:05,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:05,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:05,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:05,494 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:05,494 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:05,495 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:05,496 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:05,496 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:05,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:05,496 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:05,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:05,498 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:05,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:05,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:05,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:05,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:05,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:05,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:05,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:05,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:05,500 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:05,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:05,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:05,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:05,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:05,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:05,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:05,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:05,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:05,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:05,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:05,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:05,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:05,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:05,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:05,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:05,507 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:05,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:05,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:05,515 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:05,515 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:05,516 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:05,517 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:05,518 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:05,518 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:05,518 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:05,519 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:05,527 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3877, Threshold=0.4425, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:05,528 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3877
2025-08-04 20:42:13,778 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:13,779 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:13,779 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:13,779 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:13,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:13,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:13,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:13,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:14,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:14,099 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:14,100 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:14,182 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:14,187 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:14,187 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:14,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:14,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:14,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:14,200 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:14,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:14,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:14,209 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:14,211 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:14,214 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:14,216 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:14,218 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:14,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:14,222 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:14,225 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:14,227 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:14,229 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:14,231 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:14,239 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:14,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:14,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:14,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:14,248 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:14,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:14,256 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:14,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:14,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:14,271 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:14,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:14,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:14,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:14,281 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:14,281 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:14,281 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:14,282 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:14,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:14,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:14,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:14,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:14,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:14,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:14,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:14,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:14,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:14,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:14,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:14,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:14,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:14,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:14,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:14,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:14,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:14,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:14,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:14,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:14,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:14,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:14,288 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:14,288 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:14,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:14,291 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:14,291 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:14,292 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:14,292 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:14,294 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 93/400.
2025-08-04 20:42:14,394 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:14,394 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:14,396 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 470 anomalous samples to GAN training data (target: 470).
2025-08-04 20:42:14,404 - ClientAppLogger [Client 2] - INFO - [Client] Round 93: Training GAN with 2038 samples (1568 normal, 470 anomalous).
2025-08-04 20:42:14,404 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:15,857 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.8362
2025-08-04 20:42:15,857 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.8362
2025-08-04 20:42:15,857 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:15,865 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4040, Threshold=0.4500, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:15,866 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:42:15,866 - ClientAppLogger [Client 2] - INFO - Fit completed for round 93. Duration: 1.57s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 93, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084667818047932, 'd_loss': 0.8361807440927616, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.5723633766174316, 'cpu_percent_fit': 31.13125, 'ram_mb_fit': 8.29296875, 'accumulated_train_samples_this_round': 2038}
2025-08-04 20:42:15,866 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:42:21,151 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:21,151 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:21,152 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:21,152 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:21,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:21,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:21,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:21,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:21,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:21,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:21,524 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:21,615 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:21,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:21,620 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:21,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:21,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:21,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:21,634 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:21,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:21,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:21,643 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:21,646 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:21,648 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:21,650 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:21,653 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:21,655 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:21,658 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:21,660 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:21,662 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:21,664 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:21,666 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:21,677 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:21,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:21,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:21,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:21,688 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:21,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:21,700 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:21,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:21,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:21,716 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:21,720 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:21,725 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:21,725 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:21,726 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:21,726 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:21,726 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:21,726 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:21,726 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:21,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:21,727 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:21,727 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:21,728 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:21,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:21,729 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:21,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:21,729 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:21,729 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:21,729 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:21,730 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:21,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:21,730 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:21,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:21,730 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:21,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:21,731 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:21,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:21,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:21,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:21,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:21,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:21,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:21,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:21,733 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:21,733 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:21,733 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:21,733 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:21,733 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:21,734 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:21,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:21,737 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:21,737 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:21,738 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:21,738 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:21,740 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:21,740 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:21,740 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:21,741 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:21,749 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4040, Threshold=0.4500, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:21,749 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4040
2025-08-04 20:42:30,005 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:30,005 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:30,006 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:30,006 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:30,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:30,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:30,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:30,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:30,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:30,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:30,386 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:30,469 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:30,473 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:30,473 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:30,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:30,486 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:30,486 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:30,487 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:30,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:30,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:30,495 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:30,498 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:30,500 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:30,503 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:30,506 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:30,508 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:30,511 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:30,514 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:30,517 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:30,519 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:30,521 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:30,530 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:30,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:30,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:30,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:30,539 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:30,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:30,547 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:30,548 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:30,548 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:30,563 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:30,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:30,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:30,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:30,573 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:30,573 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:30,573 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:30,573 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:30,574 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:30,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:30,574 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:30,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:30,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:30,575 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:30,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:30,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:30,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:30,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:30,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:30,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:30,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:30,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:30,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:30,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:30,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:30,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:30,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:30,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:30,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:30,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:30,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:30,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:30,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:30,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:30,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:30,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:30,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:30,581 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:30,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:30,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:30,584 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:30,585 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:30,586 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:30,586 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:30,588 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 94/400.
2025-08-04 20:42:30,688 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:30,688 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:30,690 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 474 anomalous samples to GAN training data (target: 474).
2025-08-04 20:42:30,690 - ClientAppLogger [Client 2] - INFO - [Client] Round 94: Training GAN with 2057 samples (1583 normal, 474 anomalous).
2025-08-04 20:42:30,690 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:32,221 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.8285
2025-08-04 20:42:32,222 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.8285
2025-08-04 20:42:32,222 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:32,230 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3812, Threshold=0.4177, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:32,230 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:42:32,230 - ClientAppLogger [Client 2] - INFO - Fit completed for round 94. Duration: 1.64s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 94, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0844715477600806, 'd_loss': 0.8285055975399379, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.6426129341125488, 'cpu_percent_fit': 31.16875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2057}
2025-08-04 20:42:32,231 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:42:37,487 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:37,487 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:37,487 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:37,487 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:37,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:37,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:37,791 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:37,791 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:37,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:37,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:37,912 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:38,003 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:38,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:38,009 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:38,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:38,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:38,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:38,074 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:38,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:38,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:38,085 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:38,088 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,090 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:38,093 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:38,095 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:38,098 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:38,101 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,103 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:38,106 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:38,109 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:38,111 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:38,122 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:38,122 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:38,127 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:38,127 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:38,132 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:38,133 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:38,145 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:38,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:38,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:38,163 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:38,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:38,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:38,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:38,175 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:38,175 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:38,176 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:38,176 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:38,176 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:38,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:38,177 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:38,177 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:38,178 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:38,178 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:38,179 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:38,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:38,179 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:38,179 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:38,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:38,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:38,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:38,182 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:38,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:38,183 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:38,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:38,183 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:38,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:38,183 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:38,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:38,184 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:38,184 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:38,184 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:38,185 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:38,185 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:38,185 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:38,185 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:38,189 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:38,189 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:38,190 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:38,191 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:38,192 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:38,192 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:38,192 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:38,193 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:38,202 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3813, Threshold=0.4179, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:38,202 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3813
2025-08-04 20:42:46,471 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:46,471 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:46,471 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:46,471 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:46,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:46,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:46,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:46,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:46,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:46,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:46,837 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:46,927 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:46,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:46,931 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:46,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:46,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:46,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:46,944 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:46,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:46,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:46,953 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:46,956 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:46,958 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:46,960 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:46,962 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:46,964 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:46,967 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:46,969 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:46,972 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:46,974 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:46,976 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:46,985 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:46,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:46,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:46,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:46,995 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:46,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:47,003 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:47,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:47,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:47,018 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:47,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:47,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:47,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:47,028 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:47,028 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:47,028 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:47,029 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:47,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:47,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:47,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:47,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:47,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:47,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:47,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:47,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:47,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:47,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:47,033 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:47,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:47,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:47,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:47,035 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:47,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:47,036 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:47,036 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:47,036 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:47,040 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:47,040 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:47,042 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:47,042 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:47,043 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 95/400.
2025-08-04 20:42:47,144 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:47,144 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:47,146 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 478 anomalous samples to GAN training data (target: 478).
2025-08-04 20:42:47,146 - ClientAppLogger [Client 2] - INFO - [Client] Round 95: Training GAN with 2073 samples (1595 normal, 478 anomalous).
2025-08-04 20:42:47,146 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:48,656 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0848, Avg D Loss: 0.8304
2025-08-04 20:42:48,656 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0848, Avg D Loss: 0.8304
2025-08-04 20:42:48,657 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:48,665 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3994, Threshold=0.4277, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:48,665 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:42:48,665 - ClientAppLogger [Client 2] - INFO - Fit completed for round 95. Duration: 1.62s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 95, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084750821886003, 'd_loss': 0.8304074941254214, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.6217024326324463, 'cpu_percent_fit': 31.23125, 'ram_mb_fit': 5.23046875, 'accumulated_train_samples_this_round': 2073}
2025-08-04 20:42:48,665 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:42:53,921 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:53,922 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:42:53,922 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:42:53,922 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:42:53,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:42:53,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:54,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:54,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:54,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:42:54,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:42:54,302 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:54,400 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:54,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:54,405 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:54,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:42:54,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:54,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:42:54,419 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:54,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:54,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:42:54,428 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:54,431 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:54,433 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:54,435 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:54,438 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:54,440 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:54,442 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:54,444 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:54,447 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:54,449 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:54,454 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:54,464 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:54,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:42:54,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:42:54,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:42:54,474 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:54,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:42:54,483 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:54,483 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:42:54,484 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:54,499 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:54,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:42:54,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:42:54,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:54,509 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:54,509 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:54,510 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:54,510 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:54,510 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:42:54,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:54,510 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:42:54,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:54,512 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:42:54,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:42:54,512 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:54,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:42:54,513 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:42:54,514 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:42:54,514 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:54,515 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:42:54,516 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:54,516 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:54,516 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:54,516 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:42:54,516 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:42:54,517 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:42:54,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:42:54,520 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:42:54,520 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:54,522 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:54,522 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:42:54,523 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:54,524 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:54,524 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:54,524 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:54,532 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3994, Threshold=0.4280, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:42:54,532 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3994
2025-08-04 20:43:02,806 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:02,806 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:02,806 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:02,806 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:43:02,806 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:43:02,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:03,048 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:03,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:03,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:43:03,157 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:43:03,158 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:03,249 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:03,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:03,253 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:03,259 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:43:03,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:03,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:43:03,266 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:03,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:03,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:43:03,275 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:03,278 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:03,280 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:03,282 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:03,284 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:03,286 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:03,289 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:03,291 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:03,293 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:03,295 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:03,297 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:03,306 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:03,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:43:03,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:43:03,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:43:03,315 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:03,315 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:43:03,324 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:03,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:43:03,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:03,338 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:03,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:43:03,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:43:03,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:03,348 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:03,348 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:03,349 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:03,349 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:03,349 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:43:03,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:03,349 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:43:03,350 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:03,351 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:43:03,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:43:03,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:43:03,353 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:43:03,353 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:43:03,353 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:43:03,353 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:43:03,354 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:43:03,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:43:03,354 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:43:03,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:43:03,355 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:43:03,355 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:43:03,355 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:03,355 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:43:03,355 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:03,355 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:03,356 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:03,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:43:03,356 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:43:03,356 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:43:03,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:43:03,358 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:43:03,359 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:03,360 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:03,360 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:03,362 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 96/400.
2025-08-04 20:43:03,463 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:03,463 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:03,464 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 483 anomalous samples to GAN training data (target: 483).
2025-08-04 20:43:03,464 - ClientAppLogger [Client 2] - INFO - [Client] Round 96: Training GAN with 2096 samples (1613 normal, 483 anomalous).
2025-08-04 20:43:03,465 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:05,037 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.8259
2025-08-04 20:43:05,037 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.8259
2025-08-04 20:43:05,037 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:05,045 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4337, Threshold=0.4694, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:43:05,045 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:43:05,045 - ClientAppLogger [Client 2] - INFO - Fit completed for round 96. Duration: 1.68s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 96, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0847361855834494, 'd_loss': 0.8258796804733859, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.6834595203399658, 'cpu_percent_fit': 31.19375, 'ram_mb_fit': 2.8203125, 'accumulated_train_samples_this_round': 2096}
2025-08-04 20:43:05,046 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:43:10,310 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:10,311 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:10,311 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:10,311 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:43:10,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:43:10,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:10,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:10,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:10,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:43:10,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:43:10,649 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:10,730 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:10,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:10,736 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:10,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:43:10,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:10,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:43:10,749 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:10,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:10,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:43:10,759 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:10,761 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:10,764 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:10,766 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:10,769 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:10,771 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:10,773 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:10,776 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:10,779 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:10,781 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:10,783 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:10,791 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:10,791 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:43:10,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:43:10,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:43:10,800 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:10,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:43:10,808 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:10,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:43:10,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:10,823 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:10,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:43:10,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:43:10,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:10,832 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:10,833 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:10,833 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:10,833 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:10,833 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:43:10,833 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:10,834 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:43:10,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:10,835 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:43:10,835 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:43:10,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:43:10,837 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:43:10,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:43:10,837 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:43:10,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:43:10,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:43:10,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:43:10,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:43:10,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:43:10,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:43:10,839 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:43:10,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:10,839 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:43:10,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:10,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:10,840 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:10,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:43:10,840 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:43:10,840 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:43:10,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:43:10,844 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:43:10,844 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:10,845 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:10,845 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:10,847 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:10,847 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:10,847 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:10,848 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:10,856 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4327, Threshold=0.4684, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:43:10,856 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4327
2025-08-04 20:43:25,128 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:25,128 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:25,128 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:25,128 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:43:25,128 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:43:25,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:25,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:25,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:25,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:43:25,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:43:25,480 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:25,576 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:25,583 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:25,583 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:25,589 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:43:25,607 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:25,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:43:25,608 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:25,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:25,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:43:25,617 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:25,620 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:25,622 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:25,624 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:25,627 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:25,629 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:25,631 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:25,634 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:25,636 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:25,638 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:25,641 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:25,651 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:25,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:43:25,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:43:25,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:43:25,661 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:25,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:43:25,671 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:25,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:43:25,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:25,686 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:25,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:43:25,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:43:25,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:25,696 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:25,696 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:25,696 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:25,697 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:25,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:43:25,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:25,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:43:25,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:25,699 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:43:25,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:43:25,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:25,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:43:25,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:25,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:25,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:25,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:43:25,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:43:25,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:43:25,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:43:25,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:43:25,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:43:25,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:43:25,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:43:25,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:43:25,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:43:25,703 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:43:25,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:43:25,703 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:25,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:43:25,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:25,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:25,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:25,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:43:25,704 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:43:25,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:43:25,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:43:25,710 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:43:25,710 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:25,711 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:25,712 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:25,713 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:25,713 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:25,713 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:25,714 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:25,722 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4039, Threshold=0.4342, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:43:25,722 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4039
2025-08-04 20:43:43,024 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:43,024 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:43,024 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:43,024 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:43:43,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:43:43,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:43,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:43,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:43,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:43:43,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:43:43,358 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:43,447 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:43,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:43,453 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:43,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:43:43,466 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:43,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:43:43,467 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:43,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:43,468 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:43:43,477 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:43,480 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:43,482 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:43,484 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:43,487 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:43,489 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:43,492 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:43,494 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:43,497 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:43,499 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:43,501 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:43,510 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:43,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:43:43,515 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:43:43,515 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:43:43,520 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:43,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:43:43,528 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:43,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:43:43,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:43,543 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:43,548 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:43:43,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:43:43,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:43,553 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:43,553 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:43,553 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:43,554 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:43,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:43:43,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:43,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:43:43,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:43,555 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:43,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:43:43,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:43:43,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:43:43,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:43:43,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:43:43,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:43:43,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:43:43,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:43:43,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:43:43,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:43:43,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:43:43,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:43:43,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:43,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:43:43,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:43,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:43,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:43,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:43:43,560 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:43:43,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:43:43,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:43:43,563 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:43:43,563 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:43,565 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:43,565 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:43,566 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:43,566 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:43,567 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:43,567 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:43,575 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4393, Threshold=0.4693, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:43:43,575 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4393
2025-08-04 20:43:57,860 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:57,860 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:43:57,860 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:43:57,860 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:43:57,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:43:57,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:58,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:58,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:58,230 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:43:58,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:43:58,258 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:58,340 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:58,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:58,345 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:58,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:43:58,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:58,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:43:58,359 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:58,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:58,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:43:58,368 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:58,370 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:58,373 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:58,375 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:58,378 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:58,380 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:58,383 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:58,385 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:58,388 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:58,390 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:58,392 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:58,400 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:58,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:43:58,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:43:58,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:43:58,409 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:58,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:43:58,417 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:58,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:43:58,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:58,431 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:58,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:43:58,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:43:58,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:58,441 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:58,441 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:58,441 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:58,441 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:58,441 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:43:58,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:58,442 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:43:58,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:58,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:43:58,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:43:58,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:43:58,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:43:58,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:43:58,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:43:58,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:43:58,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:43:58,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:43:58,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:43:58,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:43:58,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:43:58,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:43:58,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:58,447 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:43:58,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:58,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:58,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:58,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:43:58,448 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:43:58,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:43:58,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:43:58,451 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:43:58,451 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:58,452 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:58,452 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:43:58,454 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:58,454 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:58,454 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:58,455 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:58,462 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3777, Threshold=0.3870, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:43:58,462 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3777
2025-08-04 20:44:03,723 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:03,723 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:03,723 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:03,723 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:44:03,723 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:44:03,724 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:03,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:03,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:04,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:44:04,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:44:04,092 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:04,176 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:04,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:04,182 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:04,188 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:44:04,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:04,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:44:04,195 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:04,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:04,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:44:04,204 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:04,206 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:04,208 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:04,211 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:04,213 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:04,215 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:04,218 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:04,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:04,223 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:04,224 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:04,226 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:04,234 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:04,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:44:04,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:44:04,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:44:04,243 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:04,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:44:04,252 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:04,252 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:44:04,252 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:04,267 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:04,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:44:04,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:44:04,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:04,277 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:04,277 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:04,277 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:04,277 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:04,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:44:04,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:04,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:44:04,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:04,280 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:44:04,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:44:04,280 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:04,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:44:04,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:44:04,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:44:04,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:44:04,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:04,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:44:04,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:04,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:04,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:04,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:44:04,285 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:44:04,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:44:04,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:44:04,288 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:44:04,288 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:04,290 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:04,290 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:04,291 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 100/400.
2025-08-04 20:44:04,393 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:04,393 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:04,394 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 503 anomalous samples to GAN training data (target: 503).
2025-08-04 20:44:04,394 - ClientAppLogger [Client 2] - INFO - [Client] Round 100: Training GAN with 2182 samples (1679 normal, 503 anomalous).
2025-08-04 20:44:04,395 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:06,025 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.8087
2025-08-04 20:44:06,025 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.8087
2025-08-04 20:44:06,025 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:06,034 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3992, Threshold=0.4094, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:44:06,034 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:44:06,034 - ClientAppLogger [Client 2] - INFO - Fit completed for round 100. Duration: 1.74s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 100, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0855101156409566, 'd_loss': 0.8086657025309247, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.7427620887756348, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 0.1328125, 'accumulated_train_samples_this_round': 2182}
2025-08-04 20:44:06,034 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:44:11,297 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,298 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:11,298 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:11,298 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:44:11,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:44:11,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:11,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:11,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:11,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:44:11,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:44:11,853 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:12,045 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:12,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:12,055 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:12,062 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:44:12,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:12,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:44:12,085 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:12,085 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:12,085 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:44:12,098 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:12,103 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,105 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:12,108 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:12,112 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:12,115 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:12,119 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,123 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:12,128 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:12,131 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:12,135 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:12,147 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:12,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:44:12,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:44:12,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:44:12,161 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:12,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:44:12,175 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:12,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:44:12,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:12,196 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:12,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:44:12,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:44:12,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:12,209 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:12,209 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:12,209 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:12,210 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:12,210 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:44:12,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:12,210 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:44:12,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:12,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:44:12,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:44:12,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:12,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:44:12,212 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:12,213 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:12,213 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:12,213 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:44:12,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:44:12,213 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:44:12,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:44:12,214 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:44:12,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:44:12,215 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:44:12,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:44:12,216 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:44:12,216 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:44:12,216 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:44:12,216 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:44:12,216 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:12,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:44:12,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:12,217 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:12,218 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:12,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:44:12,218 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:44:12,218 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:44:12,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:44:12,226 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:44:12,227 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:12,228 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:12,229 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:12,230 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:12,230 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:12,230 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:12,231 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:12,240 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3999, Threshold=0.4105, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:44:12,240 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.3999
2025-08-04 20:44:20,509 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:20,509 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:20,509 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:20,509 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:44:20,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:44:20,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:20,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:20,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:20,871 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:44:20,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:44:20,899 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:20,992 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:20,998 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:20,998 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:21,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:44:21,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:21,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:44:21,012 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:21,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:21,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:44:21,022 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:21,025 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:21,027 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:21,030 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:21,033 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:21,035 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:21,039 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:21,042 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:21,045 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:21,048 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:21,050 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:21,059 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:21,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:44:21,064 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:44:21,064 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:44:21,068 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:21,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:44:21,076 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:21,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:44:21,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:21,091 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:21,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:44:21,101 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:44:21,101 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:21,101 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:21,101 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:21,101 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:21,102 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:21,102 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:44:21,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:21,102 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:44:21,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:21,104 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:44:21,104 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:44:21,104 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:21,104 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:44:21,104 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:21,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:21,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:21,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:44:21,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:44:21,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:44:21,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:44:21,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:44:21,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:44:21,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:44:21,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:44:21,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:44:21,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:44:21,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:44:21,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:44:21,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:21,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:44:21,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:21,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:21,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:21,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:44:21,109 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:44:21,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:44:21,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:44:21,112 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:44:21,112 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:21,113 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:21,114 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:21,115 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 101/400.
2025-08-04 20:44:21,216 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:21,216 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:21,218 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 510 anomalous samples to GAN training data (target: 510).
2025-08-04 20:44:21,218 - ClientAppLogger [Client 2] - INFO - [Client] Round 101: Training GAN with 2210 samples (1700 normal, 510 anomalous).
2025-08-04 20:44:21,218 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:22,886 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.8085
2025-08-04 20:44:22,886 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.8085
2025-08-04 20:44:22,886 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:22,894 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4237, Threshold=0.4353, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:44:22,894 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:44:22,895 - ClientAppLogger [Client 2] - INFO - Fit completed for round 101. Duration: 1.78s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 101, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085545287002805, 'd_loss': 0.8085254583207728, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.7794687747955322, 'cpu_percent_fit': 31.15625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2210}
2025-08-04 20:44:22,895 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:44:31,162 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:31,162 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:31,163 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:31,163 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:44:31,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:44:31,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:31,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:31,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:31,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:44:31,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:44:31,530 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:31,621 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:31,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:31,626 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:31,633 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:44:31,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:31,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:44:31,642 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:31,642 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:31,642 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:44:31,651 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:31,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:31,657 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:31,661 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:31,663 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:31,665 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:31,668 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:31,671 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:31,674 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:31,675 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:31,678 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:31,688 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:31,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:44:31,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:44:31,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:44:31,697 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:31,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:44:31,708 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:31,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:44:31,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:31,725 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:31,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:44:31,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:44:31,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:31,735 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:31,736 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:31,736 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:31,736 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:31,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:44:31,736 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:31,737 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:44:31,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:31,738 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:44:31,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:44:31,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:31,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:44:31,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:31,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:44:31,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:44:31,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:44:31,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:44:31,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:44:31,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:44:31,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:44:31,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:44:31,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:31,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:44:31,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:31,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:31,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:31,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:44:31,744 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:44:31,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:44:31,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:44:31,749 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:44:31,749 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:31,750 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:31,750 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:31,751 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:31,752 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:31,752 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:31,752 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:31,761 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4102, Threshold=0.4214, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:44:31,761 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4102
2025-08-04 20:44:49,040 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:49,040 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:44:49,040 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:44:49,040 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:44:49,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:44:49,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:49,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:49,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:49,363 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:44:49,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:44:49,384 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:49,468 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:49,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:49,474 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:49,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:44:49,485 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:49,485 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:44:49,485 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:49,485 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:49,485 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:44:49,494 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:49,497 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:49,499 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:49,501 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:49,504 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:49,506 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:49,509 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:49,511 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:49,514 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:49,516 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:49,518 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:49,527 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:49,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:44:49,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:44:49,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:44:49,537 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:49,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:44:49,546 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:49,546 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:44:49,546 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:49,561 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:49,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:44:49,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:44:49,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:49,571 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:49,572 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:49,572 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:49,572 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:49,572 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:44:49,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:49,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:44:49,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:49,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:44:49,575 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:44:49,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:49,575 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:44:49,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:44:49,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:44:49,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:44:49,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:44:49,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:44:49,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:44:49,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:44:49,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:44:49,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:44:49,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:49,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:44:49,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:49,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:49,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:49,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:44:49,580 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:44:49,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:44:49,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:44:49,584 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:44:49,584 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:49,586 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:49,586 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:44:49,587 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:49,587 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:49,587 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:49,588 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:49,596 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4308, Threshold=0.4523, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:44:49,596 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4308
2025-08-04 20:45:09,888 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:09,888 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:09,891 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:09,891 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:45:09,891 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:45:09,891 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:10,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:10,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:10,227 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:45:10,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:45:10,254 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:10,338 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:10,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:10,344 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:10,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:45:10,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:10,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:45:10,357 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:10,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:10,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:45:10,366 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:10,369 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:10,371 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:10,374 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:10,376 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:10,378 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:10,381 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:10,383 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:10,386 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:10,388 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:10,391 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:10,399 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:10,399 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:45:10,404 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:45:10,404 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:45:10,409 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:10,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:45:10,417 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:10,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:45:10,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:10,432 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:10,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:45:10,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:45:10,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:10,442 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:10,442 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:10,442 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:10,442 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:10,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:45:10,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:10,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:45:10,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:10,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:45:10,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:45:10,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:10,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:45:10,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:45:10,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:45:10,447 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:45:10,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:10,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:45:10,449 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:10,449 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:10,449 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:10,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:45:10,450 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:45:10,450 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:45:10,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:45:10,454 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:45:10,454 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:10,455 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:10,455 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:10,457 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:10,457 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:10,457 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:10,458 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:10,465 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4477, Threshold=0.4908, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:45:10,465 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4477
2025-08-04 20:45:30,761 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:30,762 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:30,762 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:30,762 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:45:30,762 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:45:30,762 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:31,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:31,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:31,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:45:31,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:45:31,131 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:31,228 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:31,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:31,234 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:31,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:45:31,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:31,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:45:31,245 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:31,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:31,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:45:31,254 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:31,256 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:31,259 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:31,261 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:31,264 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:31,266 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:31,268 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:31,270 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:31,273 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:31,275 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:31,278 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:31,287 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:31,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:45:31,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:45:31,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:45:31,297 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:31,297 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:45:31,306 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:31,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:45:31,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:31,330 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:31,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:45:31,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:45:31,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:31,340 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:31,340 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:31,340 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:31,341 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:31,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:45:31,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:31,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:45:31,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:31,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:45:31,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:45:31,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:31,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:45:31,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:45:31,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:45:31,345 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:45:31,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:45:31,346 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:45:31,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:45:31,346 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:45:31,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:45:31,346 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:31,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:45:31,347 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:31,347 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:31,347 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:31,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:45:31,348 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:45:31,348 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:45:31,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:45:31,352 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:45:31,352 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:31,353 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:31,353 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:31,355 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:31,355 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:31,355 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:31,356 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:31,364 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4798, Threshold=0.5203, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:45:31,364 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4798
2025-08-04 20:45:45,659 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:45,659 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:45,660 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:45,660 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:45:45,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:45:45,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:46,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:46,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:46,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:45:46,216 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:45:46,217 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:46,377 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:46,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:46,385 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:46,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:45:46,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:46,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:45:46,406 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:46,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:46,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:45:46,416 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:46,419 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,421 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:46,423 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:46,427 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:46,430 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:46,432 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,435 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:46,437 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:46,439 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:46,442 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:46,451 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:46,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:45:46,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:45:46,461 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,461 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:45:46,471 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:45:46,472 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,487 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:45:46,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:45:46,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,498 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,498 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,499 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,499 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:45:46,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,499 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:45:46,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,501 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:45:46,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,502 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:45:46,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:45:46,503 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:45:46,503 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:45:46,504 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:45:46,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:45:46,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:45:46,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:45:46,505 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:45:46,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:45:46,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:45:46,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:45:46,506 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:45:46,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,507 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:45:46,508 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:45:46,508 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:45:46,508 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:45:46,512 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:45:46,512 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,513 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,513 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:46,515 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,515 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,515 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,516 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,524 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4923, Threshold=0.5621, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:45:46,524 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4923
2025-08-04 20:45:51,775 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:51,775 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:51,775 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:51,776 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:45:51,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:45:51,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:51,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:51,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:52,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:45:52,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:45:52,107 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:52,192 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:52,197 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:52,197 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:52,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:45:52,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:52,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:45:52,209 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:52,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:52,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:45:52,217 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:52,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:52,222 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:52,224 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:52,227 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:52,229 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:52,231 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:52,234 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:52,236 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:52,238 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:52,240 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:52,249 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:52,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:45:52,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:45:52,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:45:52,258 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:52,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:45:52,266 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:52,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:45:52,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:52,281 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:52,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:45:52,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:45:52,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:52,291 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:52,291 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:52,291 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:52,291 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:52,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:45:52,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:52,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:45:52,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:52,294 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:52,295 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:45:52,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:45:52,295 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:45:52,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:45:52,295 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:45:52,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:45:52,296 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:45:52,296 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:45:52,296 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:45:52,296 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:45:52,297 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:45:52,297 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:45:52,297 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:52,297 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:45:52,297 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:52,297 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:52,298 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:52,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:45:52,298 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:45:52,298 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:45:52,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:45:52,302 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:45:52,302 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:52,303 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:52,303 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:52,305 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 106/400.
2025-08-04 20:45:52,405 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:52,405 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:52,407 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 534 anomalous samples to GAN training data (target: 534).
2025-08-04 20:45:52,408 - ClientAppLogger [Client 2] - INFO - [Client] Round 106: Training GAN with 2314 samples (1780 normal, 534 anomalous).
2025-08-04 20:45:52,408 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:54,076 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0848, Avg D Loss: 0.7920
2025-08-04 20:45:54,076 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0848, Avg D Loss: 0.7920
2025-08-04 20:45:54,076 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:54,084 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4483, Threshold=0.4978, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:45:54,084 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:45:54,084 - ClientAppLogger [Client 2] - INFO - Fit completed for round 106. Duration: 1.78s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 106, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0848331220209753, 'd_loss': 0.7919840306996682, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.779531717300415, 'cpu_percent_fit': 31.15625, 'ram_mb_fit': 0.125, 'accumulated_train_samples_this_round': 2314}
2025-08-04 20:45:54,084 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:45:59,335 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:59,335 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:45:59,336 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:45:59,336 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:45:59,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:45:59,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:59,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:59,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:59,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:45:59,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:45:59,689 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:59,780 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:59,785 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:59,785 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:59,791 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:45:59,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:59,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:45:59,799 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:59,799 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:59,799 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:45:59,808 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:59,811 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:59,813 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:59,815 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:59,818 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:59,820 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:59,822 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:59,825 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:59,827 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:59,830 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:59,832 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:59,842 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:59,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:45:59,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:45:59,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:45:59,851 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:59,852 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:45:59,863 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:59,863 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:45:59,863 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:59,880 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:59,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:45:59,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:45:59,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:59,893 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:59,893 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:59,893 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:59,894 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:59,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:45:59,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:59,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:45:59,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:59,896 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:45:59,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:45:59,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:59,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:45:59,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:59,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:59,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:59,898 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:45:59,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:45:59,898 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:45:59,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:45:59,898 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:45:59,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:45:59,901 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:45:59,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:45:59,901 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:45:59,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:45:59,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:45:59,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:45:59,903 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:59,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:45:59,903 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:59,903 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:59,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:59,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:45:59,904 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:45:59,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:45:59,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:45:59,909 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:45:59,909 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:59,911 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:59,911 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:45:59,913 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:59,913 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:59,913 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:59,914 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:59,923 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4485, Threshold=0.4984, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:45:59,923 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4485
2025-08-04 20:46:05,172 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:05,172 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:05,173 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:05,173 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:46:05,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:46:05,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:05,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:05,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:05,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:46:05,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:46:05,525 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:05,616 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:05,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:05,622 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:05,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:46:05,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:05,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:46:05,635 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:05,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:05,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:46:05,644 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:05,647 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:05,651 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:05,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:05,656 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:05,658 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:05,661 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:05,663 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:05,666 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:05,668 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:05,671 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:05,682 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:05,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:46:05,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:46:05,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:46:05,692 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:05,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:46:05,703 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:05,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:46:05,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:05,729 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:05,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:46:05,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:46:05,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:05,741 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:05,741 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:05,742 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:05,742 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:05,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:46:05,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:05,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:46:05,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:05,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:46:05,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:46:05,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:46:05,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:46:05,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:46:05,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:46:05,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:46:05,747 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:46:05,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:46:05,748 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:46:05,748 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:46:05,748 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:46:05,748 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:46:05,748 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:05,748 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:46:05,749 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:05,749 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:05,749 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:05,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:46:05,750 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:46:05,750 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:46:05,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:46:05,754 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:46:05,755 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:05,756 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:05,756 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:05,757 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 107/400.
2025-08-04 20:46:05,859 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:05,859 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:05,860 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 540 anomalous samples to GAN training data (target: 540).
2025-08-04 20:46:05,861 - ClientAppLogger [Client 2] - INFO - [Client] Round 107: Training GAN with 2341 samples (1801 normal, 540 anomalous).
2025-08-04 20:46:05,861 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:07,642 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0846, Avg D Loss: 0.7914
2025-08-04 20:46:07,642 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0846, Avg D Loss: 0.7914
2025-08-04 20:46:07,643 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:07,650 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4543, Threshold=0.5065, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:46:07,650 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:46:07,651 - ClientAppLogger [Client 2] - INFO - Fit completed for round 107. Duration: 1.89s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 107, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084573508714418, 'd_loss': 0.791367374429943, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.8934247493743896, 'cpu_percent_fit': 31.25, 'ram_mb_fit': 0.1484375, 'accumulated_train_samples_this_round': 2341}
2025-08-04 20:46:07,651 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:46:12,916 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:12,916 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:12,916 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:12,916 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:46:12,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:46:12,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:13,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:13,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:13,353 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:46:13,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:46:13,386 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:13,504 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:13,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:13,509 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:13,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:46:13,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:13,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:46:13,581 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:13,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:13,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:46:13,590 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:13,593 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,596 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:13,599 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:13,606 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:13,610 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:13,613 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,616 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:13,619 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:13,621 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:13,623 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:13,633 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:13,633 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:46:13,638 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:46:13,638 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:46:13,643 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:13,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:46:13,655 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:13,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:46:13,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:13,673 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:13,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:46:13,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:46:13,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:13,687 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:13,687 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:13,687 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:13,687 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:13,688 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:46:13,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:13,688 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:46:13,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:13,690 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:46:13,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:46:13,690 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:13,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:46:13,690 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:46:13,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:46:13,693 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:46:13,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:46:13,694 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:46:13,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:46:13,694 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:46:13,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:46:13,694 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:13,695 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:46:13,695 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:13,695 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:13,696 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:13,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:46:13,696 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:46:13,696 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:46:13,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:46:13,702 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:46:13,702 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:13,703 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:13,703 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:13,705 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:13,705 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:13,705 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:13,706 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:13,715 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4543, Threshold=0.5064, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:46:13,715 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4543
2025-08-04 20:46:27,995 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:27,995 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:27,996 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:27,996 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:46:27,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:46:27,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:28,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:28,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:28,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:46:28,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:46:28,371 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:28,472 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:28,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:28,479 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:28,486 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:46:28,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:28,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:46:28,496 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:28,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:28,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:46:28,505 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:28,508 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:28,510 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:28,513 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:28,515 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:28,517 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:28,520 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:28,522 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:28,525 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:28,527 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:28,529 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:28,539 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:28,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:46:28,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:46:28,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:46:28,549 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:28,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:46:28,559 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:28,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:46:28,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:28,583 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:28,587 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:46:28,593 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:46:28,594 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:28,594 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:28,594 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:28,594 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:28,594 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:28,595 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:46:28,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:28,595 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:46:28,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:28,596 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:46:28,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:46:28,597 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:28,597 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:46:28,597 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:28,597 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:28,597 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:28,598 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:46:28,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:46:28,598 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:46:28,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:46:28,598 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:46:28,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:46:28,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:46:28,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:46:28,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:46:28,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:46:28,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:46:28,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:46:28,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:46:28,602 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:46:28,602 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:46:28,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:46:28,605 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:46:28,609 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:28,610 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:28,610 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:28,612 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:28,612 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:28,612 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:28,613 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:28,622 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4733, Threshold=0.5365, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:46:28,622 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4733
2025-08-04 20:46:42,898 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:42,898 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:42,898 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:42,898 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:46:42,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:46:42,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:43,162 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:43,162 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:43,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:46:43,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:46:43,281 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:43,378 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:43,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:43,387 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:43,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:46:43,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:43,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:46:43,427 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:43,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:43,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:46:43,437 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:43,440 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:43,442 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:43,445 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:43,448 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:43,451 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:43,453 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:43,455 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:43,458 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:43,461 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:43,463 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:43,474 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:43,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:46:43,480 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:46:43,480 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:46:43,485 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:43,485 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:46:43,497 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:43,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:46:43,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:43,515 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:43,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:46:43,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:46:43,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:43,527 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:43,527 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:43,528 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:43,528 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:43,528 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:46:43,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:43,528 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:46:43,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:43,530 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:46:43,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:46:43,530 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:43,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:46:43,531 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:43,531 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:43,531 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:43,531 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:46:43,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:46:43,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:46:43,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:46:43,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:46:43,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:46:43,534 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:46:43,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:46:43,534 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:46:43,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:46:43,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:46:43,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:46:43,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:43,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:46:43,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:43,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:43,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:43,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:46:43,536 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:46:43,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:46:43,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:46:43,543 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:46:43,543 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:43,545 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:43,545 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:43,546 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:43,546 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:43,546 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:43,547 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:43,555 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4571, Threshold=0.5132, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:46:43,555 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4571
2025-08-04 20:46:57,821 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:57,821 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:46:57,822 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:46:57,822 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:46:57,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:46:57,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:58,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:58,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:58,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:46:58,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:46:58,208 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:58,312 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:58,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:58,320 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:58,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:46:58,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:58,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:46:58,342 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:58,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:58,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:46:58,351 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:58,354 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:58,356 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:58,358 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:58,361 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:58,363 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:58,366 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:58,368 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:58,371 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:58,373 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:58,375 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:58,386 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:58,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:46:58,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:46:58,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:46:58,401 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:58,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:46:58,412 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:58,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:46:58,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:58,430 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:58,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:46:58,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:46:58,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:58,444 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:58,445 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:58,445 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:58,445 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:58,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:46:58,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:58,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:46:58,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:58,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:46:58,447 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:46:58,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:58,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:46:58,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:58,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:58,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:58,449 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:46:58,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:46:58,449 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:46:58,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:46:58,449 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:46:58,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:46:58,451 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:46:58,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:46:58,451 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:46:58,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:46:58,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:46:58,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:46:58,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:58,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:46:58,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:58,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:58,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:58,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:46:58,454 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:46:58,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:46:58,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:46:58,456 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:46:58,456 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:58,457 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:58,458 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:46:58,460 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:58,460 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:58,460 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:58,461 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:58,469 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4948, Threshold=0.5561, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:46:58,469 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4948
2025-08-04 20:47:06,731 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:06,731 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:06,732 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:06,732 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:47:06,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:47:06,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:06,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:06,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:07,056 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:47:07,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:47:07,083 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:07,168 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:07,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:07,173 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:07,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:47:07,185 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:07,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:47:07,186 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:07,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:07,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:47:07,195 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:07,197 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:07,199 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:07,202 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:07,204 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:07,206 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:07,209 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:07,211 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:07,214 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:07,216 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:07,218 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:07,226 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:07,226 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:47:07,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:47:07,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:47:07,235 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:07,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:47:07,243 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:07,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:47:07,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:07,258 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:07,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:47:07,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:47:07,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:07,268 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:07,268 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:07,269 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:07,269 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:07,269 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:47:07,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:07,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:47:07,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:07,271 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:47:07,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:47:07,271 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:07,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:47:07,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:07,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:07,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:07,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:47:07,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:47:07,273 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:47:07,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:47:07,273 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:47:07,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:47:07,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:47:07,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:47:07,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:47:07,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:47:07,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:47:07,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:47:07,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:07,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:47:07,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:07,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:07,276 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:07,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:47:07,276 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:47:07,276 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:47:07,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:47:07,280 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:47:07,280 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:07,281 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:07,282 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:07,283 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 111/400.
2025-08-04 20:47:07,384 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:07,384 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:07,385 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 560 anomalous samples to GAN training data (target: 560).
2025-08-04 20:47:07,386 - ClientAppLogger [Client 2] - INFO - [Client] Round 111: Training GAN with 2429 samples (1869 normal, 560 anomalous).
2025-08-04 20:47:07,386 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:09,157 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7869
2025-08-04 20:47:09,158 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7869
2025-08-04 20:47:09,158 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:09,166 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4660, Threshold=0.5261, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:47:09,166 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:47:09,167 - ClientAppLogger [Client 2] - INFO - Fit completed for round 111. Duration: 1.88s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 111, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0847000149651875, 'd_loss': 0.7869498517789091, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.883422613143921, 'cpu_percent_fit': 31.26875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2429}
2025-08-04 20:47:09,167 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:47:14,491 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:14,491 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:14,492 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:14,492 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:47:14,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:47:14,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:14,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:14,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:14,831 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:47:14,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:47:14,859 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:14,949 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:14,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:14,954 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:14,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:47:14,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:14,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:47:14,968 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:14,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:14,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:47:14,977 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:14,979 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:14,981 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:14,983 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:14,986 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:14,988 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:14,991 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:14,993 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:14,995 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:14,997 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:14,999 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:15,010 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:15,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:47:15,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:47:15,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:47:15,020 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:15,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:47:15,030 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:15,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:47:15,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:15,045 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:15,050 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:47:15,058 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:47:15,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:15,059 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:15,059 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:15,059 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:15,059 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:15,060 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:47:15,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:15,060 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:47:15,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:15,061 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:47:15,062 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:47:15,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:15,062 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:47:15,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:15,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:47:15,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:47:15,065 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:47:15,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:47:15,065 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:47:15,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:47:15,066 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:47:15,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:47:15,066 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:15,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:47:15,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:15,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:15,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:15,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:47:15,068 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:47:15,068 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:47:15,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:47:15,073 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:47:15,073 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:15,075 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:15,075 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:15,077 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:15,077 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:15,077 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:15,078 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:15,086 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4660, Threshold=0.5265, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:47:15,086 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4660
2025-08-04 20:47:32,375 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:32,376 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:32,376 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:32,379 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:47:32,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:47:32,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:32,638 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:32,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:32,723 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:47:32,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:47:32,751 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:32,851 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:32,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:32,860 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:32,868 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:47:32,874 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:32,874 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:47:32,875 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:32,875 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:32,875 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:47:32,884 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:32,888 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:32,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:32,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:32,896 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:32,899 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:32,901 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:32,904 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:32,907 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:32,909 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:32,911 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:32,922 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:32,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:47:32,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:47:32,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:47:32,932 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:32,932 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:47:32,941 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:32,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:47:32,942 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:32,958 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:32,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:47:32,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:47:32,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:32,969 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:32,969 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:32,970 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:32,970 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:32,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:47:32,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:32,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:47:32,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:32,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:47:32,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:47:32,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:32,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:47:32,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:32,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:32,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:32,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:47:32,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:47:32,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:47:32,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:47:32,975 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:47:32,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:47:32,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:47:32,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:47:32,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:47:32,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:47:32,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:47:32,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:47:32,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:32,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:47:32,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:32,982 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:32,982 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:32,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:47:32,982 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:47:32,983 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:47:32,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:47:32,987 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:47:32,988 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:32,989 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:32,990 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:32,992 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:32,992 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:32,992 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:32,993 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:33,004 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4356, Threshold=0.4801, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:47:33,004 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4356
2025-08-04 20:47:38,253 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:38,253 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:38,254 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:38,254 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:47:38,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:47:38,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:38,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:38,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:38,594 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:47:38,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:47:38,624 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:38,712 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:38,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:38,717 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:38,724 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:47:38,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:38,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:47:38,732 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:38,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:38,733 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:47:38,741 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:38,744 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:38,746 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:38,749 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:38,751 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:38,753 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:38,756 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:38,758 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:38,761 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:38,763 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:38,765 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:38,776 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:38,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:47:38,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:47:38,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:47:38,786 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:38,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:47:38,795 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:38,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:47:38,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:38,811 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:38,815 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:47:38,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:47:38,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:38,821 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:38,821 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:38,822 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:38,822 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:38,822 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:47:38,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:38,822 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:47:38,823 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:38,824 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:47:38,824 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:47:38,824 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:47:38,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:47:38,826 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:47:38,826 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:47:38,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:47:38,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:47:38,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:47:38,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:47:38,828 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:47:38,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:47:38,828 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:38,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:47:38,828 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:38,832 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:38,832 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:38,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:47:38,832 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:47:38,832 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:47:38,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:47:38,836 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:47:38,836 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:38,837 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:38,838 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:38,839 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 113/400.
2025-08-04 20:47:38,940 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:38,940 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:38,941 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 571 anomalous samples to GAN training data (target: 571).
2025-08-04 20:47:38,945 - ClientAppLogger [Client 2] - INFO - [Client] Round 113: Training GAN with 2476 samples (1905 normal, 571 anomalous).
2025-08-04 20:47:38,945 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:40,753 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.7848
2025-08-04 20:47:40,753 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.7848
2025-08-04 20:47:40,753 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:40,761 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4780, Threshold=0.5488, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:47:40,761 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:47:40,761 - ClientAppLogger [Client 2] - INFO - Fit completed for round 113. Duration: 1.92s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 113, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084405191919145, 'd_loss': 0.7847915230929755, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.9223482608795166, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2476}
2025-08-04 20:47:40,762 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:47:46,049 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:46,049 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:47:46,049 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:47:46,049 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:47:46,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:47:46,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:46,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:46,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:46,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:47:46,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:47:46,445 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:46,544 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:46,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:46,550 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:46,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:47:46,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:46,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:47:46,566 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:46,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:46,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:47:46,575 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:46,578 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,580 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:46,582 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:46,585 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:46,587 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:46,590 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,592 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:46,595 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:46,598 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:46,600 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:46,611 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:46,611 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:47:46,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:47:46,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:47:46,621 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:46,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:47:46,629 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:46,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:47:46,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:46,644 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:46,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:47:46,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:47:46,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:46,655 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:46,655 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:46,655 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:46,656 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:46,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:47:46,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:46,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:47:46,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:46,658 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:47:46,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:47:46,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:47:46,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:47:46,660 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:47:46,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:46,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:47:46,662 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:46,665 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:46,665 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:46,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:47:46,665 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:47:46,665 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:47:46,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:47:46,669 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:47:46,669 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:46,670 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:46,670 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:47:46,672 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:46,672 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:46,672 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:46,672 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:46,681 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4778, Threshold=0.5485, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:47:46,681 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4778
2025-08-04 20:48:03,968 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:03,968 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:03,969 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:03,969 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:03,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:03,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:04,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:04,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:04,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:04,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:04,406 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:04,505 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:04,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:04,512 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:04,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:48:04,526 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:04,526 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:48:04,527 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:04,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:04,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:48:04,538 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:04,541 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,543 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:04,545 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:04,548 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:04,550 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:04,553 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,555 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:04,558 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:04,560 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:04,562 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:04,571 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:04,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:48:04,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:48:04,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:48:04,581 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:04,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:48:04,590 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:04,590 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:48:04,591 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:04,607 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:04,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:48:04,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:48:04,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:04,619 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:04,619 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:04,620 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:04,620 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:04,620 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:48:04,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:04,621 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:48:04,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:04,622 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:48:04,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:48:04,622 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:04,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:48:04,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:48:04,624 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:48:04,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:48:04,624 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:04,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:48:04,626 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:04,629 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:04,629 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:04,629 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:48:04,630 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:48:04,630 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:48:04,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:48:04,634 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:48:04,634 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:04,635 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:04,635 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:04,637 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:04,637 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:04,637 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:04,638 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:04,648 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5093, Threshold=0.5865, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:48:04,650 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5093
2025-08-04 20:48:15,938 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:15,938 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:15,938 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:15,938 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:15,938 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:15,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:16,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:16,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:16,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:16,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:16,413 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:16,508 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:16,514 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:16,514 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:16,521 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:48:16,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:16,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:48:16,530 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:16,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:16,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:48:16,540 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:16,543 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,546 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:16,548 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:16,551 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:16,553 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:16,556 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,558 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:16,561 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:16,563 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:16,565 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:16,577 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:16,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:48:16,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:48:16,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:48:16,589 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:16,589 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:48:16,598 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:16,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:48:16,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:16,623 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:16,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:48:16,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:48:16,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:16,634 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:16,634 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:16,634 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:16,637 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:48:16,637 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:48:16,638 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:48:16,639 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:48:16,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:48:16,639 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:48:16,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:48:16,640 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:48:16,640 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:48:16,641 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:48:16,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:48:16,641 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:48:16,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:48:16,641 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:16,642 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:48:16,642 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:16,646 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:16,646 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:16,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:48:16,646 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:48:16,647 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:48:16,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:48:16,650 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:48:16,651 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:16,652 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:16,652 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:16,653 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:16,653 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:16,654 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:16,654 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:16,662 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5420, Threshold=0.6216, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:48:16,664 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5420
2025-08-04 20:48:27,938 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:27,938 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:27,938 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:27,938 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:27,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:27,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:28,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:28,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:28,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:28,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:28,338 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:28,452 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:28,461 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:28,461 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:28,480 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:48:28,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:28,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:48:28,505 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:28,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:28,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:48:28,515 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:28,518 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,521 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:28,523 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:28,527 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:28,529 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:28,532 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,534 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:28,537 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:28,539 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:28,542 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:28,552 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:28,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:48:28,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:48:28,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:48:28,563 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:28,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:48:28,574 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:28,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:48:28,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:28,592 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:28,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:48:28,606 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:48:28,606 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:28,606 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:28,606 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:28,608 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:28,608 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:28,609 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:48:28,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:28,609 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:48:28,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:28,610 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:48:28,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:48:28,611 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:48:28,612 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:48:28,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:48:28,612 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:48:28,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:48:28,613 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:48:28,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:48:28,613 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:48:28,614 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:48:28,614 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:48:28,614 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:48:28,614 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:28,614 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:48:28,615 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:28,618 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:28,618 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:28,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:48:28,618 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:48:28,618 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:48:28,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:48:28,625 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:48:28,627 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:28,631 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:28,631 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:28,633 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:28,635 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:28,636 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:28,636 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:28,645 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4527, Threshold=0.5184, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:48:28,645 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4527
2025-08-04 20:48:33,895 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:33,896 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:33,896 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:33,896 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:33,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:33,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:34,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:34,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:34,222 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:34,252 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:34,252 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:34,337 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:34,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:34,343 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:34,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:48:34,355 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:34,355 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:48:34,356 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:34,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:34,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:48:34,364 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:34,367 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:34,369 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:34,371 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:34,374 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:34,376 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:34,378 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:34,381 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:34,384 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:34,385 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:34,388 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:34,397 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:34,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:48:34,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:48:34,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:48:34,406 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:34,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:48:34,414 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:34,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:48:34,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:34,430 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:34,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:48:34,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:48:34,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:34,439 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:34,439 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:34,440 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:34,440 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:34,440 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:48:34,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:34,440 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:48:34,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:34,442 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:48:34,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:48:34,442 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:34,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:48:34,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:48:34,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:48:34,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:48:34,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:48:34,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:48:34,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:48:34,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:48:34,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:48:34,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:34,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:48:34,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:34,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:34,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:34,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:48:34,446 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:48:34,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:48:34,447 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:48:34,450 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:48:34,450 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:34,452 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:34,452 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:34,453 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 117/400.
2025-08-04 20:48:34,555 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:34,555 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:34,556 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 591 anomalous samples to GAN training data (target: 591).
2025-08-04 20:48:34,557 - ClientAppLogger [Client 2] - INFO - [Client] Round 117: Training GAN with 2563 samples (1972 normal, 591 anomalous).
2025-08-04 20:48:34,557 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:36,441 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.7842
2025-08-04 20:48:36,441 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.7842
2025-08-04 20:48:36,441 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:36,449 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4736, Threshold=0.5370, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:48:36,449 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:48:36,450 - ClientAppLogger [Client 2] - INFO - Fit completed for round 117. Duration: 2.00s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 117, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0843863541848298, 'd_loss': 0.7841961031401012, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.9958508014678955, 'cpu_percent_fit': 31.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2563}
2025-08-04 20:48:36,450 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:48:41,725 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:41,726 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:41,726 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:41,726 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:41,726 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:41,726 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:41,997 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:41,997 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:42,085 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:42,115 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:42,115 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:42,217 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:42,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:42,224 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:42,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:48:42,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:42,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:48:42,240 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:42,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:42,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:48:42,249 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:42,251 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,254 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:42,256 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:42,258 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:42,261 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:42,263 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,266 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:42,268 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:42,271 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:42,273 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:42,282 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:42,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:48:42,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:48:42,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:48:42,291 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:42,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:48:42,299 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:42,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:48:42,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:42,317 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:42,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:48:42,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:48:42,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:42,326 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:42,326 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:42,327 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:42,327 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:42,327 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:48:42,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:42,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:48:42,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:42,329 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:48:42,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:48:42,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:48:42,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:48:42,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:48:42,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:48:42,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:48:42,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:48:42,332 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:48:42,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:48:42,332 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:48:42,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:48:42,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:48:42,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:42,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:48:42,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:42,333 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:42,334 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:42,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:48:42,334 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:48:42,334 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:48:42,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:48:42,338 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:48:42,338 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:42,340 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:42,340 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:42,342 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:42,342 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:42,342 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:42,343 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:42,353 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4733, Threshold=0.5371, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:48:42,353 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4733
2025-08-04 20:48:53,622 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:53,623 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:53,623 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:53,623 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:53,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:53,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:53,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:53,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:53,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:54,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:54,013 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:54,116 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:54,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:54,124 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:54,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:48:54,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:54,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:48:54,154 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:54,154 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:54,154 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:48:54,165 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:54,168 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,171 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:54,173 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:54,176 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:54,179 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:54,182 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,185 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:54,188 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:54,191 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:54,194 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:54,205 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:54,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:48:54,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:48:54,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:48:54,217 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:54,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:48:54,228 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:54,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:48:54,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:54,246 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:54,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:48:54,256 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:48:54,256 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:54,256 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:54,256 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:54,256 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:54,257 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:54,257 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:48:54,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:54,257 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:48:54,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:54,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:48:54,259 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:48:54,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:54,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:48:54,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:54,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:54,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:54,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:48:54,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:48:54,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:48:54,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:48:54,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:48:54,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:54,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:48:54,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:54,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:54,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:54,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:48:54,265 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:48:54,265 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:48:54,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:48:54,271 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:48:54,271 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:54,273 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:54,273 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:48:54,275 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:54,275 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:54,275 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:54,276 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:54,284 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5021, Threshold=0.5741, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:48:54,284 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5021
2025-08-04 20:48:59,544 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:59,544 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:48:59,544 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:48:59,544 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:48:59,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:48:59,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:59,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:59,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:59,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:48:59,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:48:59,921 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:00,005 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:00,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:00,012 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:00,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:49:00,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:00,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:49:00,022 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:00,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:00,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:49:00,030 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:00,033 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:00,035 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:00,037 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:00,039 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:00,041 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:00,044 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:00,046 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:00,049 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:00,051 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:00,053 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:00,061 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:00,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:49:00,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:49:00,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:49:00,070 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:00,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:49:00,078 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:00,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:49:00,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:00,092 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:00,097 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:49:00,103 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:49:00,103 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:00,103 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:00,104 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:00,104 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:00,104 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:00,104 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:49:00,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:00,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:49:00,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:00,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:49:00,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:49:00,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:00,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:49:00,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:00,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:49:00,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:49:00,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:49:00,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:49:00,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:49:00,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:49:00,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:49:00,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:49:00,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:00,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:49:00,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:49:00,115 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:49:00,115 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:00,117 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:00,117 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:00,119 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 119/400.
2025-08-04 20:49:00,219 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:00,219 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:00,220 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 603 anomalous samples to GAN training data (target: 603).
2025-08-04 20:49:00,221 - ClientAppLogger [Client 2] - INFO - [Client] Round 119: Training GAN with 2613 samples (2010 normal, 603 anomalous).
2025-08-04 20:49:00,221 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:02,100 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0843, Avg D Loss: 0.7810
2025-08-04 20:49:02,100 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0843, Avg D Loss: 0.7810
2025-08-04 20:49:02,101 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:02,108 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4830, Threshold=0.5520, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:49:02,108 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:49:02,108 - ClientAppLogger [Client 2] - INFO - Fit completed for round 119. Duration: 1.99s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 119, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0842801975738583, 'd_loss': 0.7809757119798131, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 1.989800214767456, 'cpu_percent_fit': 31.23125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2613}
2025-08-04 20:49:02,109 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:49:07,384 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:07,384 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:07,384 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:07,384 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:49:07,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:49:07,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:07,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:07,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:07,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:49:07,811 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:49:07,811 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:07,904 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:07,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:07,910 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:07,914 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:49:07,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:07,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:49:07,920 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:07,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:07,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:49:07,929 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:07,931 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,934 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:07,936 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:07,938 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:07,941 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:07,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,946 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:07,949 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:07,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:07,953 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:07,961 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:07,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:49:07,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:49:07,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:49:07,970 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:07,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:49:07,978 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:07,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:49:07,979 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:07,994 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:07,999 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:49:08,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:49:08,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:08,005 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:08,005 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:08,006 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:08,006 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:08,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:49:08,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:08,007 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:49:08,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:08,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:49:08,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:49:08,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:08,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:49:08,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:08,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:08,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:08,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:49:08,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:49:08,010 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:49:08,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:49:08,010 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:49:08,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:49:08,011 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:49:08,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:49:08,011 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:49:08,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:49:08,011 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:49:08,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:49:08,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:08,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:49:08,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:08,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:08,013 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:08,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:49:08,013 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:49:08,013 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:49:08,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:49:08,017 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:49:08,017 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:08,019 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:08,019 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:08,020 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:08,021 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:08,021 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:08,022 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:08,029 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4828, Threshold=0.5522, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:49:08,029 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4828
2025-08-04 20:49:25,320 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:25,320 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:25,320 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:25,320 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:49:25,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:49:25,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:25,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:25,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:25,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:49:25,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:49:25,778 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:25,893 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:25,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:25,900 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:25,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:49:25,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:25,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:49:25,927 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:25,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:25,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:49:25,937 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:25,940 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,942 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:25,944 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:25,947 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:25,949 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:25,951 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,954 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:25,956 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:25,959 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:25,961 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:25,971 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:25,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:49:25,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:49:25,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:49:25,981 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:25,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:49:25,992 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:25,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:49:25,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:26,009 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:26,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:49:26,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:49:26,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:26,021 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:26,021 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:26,021 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:26,021 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:26,022 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:49:26,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:26,022 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:49:26,022 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:26,023 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:49:26,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:49:26,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:26,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:49:26,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:26,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:26,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:26,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:49:26,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:49:26,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:49:26,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:49:26,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:49:26,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:49:26,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:49:26,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:49:26,026 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:49:26,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:49:26,027 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:49:26,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:49:26,027 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:26,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:49:26,027 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:26,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:49:26,028 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:49:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:49:26,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:49:26,034 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:49:26,034 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:26,035 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:26,035 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:26,037 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:26,037 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:26,037 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:26,038 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:26,045 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5003, Threshold=0.5711, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:49:26,046 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5003
2025-08-04 20:49:37,313 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:37,313 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:37,313 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:37,314 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:49:37,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:49:37,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:37,617 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:37,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:37,710 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:49:37,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:49:37,745 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:37,872 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:37,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:37,881 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:37,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:49:37,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:37,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:49:37,904 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:37,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:37,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:49:37,914 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:37,916 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,920 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:37,922 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:37,924 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:37,926 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:37,929 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,932 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:37,934 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:37,936 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:37,938 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:37,949 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:37,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:49:37,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:49:37,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:49:37,960 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:37,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:49:37,968 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:37,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:49:37,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:37,985 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:37,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:49:37,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:49:37,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:37,996 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:37,996 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:37,997 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:37,997 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:37,997 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:49:37,997 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:37,998 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:49:37,998 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:37,999 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:49:37,999 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:49:38,000 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:38,000 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:49:38,000 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:38,000 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:38,000 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:38,000 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:49:38,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:49:38,001 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:49:38,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:49:38,001 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:49:38,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:49:38,002 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:49:38,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:49:38,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:49:38,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:49:38,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:49:38,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:49:38,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:38,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:49:38,004 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:38,004 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:38,004 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:38,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:49:38,005 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:49:38,005 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:49:38,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:49:38,011 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:49:38,011 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:38,012 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:38,012 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:38,014 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:38,014 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:38,014 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:38,014 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:38,023 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4429, Threshold=0.4898, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:49:38,023 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4429
2025-08-04 20:49:49,300 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:49,300 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:49,300 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:49,300 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:49:49,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:49:49,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:49,631 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:49,631 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:49,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:49:49,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:49:49,753 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:49,902 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:49,911 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:49,911 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:49,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:49:49,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:49,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:49:49,934 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:49,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:49,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:49:49,945 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:49,948 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:49,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:49,952 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:49,955 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:49,957 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:49,960 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:49,963 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:49,966 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:49,967 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:49,970 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:49,980 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:49,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:49:49,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:49:49,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:49:49,990 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:49,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:49:50,003 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:50,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:49:50,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:50,021 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:50,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:49:50,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:49:50,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:50,033 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:50,033 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:50,033 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:50,034 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:50,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:49:50,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:50,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:49:50,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:50,036 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:49:50,036 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:49:50,036 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:50,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:49:50,037 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:50,037 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:50,037 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:50,037 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:49:50,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:49:50,038 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:49:50,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:49:50,038 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:49:50,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:49:50,040 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:49:50,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:49:50,040 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:49:50,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:49:50,041 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:49:50,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:49:50,041 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:50,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:49:50,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:50,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:50,042 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:50,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:49:50,043 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:49:50,043 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:49:50,043 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:49:50,050 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:49:50,050 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:50,052 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:50,052 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:50,053 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:50,053 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:50,054 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:50,054 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:50,064 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5109, Threshold=0.5962, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:49:50,064 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5109
2025-08-04 20:49:55,321 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:55,321 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:49:55,321 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:49:55,321 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:49:55,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:49:55,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:55,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:55,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:55,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:49:55,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:49:55,771 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:55,873 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:55,878 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:55,878 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:55,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:49:55,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:55,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:49:55,893 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:55,894 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:55,894 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:49:55,903 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:55,906 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:55,908 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:55,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:55,913 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:55,916 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:55,918 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:55,920 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:55,923 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:55,925 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:55,927 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:55,937 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:55,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:49:55,942 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:49:55,942 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:49:55,947 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:55,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:49:55,957 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:55,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:49:55,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:55,973 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:55,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:49:55,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:49:55,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:55,984 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:55,984 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:55,984 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:55,985 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:55,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:49:55,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:55,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:49:55,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:55,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:49:55,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:49:55,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:55,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:49:55,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:55,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:55,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:55,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:49:55,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:49:55,989 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:49:55,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:49:55,989 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:49:55,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:49:55,991 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:49:55,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:49:55,991 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:49:55,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:49:55,992 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:49:55,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:49:55,992 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:55,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:49:55,993 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:55,993 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:55,993 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:55,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:49:55,994 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:49:55,994 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:49:55,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:49:55,998 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:49:55,998 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:56,000 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:56,000 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:49:56,002 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 123/400.
2025-08-04 20:49:56,103 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:56,103 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:56,105 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 623 anomalous samples to GAN training data (target: 623).
2025-08-04 20:49:56,105 - ClientAppLogger [Client 2] - INFO - [Client] Round 123: Training GAN with 2700 samples (2077 normal, 623 anomalous).
2025-08-04 20:49:56,105 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:58,189 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.7820
2025-08-04 20:49:58,189 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.7820
2025-08-04 20:49:58,189 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:58,197 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5324, Threshold=0.6199, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:49:58,197 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:49:58,198 - ClientAppLogger [Client 2] - INFO - Fit completed for round 123. Duration: 2.20s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 123, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0841756266134754, 'd_loss': 0.7819858906887196, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.1959023475646973, 'cpu_percent_fit': 31.20625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2700}
2025-08-04 20:49:58,198 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:50:03,462 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:03,463 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:03,463 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:03,463 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:50:03,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:50:03,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:03,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:03,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:03,824 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:50:03,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:50:03,855 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:03,953 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:03,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:03,959 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:03,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:50:03,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:03,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:50:03,977 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:03,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:03,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:50:03,986 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:03,989 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,991 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:03,993 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:03,996 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:03,998 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:04,001 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:04,003 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:04,006 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:04,008 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:04,011 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:04,023 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:04,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:50:04,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:50:04,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:50:04,032 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:04,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:50:04,041 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:04,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:50:04,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:04,056 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:04,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:50:04,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:50:04,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:04,066 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:04,066 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:04,066 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:04,067 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:04,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:50:04,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:04,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:50:04,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:04,069 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:50:04,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:50:04,069 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:50:04,070 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:50:04,071 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:50:04,071 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:50:04,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:50:04,072 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:50:04,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:50:04,072 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:50:04,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:50:04,072 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:04,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:50:04,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:04,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:04,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:04,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:50:04,074 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:50:04,074 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:50:04,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:50:04,077 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:50:04,077 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:04,078 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:04,078 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:04,079 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:04,080 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:04,080 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:04,080 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:04,088 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5279, Threshold=0.6147, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:50:04,088 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5279
2025-08-04 20:50:18,365 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:18,365 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:18,365 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:18,365 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:50:18,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:50:18,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:18,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:18,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:18,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:50:18,762 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:50:18,762 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:18,859 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:18,868 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:18,869 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:18,876 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:50:18,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:18,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:50:18,884 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:18,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:18,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:50:18,893 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:18,895 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:18,900 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:18,902 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:18,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:18,907 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:18,912 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:18,914 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:18,916 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:18,926 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:18,926 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:50:18,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:50:18,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:50:18,936 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:18,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:50:18,945 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:18,945 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:50:18,945 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:18,961 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:18,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:50:18,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:50:18,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:18,973 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:18,973 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:18,974 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:18,974 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:18,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:50:18,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:18,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:50:18,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:18,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:50:18,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:50:18,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:18,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:50:18,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:18,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:50:18,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:50:18,979 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:50:18,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:50:18,980 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:50:18,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:50:18,981 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:50:18,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:50:18,981 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:18,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:50:18,982 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:18,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:18,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:18,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:50:18,986 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:50:18,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:50:18,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:50:18,990 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:50:18,991 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:18,992 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:18,992 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:18,993 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:18,993 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:18,994 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:18,994 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:19,002 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5072, Threshold=0.5925, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:50:19,002 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5072
2025-08-04 20:50:27,253 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:27,253 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:27,253 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:27,253 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:50:27,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:50:27,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:27,476 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:27,477 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:27,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:50:27,587 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:50:27,587 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:27,669 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:27,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:27,674 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:27,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:50:27,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:27,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:50:27,688 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:27,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:27,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:50:27,697 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:27,700 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:27,702 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:27,704 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:27,707 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:27,709 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:27,712 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:27,714 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:27,717 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:27,719 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:27,721 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:27,729 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:27,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:50:27,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:50:27,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:50:27,738 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:27,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:50:27,746 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:27,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:50:27,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:27,761 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:27,766 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:50:27,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:50:27,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:27,771 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:27,771 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:27,771 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:27,772 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:27,772 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:50:27,772 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:27,772 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:50:27,772 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:27,773 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:50:27,773 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:50:27,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:50:27,775 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:50:27,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:50:27,775 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:50:27,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:50:27,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:50:27,776 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:50:27,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:50:27,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:50:27,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:50:27,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:50:27,777 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:27,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:50:27,778 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:27,781 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:27,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:27,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:50:27,782 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:50:27,782 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:50:27,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:50:27,785 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:50:27,785 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:27,787 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:27,787 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:27,789 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 125/400.
2025-08-04 20:50:27,889 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:27,890 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:27,891 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 632 anomalous samples to GAN training data (target: 632).
2025-08-04 20:50:27,894 - ClientAppLogger [Client 2] - INFO - [Client] Round 125: Training GAN with 2741 samples (2109 normal, 632 anomalous).
2025-08-04 20:50:27,894 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:29,978 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0840, Avg D Loss: 0.7798
2025-08-04 20:50:29,978 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0840, Avg D Loss: 0.7798
2025-08-04 20:50:29,978 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:29,986 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5159, Threshold=0.5949, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:50:29,986 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:50:29,987 - ClientAppLogger [Client 2] - INFO - Fit completed for round 125. Duration: 2.20s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 125, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0840113148903248, 'd_loss': 0.7797687260915831, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.1978414058685303, 'cpu_percent_fit': 31.23125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2741}
2025-08-04 20:50:29,987 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:50:35,241 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:35,242 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:35,242 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:35,242 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:50:35,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:50:35,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:35,526 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:35,526 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:35,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:50:35,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:50:35,639 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:35,747 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:35,758 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:35,758 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:35,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:50:35,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:35,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:50:35,782 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:35,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:35,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:50:35,792 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:35,795 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:35,797 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:35,800 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:35,802 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:35,805 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:35,808 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:35,811 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:35,814 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:35,817 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:35,819 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:35,832 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:35,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:50:35,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:50:35,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:50:35,846 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:35,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:50:35,870 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:35,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:50:35,871 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:35,894 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:35,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:50:35,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:50:35,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:35,914 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:35,914 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:35,915 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:35,915 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:35,916 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:50:35,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:35,917 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:50:35,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:35,919 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:50:35,919 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:50:35,919 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:35,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:50:35,921 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:35,921 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:35,921 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:35,921 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:50:35,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:50:35,922 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:50:35,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:50:35,922 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:50:35,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:50:35,924 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:50:35,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:50:35,924 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:50:35,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:50:35,924 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:50:35,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:50:35,925 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:35,925 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:50:35,925 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:35,926 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:35,926 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:35,926 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:50:35,926 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:50:35,927 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:50:35,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:50:35,932 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:50:35,933 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:35,934 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:35,934 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:35,937 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:35,937 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:35,937 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:35,938 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:35,947 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5139, Threshold=0.5946, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:50:35,948 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5139
2025-08-04 20:50:50,224 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:50,224 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:50:50,224 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:50:50,224 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:50:50,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:50:50,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:50,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:50,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:50,748 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:50:50,786 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:50:50,786 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:50,935 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:50,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:50,945 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:50,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:50:50,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:50,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:50:50,985 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:50,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:50,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:50:50,997 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:51,001 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:51,004 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:51,007 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:51,010 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:51,014 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:51,017 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:51,020 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:51,024 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:51,027 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:51,031 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:51,046 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:51,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:50:51,052 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:50:51,052 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:50:51,060 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:51,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:50:51,077 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:51,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:50:51,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:51,094 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:51,098 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:50:51,104 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:50:51,104 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:51,104 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:51,105 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:51,105 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:51,105 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:51,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:50:51,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:51,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:50:51,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:51,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:50:51,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:50:51,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:51,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:50:51,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:51,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:51,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:51,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:50:51,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:50:51,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:50:51,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:50:51,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:50:51,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:50:51,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:50:51,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:50:51,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:50:51,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:50:51,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:50:51,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:50:51,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:51,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:50:51,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:51,115 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:51,116 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:51,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:50:51,116 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:50:51,116 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:50:51,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:50:51,123 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:50:51,123 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:51,125 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:51,126 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:50:51,127 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:51,127 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:51,128 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:51,128 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:51,136 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5051, Threshold=0.5912, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:50:51,136 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5051
2025-08-04 20:51:08,411 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:08,412 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:08,412 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:08,412 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:51:08,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:51:08,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:08,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:08,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:08,797 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:51:08,829 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:51:08,829 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:08,934 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:08,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:08,942 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:08,949 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:51:08,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:08,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:51:08,961 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:08,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:08,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:51:08,972 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:08,975 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:08,979 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:08,981 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:08,984 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:08,986 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:08,989 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:08,992 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:08,994 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:08,997 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:08,999 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:09,010 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:09,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:51:09,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:51:09,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:51:09,020 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:09,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:51:09,032 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:09,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:51:09,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:09,052 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:09,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:51:09,070 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:51:09,071 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:09,071 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:09,071 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:09,072 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:09,072 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:09,072 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:51:09,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:09,073 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:51:09,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:09,075 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:51:09,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:51:09,075 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:09,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:51:09,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:09,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:09,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:09,076 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:51:09,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:51:09,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:51:09,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:51:09,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:51:09,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:51:09,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:51:09,080 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:51:09,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:51:09,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:51:09,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:51:09,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:51:09,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:09,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:51:09,082 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:09,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:09,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:09,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:51:09,086 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:51:09,087 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:51:09,087 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:51:09,092 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:51:09,093 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:09,095 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:09,095 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:09,096 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:09,096 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:09,097 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:09,097 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:09,108 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5074, Threshold=0.5941, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:51:09,108 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5074
2025-08-04 20:51:23,379 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:23,380 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:23,380 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:23,380 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:51:23,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:51:23,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:23,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:23,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:23,813 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:51:23,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:51:23,847 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:23,951 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:23,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:23,958 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:23,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:51:23,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:23,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:51:23,976 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:23,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:23,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:51:23,987 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:23,990 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:23,992 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:23,994 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:23,997 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:23,999 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:24,002 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,005 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:24,007 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:24,010 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:24,012 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:24,023 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:24,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:51:24,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:51:24,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:51:24,034 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:24,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:51:24,043 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:24,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:51:24,044 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:24,061 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:24,066 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:51:24,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:51:24,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:24,076 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:24,077 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:24,077 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:24,077 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:24,077 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:51:24,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:24,078 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:51:24,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:24,079 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:51:24,080 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:51:24,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:24,080 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:51:24,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:24,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:24,080 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:24,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:51:24,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:51:24,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:51:24,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:51:24,081 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:51:24,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:51:24,083 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:51:24,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:51:24,083 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:51:24,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:51:24,084 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:51:24,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:51:24,084 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:24,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:51:24,085 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:24,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:24,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:24,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:51:24,089 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:51:24,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:51:24,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:51:24,094 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:51:24,094 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:24,096 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:24,096 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:24,098 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:24,098 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:24,098 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:24,099 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:24,107 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5021, Threshold=0.5799, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:51:24,107 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5021
2025-08-04 20:51:32,358 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:32,359 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:32,359 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:32,359 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:51:32,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:51:32,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:32,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:32,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:32,678 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:51:32,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:51:32,705 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:32,790 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:32,794 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:32,794 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:32,800 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:51:32,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:32,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:51:32,807 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:32,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:32,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:51:32,817 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:32,820 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:32,822 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:32,824 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:32,826 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:32,828 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:32,831 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:32,833 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:32,836 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:32,838 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:32,840 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:32,848 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:32,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:51:32,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:51:32,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:51:32,857 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:32,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:51:32,866 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:32,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:51:32,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:32,880 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:32,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:51:32,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:51:32,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:32,890 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:32,890 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:32,891 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:32,891 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:32,891 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:51:32,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:32,892 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:51:32,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:32,893 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:51:32,894 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:51:32,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:32,894 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:51:32,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:32,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:32,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:32,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:51:32,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:51:32,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:51:32,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:51:32,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:51:32,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:51:32,896 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:51:32,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:51:32,896 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:51:32,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:51:32,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:51:32,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:51:32,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:32,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:51:32,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:32,898 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:32,898 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:32,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:51:32,898 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:51:32,899 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:51:32,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:51:32,902 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:51:32,902 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:32,903 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:32,904 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:32,905 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 129/400.
2025-08-04 20:51:33,006 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:33,006 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:33,007 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 654 anomalous samples to GAN training data (target: 654).
2025-08-04 20:51:33,008 - ClientAppLogger [Client 2] - INFO - [Client] Round 129: Training GAN with 2836 samples (2182 normal, 654 anomalous).
2025-08-04 20:51:33,008 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:35,065 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7821
2025-08-04 20:51:35,065 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7821
2025-08-04 20:51:35,065 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:35,073 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5021, Threshold=0.5837, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:51:35,073 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:51:35,073 - ClientAppLogger [Client 2] - INFO - Fit completed for round 129. Duration: 2.17s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 129, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083920796028482, 'd_loss': 0.7821409128616826, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.168231964111328, 'cpu_percent_fit': 31.225, 'ram_mb_fit': 4.73828125, 'accumulated_train_samples_this_round': 2836}
2025-08-04 20:51:35,073 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:51:40,333 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:40,333 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:40,333 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:40,333 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:51:40,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:51:40,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:40,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:40,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:40,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:51:40,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:51:40,666 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:40,752 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:40,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:40,757 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:40,763 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:51:40,770 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:40,770 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:51:40,771 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:40,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:40,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:51:40,780 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:40,783 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:40,785 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:40,787 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:40,790 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:40,792 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:40,794 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:40,796 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:40,799 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:40,801 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:40,803 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:40,812 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:40,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:51:40,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:51:40,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:51:40,821 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:40,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:51:40,831 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:40,831 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:51:40,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:40,846 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:40,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:51:40,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:51:40,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:40,855 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:40,856 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:40,856 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:40,856 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:40,856 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:51:40,856 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:40,857 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:51:40,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:40,858 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:51:40,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:51:40,859 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:40,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:51:40,859 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:40,859 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:40,859 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:40,860 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:51:40,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:51:40,860 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:51:40,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:51:40,860 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:51:40,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:51:40,861 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:51:40,861 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:51:40,862 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:51:40,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:51:40,862 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:51:40,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:51:40,862 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:40,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:51:40,863 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:40,863 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:40,863 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:40,863 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:51:40,864 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:51:40,864 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:51:40,864 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:51:40,867 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:51:40,868 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:40,869 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:40,869 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:40,870 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:40,871 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:40,871 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:40,871 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:40,879 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5841, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:51:40,879 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5018
2025-08-04 20:51:46,123 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:46,123 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:46,124 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:46,124 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:51:46,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:51:46,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:46,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:46,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:46,459 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:51:46,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:51:46,488 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:46,574 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:46,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:46,579 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:46,585 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:51:46,593 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:46,593 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:51:46,594 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:46,594 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:46,594 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:51:46,602 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:46,605 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:46,607 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:46,610 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:46,613 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:46,615 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:46,617 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:46,620 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:46,623 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:46,625 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:46,627 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:46,636 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:46,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:51:46,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:51:46,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:51:46,645 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:46,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:51:46,654 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:46,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:51:46,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:46,669 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:46,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:51:46,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:51:46,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:46,679 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:46,679 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:46,680 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:46,680 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:46,680 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:51:46,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:46,680 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:51:46,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:46,682 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:51:46,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:51:46,682 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:46,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:51:46,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:51:46,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:51:46,684 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:51:46,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:51:46,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:51:46,685 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:51:46,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:51:46,685 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:51:46,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:46,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:51:46,686 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:46,686 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:46,687 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:46,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:51:46,687 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:51:46,687 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:51:46,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:51:46,691 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:51:46,691 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:46,692 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:46,693 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:46,694 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 130/400.
2025-08-04 20:51:46,795 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:46,795 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:46,796 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 658 anomalous samples to GAN training data (target: 658).
2025-08-04 20:51:46,797 - ClientAppLogger [Client 2] - INFO - [Client] Round 130: Training GAN with 2854 samples (2196 normal, 658 anomalous).
2025-08-04 20:51:46,797 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:48,906 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0843, Avg D Loss: 0.7825
2025-08-04 20:51:48,907 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0843, Avg D Loss: 0.7825
2025-08-04 20:51:48,907 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:48,915 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4734, Threshold=0.5369, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:51:48,915 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:51:48,915 - ClientAppLogger [Client 2] - INFO - Fit completed for round 130. Duration: 2.22s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 130, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0842749999633767, 'd_loss': 0.7824922542431677, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.2207531929016113, 'cpu_percent_fit': 31.275, 'ram_mb_fit': 0.296875, 'accumulated_train_samples_this_round': 2854}
2025-08-04 20:51:48,915 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:51:54,182 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:54,183 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:51:54,183 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:51:54,183 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:51:54,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:51:54,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:54,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:51:54,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:51:54,689 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:54,821 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:54,830 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:54,830 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:54,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:51:54,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:54,878 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:51:54,878 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:54,879 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:54,879 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:51:54,888 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:54,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:54,896 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:54,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:54,900 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:54,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:54,908 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:54,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:54,914 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:54,928 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:54,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:51:54,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:51:54,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:51:54,939 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:54,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:51:54,951 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:54,952 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:51:54,952 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:54,968 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:54,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:51:54,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:51:54,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:54,980 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:54,981 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:54,981 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:54,981 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:54,981 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:51:54,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:54,982 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:51:54,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:54,983 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:51:54,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:51:54,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:54,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:51:54,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:54,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:54,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:54,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:51:54,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:51:54,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:51:54,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:51:54,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:51:54,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:51:54,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:51:54,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:51:54,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:51:54,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:51:54,988 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:51:54,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:51:54,989 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:54,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:51:54,989 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:54,993 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:54,994 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:54,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:51:54,994 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:51:54,994 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:51:54,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:51:55,000 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:51:55,001 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:55,002 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:55,002 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:51:55,004 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:55,004 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:55,004 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:55,005 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:55,015 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4744, Threshold=0.5384, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:51:55,015 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4744
2025-08-04 20:52:06,290 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,290 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:06,291 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:06,291 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:52:06,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:52:06,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:06,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:06,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:06,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:52:06,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:52:06,882 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:07,031 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:07,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:07,038 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:07,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:52:07,088 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:07,088 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:52:07,089 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:07,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:07,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:52:07,098 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:07,102 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,105 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:07,107 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:07,110 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:07,112 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:07,115 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,118 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:07,120 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:07,122 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:07,125 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:07,138 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:07,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:52:07,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:52:07,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:52:07,152 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:07,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:52:07,167 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:07,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:52:07,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:07,187 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:07,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:52:07,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:52:07,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:07,202 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:07,203 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:07,203 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:07,203 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:07,203 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:52:07,204 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:07,204 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:52:07,204 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:07,205 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:52:07,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:52:07,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:07,206 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:52:07,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:07,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:07,206 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:07,207 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:52:07,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:52:07,207 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:52:07,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:52:07,207 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:52:07,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:52:07,209 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:52:07,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:52:07,209 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:52:07,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:52:07,209 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:52:07,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:52:07,210 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:07,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:52:07,210 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:07,214 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:07,214 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:07,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:52:07,215 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:52:07,215 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:52:07,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:52:07,222 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:52:07,222 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:07,223 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:07,223 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:07,225 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:07,225 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:07,225 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:07,226 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:07,235 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4994, Threshold=0.5777, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:52:07,236 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4994
2025-08-04 20:52:18,516 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:18,516 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:18,517 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:18,517 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:52:18,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:52:18,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:18,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:18,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:19,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:52:19,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:52:19,063 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:19,168 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:19,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:19,176 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:19,185 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:52:19,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:19,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:52:19,220 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:19,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:19,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:52:19,231 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:19,234 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,236 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:19,238 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:19,241 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:19,243 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:19,245 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,248 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:19,251 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:19,253 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:19,257 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:19,267 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:19,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:52:19,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:52:19,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:52:19,279 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:19,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:52:19,294 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:19,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:52:19,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:19,312 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:19,317 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:52:19,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:52:19,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:19,324 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:19,324 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:19,324 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:19,324 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:19,324 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:52:19,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:19,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:52:19,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:19,326 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:52:19,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:52:19,327 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:19,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:52:19,327 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:19,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:19,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:19,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:52:19,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:52:19,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:52:19,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:52:19,329 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:52:19,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:52:19,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:52:19,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:52:19,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:52:19,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:52:19,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:52:19,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:52:19,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:19,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:52:19,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:19,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:19,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:19,332 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:52:19,332 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:52:19,332 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:52:19,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:52:19,338 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:52:19,338 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:19,339 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:19,340 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:19,341 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:19,341 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:19,341 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:19,342 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:19,351 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5190, Threshold=0.6014, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:52:19,351 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5190
2025-08-04 20:52:36,651 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:36,651 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:36,651 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:36,651 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:52:36,652 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:52:36,652 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:36,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:36,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:37,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:52:37,114 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:52:37,114 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:37,230 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:37,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:37,238 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:37,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:52:37,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:37,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:52:37,271 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:37,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:37,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:52:37,282 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:37,286 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,289 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:37,292 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:37,296 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:37,299 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:37,302 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,305 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:37,307 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:37,309 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:37,312 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:37,324 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:37,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:52:37,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:52:37,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:52:37,336 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:37,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:52:37,347 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:37,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:52:37,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:37,365 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:37,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:52:37,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:52:37,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:37,377 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:37,377 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:37,377 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:37,377 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:37,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:52:37,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:37,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:52:37,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:37,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:52:37,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:52:37,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:37,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:52:37,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:37,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:37,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:37,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:52:37,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:52:37,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:52:37,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:52:37,381 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:52:37,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:52:37,382 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:52:37,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:52:37,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:52:37,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:52:37,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:52:37,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:52:37,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:37,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:52:37,384 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:37,384 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:37,384 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:37,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:52:37,385 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:52:37,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:52:37,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:52:37,393 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:52:37,393 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:37,395 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:37,395 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:37,396 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:37,397 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:37,397 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:37,398 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:37,407 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5562, Threshold=0.6462, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:52:37,407 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5562
2025-08-04 20:52:48,685 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:48,685 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:52:48,686 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:52:48,686 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:52:48,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:52:48,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:49,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:49,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:49,118 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:52:49,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:52:49,147 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:49,271 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:49,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:49,281 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:49,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:52:49,301 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:49,301 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:52:49,302 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:49,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:49,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:52:49,313 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:49,317 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:49,319 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:49,322 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:49,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:49,327 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:49,329 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:49,332 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:49,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:49,338 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:49,340 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:49,356 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:49,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:52:49,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:52:49,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:52:49,369 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:49,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:52:49,378 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:49,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:52:49,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:49,396 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:49,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:52:49,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:52:49,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:49,410 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:49,410 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:49,410 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:49,411 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:49,411 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:52:49,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:49,411 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:52:49,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:49,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:52:49,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:52:49,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:49,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:52:49,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:52:49,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:52:49,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:52:49,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:52:49,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:52:49,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:52:49,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:52:49,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:52:49,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:52:49,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:49,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:52:49,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:49,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:49,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:49,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:52:49,421 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:52:49,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:52:49,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:52:49,429 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:52:49,431 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:49,432 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:49,433 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:52:49,435 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:49,435 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:49,436 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:49,437 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:49,453 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4958, Threshold=0.5647, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:52:49,453 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4958
2025-08-04 20:53:00,716 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:00,716 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:00,717 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:00,717 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:53:00,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:53:00,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:01,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:01,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:01,122 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:53:01,155 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:53:01,156 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:01,287 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:01,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:01,294 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:01,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:53:01,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:01,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:53:01,330 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:01,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:01,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:53:01,340 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:01,343 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:01,345 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:01,347 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:01,350 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:01,352 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:01,355 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:01,357 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:01,360 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:01,362 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:01,364 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:01,373 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:01,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:53:01,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:53:01,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:53:01,384 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:01,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:53:01,396 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:01,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:53:01,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:01,414 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:01,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:53:01,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:53:01,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:01,427 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:01,427 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:01,427 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:01,428 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:01,428 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:53:01,428 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:01,428 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:53:01,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:01,430 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:53:01,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:53:01,430 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:01,431 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:53:01,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:01,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:01,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:01,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:53:01,431 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:53:01,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:53:01,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:53:01,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:53:01,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:53:01,434 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:53:01,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:53:01,434 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:53:01,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:53:01,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:53:01,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:53:01,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:01,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:53:01,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:01,440 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:01,440 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:01,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:53:01,440 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:53:01,440 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:53:01,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:53:01,447 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:53:01,447 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:01,448 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:01,448 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:01,450 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:01,450 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:01,450 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:01,451 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:01,460 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5019, Threshold=0.5838, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:53:01,460 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5019
2025-08-04 20:53:06,711 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:06,711 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:06,711 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:06,711 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:53:06,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:53:06,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:06,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:06,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:07,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:53:07,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:53:07,068 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:07,152 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:07,156 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:07,157 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:07,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:53:07,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:07,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:53:07,172 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:07,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:07,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:53:07,180 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:07,183 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:07,185 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:07,188 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:07,191 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:07,193 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:07,196 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:07,198 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:07,201 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:07,203 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:07,205 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:07,214 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:07,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:53:07,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:53:07,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:53:07,223 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:07,223 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:53:07,232 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:07,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:53:07,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:07,249 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:07,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:53:07,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:53:07,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:07,260 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:07,260 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:07,261 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:07,261 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:07,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:53:07,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:07,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:53:07,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:07,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:07,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:53:07,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:53:07,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:53:07,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:53:07,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:53:07,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:53:07,265 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:53:07,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:53:07,265 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:53:07,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:53:07,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:53:07,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:53:07,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:07,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:53:07,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:07,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:07,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:07,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:53:07,270 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:53:07,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:53:07,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:53:07,275 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:53:07,275 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:07,276 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:07,276 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:07,277 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 136/400.
2025-08-04 20:53:07,379 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:07,379 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:07,380 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 687 anomalous samples to GAN training data (target: 687).
2025-08-04 20:53:07,384 - ClientAppLogger [Client 2] - INFO - [Client] Round 136: Training GAN with 2979 samples (2292 normal, 687 anomalous).
2025-08-04 20:53:07,384 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:09,530 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7783
2025-08-04 20:53:09,531 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7783
2025-08-04 20:53:09,531 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:09,539 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5304, Threshold=0.6144, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:53:09,539 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:53:09,539 - ClientAppLogger [Client 2] - INFO - Fit completed for round 136. Duration: 2.26s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 136, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.08353015845876, 'd_loss': 0.7782769014127865, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.2619009017944336, 'cpu_percent_fit': 31.2125, 'ram_mb_fit': 0.16796875, 'accumulated_train_samples_this_round': 2979}
2025-08-04 20:53:09,540 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:53:14,828 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:14,828 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:14,828 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:14,828 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:53:14,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:53:14,829 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:15,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:15,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:15,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:53:15,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:53:15,282 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:15,409 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:15,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:15,417 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:15,437 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:53:15,459 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:15,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:53:15,460 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:15,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:15,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:53:15,470 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:15,473 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,476 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:15,478 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:15,481 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:15,483 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:15,486 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,489 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:15,492 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:15,493 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:15,496 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:15,508 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:15,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:53:15,514 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:53:15,514 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:53:15,520 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:15,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:53:15,533 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:15,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:53:15,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:15,551 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:15,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:53:15,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:53:15,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:15,563 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:15,563 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:15,563 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:15,563 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:15,564 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:53:15,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:15,564 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:53:15,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:15,565 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:53:15,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:53:15,566 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:15,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:53:15,566 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:15,566 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:15,566 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:15,567 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:53:15,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:53:15,567 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:53:15,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:53:15,567 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:53:15,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:53:15,568 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:53:15,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:53:15,568 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:53:15,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:53:15,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:53:15,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:53:15,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:15,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:53:15,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:15,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:15,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:15,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:53:15,574 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:53:15,574 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:53:15,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:53:15,582 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:53:15,582 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:15,583 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:15,583 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:15,585 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:15,585 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:15,585 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:15,585 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:15,595 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5304, Threshold=0.6144, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:53:15,595 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5304
2025-08-04 20:53:35,907 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:35,907 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:35,907 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:35,907 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:53:35,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:53:35,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:36,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:36,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:36,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:53:36,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:53:36,309 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:36,414 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:36,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:36,425 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:36,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:53:36,468 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:36,468 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:53:36,468 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:36,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:36,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:53:36,478 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:36,481 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:36,483 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:36,485 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:36,487 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:36,490 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:36,492 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:36,495 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:36,497 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:36,499 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:36,502 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:36,511 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:36,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:53:36,516 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:53:36,516 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:53:36,520 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:36,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:53:36,531 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:36,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:53:36,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:36,553 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:36,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:53:36,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:53:36,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:36,564 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:36,564 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:36,564 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:36,565 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:36,565 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:53:36,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:36,565 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:53:36,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:36,567 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:53:36,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:53:36,568 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:36,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:53:36,568 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:36,568 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:36,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:36,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:53:36,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:53:36,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:53:36,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:53:36,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:53:36,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:53:36,571 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:53:36,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:53:36,571 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:53:36,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:53:36,571 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:53:36,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:53:36,572 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:36,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:53:36,572 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:36,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:36,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:36,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:53:36,577 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:53:36,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:53:36,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:53:36,582 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:53:36,582 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:36,584 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:36,584 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:36,586 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:36,586 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:36,586 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:36,587 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:36,594 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5292, Threshold=0.6073, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:53:36,594 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5292
2025-08-04 20:53:56,920 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:56,920 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:53:56,920 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:53:56,921 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:53:56,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:53:56,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:57,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:57,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:57,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:53:57,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:53:57,384 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:57,490 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:57,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:57,500 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:57,505 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:53:57,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:57,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:53:57,512 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:57,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:57,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:53:57,523 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:57,526 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,528 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:57,532 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:57,535 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:57,537 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:57,540 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,543 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:57,546 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:57,548 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:57,550 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:57,560 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:57,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:53:57,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:53:57,565 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:53:57,570 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:57,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:53:57,580 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:57,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:53:57,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:57,597 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:57,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:53:57,607 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:53:57,607 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:57,607 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:57,608 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:57,608 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:57,608 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:57,608 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:53:57,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:57,609 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:53:57,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:57,610 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:53:57,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:53:57,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:57,611 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:53:57,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:57,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:57,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:57,611 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:53:57,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:53:57,612 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:53:57,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:53:57,612 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:53:57,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:53:57,613 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:53:57,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:53:57,613 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:53:57,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:53:57,614 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:53:57,614 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:53:57,614 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:57,614 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:53:57,614 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:57,618 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:57,619 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:57,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:53:57,619 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:53:57,619 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:53:57,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:53:57,623 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:53:57,623 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:57,624 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:57,625 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:53:57,626 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:57,626 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:57,626 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:57,627 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:57,635 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5210, Threshold=0.6041, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:53:57,635 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5210
2025-08-04 20:54:15,024 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:15,025 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:15,026 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:15,026 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:54:15,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:54:15,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:15,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:15,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:15,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:54:15,669 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:54:15,669 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:15,800 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:15,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:15,807 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:15,829 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:54:15,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:15,851 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:54:15,852 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:15,852 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:15,852 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:54:15,863 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:15,866 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,868 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:15,870 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:15,873 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:15,875 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:15,877 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,880 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:15,883 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:15,884 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:15,887 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:15,897 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:15,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:54:15,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:54:15,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:54:15,908 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:15,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:54:15,921 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:15,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:54:15,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:15,941 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:15,947 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:54:15,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:54:15,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:15,955 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:15,955 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:15,955 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:15,955 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:15,956 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:54:15,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:15,956 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:54:15,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:15,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:54:15,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:54:15,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:54:15,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:54:15,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:54:15,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:54:15,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:54:15,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:54:15,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:54:15,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:54:15,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:54:15,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:54:15,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:54:15,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:15,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:54:15,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:15,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:15,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:15,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:54:15,967 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:54:15,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:54:15,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:54:15,977 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:54:15,978 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:15,979 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:15,979 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:15,981 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:15,981 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:15,981 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:15,982 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:15,991 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5563, Threshold=0.6494, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:54:15,991 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5563
2025-08-04 20:54:33,324 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:33,324 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:33,324 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:33,324 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:54:33,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:54:33,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:33,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:54:34,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:54:34,021 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:34,142 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:34,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:34,152 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:34,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:54:34,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:34,210 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:54:34,211 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:34,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:34,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:54:34,225 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:34,228 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,231 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:34,236 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:34,240 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:34,243 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:34,246 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,249 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:34,253 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:34,255 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:34,260 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:34,274 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:34,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:54:34,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:54:34,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:54:34,289 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:34,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:54:34,304 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:34,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:54:34,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:34,323 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:34,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:54:34,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:54:34,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:34,336 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:34,336 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:34,337 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:34,337 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:34,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:54:34,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:34,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:54:34,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:34,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:54:34,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:54:34,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:34,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:54:34,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:34,342 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:34,342 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:34,342 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:54:34,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:54:34,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:54:34,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:54:34,344 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:54:34,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:54:34,347 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:54:34,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:54:34,347 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:54:34,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:54:34,349 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:54:34,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:54:34,349 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:34,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:54:34,350 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:34,354 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:34,354 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:34,355 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:54:34,355 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:54:34,356 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:54:34,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:54:34,364 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:54:34,364 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:34,365 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:34,366 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:34,367 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:34,367 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:34,368 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:34,368 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:34,378 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5149, Threshold=0.5898, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:54:34,378 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5149
2025-08-04 20:54:54,731 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:54,731 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:54:54,732 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:54:54,732 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:54:54,733 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:54:54,733 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:55,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:55,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:55,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:54:55,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:54:55,374 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:55,514 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:55,522 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:55,522 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:55,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:54:55,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:55,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:54:55,560 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:55,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:55,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:54:55,569 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:55,572 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,575 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:55,577 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:55,580 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:55,582 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:55,585 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,587 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:55,590 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:55,592 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:55,594 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:55,604 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:55,604 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:54:55,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:54:55,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:54:55,615 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:55,615 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:54:55,626 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:55,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:54:55,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:55,643 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:55,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:54:55,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:54:55,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:55,653 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:55,653 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:55,654 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:55,654 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:55,654 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:54:55,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:55,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:54:55,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:55,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:54:55,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:54:55,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:55,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:54:55,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:55,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:55,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:55,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:54:55,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:54:55,658 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:54:55,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:54:55,658 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:54:55,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:54:55,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:54:55,659 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:54:55,659 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:54:55,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:54:55,660 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:54:55,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:54:55,660 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:55,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:54:55,661 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:55,665 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:55,665 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:55,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:54:55,665 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:54:55,665 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:54:55,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:54:55,675 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:54:55,675 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:55,677 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:55,677 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:54:55,679 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:55,679 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:55,679 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:55,679 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:55,688 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5441, Threshold=0.6231, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:54:55,689 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5441
2025-08-04 20:55:03,940 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:03,940 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:03,940 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:03,940 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:55:03,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:55:03,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:04,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:04,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:04,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:55:04,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:55:04,352 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:04,451 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:04,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:04,457 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:04,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:55:04,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:04,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:55:04,499 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:04,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:04,500 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:55:04,510 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:04,513 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:04,515 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:04,517 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:04,520 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:04,523 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:04,525 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:04,528 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:04,531 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:04,533 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:04,535 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:04,545 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:04,546 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:55:04,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:55:04,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:55:04,557 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:04,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:55:04,568 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:04,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:55:04,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:04,583 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:04,588 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:04,595 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:04,595 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:04,596 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:04,596 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:04,596 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:55:04,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:04,597 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:55:04,597 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:04,598 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:55:04,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:55:04,599 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:04,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:55:04,599 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:04,599 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:04,599 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:04,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:55:04,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:55:04,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:55:04,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:55:04,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:55:04,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:55:04,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:55:04,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:55:04,602 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:55:04,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:55:04,602 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:55:04,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:55:04,602 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:04,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:55:04,603 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:04,606 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:04,606 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:04,606 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:55:04,607 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:55:04,607 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:55:04,607 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:55:04,615 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:55:04,615 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:04,616 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:04,616 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:04,618 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 142/400.
2025-08-04 20:55:04,719 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:04,719 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:04,720 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 719 anomalous samples to GAN training data (target: 719).
2025-08-04 20:55:04,724 - ClientAppLogger [Client 2] - INFO - [Client] Round 142: Training GAN with 3116 samples (2397 normal, 719 anomalous).
2025-08-04 20:55:04,724 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:07,142 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.7794
2025-08-04 20:55:07,143 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.7794
2025-08-04 20:55:07,143 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:07,151 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4944, Threshold=0.5618, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:55:07,151 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:55:07,151 - ClientAppLogger [Client 2] - INFO - Fit completed for round 142. Duration: 2.53s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 142, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083211174886554, 'd_loss': 0.7793856890807562, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.5333480834960938, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 7.73828125, 'accumulated_train_samples_this_round': 3116}
2025-08-04 20:55:07,151 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:55:15,421 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:15,422 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:15,422 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:15,422 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:55:15,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:55:15,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:15,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:15,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:15,886 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:55:15,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:55:15,923 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:16,101 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:16,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:16,109 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:16,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:55:16,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:16,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:55:16,143 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:16,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:16,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:55:16,152 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:16,155 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,157 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:16,159 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:16,162 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:16,164 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:16,166 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,170 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:16,173 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:16,175 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:16,178 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:16,189 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:16,189 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:55:16,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:55:16,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:55:16,202 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:16,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:55:16,219 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:16,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:55:16,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:16,240 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:16,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:55:16,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:55:16,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:16,255 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:16,255 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:16,255 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:16,256 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:16,256 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:55:16,256 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:16,256 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:55:16,256 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:16,258 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:55:16,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:55:16,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:16,259 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:55:16,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:16,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:16,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:16,259 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:55:16,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:55:16,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:55:16,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:55:16,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:55:16,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:55:16,262 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:55:16,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:55:16,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:55:16,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:55:16,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:55:16,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:55:16,263 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:16,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:55:16,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:16,268 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:16,268 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:16,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:55:16,268 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:55:16,269 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:55:16,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:55:16,277 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:55:16,277 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:16,279 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:16,279 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:16,281 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:16,281 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:16,281 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:16,282 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:16,291 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5292, Threshold=0.6075, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:55:16,292 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5292
2025-08-04 20:55:36,600 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:36,601 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:36,601 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:36,601 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:55:36,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:55:36,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:36,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:36,922 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:37,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:55:37,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:55:37,046 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:37,188 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:37,197 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:37,197 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:37,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:55:37,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:37,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:55:37,246 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:37,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:37,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:55:37,255 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:37,259 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,261 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:37,262 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:37,266 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:37,268 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:37,270 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,273 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:37,275 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:37,277 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:37,280 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:37,290 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:37,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:55:37,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:55:37,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:55:37,300 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:37,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:55:37,312 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:37,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:55:37,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:37,330 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:37,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:55:37,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:55:37,344 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:37,344 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:37,344 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:37,345 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:37,345 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:37,345 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:55:37,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:37,345 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:55:37,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:37,347 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:55:37,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:55:37,348 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:37,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:55:37,348 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:37,348 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:37,348 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:37,348 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:55:37,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:55:37,349 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:55:37,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:55:37,349 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:55:37,349 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:55:37,351 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:55:37,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:55:37,351 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:55:37,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:55:37,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:55:37,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:55:37,352 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:37,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:55:37,353 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:37,357 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:37,357 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:37,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:55:37,357 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:55:37,357 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:55:37,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:55:37,366 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:55:37,366 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:37,367 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:37,368 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:37,369 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:37,369 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:37,369 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:37,370 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:37,378 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4657, Threshold=0.5139, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:55:37,379 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4657
2025-08-04 20:55:57,663 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:57,663 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:55:57,664 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:55:57,664 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:55:57,664 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:55:57,664 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:58,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:58,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:58,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:55:58,132 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:55:58,133 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:58,228 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:58,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:58,235 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:58,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:55:58,252 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:58,252 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:55:58,253 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:58,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:58,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:55:58,262 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:58,265 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:58,267 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:58,269 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:58,272 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:58,274 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:58,277 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:58,279 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:58,282 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:58,284 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:58,286 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:58,296 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:58,297 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:55:58,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:55:58,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:55:58,307 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:58,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:55:58,315 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:58,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:55:58,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:58,390 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:58,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:55:58,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:55:58,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:58,401 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:58,401 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:58,402 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:58,402 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:58,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:55:58,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:58,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:55:58,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:58,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:55:58,404 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:55:58,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:58,404 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:55:58,405 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:55:58,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:55:58,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:55:58,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:55:58,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:55:58,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:55:58,407 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:55:58,408 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:55:58,408 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:58,408 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:55:58,408 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:58,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:58,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:58,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:55:58,412 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:55:58,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:55:58,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:55:58,417 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:55:58,417 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:58,418 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:58,418 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:55:58,420 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:58,420 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:58,420 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:58,421 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:58,429 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5630, Threshold=0.6544, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:55:58,429 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5630
2025-08-04 20:56:09,708 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:09,709 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:09,709 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:09,709 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:56:09,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:56:09,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:09,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:09,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:10,048 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:56:10,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:56:10,076 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:10,164 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:10,170 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:10,170 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:10,177 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:56:10,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:10,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:56:10,193 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:10,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:10,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:56:10,202 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:10,204 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:10,207 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:10,209 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:10,211 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:10,214 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:10,216 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:10,219 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:10,222 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:10,223 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:10,226 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:10,235 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:10,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:56:10,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:56:10,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:56:10,244 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:10,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:56:10,254 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:10,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:56:10,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:10,270 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:10,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:56:10,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:56:10,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:10,280 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:10,280 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:10,280 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:10,281 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:10,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:56:10,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:10,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:56:10,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:10,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:56:10,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:56:10,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:56:10,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:56:10,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:56:10,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:56:10,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:56:10,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:56:10,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:56:10,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:56:10,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:56:10,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:56:10,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:56:10,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:10,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:56:10,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:10,291 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:10,291 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:10,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:56:10,291 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:56:10,291 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:56:10,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:56:10,295 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:56:10,296 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:10,297 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:10,297 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:10,298 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:10,299 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:10,299 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:10,300 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:10,308 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4929, Threshold=0.5423, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:56:10,308 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4929
2025-08-04 20:56:27,615 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:27,615 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:27,615 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:27,615 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:56:27,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:56:27,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:27,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:27,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:28,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:56:28,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:56:28,040 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:28,166 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:28,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:28,174 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:28,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:56:28,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:28,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:56:28,205 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:28,206 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:28,206 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:56:28,215 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:28,218 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:28,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:28,222 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:28,225 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:28,227 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:28,230 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:28,233 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:28,235 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:28,237 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:28,239 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:28,249 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:28,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:56:28,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:56:28,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:56:28,260 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:28,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:56:28,272 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:28,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:56:28,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:28,290 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:28,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:56:28,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:56:28,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:28,301 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:28,301 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:28,301 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:28,301 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:28,302 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:56:28,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:28,302 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:56:28,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:28,303 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:28,304 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:56:28,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:56:28,305 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:56:28,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:56:28,305 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:56:28,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:56:28,306 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:56:28,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:56:28,306 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:56:28,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:56:28,306 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:56:28,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:56:28,307 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:28,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:56:28,307 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:28,307 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:28,308 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:28,308 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:56:28,308 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:56:28,308 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:56:28,308 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:56:28,317 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:56:28,317 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:28,318 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:28,319 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:28,320 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:28,320 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:28,320 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:28,321 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:28,330 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5456, Threshold=0.6302, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:56:28,330 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5456
2025-08-04 20:56:48,634 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:48,634 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:48,635 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:48,635 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:56:48,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:56:48,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:48,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:48,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:48,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:56:49,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:56:49,017 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:49,126 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:49,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:49,134 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:49,162 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:56:49,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:49,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:56:49,183 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:49,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:49,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:56:49,192 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:49,195 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:49,197 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:49,199 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:49,202 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:49,204 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:49,207 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:49,209 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:49,212 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:49,214 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:49,216 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:49,226 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:49,226 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:56:49,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:56:49,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:56:49,236 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:49,236 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:56:49,245 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:49,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:56:49,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:49,261 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:49,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:56:49,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:56:49,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:49,271 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:49,272 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:49,272 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:49,272 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:49,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:56:49,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:49,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:56:49,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:49,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:56:49,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:56:49,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:56:49,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:56:49,276 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:56:49,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:56:49,276 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:49,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:56:49,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:49,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:49,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:49,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:56:49,279 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:56:49,279 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:56:49,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:56:49,286 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:56:49,286 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:49,288 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:49,288 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:49,289 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:49,290 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:49,290 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:49,290 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:49,299 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4643, Threshold=0.5059, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:56:49,299 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4643
2025-08-04 20:56:54,556 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:54,556 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:56:54,556 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:56:54,557 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:56:54,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:56:54,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:54,820 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:54,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:54,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:56:54,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:56:54,930 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:55,021 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:55,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:55,028 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:55,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:56:55,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:55,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:56:55,047 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:55,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:55,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:56:55,056 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:55,059 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:55,061 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:55,063 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:55,066 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:55,068 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:55,071 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:55,073 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:55,076 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:55,078 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:55,081 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:55,090 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:55,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:56:55,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:56:55,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:56:55,100 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:55,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:56:55,110 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:55,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:56:55,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:55,126 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:55,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:56:55,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:56:55,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:55,138 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:55,138 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:55,139 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:55,139 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:55,139 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:56:55,139 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:55,140 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:56:55,140 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:55,141 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:56:55,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:56:55,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:56:55,143 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:56:55,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:56:55,143 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:56:55,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:56:55,144 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:56:55,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:56:55,144 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:56:55,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:56:55,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:56:55,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:56:55,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:55,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:56:55,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:55,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:55,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:55,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:56:55,147 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:56:55,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:56:55,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:56:55,153 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:56:55,154 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:55,155 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:55,155 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:56:55,157 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 148/400.
2025-08-04 20:56:55,258 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:55,258 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:55,260 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 750 anomalous samples to GAN training data (target: 750).
2025-08-04 20:56:55,261 - ClientAppLogger [Client 2] - INFO - [Client] Round 148: Training GAN with 3250 samples (2500 normal, 750 anomalous).
2025-08-04 20:56:55,261 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:57,873 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.7763
2025-08-04 20:56:57,873 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.7763
2025-08-04 20:56:57,873 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:57,882 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5066, Threshold=0.5693, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:56:57,882 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:56:57,882 - ClientAppLogger [Client 2] - INFO - Fit completed for round 148. Duration: 2.73s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 148, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0829642969865065, 'd_loss': 0.776274577144476, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.725618362426758, 'cpu_percent_fit': 31.25, 'ram_mb_fit': 6.95703125, 'accumulated_train_samples_this_round': 3250}
2025-08-04 20:56:57,883 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:57:06,212 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:06,212 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:06,212 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:06,212 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:57:06,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:57:06,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:06,585 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:06,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:06,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:57:06,720 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:57:06,720 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:06,871 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:06,878 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:06,878 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:06,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:57:06,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:06,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:57:06,917 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:06,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:06,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:57:06,927 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:06,930 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,932 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:06,934 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:06,937 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:06,940 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:06,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:06,948 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:06,950 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:06,953 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:06,962 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:06,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:57:06,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:57:06,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:57:06,973 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:06,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:57:06,984 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:06,984 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:57:06,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:07,001 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:07,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:57:07,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:57:07,011 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:07,011 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:07,011 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:07,012 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:07,012 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:07,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:57:07,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:07,013 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:57:07,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:07,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:57:07,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:57:07,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:07,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:57:07,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:07,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:07,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:07,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:57:07,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:57:07,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:57:07,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:57:07,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:57:07,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:57:07,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:57:07,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:57:07,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:57:07,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:57:07,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:57:07,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:57:07,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:07,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:57:07,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:07,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:07,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:07,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:57:07,019 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:57:07,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:57:07,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:57:07,030 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:57:07,030 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:07,031 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:07,031 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:07,033 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:07,033 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:07,033 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:07,034 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:07,042 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5180, Threshold=0.5851, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:57:07,042 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5180
2025-08-04 20:57:27,392 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:27,392 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:27,393 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:27,393 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:57:27,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:57:27,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:27,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:27,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:27,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:57:27,980 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:57:27,980 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:28,147 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:28,154 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:28,154 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:28,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:57:28,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:28,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:57:28,200 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:28,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:28,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:57:28,210 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:28,213 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,215 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:28,217 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:28,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:28,223 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:28,225 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,228 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:28,230 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:28,233 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:28,235 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:28,247 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:28,247 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:57:28,252 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:57:28,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:57:28,268 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:28,268 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:57:28,284 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:28,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:57:28,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:28,303 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:28,310 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:57:28,318 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:57:28,318 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:28,319 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:28,319 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:28,319 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:28,319 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:28,320 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:57:28,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:28,320 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:57:28,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:28,321 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:57:28,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:57:28,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:28,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:57:28,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:28,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:57:28,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:57:28,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:57:28,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:57:28,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:57:28,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:57:28,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:57:28,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:57:28,326 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:28,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:57:28,326 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:28,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:28,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:28,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:57:28,331 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:57:28,331 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:57:28,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:57:28,340 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:57:28,340 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:28,342 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:28,342 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:28,344 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:28,344 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:28,344 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:28,345 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:28,354 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5262, Threshold=0.5954, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:57:28,354 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5262
2025-08-04 20:57:48,673 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:48,673 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:57:48,673 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:57:48,673 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:57:48,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:57:48,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:49,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:49,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:49,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:57:49,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:57:49,138 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:49,275 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:49,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:49,283 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:49,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:57:49,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:49,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:57:49,305 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:49,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:49,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:57:49,315 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:49,318 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,320 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:49,323 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:49,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:49,328 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:49,331 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,333 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:49,336 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:49,337 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:49,340 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:49,351 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:49,351 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:57:49,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:57:49,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:57:49,364 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:49,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:57:49,381 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:49,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:57:49,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:49,399 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:49,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:57:49,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:57:49,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:49,414 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:49,414 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:49,415 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:49,415 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:49,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:57:49,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:49,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:57:49,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:49,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:57:49,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:57:49,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:49,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:57:49,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:49,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:49,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:49,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:57:49,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:57:49,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:57:49,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:57:49,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:57:49,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:57:49,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:57:49,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:57:49,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:57:49,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:57:49,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:57:49,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:57:49,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:49,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:57:49,423 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:49,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:49,427 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:49,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:57:49,427 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:57:49,427 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:57:49,428 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:57:49,436 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:57:49,436 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:49,438 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:49,438 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:57:49,440 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:49,440 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:49,440 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:49,441 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:49,451 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5308, Threshold=0.6037, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:57:49,452 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5308
2025-08-04 20:58:06,776 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:06,776 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:06,776 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:06,778 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:58:06,778 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:58:06,778 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:07,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:07,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:07,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:58:07,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:58:07,267 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:07,401 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:07,409 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:07,409 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:07,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:58:07,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:07,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:58:07,423 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:07,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:07,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:58:07,434 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:07,437 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,439 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:07,441 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:07,444 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:07,447 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:07,450 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,453 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:07,456 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:07,458 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:07,460 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:07,471 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:07,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:58:07,476 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:58:07,476 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:58:07,482 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:07,482 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:58:07,497 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:07,497 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:58:07,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:07,516 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:07,523 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:58:07,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:58:07,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:07,531 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:07,531 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:07,531 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:07,532 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:07,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:58:07,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:07,532 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:58:07,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:07,534 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:58:07,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:58:07,534 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:07,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:58:07,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:07,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:07,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:07,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:58:07,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:58:07,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:58:07,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:58:07,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:58:07,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:58:07,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:58:07,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:58:07,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:58:07,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:58:07,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:58:07,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:58:07,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:07,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:58:07,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:07,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:07,544 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:07,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:58:07,544 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:58:07,544 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:58:07,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:58:07,550 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:58:07,550 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:07,552 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:07,552 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:07,553 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:07,553 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:07,553 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:07,554 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:07,562 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5723, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:58:07,562 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5085
2025-08-04 20:58:27,870 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:27,870 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:27,870 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:27,871 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:58:27,871 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:58:27,871 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:28,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:28,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:28,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:58:28,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:58:28,340 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:28,457 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:28,465 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:28,465 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:28,484 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:58:28,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:28,511 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:58:28,511 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:28,512 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:28,513 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:58:28,525 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:28,528 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,530 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:28,532 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:28,535 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:28,538 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:28,540 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:28,543 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:28,546 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:28,548 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:28,550 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:28,562 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:28,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:58:28,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:58:28,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:58:28,573 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:28,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:58:28,586 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:28,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:58:28,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:28,603 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:28,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:58:28,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:58:28,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:28,620 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:28,620 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:28,620 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:28,621 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:28,621 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:58:28,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:28,621 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:58:28,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:28,623 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:58:28,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:58:28,624 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:28,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:58:28,624 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:28,624 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:28,624 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:28,625 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:58:28,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:58:28,625 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:58:28,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:58:28,625 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:58:28,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:58:28,627 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:58:28,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:58:28,628 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:58:28,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:58:28,628 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:58:28,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:58:28,628 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:28,629 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:58:28,629 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:28,633 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:28,633 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:28,633 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:58:28,633 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:58:28,634 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:58:28,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:58:28,641 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:58:28,642 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:28,643 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:28,643 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:28,645 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:28,645 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:28,645 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:28,646 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:28,655 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5594, Threshold=0.6457, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:58:28,655 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5594
2025-08-04 20:58:45,966 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:45,966 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:45,966 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:45,966 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:58:45,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:58:45,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:46,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:46,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:46,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:58:46,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:58:46,460 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:46,594 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:46,603 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:46,603 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:46,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:58:46,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:46,635 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:58:46,636 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:46,637 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:46,637 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:58:46,646 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:46,649 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,651 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:46,653 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:46,656 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:46,659 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:46,663 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,667 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:46,671 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:46,674 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:46,678 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:46,693 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:46,693 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:58:46,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:58:46,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:58:46,707 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:46,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:58:46,721 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:46,722 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:58:46,722 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:46,739 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:46,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:58:46,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:58:46,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:46,750 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:46,750 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:46,750 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:46,751 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:46,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:58:46,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:46,751 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:58:46,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:46,753 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:58:46,753 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:58:46,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:46,754 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:58:46,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:46,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:46,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:46,754 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:58:46,755 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:58:46,755 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:58:46,755 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:58:46,755 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:58:46,755 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:58:46,757 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:58:46,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:58:46,757 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:58:46,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:58:46,758 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:58:46,758 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:58:46,758 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:46,758 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:58:46,758 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:46,759 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:46,759 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:46,759 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:58:46,759 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:58:46,759 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:58:46,760 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:58:46,767 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:58:46,768 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:46,769 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:46,772 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:46,773 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:46,774 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:46,774 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:46,774 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:46,783 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4656, Threshold=0.5135, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:58:46,783 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4656
2025-08-04 20:58:52,050 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:52,050 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:58:52,050 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:58:52,050 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:58:52,051 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:58:52,051 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:52,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:52,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:52,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:58:52,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:58:52,449 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:52,541 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:52,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:52,547 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:52,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:58:52,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:52,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:58:52,602 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:52,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:52,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:58:52,611 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:52,614 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:52,617 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:52,619 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:52,622 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:52,624 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:52,627 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:52,629 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:52,632 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:52,634 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:52,636 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:52,645 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:52,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:58:52,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:58:52,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:58:52,656 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:52,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:58:52,669 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:52,669 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:58:52,669 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:52,686 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:52,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:58:52,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:58:52,697 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:52,697 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:52,697 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:52,698 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:52,698 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:52,698 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:58:52,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:52,698 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:58:52,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:52,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:58:52,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:58:52,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:58:52,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:58:52,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:58:52,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:58:52,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:58:52,703 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:58:52,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:58:52,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:58:52,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:58:52,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:58:52,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:58:52,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:52,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:58:52,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:52,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:52,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:52,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:58:52,706 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:58:52,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:58:52,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:58:52,714 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:58:52,714 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:52,716 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:52,716 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:58:52,717 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 154/400.
2025-08-04 20:58:52,819 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:52,819 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:52,821 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 781 anomalous samples to GAN training data (target: 781).
2025-08-04 20:58:52,822 - ClientAppLogger [Client 2] - INFO - [Client] Round 154: Training GAN with 3386 samples (2605 normal, 781 anomalous).
2025-08-04 20:58:52,822 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:55,467 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0828, Avg D Loss: 0.7779
2025-08-04 20:58:55,467 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0828, Avg D Loss: 0.7779
2025-08-04 20:58:55,468 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:55,475 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5587, Threshold=0.6396, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:58:55,476 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 20:58:55,476 - ClientAppLogger [Client 2] - INFO - Fit completed for round 154. Duration: 2.76s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 154, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0828344966699155, 'd_loss': 0.7779431361491626, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.7584784030914307, 'cpu_percent_fit': 31.2375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3386}
2025-08-04 20:58:55,477 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:59:06,794 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:06,794 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:06,794 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:06,794 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:59:06,795 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:59:06,795 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:07,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:07,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:07,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:59:07,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:59:07,306 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:07,393 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:07,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:07,398 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:07,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:59:07,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:07,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:59:07,457 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:07,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:07,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:59:07,466 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:07,468 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,471 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:07,473 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:07,476 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:07,478 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:07,481 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,484 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:07,488 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:07,489 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:07,492 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:07,502 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:07,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:59:07,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:59:07,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:59:07,513 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:07,513 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:59:07,524 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:07,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:59:07,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:07,539 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:07,543 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:59:07,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:59:07,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:07,550 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:07,550 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:07,551 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:07,551 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:07,551 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:59:07,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:07,551 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:59:07,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:07,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:59:07,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:59:07,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:07,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:59:07,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:07,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:07,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:07,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:59:07,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:59:07,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:59:07,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:59:07,555 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:59:07,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:59:07,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:59:07,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:59:07,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:59:07,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:59:07,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:59:07,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:59:07,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:07,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:59:07,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:07,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:07,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:07,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:59:07,561 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:59:07,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:59:07,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:59:07,569 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:59:07,569 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:07,570 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:07,571 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:07,572 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:07,572 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:07,572 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:07,573 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:07,580 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5228, Threshold=0.5929, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:59:07,582 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5228
2025-08-04 20:59:24,899 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:24,899 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:24,899 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:24,899 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:59:24,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:59:24,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:25,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:25,215 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:25,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:59:25,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:59:25,335 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:25,429 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:25,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:25,434 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:25,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:59:25,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:25,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:59:25,501 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:25,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:25,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:59:25,510 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:25,513 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,515 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:25,518 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:25,521 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:25,523 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:25,526 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,528 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:25,531 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:25,533 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:25,535 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:25,547 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:25,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:59:25,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:59:25,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:59:25,558 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:25,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:59:25,569 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:25,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:59:25,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:25,585 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:25,590 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:59:25,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:59:25,597 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:25,597 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:25,597 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:25,597 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:25,597 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:25,598 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:59:25,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:25,598 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:59:25,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:25,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:59:25,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:59:25,600 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:25,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:59:25,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:25,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:25,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:25,601 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:59:25,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:59:25,602 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:59:25,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:59:25,602 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:59:25,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:59:25,604 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:59:25,604 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:59:25,604 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:59:25,604 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:59:25,604 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:59:25,605 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:59:25,605 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:25,605 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:59:25,605 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:25,609 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:25,609 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:25,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:59:25,610 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:59:25,610 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:59:25,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:59:25,617 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:59:25,618 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:25,620 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:25,620 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:25,621 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:25,622 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:25,622 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:25,623 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:25,633 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5161, Threshold=0.5831, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:59:25,633 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5161
2025-08-04 20:59:36,928 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:36,929 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:36,929 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:36,929 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:59:36,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:59:36,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:37,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:37,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:37,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:59:37,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:59:37,397 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:37,493 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:37,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:37,499 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:37,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:59:37,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:37,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:59:37,569 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:37,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:37,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:59:37,578 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:37,581 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,583 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:37,585 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:37,589 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:37,591 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:37,593 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,596 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:37,599 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:37,601 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:37,603 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:37,613 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:37,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:59:37,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:59:37,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:59:37,624 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:37,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:59:37,635 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:37,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:59:37,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:37,653 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:37,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:59:37,667 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:59:37,667 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:37,667 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:37,667 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:37,667 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:37,668 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:37,668 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:59:37,668 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:37,668 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:59:37,669 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:37,670 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:59:37,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:59:37,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:37,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:59:37,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:37,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:37,671 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:37,672 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:59:37,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:59:37,672 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:59:37,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:59:37,672 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:59:37,673 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:59:37,674 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:59:37,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:59:37,674 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:59:37,675 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:59:37,675 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:59:37,675 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:59:37,675 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:37,675 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:59:37,676 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:37,679 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:37,680 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:37,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:59:37,680 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:59:37,680 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:59:37,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:59:37,689 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:59:37,689 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:37,690 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:37,690 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:37,692 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:37,692 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:37,693 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:37,694 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:37,702 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4931, Threshold=0.5722, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:59:37,702 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4931
2025-08-04 20:59:51,989 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:51,989 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:59:51,989 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:59:51,989 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:59:51,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:59:51,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:52,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:52,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:52,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:59:52,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:59:52,487 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:52,596 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:52,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:52,601 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:52,619 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:59:52,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:52,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:59:52,640 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:52,640 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:52,640 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:59:52,648 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:52,651 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:52,656 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:52,659 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:52,661 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:52,663 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,666 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:52,669 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:52,671 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:52,673 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:52,683 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:52,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:59:52,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:59:52,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:59:52,694 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:52,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:59:52,706 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:52,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:59:52,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:52,723 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:52,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:59:52,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:59:52,736 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:52,736 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:52,736 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:52,736 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:52,737 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:52,737 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:59:52,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:52,737 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:59:52,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:52,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:59:52,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:59:52,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:52,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:59:52,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:52,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:52,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:52,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:59:52,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:59:52,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:59:52,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:59:52,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:59:52,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:59:52,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:59:52,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:59:52,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:59:52,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:59:52,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:59:52,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:59:52,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:52,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:59:52,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:52,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:52,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:52,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:59:52,745 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:59:52,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:59:52,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:59:52,752 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:59:52,752 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:52,754 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:52,754 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:59:52,755 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:52,756 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:52,756 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:52,757 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:52,766 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4999, Threshold=0.5587, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 20:59:52,766 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4999
